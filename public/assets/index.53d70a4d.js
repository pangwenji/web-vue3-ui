var We=Object.defineProperty;var fe=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var ve=(g,_,s)=>_ in g?We(g,_,{enumerable:!0,configurable:!0,writable:!0,value:s}):g[_]=s,_e=(g,_)=>{for(var s in _||(_={}))Xe.call(_,s)&&ve(g,s,_[s]);if(fe)for(var s of fe(_))Ze.call(_,s)&&ve(g,s,_[s]);return g};import{a0 as el,s as ll,g as i,a7 as tl,a3 as ol,r,a8 as he,o as c,i as A,U as h,V as Z,j as t,w as o,k as u,a9 as ye,v as ee,x as le,c as y,m as E,t as ge,l as P,L as p,R as al,S as L}from"./vendor.d1385716.js";import{l as nl,e as ul,f as dl,g as be,h as sl,i as rl,j as il}from"./role.f1249458.js";import{r as pl,t as ml}from"./menu.1cccbd8f.js";import{r as cl}from"./dept.abc86310.js";import"./index.a83617fe.js";const fl={class:"app-container"},vl=p("\u641C\u7D22"),_l=p("\u91CD\u7F6E"),hl=p("\u65B0\u589E"),yl=p("\u4FEE\u6539"),gl=p("\u5220\u9664"),bl=p("\u5BFC\u51FA"),kl=p(" \u6743\u9650\u5B57\u7B26 "),Vl=p("\u5C55\u5F00/\u6298\u53E0"),Cl=p("\u5168\u9009/\u5168\u4E0D\u9009"),Sl=p("\u7236\u5B50\u8054\u52A8"),wl={class:"dialog-footer"},xl=p("\u786E \u5B9A"),Kl=p("\u53D6 \u6D88"),Ul=p("\u5C55\u5F00/\u6298\u53E0"),Nl=p("\u5168\u9009/\u5168\u4E0D\u9009"),Rl=p("\u7236\u5B50\u8054\u52A8"),Il={class:"dialog-footer"},Dl=p("\u786E \u5B9A"),Tl=p("\u53D6 \u6D88"),$l=el({name:"Role"}),Ll=Object.assign($l,{setup(g){const _=ll(),{proxy:s}=al(),{sys_normal_disable:te}=s.useDict("sys_normal_disable"),oe=i([]),w=i(!1),z=i(!0),B=i(!0),F=i([]),ae=i(!0),ne=i(!0),O=i(0),U=i(""),T=i([]),N=i([]),Y=i(!1),Q=i(!1),H=i(!0),G=i(!1),$=i([]),R=i(!1),b=i(null),k=i(null),ke=i([{value:"1",label:"\u5168\u90E8\u6570\u636E\u6743\u9650"},{value:"2",label:"\u81EA\u5B9A\u6570\u636E\u6743\u9650"},{value:"3",label:"\u672C\u90E8\u95E8\u6570\u636E\u6743\u9650"},{value:"4",label:"\u672C\u90E8\u95E8\u53CA\u4EE5\u4E0B\u6570\u636E\u6743\u9650"},{value:"5",label:"\u4EC5\u672C\u4EBA\u6570\u636E\u6743\u9650"}]),Ve=tl({form:{},queryParams:{pageNum:1,pageSize:10,roleName:void 0,roleKey:void 0,status:void 0},rules:{roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],roleKey:[{required:!0,message:"\u6743\u9650\u5B57\u7B26\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],roleSort:[{required:!0,message:"\u89D2\u8272\u987A\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:f,form:n,rules:Ce}=ol(Ve);function V(){z.value=!0,nl(s.addDateRange(f.value,T.value)).then(a=>{oe.value=a.rows,O.value=a.total,z.value=!1})}function q(){f.value.pageNum=1,V()}function Se(){T.value=[],s.resetForm("queryRef"),q()}function ue(a){const e=a.roleId||F.value;s.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u89D2\u8272\u7F16\u53F7\u4E3A"'+e+'"\u7684\u6570\u636E\u9879?').then(function(){return ul(e)}).then(()=>{V(),s.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function we(){s.download("system/role/export",_e({},f.value),`role_${new Date().getTime()}.xlsx`)}function xe(a){F.value=a.map(e=>e.roleId),ae.value=a.length!=1,ne.value=!a.length}function Ke(a){let e=a.status==="0"?"\u542F\u7528":"\u505C\u7528";s.$modal.confirm('\u786E\u8BA4\u8981"'+e+'""'+a.roleName+'"\u89D2\u8272\u5417?').then(function(){return dl(a.roleId,a.status)}).then(()=>{s.$modal.msgSuccess(e+"\u6210\u529F")}).catch(function(){a.status=a.status==="0"?"1":"0"})}function Ue(a){_.push("/system/role-auth/user/"+a.roleId)}function Ne(){ml().then(a=>{N.value=a.data})}function Re(){let a=k.value.getCheckedKeys(),e=k.value.getHalfCheckedKeys();return a.unshift.apply(a,e),a}function I(){b.value!=null&&b.value.setCheckedKeys([]),Y.value=!1,Q.value=!1,H.value=!0,G.value=!1,n.value={roleId:void 0,roleName:void 0,roleKey:void 0,roleSort:0,status:"0",menuIds:[],deptIds:[],menuCheckStrictly:!0,deptCheckStrictly:!0,remark:void 0},s.resetForm("roleRef")}function Ie(){I(),Ne(),w.value=!0,U.value="\u6DFB\u52A0\u89D2\u8272"}function de(a){I();const e=a.roleId||F.value,m=De(e);be(e).then(d=>{n.value=d.data,n.value.roleSort=Number(n.value.roleSort),w.value=!0,L(()=>{m.then(M=>{M.checkedKeys.forEach(W=>{L(()=>{b.value.setChecked(W,!0,!1)})})})}),U.value="\u4FEE\u6539\u89D2\u8272"})}function De(a){return pl(a).then(e=>(N.value=e.menus,e))}function Te(a){return cl(a).then(e=>($.value=e.depts,e))}function se(a,e){if(e=="menu"){let m=N.value;for(let d=0;d<m.length;d++)b.value.store.nodesMap[m[d].id].expanded=a}else if(e=="dept"){let m=$.value;for(let d=0;d<m.length;d++)k.value.store.nodesMap[m[d].id].expanded=a}}function re(a,e){e=="menu"?b.value.setCheckedNodes(a?N.value:[]):e=="dept"&&k.value.setCheckedNodes(a?$.value:[])}function ie(a,e){e=="menu"?n.value.menuCheckStrictly=!!a:e=="dept"&&(n.value.deptCheckStrictly=!!a)}function pe(){let a=b.value.getCheckedKeys(),e=b.value.getHalfCheckedKeys();return a.unshift.apply(a,e),a}function $e(){s.$refs.roleRef.validate(a=>{a&&(n.value.roleId!=null?(n.value.menuIds=pe(),sl(n.value).then(e=>{s.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),w.value=!1,V()})):(n.value.menuIds=pe(),rl(n.value).then(e=>{s.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),w.value=!1,V()})))})}function qe(){w.value=!1,I()}function Me(a){a!=="2"&&k.value.setCheckedKeys([])}function je(a){I();const e=Te(a.roleId);be(a.roleId).then(m=>{n.value=m.data,R.value=!0,L(()=>{e.then(d=>{L(()=>{k.value&&k.value.setCheckedKeys(d.checkedKeys)})})}),U.value="\u5206\u914D\u6570\u636E\u6743\u9650"})}function Ae(){n.value.roleId!=null&&(n.value.deptIds=Re(),il(n.value).then(a=>{s.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),R.value=!1,V()}))}function Ee(){R.value=!1,I()}return V(),(a,e)=>{const m=r("el-input"),d=r("el-form-item"),M=r("el-option"),J=r("el-select"),W=r("el-date-picker"),v=r("el-button"),X=r("el-form"),j=r("el-col"),Pe=r("right-toolbar"),Le=r("el-row"),C=r("el-table-column"),ze=r("el-switch"),D=r("el-tooltip"),Be=r("el-table"),Fe=r("pagination"),Oe=r("question-filled"),Ye=r("el-icon"),Qe=r("el-input-number"),He=r("el-radio"),Ge=r("el-radio-group"),x=r("el-checkbox"),me=r("el-tree"),ce=r("el-dialog"),S=he("hasPermi"),Je=he("loading");return c(),A("div",fl,[h(t(X,{model:u(f),ref:"queryRef",inline:!0},{default:o(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName"},{default:o(()=>[t(m,{modelValue:u(f).roleName,"onUpdate:modelValue":e[0]||(e[0]=l=>u(f).roleName=l),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:ye(q,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,{label:"\u6743\u9650\u5B57\u7B26",prop:"roleKey"},{default:o(()=>[t(m,{modelValue:u(f).roleKey,"onUpdate:modelValue":e[1]||(e[1]=l=>u(f).roleKey=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:"",style:{width:"240px"},onKeyup:ye(q,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[t(J,{modelValue:u(f).status,"onUpdate:modelValue":e[2]||(e[2]=l=>u(f).status=l),placeholder:"\u89D2\u8272\u72B6\u6001",clearable:"",style:{width:"240px"}},{default:o(()=>[(c(!0),A(ee,null,le(u(te),l=>(c(),y(M,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u521B\u5EFA\u65F6\u95F4",style:{width:"308px"}},{default:o(()=>[t(W,{modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=l=>T.value=l),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(v,{type:"primary",icon:"Search",onClick:q},{default:o(()=>[vl]),_:1}),t(v,{icon:"Refresh",onClick:Se},{default:o(()=>[_l]),_:1})]),_:1})]),_:1},8,["model"]),[[Z,B.value]]),t(Le,{gutter:10,class:"mb8"},{default:o(()=>[t(j,{span:1.5},{default:o(()=>[h((c(),y(v,{type:"primary",plain:"",icon:"Plus",onClick:Ie},{default:o(()=>[hl]),_:1})),[[S,["system:role:add"]]])]),_:1},8,["span"]),t(j,{span:1.5},{default:o(()=>[h((c(),y(v,{type:"success",plain:"",icon:"Edit",disabled:ae.value,onClick:de},{default:o(()=>[yl]),_:1},8,["disabled"])),[[S,["system:role:edit"]]])]),_:1},8,["span"]),t(j,{span:1.5},{default:o(()=>[h((c(),y(v,{type:"danger",plain:"",icon:"Delete",disabled:ne.value,onClick:ue},{default:o(()=>[gl]),_:1},8,["disabled"])),[[S,["system:role:remove"]]])]),_:1},8,["span"]),t(j,{span:1.5},{default:o(()=>[h((c(),y(v,{type:"warning",plain:"",icon:"Download",onClick:we},{default:o(()=>[bl]),_:1})),[[S,["system:role:export"]]])]),_:1},8,["span"]),t(Pe,{showSearch:B.value,"onUpdate:showSearch":e[4]||(e[4]=l=>B.value=l),onQueryTable:V},null,8,["showSearch"])]),_:1}),h((c(),y(Be,{data:oe.value,onSelectionChange:xe},{default:o(()=>[t(C,{type:"selection",width:"55",align:"center"}),t(C,{label:"\u89D2\u8272\u7F16\u53F7",prop:"roleId",width:"120"}),t(C,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName","show-overflow-tooltip":!0,width:"150"}),t(C,{label:"\u6743\u9650\u5B57\u7B26",prop:"roleKey","show-overflow-tooltip":!0,width:"150"}),t(C,{label:"\u663E\u793A\u987A\u5E8F",prop:"roleSort",width:"100"}),t(C,{label:"\u72B6\u6001",align:"center",width:"100"},{default:o(l=>[t(ze,{modelValue:l.row.status,"onUpdate:modelValue":K=>l.row.status=K,"active-value":"0","inactive-value":"1",onChange:K=>Ke(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(C,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime"},{default:o(l=>[E("span",null,ge(a.parseTime(l.row.createTime)),1)]),_:1}),t(C,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:o(l=>[l.row.roleId!==1?(c(),y(D,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:o(()=>[h(t(v,{type:"text",icon:"Edit",onClick:K=>de(l.row)},null,8,["onClick"]),[[S,["system:role:edit"]]])]),_:2},1024)):P("",!0),l.row.roleId!==1?(c(),y(D,{key:1,content:"\u5220\u9664",placement:"top"},{default:o(()=>[h(t(v,{type:"text",icon:"Delete",onClick:K=>ue(l.row)},null,8,["onClick"]),[[S,["system:role:remove"]]])]),_:2},1024)):P("",!0),l.row.roleId!==1?(c(),y(D,{key:2,content:"\u6570\u636E\u6743\u9650",placement:"top"},{default:o(()=>[h(t(v,{type:"text",icon:"CircleCheck",onClick:K=>je(l.row)},null,8,["onClick"]),[[S,["system:role:edit"]]])]),_:2},1024)):P("",!0),l.row.roleId!==1?(c(),y(D,{key:3,content:"\u5206\u914D\u7528\u6237",placement:"top"},{default:o(()=>[h(t(v,{type:"text",icon:"User",onClick:K=>Ue(l.row)},null,8,["onClick"]),[[S,["system:role:edit"]]])]),_:2},1024)):P("",!0)]),_:1})]),_:1},8,["data"])),[[Je,z.value]]),h(t(Fe,{total:O.value,page:u(f).pageNum,"onUpdate:page":e[5]||(e[5]=l=>u(f).pageNum=l),limit:u(f).pageSize,"onUpdate:limit":e[6]||(e[6]=l=>u(f).pageSize=l),onPagination:V},null,8,["total","page","limit"]),[[Z,O.value>0]]),t(ce,{title:U.value,modelValue:w.value,"onUpdate:modelValue":e[18]||(e[18]=l=>w.value=l),width:"500px","append-to-body":""},{footer:o(()=>[E("div",wl,[t(v,{type:"primary",onClick:$e},{default:o(()=>[xl]),_:1}),t(v,{onClick:qe},{default:o(()=>[Kl]),_:1})])]),default:o(()=>[t(X,{ref:"roleRef",model:u(n),rules:u(Ce),"label-width":"100px"},{default:o(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName"},{default:o(()=>[t(m,{modelValue:u(n).roleName,"onUpdate:modelValue":e[7]||(e[7]=l=>u(n).roleName=l),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{prop:"roleKey"},{label:o(()=>[E("span",null,[t(D,{content:"\u63A7\u5236\u5668\u4E2D\u5B9A\u4E49\u7684\u6743\u9650\u5B57\u7B26\uFF0C\u5982\uFF1A@PreAuthorize(`@ss.hasRole('admin')`)",placement:"top"},{default:o(()=>[t(Ye,null,{default:o(()=>[t(Oe)]),_:1})]),_:1}),kl])]),default:o(()=>[t(m,{modelValue:u(n).roleKey,"onUpdate:modelValue":e[8]||(e[8]=l=>u(n).roleKey=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u89D2\u8272\u987A\u5E8F",prop:"roleSort"},{default:o(()=>[t(Qe,{modelValue:u(n).roleSort,"onUpdate:modelValue":e[9]||(e[9]=l=>u(n).roleSort=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u72B6\u6001"},{default:o(()=>[t(Ge,{modelValue:u(n).status,"onUpdate:modelValue":e[10]||(e[10]=l=>u(n).status=l)},{default:o(()=>[(c(!0),A(ee,null,le(u(te),l=>(c(),y(He,{key:l.value,label:l.value},{default:o(()=>[p(ge(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u83DC\u5355\u6743\u9650"},{default:o(()=>[t(x,{modelValue:Y.value,"onUpdate:modelValue":e[11]||(e[11]=l=>Y.value=l),onChange:e[12]||(e[12]=l=>se(l,"menu"))},{default:o(()=>[Vl]),_:1},8,["modelValue"]),t(x,{modelValue:Q.value,"onUpdate:modelValue":e[13]||(e[13]=l=>Q.value=l),onChange:e[14]||(e[14]=l=>re(l,"menu"))},{default:o(()=>[Cl]),_:1},8,["modelValue"]),t(x,{modelValue:u(n).menuCheckStrictly,"onUpdate:modelValue":e[15]||(e[15]=l=>u(n).menuCheckStrictly=l),onChange:e[16]||(e[16]=l=>ie(l,"menu"))},{default:o(()=>[Sl]),_:1},8,["modelValue"]),t(me,{class:"tree-border",data:N.value,"show-checkbox":"",ref_key:"menuRef",ref:b,"node-key":"id","check-strictly":!u(n).menuCheckStrictly,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019",props:{label:"label",children:"children"}},null,8,["data","check-strictly"])]),_:1}),t(d,{label:"\u5907\u6CE8"},{default:o(()=>[t(m,{modelValue:u(n).remark,"onUpdate:modelValue":e[17]||(e[17]=l=>u(n).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),t(ce,{title:U.value,modelValue:R.value,"onUpdate:modelValue":e[28]||(e[28]=l=>R.value=l),width:"500px","append-to-body":""},{footer:o(()=>[E("div",Il,[t(v,{type:"primary",onClick:Ae},{default:o(()=>[Dl]),_:1}),t(v,{onClick:Ee},{default:o(()=>[Tl]),_:1})])]),default:o(()=>[t(X,{model:u(n),"label-width":"80px"},{default:o(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0"},{default:o(()=>[t(m,{modelValue:u(n).roleName,"onUpdate:modelValue":e[19]||(e[19]=l=>u(n).roleName=l),disabled:!0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u6743\u9650\u5B57\u7B26"},{default:o(()=>[t(m,{modelValue:u(n).roleKey,"onUpdate:modelValue":e[20]||(e[20]=l=>u(n).roleKey=l),disabled:!0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u6743\u9650\u8303\u56F4"},{default:o(()=>[t(J,{modelValue:u(n).dataScope,"onUpdate:modelValue":e[21]||(e[21]=l=>u(n).dataScope=l),onChange:Me},{default:o(()=>[(c(!0),A(ee,null,le(ke.value,l=>(c(),y(M,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),h(t(d,{label:"\u6570\u636E\u6743\u9650"},{default:o(()=>[t(x,{modelValue:H.value,"onUpdate:modelValue":e[22]||(e[22]=l=>H.value=l),onChange:e[23]||(e[23]=l=>se(l,"dept"))},{default:o(()=>[Ul]),_:1},8,["modelValue"]),t(x,{modelValue:G.value,"onUpdate:modelValue":e[24]||(e[24]=l=>G.value=l),onChange:e[25]||(e[25]=l=>re(l,"dept"))},{default:o(()=>[Nl]),_:1},8,["modelValue"]),t(x,{modelValue:u(n).deptCheckStrictly,"onUpdate:modelValue":e[26]||(e[26]=l=>u(n).deptCheckStrictly=l),onChange:e[27]||(e[27]=l=>ie(l,"dept"))},{default:o(()=>[Rl]),_:1},8,["modelValue"]),t(me,{class:"tree-border",data:$.value,"show-checkbox":"","default-expand-all":"",ref_key:"deptRef",ref:k,"node-key":"id","check-strictly":!u(n).deptCheckStrictly,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019",props:{label:"label",children:"children"}},null,8,["data","check-strictly"])]),_:1},512),[[Z,u(n).dataScope==2]])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}});export{Ll as default};
