import{ac as getAugmentedNamespace,ad as commonjsGlobal,ae as getDefaultExportFromCjs}from"./vendor.d1385716.js";var fabric={},__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(be){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var H=H||{version:"5.2.1"};if(be.fabric=H,typeof document!="undefined"&&typeof window!="undefined")document instanceof(typeof HTMLDocument!="undefined"?HTMLDocument:Document)?H.document=document:H.document=document.implementation.createHTMLDocument(""),H.window=window;else{var X=require$$2,I=new X.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;H.document=I.document,H.jsdomImplForWrapper=require$$2.implForWrapper,H.nodeCanvas=require$$2.Canvas,H.window=I,DOMParser=H.window.DOMParser}H.isTouchSupported="ontouchstart"in H.window||"ontouchstart"in H.document||H.window&&H.window.navigator&&H.window.navigator.maxTouchPoints>0,H.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",H.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],H.DPI=96,H.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",H.commaWsp="(?:\\s+,?\\s*|,\\s*)",H.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,H.reNonWord=/[ \n\.,;!\?\-]/,H.fontPaths={},H.iMatrix=[1,0,0,1,0,0],H.svgNS="http://www.w3.org/2000/svg",H.perfLimitSizeTotal=2097152,H.maxCacheSideLimit=4096,H.minCacheSideLimit=256,H.charWidthsCache={},H.textureSize=2048,H.disableStyleCopyPaste=!1,H.enableGLFiltering=!0,H.devicePixelRatio=H.window.devicePixelRatio||H.window.webkitDevicePixelRatio||H.window.mozDevicePixelRatio||1,H.browserShadowBlurConstant=1,H.arcToSegmentsCache={},H.boundsOfCurveCache={},H.cachesBoundsOfCurve=!0,H.forceGLPutImageData=!1,H.initFilterBackend=function(){if(H.enableGLFiltering&&H.isWebglSupported&&H.isWebglSupported(H.textureSize))return console.log("max texture size: "+H.maxTextureSize),new H.WebglFilterBackend({tileSize:H.textureSize});if(H.Canvas2dFilterBackend)return new H.Canvas2dFilterBackend},typeof document!="undefined"&&typeof window!="undefined"&&(window.fabric=H),function(){function m(a,s){if(!!this.__eventListeners[a]){var u=this.__eventListeners[a];s?u[u.indexOf(s)]=!1:H.util.array.fill(u,!1)}}function r(a,s){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var u in a)this.on(u,a[u]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(s);return this}function c(a,s){var u=function(){s.apply(this,arguments),this.off(a,u)}.bind(this);this.on(a,u)}function l(a,s){if(arguments.length===1)for(var u in a)c.call(this,u,a[u]);else c.call(this,a,s);return this}function e(a,s){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)m.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var u in a)m.call(this,u,a[u]);else m.call(this,a,s);return this}function n(a,s){if(!this.__eventListeners)return this;var u=this.__eventListeners[a];if(!u)return this;for(var t=0,f=u.length;t<f;t++)u[t]&&u[t].call(this,s||{});return this.__eventListeners[a]=u.filter(function(h){return h!==!1}),this}H.Observable={fire:n,on:r,once:l,off:e}}(),H.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var m=0,r=arguments.length;m<r;m++)this._onObjectAdded(arguments[m]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(m,r,c){var l=this._objects;return c?l[r]=m:l.splice(r,0,m),this._onObjectAdded&&this._onObjectAdded(m),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var m=this._objects,r,c=!1,l=0,e=arguments.length;l<e;l++)r=m.indexOf(arguments[l]),r!==-1&&(c=!0,m.splice(r,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[l]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(m,r){for(var c=this.getObjects(),l=0,e=c.length;l<e;l++)m.call(r,c[l],l,c);return this},getObjects:function(m){return typeof m=="undefined"?this._objects.concat():this._objects.filter(function(r){return r.type===m})},item:function(m){return this._objects[m]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(m,r){return this._objects.indexOf(m)>-1?!0:r?this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(m,!0)}):!1},complexity:function(){return this._objects.reduce(function(m,r){return m+=r.complexity?r.complexity():0,m},0)}},H.CommonMethods={_setOptions:function(m){for(var r in m)this.set(r,m[r])},_initGradient:function(m,r){m&&m.colorStops&&!(m instanceof H.Gradient)&&this.set(r,new H.Gradient(m))},_initPattern:function(m,r,c){m&&m.source&&!(m instanceof H.Pattern)?this.set(r,new H.Pattern(m,c)):c&&c()},_setObject:function(m){for(var r in m)this._set(r,m[r])},set:function(m,r){return typeof m=="object"?this._setObject(m):this._set(m,r),this},_set:function(m,r){this[m]=r},toggle:function(m){var r=this.get(m);return typeof r=="boolean"&&this.set(m,!r),this},get:function(m){return this[m]}},function(m){var r=Math.sqrt,c=Math.atan2,l=Math.pow,e=Math.PI/180,n=Math.PI/2;H.util={cos:function(a){if(a===0)return 1;a<0&&(a=-a);var s=a/n;switch(s){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var s=a/n,u=1;switch(a<0&&(u=-1),s){case 1:return u;case 2:return 0;case 3:return-u}return Math.sin(a)},removeFromArray:function(a,s){var u=a.indexOf(s);return u!==-1&&a.splice(u,1),a},getRandomInt:function(a,s){return Math.floor(Math.random()*(s-a+1))+a},degreesToRadians:function(a){return a*e},radiansToDegrees:function(a){return a/e},rotatePoint:function(a,s,u){var t=new H.Point(a.x-s.x,a.y-s.y),f=H.util.rotateVector(t,u);return new H.Point(f.x,f.y).addEquals(s)},rotateVector:function(a,s){var u=H.util.sin(s),t=H.util.cos(s),f=a.x*t-a.y*u,h=a.x*u+a.y*t;return{x:f,y:h}},createVector:function(a,s){return new H.Point(s.x-a.x,s.y-a.y)},calcAngleBetweenVectors:function(a,s){return Math.acos((a.x*s.x+a.y*s.y)/(Math.hypot(a.x,a.y)*Math.hypot(s.x,s.y)))},getHatVector:function(a){return new H.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,s,u){var t=H.util.createVector(a,s),f=H.util.createVector(a,u),h=H.util.calcAngleBetweenVectors(t,f),v=H.util.calcAngleBetweenVectors(H.util.rotateVector(t,h),f),y=h*(v===0?1:-1)/2;return{vector:H.util.getHatVector(H.util.rotateVector(t,y)),angle:h}},projectStrokeOnPoints:function(a,s,u){var t=[],f=s.strokeWidth/2,h=s.strokeUniform?new H.Point(1/s.scaleX,1/s.scaleY):new H.Point(1,1),v=function(y){var p=f/Math.hypot(y.x,y.y);return new H.Point(y.x*p*h.x,y.y*p*h.y)};return a.length<=1||a.forEach(function(y,p){var g=new H.Point(y.x,y.y),d,E;p===0?(E=a[p+1],d=u?v(H.util.createVector(E,g)).addEquals(g):a[a.length-1]):p===a.length-1?(d=a[p-1],E=u?v(H.util.createVector(d,g)).addEquals(g):a[0]):(d=a[p-1],E=a[p+1]);var w=H.util.getBisector(g,d,E),D=w.vector,b=w.angle,S,C;if(s.strokeLineJoin==="miter"&&(S=-f/Math.sin(b/2),C=new H.Point(D.x*S*h.x,D.y*S*h.y),Math.hypot(C.x,C.y)/f<=s.strokeMiterLimit)){t.push(g.add(C)),t.push(g.subtract(C));return}S=-f*Math.SQRT2,C=new H.Point(D.x*S*h.x,D.y*S*h.y),t.push(g.add(C)),t.push(g.subtract(C))}),t},transformPoint:function(a,s,u){return u?new H.Point(s[0]*a.x+s[2]*a.y,s[1]*a.x+s[3]*a.y):new H.Point(s[0]*a.x+s[2]*a.y+s[4],s[1]*a.x+s[3]*a.y+s[5])},makeBoundingBoxFromPoints:function(a,s){if(s)for(var u=0;u<a.length;u++)a[u]=H.util.transformPoint(a[u],s);var t=[a[0].x,a[1].x,a[2].x,a[3].x],f=H.util.array.min(t),h=H.util.array.max(t),v=h-f,y=[a[0].y,a[1].y,a[2].y,a[3].y],p=H.util.array.min(y),g=H.util.array.max(y),d=g-p;return{left:f,top:p,width:v,height:d}},invertTransform:function(a){var s=1/(a[0]*a[3]-a[1]*a[2]),u=[s*a[3],-s*a[1],-s*a[2],s*a[0]],t=H.util.transformPoint({x:a[4],y:a[5]},u,!0);return u[4]=-t.x,u[5]=-t.y,u},toFixed:function(a,s){return parseFloat(Number(a).toFixed(s))},parseUnit:function(a,s){var u=/\D{0,2}$/.exec(a),t=parseFloat(a);switch(s||(s=H.Text.DEFAULT_SVG_FONT_SIZE),u[0]){case"mm":return t*H.DPI/25.4;case"cm":return t*H.DPI/2.54;case"in":return t*H.DPI;case"pt":return t*H.DPI/72;case"pc":return t*H.DPI/72*12;case"em":return t*s;default:return t}},falseFunction:function(){return!1},getKlass:function(a,s){return a=H.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),H.util.resolveNamespace(s)[a]},getSvgAttributes:function(a){var s=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":s=s.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":s=s.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":s=s.concat(["offset","stop-color","stop-opacity"]);break}return s},resolveNamespace:function(a){if(!a)return H;var s=a.split("."),u=s.length,t,f=m||H.window;for(t=0;t<u;++t)f=f[s[t]];return f},loadImage:function(a,s,u,t){if(!a){s&&s.call(u,a);return}var f=H.util.createImage(),h=function(){s&&s.call(u,f,!1),f=f.onload=f.onerror=null};f.onload=h,f.onerror=function(){H.log("Error loading "+f.src),s&&s.call(u,null,!0),f=f.onload=f.onerror=null},a.indexOf("data")!==0&&t!==void 0&&t!==null&&(f.crossOrigin=t),a.substring(0,14)==="data:image/svg"&&(f.onload=null,H.util.loadImageInDom(f,h)),f.src=a},loadImageInDom:function(a,s){var u=H.document.createElement("div");u.style.width=u.style.height="1px",u.style.left=u.style.top="-100%",u.style.position="absolute",u.appendChild(a),H.document.querySelector("body").appendChild(u),a.onload=function(){s(),u.parentNode.removeChild(u),u=null}},enlivenObjects:function(a,s,u,t){a=a||[];var f=[],h=0,v=a.length;function y(){++h===v&&s&&s(f.filter(function(p){return p}))}if(!v){s&&s(f);return}a.forEach(function(p,g){if(!p||!p.type){y();return}var d=H.util.getKlass(p.type,u);d.fromObject(p,function(E,w){w||(f[g]=E),t&&t(p,E,w),y()})})},enlivenObjectEnlivables:function(a,s,u){var t=H.Object.ENLIVEN_PROPS.filter(function(f){return!!a[f]});H.util.enlivenObjects(t.map(function(f){return a[f]}),function(f){var h={};t.forEach(function(v,y){h[v]=f[y],s&&(s[v]=f[y])}),u&&u(h)})},enlivenPatterns:function(a,s){a=a||[];function u(){++f===h&&s&&s(t)}var t=[],f=0,h=a.length;if(!h){s&&s(t);return}a.forEach(function(v,y){v&&v.source?new H.Pattern(v,function(p){t[y]=p,u()}):(t[y]=v,u())})},groupSVGElements:function(a,s,u){var t;return a&&a.length===1?a[0]:(s&&(s.width&&s.height?s.centerPoint={x:s.width/2,y:s.height/2}:(delete s.width,delete s.height)),t=new H.Group(a,s),typeof u!="undefined"&&(t.sourcePath=u),t)},populateWithProperties:function(a,s,u){if(u&&Array.isArray(u))for(var t=0,f=u.length;t<f;t++)u[t]in a&&(s[u[t]]=a[u[t]])},createCanvasElement:function(){return H.document.createElement("canvas")},copyCanvasElement:function(a){var s=H.util.createCanvasElement();return s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0),s},toDataURL:function(a,s,u){return a.toDataURL("image/"+s,u)},createImage:function(){return H.document.createElement("img")},multiplyTransformMatrices:function(a,s,u){return[a[0]*s[0]+a[2]*s[1],a[1]*s[0]+a[3]*s[1],a[0]*s[2]+a[2]*s[3],a[1]*s[2]+a[3]*s[3],u?0:a[0]*s[4]+a[2]*s[5]+a[4],u?0:a[1]*s[4]+a[3]*s[5]+a[5]]},qrDecompose:function(a){var s=c(a[1],a[0]),u=l(a[0],2)+l(a[1],2),t=r(u),f=(a[0]*a[3]-a[2]*a[1])/t,h=c(a[0]*a[2]+a[1]*a[3],u);return{angle:s/e,scaleX:t,scaleY:f,skewX:h/e,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return H.iMatrix.concat();var s=H.util.degreesToRadians(a.angle),u=H.util.cos(s),t=H.util.sin(s);return[u,t,-t,u,0,0]},calcDimensionsMatrix:function(a){var s=typeof a.scaleX=="undefined"?1:a.scaleX,u=typeof a.scaleY=="undefined"?1:a.scaleY,t=[a.flipX?-s:s,0,0,a.flipY?-u:u,0,0],f=H.util.multiplyTransformMatrices,h=H.util.degreesToRadians;return a.skewX&&(t=f(t,[1,0,Math.tan(h(a.skewX)),1],!0)),a.skewY&&(t=f(t,[1,Math.tan(h(a.skewY)),0,1],!0)),t},composeMatrix:function(a){var s=[1,0,0,1,a.translateX||0,a.translateY||0],u=H.util.multiplyTransformMatrices;return a.angle&&(s=u(s,H.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(s=u(s,H.util.calcDimensionsMatrix(a))),s},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,s,u,t){t>0&&(s>t?s-=t:s=0,u>t?u-=t:u=0);var f=!0,h,v,y=a.getImageData(s,u,t*2||1,t*2||1),p=y.data.length;for(h=3;h<p&&(v=y.data[h],f=v<=0,f!==!1);h+=4);return y=null,f},parsePreserveAspectRatioAttribute:function(a){var s="meet",u="Mid",t="Mid",f=a.split(" "),h;return f&&f.length&&(s=f.pop(),s!=="meet"&&s!=="slice"?(h=s,s="meet"):f.length&&(h=f.pop())),u=h!=="none"?h.slice(1,4):"none",t=h!=="none"?h.slice(5,8):"none",{meetOrSlice:s,alignX:u,alignY:t}},clearFabricFontCache:function(a){a=(a||"").toLowerCase(),a?H.charWidthsCache[a]&&delete H.charWidthsCache[a]:H.charWidthsCache={}},limitDimsByArea:function(a,s){var u=Math.sqrt(s*a),t=Math.floor(s/u);return{x:Math.floor(u),y:t}},capValue:function(a,s,u){return Math.max(a,Math.min(s,u))},findScaleToFit:function(a,s){return Math.min(s.width/a.width,s.height/a.height)},findScaleToCover:function(a,s){return Math.max(s.width/a.width,s.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(s){return H.util.toFixed(s,H.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,s){var u=H.util.invertTransform(s),t=H.util.multiplyTransformMatrices(u,a.calcOwnMatrix());H.util.applyTransformToObject(a,t)},addTransformToObject:function(a,s){H.util.applyTransformToObject(a,H.util.multiplyTransformMatrices(s,a.calcOwnMatrix()))},applyTransformToObject:function(a,s){var u=H.util.qrDecompose(s),t=new H.Point(u.translateX,u.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",u.scaleX),a.set("scaleY",u.scaleY),a.skewX=u.skewX,a.skewY=u.skewY,a.angle=u.angle,a.setPositionByOrigin(t,"center","center")},sizeAfterTransform:function(a,s,u){var t=a/2,f=s/2,h=[{x:-t,y:-f},{x:t,y:-f},{x:-t,y:f},{x:t,y:f}],v=H.util.calcDimensionsMatrix(u),y=H.util.makeBoundingBoxFromPoints(h,v);return{x:y.width,y:y.height}},mergeClipPaths:function(a,s){var u=a,t=s;u.inverted&&!t.inverted&&(u=s,t=a),H.util.applyTransformToObject(t,H.util.multiplyTransformMatrices(H.util.invertTransform(u.calcTransformMatrix()),t.calcTransformMatrix()));var f=u.inverted&&t.inverted;return f&&(u.inverted=t.inverted=!1),new H.Group([u],{clipPath:t,inverted:f})}}}(be),function(){var m=Array.prototype.join,r={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function l(x,A,k,M,N,U,j,z,J,te,re){var oe=H.util.cos(x),se=H.util.sin(x),me=H.util.cos(A),fe=H.util.sin(A),ue=k*N*me-M*U*fe+j,ye=M*N*me+k*U*fe+z,pe=te+J*(-k*N*se-M*U*oe),de=re+J*(-M*N*se+k*U*oe),ve=ue+J*(k*N*fe+M*U*me),ne=ye+J*(M*N*fe-k*U*me);return["C",pe,de,ve,ne,ue,ye]}function e(x,A,k,M,N,U,j){var z=Math.PI,J=j*z/180,te=H.util.sin(J),re=H.util.cos(J),oe=0,se=0;k=Math.abs(k),M=Math.abs(M);var me=-re*x*.5-te*A*.5,fe=-re*A*.5+te*x*.5,ue=k*k,ye=M*M,pe=fe*fe,de=me*me,ve=ue*ye-ue*pe-ye*de,ne=0;if(ve<0){var we=Math.sqrt(1-ve/(ue*ye));k*=we,M*=we}else ne=(N===U?-1:1)*Math.sqrt(ve/(ue*pe+ye*de));var Ce=ne*k*fe/M,ge=-ne*M*me/k,_e=re*Ce-te*ge+x*.5,Pe=te*Ce+re*ge+A*.5,Q=n(1,0,(me-Ce)/k,(fe-ge)/M),B=n((me-Ce)/k,(fe-ge)/M,(-me-Ce)/k,(-fe-ge)/M);U===0&&B>0?B-=2*z:U===1&&B<0&&(B+=2*z);for(var W=Math.ceil(Math.abs(B/z*2)),Y=[],$=B/W,ie=8/3*Math.sin($/4)*Math.sin($/4)/Math.sin($/2),le=Q+$,ce=0;ce<W;ce++)Y[ce]=l(Q,le,re,te,k,M,_e,Pe,ie,oe,se),oe=Y[ce][5],se=Y[ce][6],Q=le,le+=$;return Y}function n(x,A,k,M){var N=Math.atan2(A,x),U=Math.atan2(M,k);return U>=N?U-N:2*Math.PI-(N-U)}function a(x,A,k,M,N,U,j,z){var J;if(H.cachesBoundsOfCurve&&(J=m.call(arguments),H.boundsOfCurveCache[J]))return H.boundsOfCurveCache[J];var te=Math.sqrt,re=Math.min,oe=Math.max,se=Math.abs,me=[],fe=[[],[]],ue,ye,pe,de,ve,ne,we,Ce;ye=6*x-12*k+6*N,ue=-3*x+9*k-9*N+3*j,pe=3*k-3*x;for(var ge=0;ge<2;++ge){if(ge>0&&(ye=6*A-12*M+6*U,ue=-3*A+9*M-9*U+3*z,pe=3*M-3*A),se(ue)<1e-12){if(se(ye)<1e-12)continue;de=-pe/ye,0<de&&de<1&&me.push(de);continue}we=ye*ye-4*pe*ue,!(we<0)&&(Ce=te(we),ve=(-ye+Ce)/(2*ue),0<ve&&ve<1&&me.push(ve),ne=(-ye-Ce)/(2*ue),0<ne&&ne<1&&me.push(ne))}for(var _e,Pe,Q=me.length,B=Q,W;Q--;)de=me[Q],W=1-de,_e=W*W*W*x+3*W*W*de*k+3*W*de*de*N+de*de*de*j,fe[0][Q]=_e,Pe=W*W*W*A+3*W*W*de*M+3*W*de*de*U+de*de*de*z,fe[1][Q]=Pe;fe[0][B]=x,fe[1][B]=A,fe[0][B+1]=j,fe[1][B+1]=z;var Y=[{x:re.apply(null,fe[0]),y:re.apply(null,fe[1])},{x:oe.apply(null,fe[0]),y:oe.apply(null,fe[1])}];return H.cachesBoundsOfCurve&&(H.boundsOfCurveCache[J]=Y),Y}function s(x,A,k){for(var M=k[1],N=k[2],U=k[3],j=k[4],z=k[5],J=k[6],te=k[7],re=e(J-x,te-A,M,N,j,z,U),oe=0,se=re.length;oe<se;oe++)re[oe][1]+=x,re[oe][2]+=A,re[oe][3]+=x,re[oe][4]+=A,re[oe][5]+=x,re[oe][6]+=A;return re}function u(x){var A=0,k=0,M=x.length,N=0,U=0,j,z,J,te=[],re,oe,se;for(z=0;z<M;++z){switch(J=!1,j=x[z].slice(0),j[0]){case"l":j[0]="L",j[1]+=A,j[2]+=k;case"L":A=j[1],k=j[2];break;case"h":j[1]+=A;case"H":j[0]="L",j[2]=k,A=j[1];break;case"v":j[1]+=k;case"V":j[0]="L",k=j[1],j[1]=A,j[2]=k;break;case"m":j[0]="M",j[1]+=A,j[2]+=k;case"M":A=j[1],k=j[2],N=j[1],U=j[2];break;case"c":j[0]="C",j[1]+=A,j[2]+=k,j[3]+=A,j[4]+=k,j[5]+=A,j[6]+=k;case"C":oe=j[3],se=j[4],A=j[5],k=j[6];break;case"s":j[0]="S",j[1]+=A,j[2]+=k,j[3]+=A,j[4]+=k;case"S":re==="C"?(oe=2*A-oe,se=2*k-se):(oe=A,se=k),A=j[3],k=j[4],j[0]="C",j[5]=j[3],j[6]=j[4],j[3]=j[1],j[4]=j[2],j[1]=oe,j[2]=se,oe=j[3],se=j[4];break;case"q":j[0]="Q",j[1]+=A,j[2]+=k,j[3]+=A,j[4]+=k;case"Q":oe=j[1],se=j[2],A=j[3],k=j[4];break;case"t":j[0]="T",j[1]+=A,j[2]+=k;case"T":re==="Q"?(oe=2*A-oe,se=2*k-se):(oe=A,se=k),j[0]="Q",A=j[1],k=j[2],j[1]=oe,j[2]=se,j[3]=A,j[4]=k;break;case"a":j[0]="A",j[6]+=A,j[7]+=k;case"A":J=!0,te=te.concat(s(A,k,j)),A=j[6],k=j[7];break;case"z":case"Z":A=N,k=U;break}J||te.push(j),re=j[0]}return te}function t(x,A,k,M){return Math.sqrt((k-x)*(k-x)+(M-A)*(M-A))}function f(x){return x*x*x}function h(x){return 3*x*x*(1-x)}function v(x){return 3*x*(1-x)*(1-x)}function y(x){return(1-x)*(1-x)*(1-x)}function p(x,A,k,M,N,U,j,z){return function(J){var te=f(J),re=h(J),oe=v(J),se=y(J);return{x:j*te+N*re+k*oe+x*se,y:z*te+U*re+M*oe+A*se}}}function g(x,A,k,M,N,U,j,z){return function(J){var te=1-J,re=3*te*te*(k-x)+6*te*J*(N-k)+3*J*J*(j-N),oe=3*te*te*(M-A)+6*te*J*(U-M)+3*J*J*(z-U);return Math.atan2(oe,re)}}function d(x){return x*x}function E(x){return 2*x*(1-x)}function w(x){return(1-x)*(1-x)}function D(x,A,k,M,N,U){return function(j){var z=d(j),J=E(j),te=w(j);return{x:N*z+k*J+x*te,y:U*z+M*J+A*te}}}function b(x,A,k,M,N,U){return function(j){var z=1-j,J=2*z*(k-x)+2*j*(N-k),te=2*z*(M-A)+2*j*(U-M);return Math.atan2(te,J)}}function S(x,A,k){var M={x:A,y:k},N,U=0,j;for(j=1;j<=100;j+=1)N=x(j/100),U+=t(M.x,M.y,N.x,N.y),M=N;return U}function C(x,A){for(var k=0,M=0,N=x.iterator,U={x:x.x,y:x.y},j,z,J=.01,te=x.angleFinder,re;M<A&&J>1e-4;)j=N(k),re=k,z=t(U.x,U.y,j.x,j.y),z+M>A?(k-=J,J/=2):(U=j,k+=J,M+=z);return j.angle=te(re),j}function P(x){for(var A=0,k=x.length,M,N=0,U=0,j=0,z=0,J=[],te,re,oe,se=0;se<k;se++){switch(M=x[se],re={x:N,y:U,command:M[0]},M[0]){case"M":re.length=0,j=N=M[1],z=U=M[2];break;case"L":re.length=t(N,U,M[1],M[2]),N=M[1],U=M[2];break;case"C":te=p(N,U,M[1],M[2],M[3],M[4],M[5],M[6]),oe=g(N,U,M[1],M[2],M[3],M[4],M[5],M[6]),re.iterator=te,re.angleFinder=oe,re.length=S(te,N,U),N=M[5],U=M[6];break;case"Q":te=D(N,U,M[1],M[2],M[3],M[4]),oe=b(N,U,M[1],M[2],M[3],M[4]),re.iterator=te,re.angleFinder=oe,re.length=S(te,N,U),N=M[3],U=M[4];break;case"Z":case"z":re.destX=j,re.destY=z,re.length=t(N,U,j,z),N=j,U=z;break}A+=re.length,J.push(re)}return J.push({length:A,x:N,y:U}),J}function R(x,A,k){k||(k=P(x));for(var M=0;A-k[M].length>0&&M<k.length-2;)A-=k[M].length,M++;var N=k[M],U=A/N.length,j=N.command,z=x[M],J;switch(j){case"M":return{x:N.x,y:N.y,angle:0};case"Z":case"z":return J=new H.Point(N.x,N.y).lerp(new H.Point(N.destX,N.destY),U),J.angle=Math.atan2(N.destY-N.y,N.destX-N.x),J;case"L":return J=new H.Point(N.x,N.y).lerp(new H.Point(z[1],z[2]),U),J.angle=Math.atan2(z[2]-N.y,z[1]-N.x),J;case"C":return C(N,A);case"Q":return C(N,A)}}function L(x){var A=[],k=[],M,N,U=H.rePathCommand,j="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",z="("+j+")"+H.commaWsp,J="([01])"+H.commaWsp+"?",te=z+"?"+z+"?"+z+J+J+z+"?("+j+")",re=new RegExp(te,"g"),oe,se,me;if(!x||!x.match)return A;me=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var fe=0,ue,ye=me.length;fe<ye;fe++){M=me[fe],se=M.slice(1).trim(),k.length=0;var pe=M.charAt(0);if(ue=[pe],pe.toLowerCase()==="a")for(var de;de=re.exec(se);)for(var ve=1;ve<de.length;ve++)k.push(de[ve]);else for(;oe=U.exec(se);)k.push(oe[0]);for(var ve=0,ne=k.length;ve<ne;ve++)N=parseFloat(k[ve]),isNaN(N)||ue.push(N);var we=r[pe.toLowerCase()],Ce=c[pe]||pe;if(ue.length-1>we)for(var ge=1,_e=ue.length;ge<_e;ge+=we)A.push([pe].concat(ue.slice(ge,ge+we))),pe=Ce;else A.push(ue)}return A}function O(x,A){var k=[],M,N=new H.Point(x[0].x,x[0].y),U=new H.Point(x[1].x,x[1].y),j=x.length,z=1,J=0,te=j>2;for(A=A||0,te&&(z=x[2].x<U.x?-1:x[2].x===U.x?0:1,J=x[2].y<U.y?-1:x[2].y===U.y?0:1),k.push(["M",N.x-z*A,N.y-J*A]),M=1;M<j;M++){if(!N.eq(U)){var re=N.midPointFrom(U);k.push(["Q",N.x,N.y,re.x,re.y])}N=x[M],M+1<x.length&&(U=x[M+1])}return te&&(z=N.x>x[M-2].x?1:N.x===x[M-2].x?0:-1,J=N.y>x[M-2].y?1:N.y===x[M-2].y?0:-1),k.push(["L",N.x+z*A,N.y+J*A]),k}function _(x,A,k){return k&&(A=H.util.multiplyTransformMatrices(A,[1,0,0,1,-k.x,-k.y])),x.map(function(M){for(var N=M.slice(0),U={},j=1;j<M.length-1;j+=2)U.x=M[j],U.y=M[j+1],U=H.util.transformPoint(U,A),N[j]=U.x,N[j+1]=U.y;return N})}H.util.joinPath=function(x){return x.map(function(A){return A.join(" ")}).join(" ")},H.util.parsePath=L,H.util.makePathSimpler=u,H.util.getSmoothPathFromPoints=O,H.util.getPathSegmentsInfo=P,H.util.getBoundsOfCurve=a,H.util.getPointOnPath=R,H.util.transformPath=_}(),function(){var m=Array.prototype.slice;function r(a,s){for(var u=m.call(arguments,2),t=[],f=0,h=a.length;f<h;f++)t[f]=u.length?a[f][s].apply(a[f],u):a[f][s].call(a[f]);return t}function c(a,s){return n(a,s,function(u,t){return u>=t})}function l(a,s){return n(a,s,function(u,t){return u<t})}function e(a,s){for(var u=a.length;u--;)a[u]=s;return a}function n(a,s,u){if(!(!a||a.length===0)){var t=a.length-1,f=s?a[t][s]:a[t];if(s)for(;t--;)u(a[t][s],f)&&(f=a[t][s]);else for(;t--;)u(a[t],f)&&(f=a[t]);return f}}H.util.array={fill:e,invoke:r,min:l,max:c}}(),function(){function m(c,l,e){if(e)if(!H.isLikelyNode&&l instanceof Element)c=l;else if(l instanceof Array){c=[];for(var n=0,a=l.length;n<a;n++)c[n]=m({},l[n],e)}else if(l&&typeof l=="object")for(var s in l)s==="canvas"||s==="group"?c[s]=null:l.hasOwnProperty(s)&&(c[s]=m({},l[s],e));else c=l;else for(var s in l)c[s]=l[s];return c}function r(c,l){return m({},c,l)}H.util.object={extend:m,clone:r},H.util.object.extend(H.util,H.Observable)}(),function(){function m(n){return n.replace(/-+(.)?/g,function(a,s){return s?s.toUpperCase():""})}function r(n,a){return n.charAt(0).toUpperCase()+(a?n.slice(1):n.slice(1).toLowerCase())}function c(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(n){var a=0,s,u=[];for(a=0,s;a<n.length;a++)(s=e(n,a))!==!1&&u.push(s);return u}function e(n,a){var s=n.charCodeAt(a);if(isNaN(s))return"";if(s<55296||s>57343)return n.charAt(a);if(55296<=s&&s<=56319){if(n.length<=a+1)throw"High surrogate without following low surrogate";var u=n.charCodeAt(a+1);if(56320>u||u>57343)throw"High surrogate without following low surrogate";return n.charAt(a)+n.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var t=n.charCodeAt(a-1);if(55296>t||t>56319)throw"Low surrogate without preceding high surrogate";return!1}H.util.string={camelize:m,capitalize:r,escapeXml:c,graphemeSplit:l}}(),function(){var m=Array.prototype.slice,r=function(){},c=function(){for(var s in{toString:1})if(s==="toString")return!1;return!0}(),l=function(s,u,t){for(var f in u)f in s.prototype&&typeof s.prototype[f]=="function"&&(u[f]+"").indexOf("callSuper")>-1?s.prototype[f]=function(h){return function(){var v=this.constructor.superclass;this.constructor.superclass=t;var y=u[h].apply(this,arguments);if(this.constructor.superclass=v,h!=="initialize")return y}}(f):s.prototype[f]=u[f],c&&(u.toString!==Object.prototype.toString&&(s.prototype.toString=u.toString),u.valueOf!==Object.prototype.valueOf&&(s.prototype.valueOf=u.valueOf))};function e(){}function n(s){for(var u=null,t=this;t.constructor.superclass;){var f=t.constructor.superclass.prototype[s];if(t[s]!==f){u=f;break}t=t.constructor.superclass.prototype}return u?arguments.length>1?u.apply(this,m.call(arguments,1)):u.call(this):console.log("tried to callSuper "+s+", method not found in prototype chain",this)}function a(){var s=null,u=m.call(arguments,0);typeof u[0]=="function"&&(s=u.shift());function t(){this.initialize.apply(this,arguments)}t.superclass=s,t.subclasses=[],s&&(e.prototype=s.prototype,t.prototype=new e,s.subclasses.push(t));for(var f=0,h=u.length;f<h;f++)l(t,u[f],s);return t.prototype.initialize||(t.prototype.initialize=r),t.prototype.constructor=t,t.prototype.callSuper=n,t}H.util.createClass=a}(),function(){var m=!!H.document.createElement("div").attachEvent,r=["touchstart","touchmove","touchend"];H.util.addListener=function(l,e,n,a){l&&l.addEventListener(e,n,m?!1:a)},H.util.removeListener=function(l,e,n,a){l&&l.removeEventListener(e,n,m?!1:a)};function c(l){var e=l.changedTouches;return e&&e[0]?e[0]:l}H.util.getPointer=function(l){var e=l.target,n=H.util.getScrollLeftTop(e),a=c(l);return{x:a.clientX+n.left,y:a.clientY+n.top}},H.util.isTouchEvent=function(l){return r.indexOf(l.type)>-1||l.pointerType==="touch"}}(),function(){function m(a,s){var u=a.style;if(!u)return a;if(typeof s=="string")return a.style.cssText+=";"+s,s.indexOf("opacity")>-1?n(a,s.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var t in s)if(t==="opacity")n(a,s[t]);else{var f=t==="float"||t==="cssFloat"?typeof u.styleFloat=="undefined"?"cssFloat":"styleFloat":t;u[f]=s[t]}return a}var r=H.document.createElement("div"),c=typeof r.style.opacity=="string",l=typeof r.style.filter=="string",e=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(a){return a};c?n=function(a,s){return a.style.opacity=s,a}:l&&(n=function(a,s){var u=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(u.zoom=1),e.test(u.filter)?(s=s>=.9999?"":"alpha(opacity="+s*100+")",u.filter=u.filter.replace(e,s)):u.filter+=" alpha(opacity="+s*100+")",a}),H.util.setStyle=m}(),function(){var m=Array.prototype.slice;function r(y){return typeof y=="string"?H.document.getElementById(y):y}var c,l=function(y){return m.call(y,0)};try{c=l(H.document.childNodes)instanceof Array}catch{}c||(l=function(y){for(var p=new Array(y.length),g=y.length;g--;)p[g]=y[g];return p});function e(y,p){var g=H.document.createElement(y);for(var d in p)d==="class"?g.className=p[d]:d==="for"?g.htmlFor=p[d]:g.setAttribute(d,p[d]);return g}function n(y,p){y&&(" "+y.className+" ").indexOf(" "+p+" ")===-1&&(y.className+=(y.className?" ":"")+p)}function a(y,p,g){return typeof p=="string"&&(p=e(p,g)),y.parentNode&&y.parentNode.replaceChild(p,y),p.appendChild(y),p}function s(y){for(var p=0,g=0,d=H.document.documentElement,E=H.document.body||{scrollLeft:0,scrollTop:0};y&&(y.parentNode||y.host)&&(y=y.parentNode||y.host,y===H.document?(p=E.scrollLeft||d.scrollLeft||0,g=E.scrollTop||d.scrollTop||0):(p+=y.scrollLeft||0,g+=y.scrollTop||0),!(y.nodeType===1&&y.style.position==="fixed")););return{left:p,top:g}}function u(y){var p,g=y&&y.ownerDocument,d={left:0,top:0},E={left:0,top:0},w,D={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!g)return E;for(var b in D)E[D[b]]+=parseInt(t(y,b),10)||0;return p=g.documentElement,typeof y.getBoundingClientRect!="undefined"&&(d=y.getBoundingClientRect()),w=s(y),{left:d.left+w.left-(p.clientLeft||0)+E.left,top:d.top+w.top-(p.clientTop||0)+E.top}}var t;H.document.defaultView&&H.document.defaultView.getComputedStyle?t=function(y,p){var g=H.document.defaultView.getComputedStyle(y,null);return g?g[p]:void 0}:t=function(y,p){var g=y.style[p];return!g&&y.currentStyle&&(g=y.currentStyle[p]),g},function(){var y=H.document.documentElement.style,p="userSelect"in y?"userSelect":"MozUserSelect"in y?"MozUserSelect":"WebkitUserSelect"in y?"WebkitUserSelect":"KhtmlUserSelect"in y?"KhtmlUserSelect":"";function g(E){return typeof E.onselectstart!="undefined"&&(E.onselectstart=H.util.falseFunction),p?E.style[p]="none":typeof E.unselectable=="string"&&(E.unselectable="on"),E}function d(E){return typeof E.onselectstart!="undefined"&&(E.onselectstart=null),p?E.style[p]="":typeof E.unselectable=="string"&&(E.unselectable=""),E}H.util.makeElementUnselectable=g,H.util.makeElementSelectable=d}();function f(y){var p=H.jsdomImplForWrapper(y);return p._canvas||p._image}function h(y){if(!!H.isLikelyNode){var p=H.jsdomImplForWrapper(y);p&&(p._image=null,p._canvas=null,p._currentSrc=null,p._attributes=null,p._classList=null)}}function v(y,p){y.imageSmoothingEnabled=y.imageSmoothingEnabled||y.webkitImageSmoothingEnabled||y.mozImageSmoothingEnabled||y.msImageSmoothingEnabled||y.oImageSmoothingEnabled,y.imageSmoothingEnabled=p}H.util.setImageSmoothing=v,H.util.getById=r,H.util.toArray=l,H.util.addClass=n,H.util.makeElement=e,H.util.wrapElement=a,H.util.getScrollLeftTop=s,H.util.getElementOffset=u,H.util.getNodeCanvas=f,H.util.cleanUpJsdomNode=h}(),function(){function m(l,e){return l+(/\?/.test(l)?"&":"?")+e}function r(){}function c(l,e){e||(e={});var n=e.method?e.method.toUpperCase():"GET",a=e.onComplete||function(){},s=new H.window.XMLHttpRequest,u=e.body||e.parameters;return s.onreadystatechange=function(){s.readyState===4&&(a(s),s.onreadystatechange=r)},n==="GET"&&(u=null,typeof e.parameters=="string"&&(l=m(l,e.parameters))),s.open(n,l,!0),(n==="POST"||n==="PUT")&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(u),s}H.util.request=c}(),H.log=console.log,H.warn=console.warn,function(){var m=H.util.object.extend,r=H.util.object.clone,c=[];H.util.object.extend(c,{cancelAll:function(){var f=this.splice(0);return f.forEach(function(h){h.cancel()}),f},cancelByCanvas:function(f){if(!f)return[];var h=this.filter(function(v){return typeof v.target=="object"&&v.target.canvas===f});return h.forEach(function(v){v.cancel()}),h},cancelByTarget:function(f){var h=this.findAnimationsByTarget(f);return h.forEach(function(v){v.cancel()}),h},findAnimationIndex:function(f){return this.indexOf(this.findAnimation(f))},findAnimation:function(f){return this.find(function(h){return h.cancel===f})},findAnimationsByTarget:function(f){return f?this.filter(function(h){return h.target===f}):[]}});function l(){return!1}function e(f,h,v,y){return-v*Math.cos(f/y*(Math.PI/2))+v+h}function n(f){f||(f={});var h=!1,v,y=function(){var p=H.runningAnimations.indexOf(v);return p>-1&&H.runningAnimations.splice(p,1)[0]};return v=m(r(f),{cancel:function(){return h=!0,y()},currentValue:"startValue"in f?f.startValue:0,completionRate:0,durationRate:0}),H.runningAnimations.push(v),u(function(p){var g=p||+new Date,d=f.duration||500,E=g+d,w,D=f.onChange||l,b=f.abort||l,S=f.onComplete||l,C=f.easing||e,P="startValue"in f?f.startValue.length>0:!1,R="startValue"in f?f.startValue:0,L="endValue"in f?f.endValue:100,O=f.byValue||(P?R.map(function(_,x){return L[x]-R[x]}):L-R);f.onStart&&f.onStart(),function _(x){w=x||+new Date;var A=w>E?d:w-g,k=A/d,M=P?R.map(function(U,j){return C(A,R[j],O[j],d)}):C(A,R,O,d),N=Math.abs(P?(M[0]-R[0])/O[0]:(M-R)/O);if(v.currentValue=P?M.slice():M,v.completionRate=N,v.durationRate=k,!h){if(b(M,N,k)){y();return}if(w>E){v.currentValue=P?L.slice():L,v.completionRate=1,v.durationRate=1,D(P?L.slice():L,1,1),S(L,1,1),y();return}else D(M,N,k),u(_)}}(g)}),v.cancel}var a=H.window.requestAnimationFrame||H.window.webkitRequestAnimationFrame||H.window.mozRequestAnimationFrame||H.window.oRequestAnimationFrame||H.window.msRequestAnimationFrame||function(f){return H.window.setTimeout(f,1e3/60)},s=H.window.cancelAnimationFrame||H.window.clearTimeout;function u(){return a.apply(H.window,arguments)}function t(){return s.apply(H.window,arguments)}H.util.animate=n,H.util.requestAnimFrame=u,H.util.cancelAnimFrame=t,H.runningAnimations=c}(),function(){function m(c,l,e){var n="rgba("+parseInt(c[0]+e*(l[0]-c[0]),10)+","+parseInt(c[1]+e*(l[1]-c[1]),10)+","+parseInt(c[2]+e*(l[2]-c[2]),10);return n+=","+(c&&l?parseFloat(c[3]+e*(l[3]-c[3])):1),n+=")",n}function r(c,l,e,n){var a=new H.Color(c).getSource(),s=new H.Color(l).getSource(),u=n.onComplete,t=n.onChange;return n=n||{},H.util.animate(H.util.object.extend(n,{duration:e||500,startValue:a,endValue:s,byValue:s,easing:function(f,h,v,y){var p=n.colorEasing?n.colorEasing(f,y):1-Math.cos(f/y*(Math.PI/2));return m(h,v,p)},onComplete:function(f,h,v){if(u)return u(m(s,s,0),h,v)},onChange:function(f,h,v){if(t){if(Array.isArray(f))return t(m(f,f,0),h,v);t(f,h,v)}}}))}H.util.animateColor=r}(),function(){function m(x,A,k,M){return x<Math.abs(A)?(x=A,M=k/4):A===0&&x===0?M=k/(2*Math.PI)*Math.asin(1):M=k/(2*Math.PI)*Math.asin(A/x),{a:x,c:A,p:k,s:M}}function r(x,A,k){return x.a*Math.pow(2,10*(A-=1))*Math.sin((A*k-x.s)*(2*Math.PI)/x.p)}function c(x,A,k,M){return k*((x=x/M-1)*x*x+1)+A}function l(x,A,k,M){return x/=M/2,x<1?k/2*x*x*x+A:k/2*((x-=2)*x*x+2)+A}function e(x,A,k,M){return k*(x/=M)*x*x*x+A}function n(x,A,k,M){return-k*((x=x/M-1)*x*x*x-1)+A}function a(x,A,k,M){return x/=M/2,x<1?k/2*x*x*x*x+A:-k/2*((x-=2)*x*x*x-2)+A}function s(x,A,k,M){return k*(x/=M)*x*x*x*x+A}function u(x,A,k,M){return k*((x=x/M-1)*x*x*x*x+1)+A}function t(x,A,k,M){return x/=M/2,x<1?k/2*x*x*x*x*x+A:k/2*((x-=2)*x*x*x*x+2)+A}function f(x,A,k,M){return-k*Math.cos(x/M*(Math.PI/2))+k+A}function h(x,A,k,M){return k*Math.sin(x/M*(Math.PI/2))+A}function v(x,A,k,M){return-k/2*(Math.cos(Math.PI*x/M)-1)+A}function y(x,A,k,M){return x===0?A:k*Math.pow(2,10*(x/M-1))+A}function p(x,A,k,M){return x===M?A+k:k*(-Math.pow(2,-10*x/M)+1)+A}function g(x,A,k,M){return x===0?A:x===M?A+k:(x/=M/2,x<1?k/2*Math.pow(2,10*(x-1))+A:k/2*(-Math.pow(2,-10*--x)+2)+A)}function d(x,A,k,M){return-k*(Math.sqrt(1-(x/=M)*x)-1)+A}function E(x,A,k,M){return k*Math.sqrt(1-(x=x/M-1)*x)+A}function w(x,A,k,M){return x/=M/2,x<1?-k/2*(Math.sqrt(1-x*x)-1)+A:k/2*(Math.sqrt(1-(x-=2)*x)+1)+A}function D(x,A,k,M){var N=1.70158,U=0,j=k;if(x===0)return A;if(x/=M,x===1)return A+k;U||(U=M*.3);var z=m(j,k,U,N);return-r(z,x,M)+A}function b(x,A,k,M){var N=1.70158,U=0,j=k;if(x===0)return A;if(x/=M,x===1)return A+k;U||(U=M*.3);var z=m(j,k,U,N);return z.a*Math.pow(2,-10*x)*Math.sin((x*M-z.s)*(2*Math.PI)/z.p)+z.c+A}function S(x,A,k,M){var N=1.70158,U=0,j=k;if(x===0)return A;if(x/=M/2,x===2)return A+k;U||(U=M*(.3*1.5));var z=m(j,k,U,N);return x<1?-.5*r(z,x,M)+A:z.a*Math.pow(2,-10*(x-=1))*Math.sin((x*M-z.s)*(2*Math.PI)/z.p)*.5+z.c+A}function C(x,A,k,M,N){return N===void 0&&(N=1.70158),k*(x/=M)*x*((N+1)*x-N)+A}function P(x,A,k,M,N){return N===void 0&&(N=1.70158),k*((x=x/M-1)*x*((N+1)*x+N)+1)+A}function R(x,A,k,M,N){return N===void 0&&(N=1.70158),x/=M/2,x<1?k/2*(x*x*(((N*=1.525)+1)*x-N))+A:k/2*((x-=2)*x*(((N*=1.525)+1)*x+N)+2)+A}function L(x,A,k,M){return k-O(M-x,0,k,M)+A}function O(x,A,k,M){return(x/=M)<1/2.75?k*(7.5625*x*x)+A:x<2/2.75?k*(7.5625*(x-=1.5/2.75)*x+.75)+A:x<2.5/2.75?k*(7.5625*(x-=2.25/2.75)*x+.9375)+A:k*(7.5625*(x-=2.625/2.75)*x+.984375)+A}function _(x,A,k,M){return x<M/2?L(x*2,0,k,M)*.5+A:O(x*2-M,0,k,M)*.5+k*.5+A}H.util.ease={easeInQuad:function(x,A,k,M){return k*(x/=M)*x+A},easeOutQuad:function(x,A,k,M){return-k*(x/=M)*(x-2)+A},easeInOutQuad:function(x,A,k,M){return x/=M/2,x<1?k/2*x*x+A:-k/2*(--x*(x-2)-1)+A},easeInCubic:function(x,A,k,M){return k*(x/=M)*x*x+A},easeOutCubic:c,easeInOutCubic:l,easeInQuart:e,easeOutQuart:n,easeInOutQuart:a,easeInQuint:s,easeOutQuint:u,easeInOutQuint:t,easeInSine:f,easeOutSine:h,easeInOutSine:v,easeInExpo:y,easeOutExpo:p,easeInOutExpo:g,easeInCirc:d,easeOutCirc:E,easeInOutCirc:w,easeInElastic:D,easeOutElastic:b,easeInOutElastic:S,easeInBack:C,easeOutBack:P,easeInOutBack:R,easeInBounce:L,easeOutBounce:O,easeInOutBounce:_}}(),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.util.object.clone,e=r.util.toFixed,n=r.util.parseUnit,a=r.util.multiplyTransformMatrices,s=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],u=["symbol","image","marker","pattern","view","svg"],t=["pattern","defs","symbol","metadata","clipPath","mask","desc"],f=["symbol","g","a","svg","clipPath","defs"],h={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},v={stroke:"strokeOpacity",fill:"fillOpacity"},y="font-size",p="clip-path";r.svgValidTagNamesRegEx=E(s),r.svgViewBoxElementsRegEx=E(u),r.svgInvalidAncestorsRegEx=E(t),r.svgValidParentsRegEx=E(f),r.cssRules={},r.gradientDefs={},r.clipPaths={};function g(U){return U in h?h[U]:U}function d(U,j,z,J){var te=Array.isArray(j),re;if((U==="fill"||U==="stroke")&&j==="none")j="";else{if(U==="strokeUniform")return j==="non-scaling-stroke";if(U==="strokeDashArray")j==="none"?j=null:j=j.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(U==="transformMatrix")z&&z.transformMatrix?j=a(z.transformMatrix,r.parseTransformAttribute(j)):j=r.parseTransformAttribute(j);else if(U==="visible")j=j!=="none"&&j!=="hidden",z&&z.visible===!1&&(j=!1);else if(U==="opacity")j=parseFloat(j),z&&typeof z.opacity!="undefined"&&(j*=z.opacity);else if(U==="textAnchor")j=j==="start"?"left":j==="end"?"right":"center";else if(U==="charSpacing")re=n(j,J)/J*1e3;else if(U==="paintFirst"){var oe=j.indexOf("fill"),se=j.indexOf("stroke"),j="fill";(oe>-1&&se>-1&&se<oe||oe===-1&&se>-1)&&(j="stroke")}else{if(U==="href"||U==="xlink:href"||U==="font")return j;if(U==="imageSmoothing")return j==="optimizeQuality";re=te?j.map(n):n(j,J)}}return!te&&isNaN(re)?j:re}function E(U){return new RegExp("^("+U.join("|")+")\\b","i")}function w(U){for(var j in v)if(!(typeof U[v[j]]=="undefined"||U[j]==="")){if(typeof U[j]=="undefined"){if(!r.Object.prototype[j])continue;U[j]=r.Object.prototype[j]}if(U[j].indexOf("url(")!==0){var z=new r.Color(U[j]);U[j]=z.setAlpha(e(z.getAlpha()*U[v[j]],2)).toRgba()}}return U}function D(U,j){var z,J=[],te,re,oe;for(re=0,oe=j.length;re<oe;re++)z=j[re],te=U.getElementsByTagName(z),J=J.concat(Array.prototype.slice.call(te));return J}r.parseTransformAttribute=function(){function U(ge,_e){var Pe=r.util.cos(_e[0]),Q=r.util.sin(_e[0]),B=0,W=0;_e.length===3&&(B=_e[1],W=_e[2]),ge[0]=Pe,ge[1]=Q,ge[2]=-Q,ge[3]=Pe,ge[4]=B-(Pe*B-Q*W),ge[5]=W-(Q*B+Pe*W)}function j(ge,_e){var Pe=_e[0],Q=_e.length===2?_e[1]:_e[0];ge[0]=Pe,ge[3]=Q}function z(ge,_e,Pe){ge[Pe]=Math.tan(r.util.degreesToRadians(_e[0]))}function J(ge,_e){ge[4]=_e[0],_e.length===2&&(ge[5]=_e[1])}var te=r.iMatrix,re=r.reNum,oe=r.commaWsp,se="(?:(skewX)\\s*\\(\\s*("+re+")\\s*\\))",me="(?:(skewY)\\s*\\(\\s*("+re+")\\s*\\))",fe="(?:(rotate)\\s*\\(\\s*("+re+")(?:"+oe+"("+re+")"+oe+"("+re+"))?\\s*\\))",ue="(?:(scale)\\s*\\(\\s*("+re+")(?:"+oe+"("+re+"))?\\s*\\))",ye="(?:(translate)\\s*\\(\\s*("+re+")(?:"+oe+"("+re+"))?\\s*\\))",pe="(?:(matrix)\\s*\\(\\s*("+re+")"+oe+"("+re+")"+oe+"("+re+")"+oe+"("+re+")"+oe+"("+re+")"+oe+"("+re+")\\s*\\))",de="(?:"+pe+"|"+ye+"|"+ue+"|"+fe+"|"+se+"|"+me+")",ve="(?:"+de+"(?:"+oe+"*"+de+")*)",ne="^\\s*(?:"+ve+"?)\\s*$",we=new RegExp(ne),Ce=new RegExp(de,"g");return function(ge){var _e=te.concat(),Pe=[];if(!ge||ge&&!we.test(ge))return _e;ge.replace(Ce,function(B){var W=new RegExp(de).exec(B).filter(function(ie){return!!ie}),Y=W[1],$=W.slice(2).map(parseFloat);switch(Y){case"translate":J(_e,$);break;case"rotate":$[0]=r.util.degreesToRadians($[0]),U(_e,$);break;case"scale":j(_e,$);break;case"skewX":z(_e,$,2);break;case"skewY":z(_e,$,1);break;case"matrix":_e=$;break}Pe.push(_e.concat()),_e=te.concat()});for(var Q=Pe[0];Pe.length>1;)Pe.shift(),Q=r.util.multiplyTransformMatrices(Q,Pe[0]);return Q}}();function b(U,j){var z,J;U.replace(/;\s*$/,"").split(";").forEach(function(te){var re=te.split(":");z=re[0].trim().toLowerCase(),J=re[1].trim(),j[z]=J})}function S(U,j){var z,J;for(var te in U)typeof U[te]!="undefined"&&(z=te.toLowerCase(),J=U[te],j[z]=J)}function C(U,j){var z={};for(var J in r.cssRules[j])if(P(U,J.split(" ")))for(var te in r.cssRules[j][J])z[te]=r.cssRules[j][J][te];return z}function P(U,j){var z,J=!0;return z=L(U,j.pop()),z&&j.length&&(J=R(U,j)),z&&J&&j.length===0}function R(U,j){for(var z,J=!0;U.parentNode&&U.parentNode.nodeType===1&&j.length;)J&&(z=j.pop()),U=U.parentNode,J=L(U,z);return j.length===0}function L(U,j){var z=U.nodeName,J=U.getAttribute("class"),te=U.getAttribute("id"),re,oe;if(re=new RegExp("^"+z,"i"),j=j.replace(re,""),te&&j.length&&(re=new RegExp("#"+te+"(?![a-zA-Z\\-]+)","i"),j=j.replace(re,"")),J&&j.length)for(J=J.split(" "),oe=J.length;oe--;)re=new RegExp("\\."+J[oe]+"(?![a-zA-Z\\-]+)","i"),j=j.replace(re,"");return j.length===0}function O(U,j){var z;if(U.getElementById&&(z=U.getElementById(j)),z)return z;var J,te,re,oe=U.getElementsByTagName("*");for(te=0,re=oe.length;te<re;te++)if(J=oe[te],j===J.getAttribute("id"))return J}function _(U){for(var j=D(U,["use","svg:use"]),z=0;j.length&&z<j.length;){var J=j[z],te=J.getAttribute("xlink:href")||J.getAttribute("href");if(te===null)return;var re=te.slice(1),oe=J.getAttribute("x")||0,se=J.getAttribute("y")||0,me=O(U,re).cloneNode(!0),fe=(me.getAttribute("transform")||"")+" translate("+oe+", "+se+")",ue,ye=j.length,pe,de,ve,ne,we=r.svgNS;if(A(me),/^svg$/i.test(me.nodeName)){var Ce=me.ownerDocument.createElementNS(we,"g");for(de=0,ve=me.attributes,ne=ve.length;de<ne;de++)pe=ve.item(de),Ce.setAttributeNS(we,pe.nodeName,pe.nodeValue);for(;me.firstChild;)Ce.appendChild(me.firstChild);me=Ce}for(de=0,ve=J.attributes,ne=ve.length;de<ne;de++)pe=ve.item(de),!(pe.nodeName==="x"||pe.nodeName==="y"||pe.nodeName==="xlink:href"||pe.nodeName==="href")&&(pe.nodeName==="transform"?fe=pe.nodeValue+" "+fe:me.setAttribute(pe.nodeName,pe.nodeValue));me.setAttribute("transform",fe),me.setAttribute("instantiated_by_use","1"),me.removeAttribute("id"),ue=J.parentNode,ue.replaceChild(me,J),j.length===ye&&z++}}var x=new RegExp("^\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*$");function A(U){if(!r.svgViewBoxElementsRegEx.test(U.nodeName))return{};var j=U.getAttribute("viewBox"),z=1,J=1,te=0,re=0,oe,se,me,fe,ue=U.getAttribute("width"),ye=U.getAttribute("height"),pe=U.getAttribute("x")||0,de=U.getAttribute("y")||0,ve=U.getAttribute("preserveAspectRatio")||"",ne=!j||!(j=j.match(x)),we=!ue||!ye||ue==="100%"||ye==="100%",Ce=ne&&we,ge={},_e="",Pe=0,Q=0;if(ge.width=0,ge.height=0,ge.toBeParsed=Ce,ne&&(pe||de)&&U.parentNode&&U.parentNode.nodeName!=="#document"&&(_e=" translate("+n(pe)+" "+n(de)+") ",me=(U.getAttribute("transform")||"")+_e,U.setAttribute("transform",me),U.removeAttribute("x"),U.removeAttribute("y")),Ce)return ge;if(ne)return ge.width=n(ue),ge.height=n(ye),ge;if(te=-parseFloat(j[1]),re=-parseFloat(j[2]),oe=parseFloat(j[3]),se=parseFloat(j[4]),ge.minX=te,ge.minY=re,ge.viewBoxWidth=oe,ge.viewBoxHeight=se,we?(ge.width=oe,ge.height=se):(ge.width=n(ue),ge.height=n(ye),z=ge.width/oe,J=ge.height/se),ve=r.util.parsePreserveAspectRatioAttribute(ve),ve.alignX!=="none"&&(ve.meetOrSlice==="meet"&&(J=z=z>J?J:z),ve.meetOrSlice==="slice"&&(J=z=z>J?z:J),Pe=ge.width-oe*z,Q=ge.height-se*z,ve.alignX==="Mid"&&(Pe/=2),ve.alignY==="Mid"&&(Q/=2),ve.alignX==="Min"&&(Pe=0),ve.alignY==="Min"&&(Q=0)),z===1&&J===1&&te===0&&re===0&&pe===0&&de===0)return ge;if((pe||de)&&U.parentNode.nodeName!=="#document"&&(_e=" translate("+n(pe)+" "+n(de)+") "),me=_e+" matrix("+z+" 0 0 "+J+" "+(te*z+Pe)+" "+(re*J+Q)+") ",U.nodeName==="svg"){for(fe=U.ownerDocument.createElementNS(r.svgNS,"g");U.firstChild;)fe.appendChild(U.firstChild);U.appendChild(fe)}else fe=U,fe.removeAttribute("x"),fe.removeAttribute("y"),me=fe.getAttribute("transform")+me;return fe.setAttribute("transform",me),ge}function k(U,j){for(;U&&(U=U.parentNode);)if(U.nodeName&&j.test(U.nodeName.replace("svg:",""))&&!U.getAttribute("instantiated_by_use"))return!0;return!1}r.parseSVGDocument=function(U,j,z,J){if(!!U){_(U);var te=r.Object.__uid++,re,oe,se=A(U),me=r.util.toArray(U.getElementsByTagName("*"));if(se.crossOrigin=J&&J.crossOrigin,se.svgUid=te,me.length===0&&r.isLikelyNode){me=U.selectNodes('//*[name(.)!="svg"]');var fe=[];for(re=0,oe=me.length;re<oe;re++)fe[re]=me[re];me=fe}var ue=me.filter(function(pe){return A(pe),r.svgValidTagNamesRegEx.test(pe.nodeName.replace("svg:",""))&&!k(pe,r.svgInvalidAncestorsRegEx)});if(!ue||ue&&!ue.length){j&&j([],{});return}var ye={};me.filter(function(pe){return pe.nodeName.replace("svg:","")==="clipPath"}).forEach(function(pe){var de=pe.getAttribute("id");ye[de]=r.util.toArray(pe.getElementsByTagName("*")).filter(function(ve){return r.svgValidTagNamesRegEx.test(ve.nodeName.replace("svg:",""))})}),r.gradientDefs[te]=r.getGradientDefs(U),r.cssRules[te]=r.getCSSRules(U),r.clipPaths[te]=ye,r.parseElements(ue,function(pe,de){j&&(j(pe,se,de,me),delete r.gradientDefs[te],delete r.cssRules[te],delete r.clipPaths[te])},l(se),z,J)}};function M(U,j){var z=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],J="xlink:href",te=j.getAttribute(J).slice(1),re=O(U,te);if(re&&re.getAttribute(J)&&M(U,re),z.forEach(function(se){re&&!j.hasAttribute(se)&&re.hasAttribute(se)&&j.setAttribute(se,re.getAttribute(se))}),!j.children.length)for(var oe=re.cloneNode(!0);oe.firstChild;)j.appendChild(oe.firstChild);j.removeAttribute(J)}var N=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+r.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+r.reNum+"))?\\s+(.*)");c(r,{parseFontDeclaration:function(U,j){var z=U.match(N);if(!!z){var J=z[1],te=z[3],re=z[4],oe=z[5],se=z[6];J&&(j.fontStyle=J),te&&(j.fontWeight=isNaN(parseFloat(te))?te:parseFloat(te)),re&&(j.fontSize=n(re)),se&&(j.fontFamily=se),oe&&(j.lineHeight=oe==="normal"?1:oe)}},getGradientDefs:function(U){var j=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],z=D(U,j),J,te=0,re={};for(te=z.length;te--;)J=z[te],J.getAttribute("xlink:href")&&M(U,J),re[J.getAttribute("id")]=J;return re},parseAttributes:function(U,j,z){if(!!U){var J,te={},re,oe;typeof z=="undefined"&&(z=U.getAttribute("svgUid")),U.parentNode&&r.svgValidParentsRegEx.test(U.parentNode.nodeName)&&(te=r.parseAttributes(U.parentNode,j,z));var se=j.reduce(function(ve,ne){return J=U.getAttribute(ne),J&&(ve[ne]=J),ve},{}),me=c(C(U,z),r.parseStyleAttribute(U));se=c(se,me),me[p]&&U.setAttribute(p,me[p]),re=oe=te.fontSize||r.Text.DEFAULT_SVG_FONT_SIZE,se[y]&&(se[y]=re=n(se[y],oe));var fe,ue,ye={};for(var pe in se)fe=g(pe),ue=d(fe,se[pe],te,re),ye[fe]=ue;ye&&ye.font&&r.parseFontDeclaration(ye.font,ye);var de=c(te,ye);return r.svgValidParentsRegEx.test(U.nodeName)?de:w(de)}},parseElements:function(U,j,z,J,te){new r.ElementsParser(U,j,z,J,te).parse()},parseStyleAttribute:function(U){var j={},z=U.getAttribute("style");return z&&(typeof z=="string"?b(z,j):S(z,j)),j},parsePointsAttribute:function(U){if(!U)return null;U=U.replace(/,/g," ").trim(),U=U.split(/\s+/);var j=[],z,J;for(z=0,J=U.length;z<J;z+=2)j.push({x:parseFloat(U[z]),y:parseFloat(U[z+1])});return j},getCSSRules:function(U){var j=U.getElementsByTagName("style"),z,J,te={},re;for(z=0,J=j.length;z<J;z++){var oe=j[z].textContent;oe=oe.replace(/\/\*[\s\S]*?\*\//g,""),oe.trim()!==""&&(re=oe.split("}"),re=re.filter(function(se){return se.trim()}),re.forEach(function(se){var me=se.split("{"),fe={},ue=me[1].trim(),ye=ue.split(";").filter(function(ne){return ne.trim()});for(z=0,J=ye.length;z<J;z++){var pe=ye[z].split(":"),de=pe[0].trim(),ve=pe[1].trim();fe[de]=ve}se=me[0].trim(),se.split(",").forEach(function(ne){ne=ne.replace(/^svg/i,"").trim(),ne!==""&&(te[ne]?r.util.object.extend(te[ne],fe):te[ne]=r.util.object.clone(fe))})}))}return te},loadSVGFromURL:function(U,j,z,J){U=U.replace(/^\n\s*/,"").trim(),new r.util.request(U,{method:"get",onComplete:te});function te(re){var oe=re.responseXML;if(!oe||!oe.documentElement)return j&&j(null),!1;r.parseSVGDocument(oe.documentElement,function(se,me,fe,ue){j&&j(se,me,fe,ue)},z,J)}},loadSVGFromString:function(U,j,z,J){var te=new r.window.DOMParser,re=te.parseFromString(U.trim(),"text/xml");r.parseSVGDocument(re.documentElement,function(oe,se,me,fe){j(oe,se,me,fe)},z,J)}})}(be),H.ElementsParser=function(m,r,c,l,e,n){this.elements=m,this.callback=r,this.options=c,this.reviver=l,this.svgUid=c&&c.svgUid||0,this.parsingOptions=e,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=n},function(m){m.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},m.createObjects=function(){var r=this;this.elements.forEach(function(c,l){c.setAttribute("svgUid",r.svgUid),r.createObject(c,l)})},m.findTag=function(r){return H[H.util.string.capitalize(r.tagName.replace("svg:",""))]},m.createObject=function(r,c){var l=this.findTag(r);if(l&&l.fromElement)try{l.fromElement(r,this.createCallback(c,r),this.options)}catch(e){H.log(e)}else this.checkIfDone()},m.createCallback=function(r,c){var l=this;return function(e){var n;l.resolveGradient(e,c,"fill"),l.resolveGradient(e,c,"stroke"),e instanceof H.Image&&e._originalElement&&(n=e.parsePreserveAspectRatioAttribute(c)),e._removeTransformMatrix(n),l.resolveClipPath(e,c),l.reviver&&l.reviver(c,e),l.instances[r]=e,l.checkIfDone()}},m.extractPropertyDefinition=function(r,c,l){var e=r[c],n=this.regexUrl;if(!!n.test(e)){n.lastIndex=0;var a=n.exec(e)[1];return n.lastIndex=0,H[l][this.svgUid][a]}},m.resolveGradient=function(r,c,l){var e=this.extractPropertyDefinition(r,l,"gradientDefs");if(e){var n=c.getAttribute(l+"-opacity"),a=H.Gradient.fromElement(e,r,n,this.options);r.set(l,a)}},m.createClipPathCallback=function(r,c){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,c.push(l)}},m.resolveClipPath=function(r,c){var l=this.extractPropertyDefinition(r,"clipPath","clipPaths"),e,n,a,s,u,t;if(l){s=[],a=H.util.invertTransform(r.calcTransformMatrix());for(var f=l[0].parentNode,h=c;h.parentNode&&h.getAttribute("clip-path")!==r.clipPath;)h=h.parentNode;h.parentNode.appendChild(f);for(var v=0;v<l.length;v++)e=l[v],n=this.findTag(e),n.fromElement(e,this.createClipPathCallback(r,s),this.options);s.length===1?l=s[0]:l=new H.Group(s),u=H.util.multiplyTransformMatrices(a,l.calcTransformMatrix()),l.clipPath&&this.resolveClipPath(l,h);var t=H.util.qrDecompose(u);l.flipX=!1,l.flipY=!1,l.set("scaleX",t.scaleX),l.set("scaleY",t.scaleY),l.angle=t.angle,l.skewX=t.skewX,l.skewY=0,l.setPositionByOrigin({x:t.translateX,y:t.translateY},"center","center"),r.clipPath=l}else delete r.clipPath},m.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(r){return r!=null}),this.callback(this.instances,this.elements))}}(H.ElementsParser.prototype),function(m){var r=m.fabric||(m.fabric={});if(r.Point){r.warn("fabric.Point is already defined");return}r.Point=c;function c(l,e){this.x=l,this.y=e}c.prototype={type:"point",constructor:c,add:function(l){return new c(this.x+l.x,this.y+l.y)},addEquals:function(l){return this.x+=l.x,this.y+=l.y,this},scalarAdd:function(l){return new c(this.x+l,this.y+l)},scalarAddEquals:function(l){return this.x+=l,this.y+=l,this},subtract:function(l){return new c(this.x-l.x,this.y-l.y)},subtractEquals:function(l){return this.x-=l.x,this.y-=l.y,this},scalarSubtract:function(l){return new c(this.x-l,this.y-l)},scalarSubtractEquals:function(l){return this.x-=l,this.y-=l,this},multiply:function(l){return new c(this.x*l,this.y*l)},multiplyEquals:function(l){return this.x*=l,this.y*=l,this},divide:function(l){return new c(this.x/l,this.y/l)},divideEquals:function(l){return this.x/=l,this.y/=l,this},eq:function(l){return this.x===l.x&&this.y===l.y},lt:function(l){return this.x<l.x&&this.y<l.y},lte:function(l){return this.x<=l.x&&this.y<=l.y},gt:function(l){return this.x>l.x&&this.y>l.y},gte:function(l){return this.x>=l.x&&this.y>=l.y},lerp:function(l,e){return typeof e=="undefined"&&(e=.5),e=Math.max(Math.min(1,e),0),new c(this.x+(l.x-this.x)*e,this.y+(l.y-this.y)*e)},distanceFrom:function(l){var e=this.x-l.x,n=this.y-l.y;return Math.sqrt(e*e+n*n)},midPointFrom:function(l){return this.lerp(l)},min:function(l){return new c(Math.min(this.x,l.x),Math.min(this.y,l.y))},max:function(l){return new c(Math.max(this.x,l.x),Math.max(this.y,l.y))},toString:function(){return this.x+","+this.y},setXY:function(l,e){return this.x=l,this.y=e,this},setX:function(l){return this.x=l,this},setY:function(l){return this.y=l,this},setFromPoint:function(l){return this.x=l.x,this.y=l.y,this},swap:function(l){var e=this.x,n=this.y;this.x=l.x,this.y=l.y,l.x=e,l.y=n},clone:function(){return new c(this.x,this.y)}}}(be),function(m){var r=m.fabric||(m.fabric={});if(r.Intersection){r.warn("fabric.Intersection is already defined");return}function c(l){this.status=l,this.points=[]}r.Intersection=c,r.Intersection.prototype={constructor:c,appendPoint:function(l){return this.points.push(l),this},appendPoints:function(l){return this.points=this.points.concat(l),this}},r.Intersection.intersectLineLine=function(l,e,n,a){var s,u=(a.x-n.x)*(l.y-n.y)-(a.y-n.y)*(l.x-n.x),t=(e.x-l.x)*(l.y-n.y)-(e.y-l.y)*(l.x-n.x),f=(a.y-n.y)*(e.x-l.x)-(a.x-n.x)*(e.y-l.y);if(f!==0){var h=u/f,v=t/f;0<=h&&h<=1&&0<=v&&v<=1?(s=new c("Intersection"),s.appendPoint(new r.Point(l.x+h*(e.x-l.x),l.y+h*(e.y-l.y)))):s=new c}else u===0||t===0?s=new c("Coincident"):s=new c("Parallel");return s},r.Intersection.intersectLinePolygon=function(l,e,n){var a=new c,s=n.length,u,t,f,h;for(h=0;h<s;h++)u=n[h],t=n[(h+1)%s],f=c.intersectLineLine(l,e,u,t),a.appendPoints(f.points);return a.points.length>0&&(a.status="Intersection"),a},r.Intersection.intersectPolygonPolygon=function(l,e){var n=new c,a=l.length,s;for(s=0;s<a;s++){var u=l[s],t=l[(s+1)%a],f=c.intersectLinePolygon(u,t,e);n.appendPoints(f.points)}return n.points.length>0&&(n.status="Intersection"),n},r.Intersection.intersectPolygonRectangle=function(l,e,n){var a=e.min(n),s=e.max(n),u=new r.Point(s.x,a.y),t=new r.Point(a.x,s.y),f=c.intersectLinePolygon(a,u,l),h=c.intersectLinePolygon(u,s,l),v=c.intersectLinePolygon(s,t,l),y=c.intersectLinePolygon(t,a,l),p=new c;return p.appendPoints(f.points),p.appendPoints(h.points),p.appendPoints(v.points),p.appendPoints(y.points),p.points.length>0&&(p.status="Intersection"),p}}(be),function(m){var r=m.fabric||(m.fabric={});if(r.Color){r.warn("fabric.Color is already defined.");return}function c(e){e?this._tryParsingColor(e):this.setSource([0,0,0,1])}r.Color=c,r.Color.prototype={_tryParsingColor:function(e){var n;e in c.colorNameMap&&(e=c.colorNameMap[e]),e==="transparent"&&(n=[255,255,255,0]),n||(n=c.sourceFromHex(e)),n||(n=c.sourceFromRgb(e)),n||(n=c.sourceFromHsl(e)),n||(n=[0,0,0,1]),n&&this.setSource(n)},_rgbToHsl:function(e,n,a){e/=255,n/=255,a/=255;var s,u,t,f=r.util.array.max([e,n,a]),h=r.util.array.min([e,n,a]);if(t=(f+h)/2,f===h)s=u=0;else{var v=f-h;switch(u=t>.5?v/(2-f-h):v/(f+h),f){case e:s=(n-a)/v+(n<a?6:0);break;case n:s=(a-e)/v+2;break;case a:s=(e-n)/v+4;break}s/=6}return[Math.round(s*360),Math.round(u*100),Math.round(t*100)]},getSource:function(){return this._source},setSource:function(e){this._source=e},toRgb:function(){var e=this.getSource();return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRgba:function(){var e=this.getSource();return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toHsl:function(){var e=this.getSource(),n=this._rgbToHsl(e[0],e[1],e[2]);return"hsl("+n[0]+","+n[1]+"%,"+n[2]+"%)"},toHsla:function(){var e=this.getSource(),n=this._rgbToHsl(e[0],e[1],e[2]);return"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+e[3]+")"},toHex:function(){var e=this.getSource(),n,a,s;return n=e[0].toString(16),n=n.length===1?"0"+n:n,a=e[1].toString(16),a=a.length===1?"0"+a:a,s=e[2].toString(16),s=s.length===1?"0"+s:s,n.toUpperCase()+a.toUpperCase()+s.toUpperCase()},toHexa:function(){var e=this.getSource(),n;return n=Math.round(e[3]*255),n=n.toString(16),n=n.length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var n=this.getSource();return n[3]=e,this.setSource(n),this},toGrayscale:function(){var e=this.getSource(),n=parseInt((e[0]*.3+e[1]*.59+e[2]*.11).toFixed(0),10),a=e[3];return this.setSource([n,n,n,a]),this},toBlackWhite:function(e){var n=this.getSource(),a=(n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),s=n[3];return e=e||127,a=Number(a)<Number(e)?0:255,this.setSource([a,a,a,s]),this},overlayWith:function(e){e instanceof c||(e=new c(e));var n=[],a=this.getAlpha(),s=.5,u=this.getSource(),t=e.getSource(),f;for(f=0;f<3;f++)n.push(Math.round(u[f]*(1-s)+t[f]*s));return n[3]=a,this.setSource(n),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,r.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function l(e,n,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(n-e)*6*a:a<1/2?n:a<2/3?e+(n-e)*(2/3-a)*6:e}r.Color.fromRgb=function(e){return c.fromSource(c.sourceFromRgb(e))},r.Color.sourceFromRgb=function(e){var n=e.match(c.reRGBa);if(n){var a=parseInt(n[1],10)/(/%$/.test(n[1])?100:1)*(/%$/.test(n[1])?255:1),s=parseInt(n[2],10)/(/%$/.test(n[2])?100:1)*(/%$/.test(n[2])?255:1),u=parseInt(n[3],10)/(/%$/.test(n[3])?100:1)*(/%$/.test(n[3])?255:1);return[parseInt(a,10),parseInt(s,10),parseInt(u,10),n[4]?parseFloat(n[4]):1]}},r.Color.fromRgba=c.fromRgb,r.Color.fromHsl=function(e){return c.fromSource(c.sourceFromHsl(e))},r.Color.sourceFromHsl=function(e){var n=e.match(c.reHSLa);if(!!n){var a=(parseFloat(n[1])%360+360)%360/360,s=parseFloat(n[2])/(/%$/.test(n[2])?100:1),u=parseFloat(n[3])/(/%$/.test(n[3])?100:1),t,f,h;if(s===0)t=f=h=u;else{var v=u<=.5?u*(s+1):u+s-u*s,y=u*2-v;t=l(y,v,a+1/3),f=l(y,v,a),h=l(y,v,a-1/3)}return[Math.round(t*255),Math.round(f*255),Math.round(h*255),n[4]?parseFloat(n[4]):1]}},r.Color.fromHsla=c.fromHsl,r.Color.fromHex=function(e){return c.fromSource(c.sourceFromHex(e))},r.Color.sourceFromHex=function(e){if(e.match(c.reHex)){var n=e.slice(e.indexOf("#")+1),a=n.length===3||n.length===4,s=n.length===8||n.length===4,u=a?n.charAt(0)+n.charAt(0):n.substring(0,2),t=a?n.charAt(1)+n.charAt(1):n.substring(2,4),f=a?n.charAt(2)+n.charAt(2):n.substring(4,6),h=s?a?n.charAt(3)+n.charAt(3):n.substring(6,8):"FF";return[parseInt(u,16),parseInt(t,16),parseInt(f,16),parseFloat((parseInt(h,16)/255).toFixed(2))]}},r.Color.fromSource=function(e){var n=new c;return n.setSource(e),n}}(be),function(m){var r=m.fabric||(m.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],l=["ns","nesw","ew","nwse"],e={},n="left",a="top",s="right",u="bottom",t="center",f={top:u,bottom:a,left:s,right:n,center:t},h=r.util.radiansToDegrees,v=Math.sign||function(fe){return(fe>0)-(fe<0)||+fe};function y(fe,ue){var ye=fe.angle+h(Math.atan2(ue.y,ue.x))+360;return Math.round(ye%360/45)}function p(fe,ue){var ye=ue.transform.target,pe=ye.canvas,de=r.util.object.clone(ue);de.target=ye,pe&&pe.fire("object:"+fe,de),ye.fire(fe,ue)}function g(fe,ue){var ye=ue.canvas,pe=ye.uniScaleKey,de=fe[pe];return ye.uniformScaling&&!de||!ye.uniformScaling&&de}function d(fe){return fe.originX===t&&fe.originY===t}function E(fe,ue,ye){var pe=fe.lockScalingX,de=fe.lockScalingY;return!!(pe&&de||!ue&&(pe||de)&&ye||pe&&ue==="x"||de&&ue==="y")}function w(fe,ue,ye){var pe="not-allowed",de=g(fe,ye),ve="";if(ue.x!==0&&ue.y===0?ve="x":ue.x===0&&ue.y!==0&&(ve="y"),E(ye,ve,de))return pe;var ne=y(ye,ue);return c[ne]+"-resize"}function D(fe,ue,ye){var pe="not-allowed";if(ue.x!==0&&ye.lockSkewingY||ue.y!==0&&ye.lockSkewingX)return pe;var de=y(ye,ue)%4;return l[de]+"-resize"}function b(fe,ue,ye){return fe[ye.canvas.altActionKey]?e.skewCursorStyleHandler(fe,ue,ye):e.scaleCursorStyleHandler(fe,ue,ye)}function S(fe,ue,ye){var pe=fe[ye.canvas.altActionKey];if(ue.x===0)return pe?"skewX":"scaleY";if(ue.y===0)return pe?"skewY":"scaleX"}function C(fe,ue,ye){return ye.lockRotation?"not-allowed":ue.cursorStyle}function P(fe,ue,ye,pe){return{e:fe,transform:ue,pointer:{x:ye,y:pe}}}function R(fe){return function(ue,ye,pe,de){var ve=ye.target,ne=ve.getCenterPoint(),we=ve.translateToOriginPoint(ne,ye.originX,ye.originY),Ce=fe(ue,ye,pe,de);return ve.setPositionByOrigin(we,ye.originX,ye.originY),Ce}}function L(fe,ue){return function(ye,pe,de,ve){var ne=ue(ye,pe,de,ve);return ne&&p(fe,P(ye,pe,de,ve)),ne}}function O(fe,ue,ye,pe,de){var ve=fe.target,ne=ve.controls[fe.corner],we=ve.canvas.getZoom(),Ce=ve.padding/we,ge=ve.toLocalPoint(new r.Point(pe,de),ue,ye);return ge.x>=Ce&&(ge.x-=Ce),ge.x<=-Ce&&(ge.x+=Ce),ge.y>=Ce&&(ge.y-=Ce),ge.y<=Ce&&(ge.y+=Ce),ge.x-=ne.offsetX,ge.y-=ne.offsetY,ge}function _(fe){return fe.flipX!==fe.flipY}function x(fe,ue,ye,pe,de){if(fe[ue]!==0){var ve=fe._getTransformedDimensions()[pe],ne=de/ve*fe[ye];fe.set(ye,ne)}}function A(fe,ue,ye,pe){var de=ue.target,ve=de._getTransformedDimensions(0,de.skewY),ne=O(ue,ue.originX,ue.originY,ye,pe),we=Math.abs(ne.x*2)-ve.x,Ce=de.skewX,ge;we<2?ge=0:(ge=h(Math.atan2(we/de.scaleX,ve.y/de.scaleY)),ue.originX===n&&ue.originY===u&&(ge=-ge),ue.originX===s&&ue.originY===a&&(ge=-ge),_(de)&&(ge=-ge));var _e=Ce!==ge;if(_e){var Pe=de._getTransformedDimensions().y;de.set("skewX",ge),x(de,"skewY","scaleY","y",Pe)}return _e}function k(fe,ue,ye,pe){var de=ue.target,ve=de._getTransformedDimensions(de.skewX,0),ne=O(ue,ue.originX,ue.originY,ye,pe),we=Math.abs(ne.y*2)-ve.y,Ce=de.skewY,ge;we<2?ge=0:(ge=h(Math.atan2(we/de.scaleY,ve.x/de.scaleX)),ue.originX===n&&ue.originY===u&&(ge=-ge),ue.originX===s&&ue.originY===a&&(ge=-ge),_(de)&&(ge=-ge));var _e=Ce!==ge;if(_e){var Pe=de._getTransformedDimensions().x;de.set("skewY",ge),x(de,"skewX","scaleX","x",Pe)}return _e}function M(fe,ue,ye,pe){var de=ue.target,ve=de.skewX,ne,we=ue.originY;if(de.lockSkewingX)return!1;if(ve===0){var Ce=O(ue,t,t,ye,pe);Ce.x>0?ne=n:ne=s}else ve>0&&(ne=we===a?n:s),ve<0&&(ne=we===a?s:n),_(de)&&(ne=ne===n?s:n);ue.originX=ne;var ge=L("skewing",R(A));return ge(fe,ue,ye,pe)}function N(fe,ue,ye,pe){var de=ue.target,ve=de.skewY,ne,we=ue.originX;if(de.lockSkewingY)return!1;if(ve===0){var Ce=O(ue,t,t,ye,pe);Ce.y>0?ne=a:ne=u}else ve>0&&(ne=we===n?a:u),ve<0&&(ne=we===n?u:a),_(de)&&(ne=ne===a?u:a);ue.originY=ne;var ge=L("skewing",R(k));return ge(fe,ue,ye,pe)}function U(fe,ue,ye,pe){var de=ue,ve=de.target,ne=ve.translateToOriginPoint(ve.getCenterPoint(),de.originX,de.originY);if(ve.lockRotation)return!1;var we=Math.atan2(de.ey-ne.y,de.ex-ne.x),Ce=Math.atan2(pe-ne.y,ye-ne.x),ge=h(Ce-we+de.theta),_e=!0;if(ve.snapAngle>0){var Pe=ve.snapAngle,Q=ve.snapThreshold||Pe,B=Math.ceil(ge/Pe)*Pe,W=Math.floor(ge/Pe)*Pe;Math.abs(ge-W)<Q?ge=W:Math.abs(ge-B)<Q&&(ge=B)}return ge<0&&(ge=360+ge),ge%=360,_e=ve.angle!==ge,ve.angle=ge,_e}function j(fe,ue,ye,pe,de){de=de||{};var ve=ue.target,ne=ve.lockScalingX,we=ve.lockScalingY,Ce=de.by,ge,_e,Pe,Q,B=g(fe,ve),W=E(ve,Ce,B),Y,$,ie=ue.gestureScale;if(W)return!1;if(ie)_e=ue.scaleX*ie,Pe=ue.scaleY*ie;else{if(ge=O(ue,ue.originX,ue.originY,ye,pe),Y=Ce!=="y"?v(ge.x):1,$=Ce!=="x"?v(ge.y):1,ue.signX||(ue.signX=Y),ue.signY||(ue.signY=$),ve.lockScalingFlip&&(ue.signX!==Y||ue.signY!==$))return!1;if(Q=ve._getTransformedDimensions(),B&&!Ce){var le=Math.abs(ge.x)+Math.abs(ge.y),ce=ue.original,xe=Math.abs(Q.x*ce.scaleX/ve.scaleX)+Math.abs(Q.y*ce.scaleY/ve.scaleY),Oe=le/xe;_e=ce.scaleX*Oe,Pe=ce.scaleY*Oe}else _e=Math.abs(ge.x*ve.scaleX/Q.x),Pe=Math.abs(ge.y*ve.scaleY/Q.y);d(ue)&&(_e*=2,Pe*=2),ue.signX!==Y&&Ce!=="y"&&(ue.originX=f[ue.originX],_e*=-1,ue.signX=Y),ue.signY!==$&&Ce!=="x"&&(ue.originY=f[ue.originY],Pe*=-1,ue.signY=$)}var ke=ve.scaleX,Ue=ve.scaleY;return Ce?(Ce==="x"&&ve.set("scaleX",_e),Ce==="y"&&ve.set("scaleY",Pe)):(!ne&&ve.set("scaleX",_e),!we&&ve.set("scaleY",Pe)),ke!==ve.scaleX||Ue!==ve.scaleY}function z(fe,ue,ye,pe){return j(fe,ue,ye,pe)}function J(fe,ue,ye,pe){return j(fe,ue,ye,pe,{by:"x"})}function te(fe,ue,ye,pe){return j(fe,ue,ye,pe,{by:"y"})}function re(fe,ue,ye,pe){return fe[ue.target.canvas.altActionKey]?e.skewHandlerX(fe,ue,ye,pe):e.scalingY(fe,ue,ye,pe)}function oe(fe,ue,ye,pe){return fe[ue.target.canvas.altActionKey]?e.skewHandlerY(fe,ue,ye,pe):e.scalingX(fe,ue,ye,pe)}function se(fe,ue,ye,pe){var de=ue.target,ve=O(ue,ue.originX,ue.originY,ye,pe),ne=de.strokeWidth/(de.strokeUniform?de.scaleX:1),we=d(ue)?2:1,Ce=de.width,ge=Math.abs(ve.x*we/de.scaleX)-ne;return de.set("width",Math.max(ge,0)),Ce!==ge}function me(fe,ue,ye,pe){var de=ue.target,ve=ye-ue.offsetX,ne=pe-ue.offsetY,we=!de.get("lockMovementX")&&de.left!==ve,Ce=!de.get("lockMovementY")&&de.top!==ne;return we&&de.set("left",ve),Ce&&de.set("top",ne),(we||Ce)&&p("moving",P(fe,ue,ye,pe)),we||Ce}e.scaleCursorStyleHandler=w,e.skewCursorStyleHandler=D,e.scaleSkewCursorStyleHandler=b,e.rotationWithSnapping=L("rotating",R(U)),e.scalingEqually=L("scaling",R(z)),e.scalingX=L("scaling",R(J)),e.scalingY=L("scaling",R(te)),e.scalingYOrSkewingX=re,e.scalingXOrSkewingY=oe,e.changeWidth=L("resizing",R(se)),e.skewHandlerX=M,e.skewHandlerY=N,e.dragHandler=me,e.scaleOrSkewActionName=S,e.rotationStyleHandler=C,e.fireEvent=p,e.wrapWithFixedAnchor=R,e.wrapWithFireEvent=L,e.getLocalPoint=O,r.controlsUtils=e}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.degreesToRadians,l=r.controlsUtils;function e(a,s,u,t,f){t=t||{};var h=this.sizeX||t.cornerSize||f.cornerSize,v=this.sizeY||t.cornerSize||f.cornerSize,y=typeof t.transparentCorners!="undefined"?t.transparentCorners:f.transparentCorners,p=y?"stroke":"fill",g=!y&&(t.cornerStrokeColor||f.cornerStrokeColor),d=s,E=u,w;a.save(),a.fillStyle=t.cornerColor||f.cornerColor,a.strokeStyle=t.cornerStrokeColor||f.cornerStrokeColor,h>v?(w=h,a.scale(1,v/h),E=u*h/v):v>h?(w=v,a.scale(h/v,1),d=s*v/h):w=h,a.lineWidth=1,a.beginPath(),a.arc(d,E,w/2,0,2*Math.PI,!1),a[p](),g&&a.stroke(),a.restore()}function n(a,s,u,t,f){t=t||{};var h=this.sizeX||t.cornerSize||f.cornerSize,v=this.sizeY||t.cornerSize||f.cornerSize,y=typeof t.transparentCorners!="undefined"?t.transparentCorners:f.transparentCorners,p=y?"stroke":"fill",g=!y&&(t.cornerStrokeColor||f.cornerStrokeColor),d=h/2,E=v/2;a.save(),a.fillStyle=t.cornerColor||f.cornerColor,a.strokeStyle=t.cornerStrokeColor||f.cornerStrokeColor,a.lineWidth=1,a.translate(s,u),a.rotate(c(f.angle)),a[p+"Rect"](-d,-E,h,v),g&&a.strokeRect(-d,-E,h,v),a.restore()}l.renderCircleControl=e,l.renderSquareControl=n}(be),function(m){var r=m.fabric||(m.fabric={});function c(l){for(var e in l)this[e]=l[e]}r.Control=c,r.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,e){return e.cursorStyle},getActionName:function(l,e){return e.actionName},getVisibility:function(l,e){var n=l._controlsVisibility;return n&&typeof n[e]!="undefined"?n[e]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,e){var n=r.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},e);return n},calcCornerCoords:function(l,e,n,a,s){var u,t,f,h,v=s?this.touchSizeX:this.sizeX,y=s?this.touchSizeY:this.sizeY;if(v&&y&&v!==y){var p=Math.atan2(y,v),g=Math.sqrt(v*v+y*y)/2,d=p-r.util.degreesToRadians(l),E=Math.PI/2-p-r.util.degreesToRadians(l);u=g*r.util.cos(d),t=g*r.util.sin(d),f=g*r.util.cos(E),h=g*r.util.sin(E)}else{var w=v&&y?v:e;g=w*.7071067812;var d=r.util.degreesToRadians(45-l);u=f=g*r.util.cos(d),t=h=g*r.util.sin(d)}return{tl:{x:n-h,y:a-f},tr:{x:n+u,y:a-t},bl:{x:n-u,y:a+t},br:{x:n+h,y:a+f}}},render:function(l,e,n,a,s){switch(a=a||{},a.cornerStyle||s.cornerStyle){case"circle":r.controlsUtils.renderCircleControl.call(this,l,e,n,a,s);break;default:r.controlsUtils.renderSquareControl.call(this,l,e,n,a,s)}}}}(be),function(){function m(n,a){var s=n.getAttribute("style"),u=n.getAttribute("offset")||0,t,f,h,v;if(u=parseFloat(u)/(/%$/.test(u)?100:1),u=u<0?0:u>1?1:u,s){var y=s.split(/\s*;\s*/);for(y[y.length-1]===""&&y.pop(),v=y.length;v--;){var p=y[v].split(/\s*:\s*/),g=p[0].trim(),d=p[1].trim();g==="stop-color"?t=d:g==="stop-opacity"&&(h=d)}}return t||(t=n.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=n.getAttribute("stop-opacity")),t=new H.Color(t),f=t.getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=f*a,{offset:u,color:t.toRgb(),opacity:h}}function r(n){return{x1:n.getAttribute("x1")||0,y1:n.getAttribute("y1")||0,x2:n.getAttribute("x2")||"100%",y2:n.getAttribute("y2")||0}}function c(n){return{x1:n.getAttribute("fx")||n.getAttribute("cx")||"50%",y1:n.getAttribute("fy")||n.getAttribute("cy")||"50%",r1:0,x2:n.getAttribute("cx")||"50%",y2:n.getAttribute("cy")||"50%",r2:n.getAttribute("r")||"50%"}}var l=H.util.object.clone;H.Gradient=H.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(n){n||(n={}),n.coords||(n.coords={});var a,s=this;Object.keys(n).forEach(function(u){s[u]=n[u]}),this.id?this.id+="_"+H.Object.__uid++:this.id=H.Object.__uid++,a={x1:n.coords.x1||0,y1:n.coords.y1||0,x2:n.coords.x2||0,y2:n.coords.y2||0},this.type==="radial"&&(a.r1=n.coords.r1||0,a.r2=n.coords.r2||0),this.coords=a,this.colorStops=n.colorStops.slice()},addColorStop:function(n){for(var a in n){var s=new H.Color(n[a]);this.colorStops.push({offset:parseFloat(a),color:s.toRgb(),opacity:s.getAlpha()})}return this},toObject:function(n){var a={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return H.util.populateWithProperties(this,a,n),a},toSVG:function(n,a){var s=l(this.coords,!0),u,t,a=a||{},f,h,v=l(this.colorStops,!0),y=s.r1>s.r2,p=this.gradientTransform?this.gradientTransform.concat():H.iMatrix.concat(),g=-this.offsetX,d=-this.offsetY,E=!!a.additionalTransform,w=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(v.sort(function(P,R){return P.offset-R.offset}),w==="objectBoundingBox"?(g/=n.width,d/=n.height):(g+=n.width/2,d+=n.height/2),n.type==="path"&&this.gradientUnits!=="percentage"&&(g-=n.pathOffset.x,d-=n.pathOffset.y),p[4]-=g,p[5]-=d,h='id="SVGID_'+this.id+'" gradientUnits="'+w+'"',h+=' gradientTransform="'+(E?a.additionalTransform+" ":"")+H.util.matrixToSVG(p)+'" ',this.type==="linear"?f=["<linearGradient ",h,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,`">
`]:this.type==="radial"&&(f=["<radialGradient ",h,' cx="',y?s.x1:s.x2,'" cy="',y?s.y1:s.y2,'" r="',y?s.r1:s.r2,'" fx="',y?s.x2:s.x1,'" fy="',y?s.y2:s.y1,`">
`]),this.type==="radial"){if(y)for(v=v.concat(),v.reverse(),u=0,t=v.length;u<t;u++)v[u].offset=1-v[u].offset;var D=Math.min(s.r1,s.r2);if(D>0){var b=Math.max(s.r1,s.r2),S=D/b;for(u=0,t=v.length;u<t;u++)v[u].offset+=S*(1-v[u].offset)}}for(u=0,t=v.length;u<t;u++){var C=v[u];f.push("<stop ",'offset="',C.offset*100+"%",'" style="stop-color:',C.color,typeof C.opacity!="undefined"?";stop-opacity: "+C.opacity:";",`"/>
`)}return f.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),f.join("")},toLive:function(n){var a,s=H.util.object.clone(this.coords),u,t;if(!!this.type){for(this.type==="linear"?a=n.createLinearGradient(s.x1,s.y1,s.x2,s.y2):this.type==="radial"&&(a=n.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2)),u=0,t=this.colorStops.length;u<t;u++){var f=this.colorStops[u].color,h=this.colorStops[u].opacity,v=this.colorStops[u].offset;typeof h!="undefined"&&(f=new H.Color(f).setAlpha(h).toRgba()),a.addColorStop(v,f)}return a}}}),H.util.object.extend(H.Gradient,{fromElement:function(n,a,s,u){var t=parseFloat(s)/(/%$/.test(s)?100:1);t=t<0?0:t>1?1:t,isNaN(t)&&(t=1);var f=n.getElementsByTagName("stop"),h,v=n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",y=n.getAttribute("gradientTransform")||"",p=[],g,d,E=0,w=0,D;for(n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?(h="linear",g=r(n)):(h="radial",g=c(n)),d=f.length;d--;)p.push(m(f[d],t));D=H.parseTransformAttribute(y),e(a,g,u,v),v==="pixels"&&(E=-a.left,w=-a.top);var b=new H.Gradient({id:n.getAttribute("id"),type:h,coords:g,colorStops:p,gradientUnits:v,gradientTransform:D,offsetX:E,offsetY:w});return b}});function e(n,a,s,u){var t,f;Object.keys(a).forEach(function(h){t=a[h],t==="Infinity"?f=1:t==="-Infinity"?f=0:(f=parseFloat(a[h],10),typeof t=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(t)&&(f*=.01,u==="pixels"&&((h==="x1"||h==="x2"||h==="r2")&&(f*=s.viewBoxWidth||s.width),(h==="y1"||h==="y2")&&(f*=s.viewBoxHeight||s.height)))),a[h]=f})}}(),function(){var m=H.util.toFixed;H.Pattern=H.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(r,c){if(r||(r={}),this.id=H.Object.__uid++,this.setOptions(r),!r.source||r.source&&typeof r.source!="string"){c&&c(this);return}else{var l=this;this.source=H.util.createImage(),H.util.loadImage(r.source,function(e,n){l.source=e,c&&c(l,n)},null,this.crossOrigin)}},toObject:function(r){var c=H.Object.NUM_FRACTION_DIGITS,l,e;return typeof this.source.src=="string"?l=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(l=this.source.toDataURL()),e={type:"pattern",source:l,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:m(this.offsetX,c),offsetY:m(this.offsetY,c),patternTransform:this.patternTransform?this.patternTransform.concat():null},H.util.populateWithProperties(this,e,r),e},toSVG:function(r){var c=typeof this.source=="function"?this.source():this.source,l=c.width/r.width,e=c.height/r.height,n=this.offsetX/r.width,a=this.offsetY/r.height,s="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(e=1,a&&(e+=Math.abs(a))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(l=1,n&&(l+=Math.abs(n))),c.src?s=c.src:c.toDataURL&&(s=c.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+a+'" width="'+l+'" height="'+e+`">
<image x="0" y="0" width="`+c.width+'" height="'+c.height+'" xlink:href="'+s+`"></image>
</pattern>
`},setOptions:function(r){for(var c in r)this[c]=r[c]},toLive:function(r){var c=this.source;return!c||typeof c.src!="undefined"&&(!c.complete||c.naturalWidth===0||c.naturalHeight===0)?"":r.createPattern(c,this.repeat)}})}(),function(m){var r=m.fabric||(m.fabric={}),c=r.util.toFixed;if(r.Shadow){r.warn("fabric.Shadow is already defined.");return}r.Shadow=r.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(l){typeof l=="string"&&(l=this._parseShadow(l));for(var e in l)this[e]=l[e];this.id=r.Object.__uid++},_parseShadow:function(l){var e=l.trim(),n=r.Shadow.reOffsetsAndBlur.exec(e)||[],a=e.replace(r.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:a.trim(),offsetX:parseFloat(n[1],10)||0,offsetY:parseFloat(n[2],10)||0,blur:parseFloat(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(l){var e=40,n=40,a=r.Object.NUM_FRACTION_DIGITS,s=r.util.rotateVector({x:this.offsetX,y:this.offsetY},r.util.degreesToRadians(-l.angle)),u=20,t=new r.Color(this.color);return l.width&&l.height&&(e=c((Math.abs(s.x)+this.blur)/l.width,a)*100+u,n=c((Math.abs(s.y)+this.blur)/l.height,a)*100+u),l.flipX&&(s.x*=-1),l.flipY&&(s.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+e+'%" width="'+(100+2*e)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,a)+`"></feGaussianBlur>
	<feOffset dx="`+c(s.x,a)+'" dy="'+c(s.y,a)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+t.toRgb()+'" flood-opacity="'+t.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var l={},e=r.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(n){this[n]!==e[n]&&(l[n]=this[n])},this),l}}),r.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(be),function(){if(H.StaticCanvas){H.warn("fabric.StaticCanvas is already defined.");return}var m=H.util.object.extend,r=H.util.getElementOffset,c=H.util.removeFromArray,l=H.util.toFixed,e=H.util.transformPoint,n=H.util.invertTransform,a=H.util.getNodeCanvas,s=H.util.createCanvasElement,u=new Error("Could not initialize `canvas` element");H.StaticCanvas=H.util.createClass(H.CommonMethods,{initialize:function(t,f){f||(f={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,f)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:H.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,f){var h=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(f),this.interactive||this._initRetinaScaling(),f.overlayImage&&this.setOverlayImage(f.overlayImage,h),f.backgroundImage&&this.setBackgroundImage(f.backgroundImage,h),f.backgroundColor&&this.setBackgroundColor(f.backgroundColor,h),f.overlayColor&&this.setOverlayColor(f.overlayColor,h),this.calcOffset()},_isRetinaScaling:function(){return H.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,H.devicePixelRatio):1},_initRetinaScaling:function(){if(!!this._isRetinaScaling()){var t=H.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,f,h){f.setAttribute("width",this.width*t),f.setAttribute("height",this.height*t),h.scale(t,t)},calcOffset:function(){return this._offset=r(this.lowerCanvasEl),this},setOverlayImage:function(t,f,h){return this.__setBgOverlayImage("overlayImage",t,f,h)},setBackgroundImage:function(t,f,h){return this.__setBgOverlayImage("backgroundImage",t,f,h)},setOverlayColor:function(t,f){return this.__setBgOverlayColor("overlayColor",t,f)},setBackgroundColor:function(t,f){return this.__setBgOverlayColor("backgroundColor",t,f)},__setBgOverlayImage:function(t,f,h,v){return typeof f=="string"?H.util.loadImage(f,function(y,p){if(y){var g=new H.Image(y,v);this[t]=g,g.canvas=this}h&&h(y,p)},this,v&&v.crossOrigin):(v&&f.setOptions(v),this[t]=f,f&&(f.canvas=this),h&&h(f,!1)),this},__setBgOverlayColor:function(t,f,h){return this[t]=f,this._initGradient(f,t),this._initPattern(f,t,h),this},_createCanvasElement:function(){var t=s();if(!t||(t.style||(t.style={}),typeof t.getContext=="undefined"))throw u;return t},_initOptions:function(t){var f=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(f.width,10)||0,this.height=this.height||parseInt(f.height,10)||0,!!this.lowerCanvasEl.style&&(f.width=this.width,f.height=this.height,f.style.width=this.width+"px",f.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=H.util.getById(t)||this._createCanvasElement(),H.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,f){return this.setDimensions({width:t},f)},setHeight:function(t,f){return this.setDimensions({height:t},f)},setDimensions:function(t,f){var h;f=f||{};for(var v in t)h=t[v],f.cssOnly||(this._setBackstoreDimension(v,t[v]),h+="px",this.hasLostContext=!0),f.backstoreOnly||this._setCssDimension(v,h);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),f.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,f){return this.lowerCanvasEl[t]=f,this.upperCanvasEl&&(this.upperCanvasEl[t]=f),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=f),this[t]=f,this},_setCssDimension:function(t,f){return this.lowerCanvasEl.style[t]=f,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=f),this.wrapperEl&&(this.wrapperEl.style[t]=f),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var f=this._activeObject,h=this.backgroundImage,v=this.overlayImage,y,p,g;for(this.viewportTransform=t,p=0,g=this._objects.length;p<g;p++)y=this._objects[p],y.group||y.setCoords(!0);return f&&f.setCoords(),h&&h.setCoords(!0),v&&v.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,f){var h=t,v=this.viewportTransform.slice(0);t=e(t,n(this.viewportTransform)),v[0]=f,v[3]=f;var y=e(t,v);return v[4]+=h.x-y.x,v[5]+=h.y-y.y,this.setViewportTransform(v)},setZoom:function(t){return this.zoomToPoint(new H.Point(0,0),t),this},absolutePan:function(t){var f=this.viewportTransform.slice(0);return f[4]=-t.x,f[5]=-t.y,this.setViewportTransform(f)},relativePan:function(t){return this.absolutePan(new H.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=H.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},f=this.width,h=this.height,v=n(this.viewportTransform);return t.tl=e({x:0,y:0},v),t.br=e({x:f,y:h},v),t.tr=new H.Point(t.br.x,t.tl.y),t.bl=new H.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(H.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,f){var h=this.viewportTransform,v=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),H.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._renderObjects(t,f),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),v&&(v.canvas=this,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var f=this.viewportTransform,h=this.clipPath;t.save(),t.transform(f[0],f[1],f[2],f[3],f[4],f[5]),t.globalCompositeOperation="destination-in",h.transform(t),t.scale(1/h.zoomX,1/h.zoomY),t.drawImage(h._cacheCanvas,-h.cacheTranslationX,-h.cacheTranslationY),t.restore()},_renderObjects:function(t,f){var h,v;for(h=0,v=f.length;h<v;++h)f[h]&&f[h].render(t)},_renderBackgroundOrOverlay:function(t,f){var h=this[f+"Color"],v=this[f+"Image"],y=this.viewportTransform,p=this[f+"Vpt"];if(!(!h&&!v)){if(h){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=h.toLive?h.toLive(t,this):h,p&&t.transform(y[0],y[1],y[2],y[3],y[4],y[5]),t.transform(1,0,0,1,h.offsetX||0,h.offsetY||0);var g=h.gradientTransform||h.patternTransform;g&&t.transform(g[0],g[1],g[2],g[3],g[4],g[5]),t.fill(),t.restore()}v&&(t.save(),p&&t.transform(y[0],y[1],y[2],y[3],y[4],y[5]),v.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new H.Point(this.width/2,this.height/2)},centerObjectH:function(t){return this._centerObject(t,new H.Point(this.getCenterPoint().x,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new H.Point(t.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(t){var f=this.getCenterPoint();return this._centerObject(t,f)},viewportCenterObject:function(t){var f=this.getVpCenter();return this._centerObject(t,f)},viewportCenterObjectH:function(t){var f=this.getVpCenter();return this._centerObject(t,new H.Point(f.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var f=this.getVpCenter();return this._centerObject(t,new H.Point(t.getCenterPoint().x,f.y))},getVpCenter:function(){var t=this.getCenterPoint(),f=n(this.viewportTransform);return e(t,f)},_centerObject:function(t,f){return t.setPositionByOrigin(f,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(t,f){var h=this.clipPath,v={version:H.version,objects:this._toObjects(t,f)};return h&&!h.excludeFromExport&&(v.clipPath=this._toObject(this.clipPath,t,f)),m(v,this.__serializeBgOverlay(t,f)),H.util.populateWithProperties(this,v,f),v},_toObjects:function(t,f){return this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){return this._toObject(h,t,f)},this)},_toObject:function(t,f,h){var v;this.includeDefaultValues||(v=t.includeDefaultValues,t.includeDefaultValues=!1);var y=t[f](h);return this.includeDefaultValues||(t.includeDefaultValues=v),y},__serializeBgOverlay:function(t,f){var h={},v=this.backgroundImage,y=this.overlayImage,p=this.backgroundColor,g=this.overlayColor;return p&&p.toObject?p.excludeFromExport||(h.background=p.toObject(f)):p&&(h.background=p),g&&g.toObject?g.excludeFromExport||(h.overlay=g.toObject(f)):g&&(h.overlay=g),v&&!v.excludeFromExport&&(h.backgroundImage=this._toObject(v,t,f)),y&&!y.excludeFromExport&&(h.overlayImage=this._toObject(y,t,f)),h},svgViewportTransformation:!0,toSVG:function(t,f){t||(t={}),t.reviver=f;var h=[];return this._setSVGPreamble(h,t),this._setSVGHeader(h,t),this.clipPath&&h.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(h,"background"),this._setSVGBgOverlayImage(h,"backgroundImage",f),this._setSVGObjects(h,f),this.clipPath&&h.push(`</g>
`),this._setSVGBgOverlayColor(h,"overlay"),this._setSVGBgOverlayImage(h,"overlayImage",f),h.push("</svg>"),h.join("")},_setSVGPreamble:function(t,f){f.suppressPreamble||t.push('<?xml version="1.0" encoding="',f.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(t,f){var h=f.width||this.width,v=f.height||this.height,y,p='viewBox="0 0 '+this.width+" "+this.height+'" ',g=H.Object.NUM_FRACTION_DIGITS;f.viewBox?p='viewBox="'+f.viewBox.x+" "+f.viewBox.y+" "+f.viewBox.width+" "+f.viewBox.height+'" ':this.svgViewportTransformation&&(y=this.viewportTransform,p='viewBox="'+l(-y[4]/y[0],g)+" "+l(-y[5]/y[3],g)+" "+l(this.width/y[0],g)+" "+l(this.height/y[3],g)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',h,'" ','height="',v,'" ',p,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",H.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(f),`</defs>
`)},createSVGClipPathMarkup:function(t){var f=this.clipPath;return f?(f.clipPathId="CLIPPATH_"+H.Object.__uid++,'<clipPath id="'+f.clipPathId+`" >
`+this.clipPath.toClipPathSVG(t.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var t=this,f=["background","overlay"].map(function(h){var v=t[h+"Color"];if(v&&v.toLive){var y=t[h+"Vpt"],p=t.viewportTransform,g={width:t.width/(y?p[0]:1),height:t.height/(y?p[3]:1)};return v.toSVG(g,{additionalTransform:y?H.util.matrixToSVG(p):""})}});return f.join("")},createSVGFontFacesMarkup:function(){var t="",f={},h,v,y,p,g,d,E,w,D,b=H.fontPaths,S=[];for(this._objects.forEach(function P(R){S.push(R),R._objects&&R._objects.forEach(P)}),w=0,D=S.length;w<D;w++)if(h=S[w],v=h.fontFamily,!(h.type.indexOf("text")===-1||f[v]||!b[v])&&(f[v]=!0,!!h.styles)){y=h.styles;for(g in y){p=y[g];for(E in p)d=p[E],v=d.fontFamily,!f[v]&&b[v]&&(f[v]=!0)}}for(var C in f)t+=[`		@font-face {
`,"			font-family: '",C,`';
`,"			src: url('",b[C],`');
`,`		}
`].join("");return t&&(t=['	<style type="text/css">',`<![CDATA[
`,t,"]]>",`</style>
`].join("")),t},_setSVGObjects:function(t,f){var h,v,y,p=this._objects;for(v=0,y=p.length;v<y;v++)h=p[v],!h.excludeFromExport&&this._setSVGObject(t,h,f)},_setSVGObject:function(t,f,h){t.push(f.toSVG(h))},_setSVGBgOverlayImage:function(t,f,h){this[f]&&!this[f].excludeFromExport&&this[f].toSVG&&t.push(this[f].toSVG(h))},_setSVGBgOverlayColor:function(t,f){var h=this[f+"Color"],v=this.viewportTransform,y=this.width,p=this.height;if(!!h)if(h.toLive){var g=h.repeat,d=H.util.invertTransform(v),E=this[f+"Vpt"],w=E?H.util.matrixToSVG(d):"";t.push('<rect transform="'+w+" translate(",y/2,",",p/2,')"',' x="',h.offsetX-y/2,'" y="',h.offsetY-p/2,'" ','width="',g==="repeat-y"||g==="no-repeat"?h.source.width:y,'" height="',g==="repeat-x"||g==="no-repeat"?h.source.height:p,'" fill="url(#SVGID_'+h.id+')"',`></rect>
`)}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',h,'"',`></rect>
`)},sendToBack:function(t){if(!t)return this;var f=this._activeObject,h,v,y;if(t===f&&t.type==="activeSelection")for(y=f._objects,h=y.length;h--;)v=y[h],c(this._objects,v),this._objects.unshift(v);else c(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var f=this._activeObject,h,v,y;if(t===f&&t.type==="activeSelection")for(y=f._objects,h=0;h<y.length;h++)v=y[h],c(this._objects,v),this._objects.push(v);else c(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,f){if(!t)return this;var h=this._activeObject,v,y,p,g,d,E=0;if(t===h&&t.type==="activeSelection")for(d=h._objects,v=0;v<d.length;v++)y=d[v],p=this._objects.indexOf(y),p>0+E&&(g=p-1,c(this._objects,y),this._objects.splice(g,0,y)),E++;else p=this._objects.indexOf(t),p!==0&&(g=this._findNewLowerIndex(t,p,f),c(this._objects,t),this._objects.splice(g,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,f,h){var v,y;if(h)for(v=f,y=f-1;y>=0;--y){var p=t.intersectsWithObject(this._objects[y])||t.isContainedWithinObject(this._objects[y])||this._objects[y].isContainedWithinObject(t);if(p){v=y;break}}else v=f-1;return v},bringForward:function(t,f){if(!t)return this;var h=this._activeObject,v,y,p,g,d,E=0;if(t===h&&t.type==="activeSelection")for(d=h._objects,v=d.length;v--;)y=d[v],p=this._objects.indexOf(y),p<this._objects.length-1-E&&(g=p+1,c(this._objects,y),this._objects.splice(g,0,y)),E++;else p=this._objects.indexOf(t),p!==this._objects.length-1&&(g=this._findNewUpperIndex(t,p,f),c(this._objects,t),this._objects.splice(g,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,f,h){var v,y,p;if(h)for(v=f,y=f+1,p=this._objects.length;y<p;++y){var g=t.intersectsWithObject(this._objects[y])||t.isContainedWithinObject(this._objects[y])||this._objects[y].isContainedWithinObject(t);if(g){v=y;break}}else v=f+1;return v},moveTo:function(t,f){return c(this._objects,t),this._objects.splice(f,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(H.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(t){t.dispose&&t.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),H.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),H.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),m(H.StaticCanvas.prototype,H.Observable),m(H.StaticCanvas.prototype,H.Collection),m(H.StaticCanvas.prototype,H.DataURLExporter),m(H.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var f=s();if(!f||!f.getContext)return null;var h=f.getContext("2d");if(!h)return null;switch(t){case"setLineDash":return typeof h.setLineDash!="undefined";default:return null}}}),H.StaticCanvas.prototype.toJSON=H.StaticCanvas.prototype.toObject,H.isLikelyNode&&(H.StaticCanvas.prototype.createPNGStream=function(){var t=a(this.lowerCanvasEl);return t&&t.createPNGStream()},H.StaticCanvas.prototype.createJPEGStream=function(t){var f=a(this.lowerCanvasEl);return f&&f.createJPEGStream(t)})}(),H.BaseBrush=H.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(m){m.strokeStyle=this.color,m.lineWidth=this.width,m.lineCap=this.strokeLineCap,m.miterLimit=this.strokeMiterLimit,m.lineJoin=this.strokeLineJoin,m.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(m){var r=this.canvas.viewportTransform;m.save(),m.transform(r[0],r[1],r[2],r[3],r[4],r[5])},_setShadow:function(){if(!!this.shadow){var m=this.canvas,r=this.shadow,c=m.contextTop,l=m.getZoom();m&&m._isRetinaScaling()&&(l*=H.devicePixelRatio),c.shadowColor=r.color,c.shadowBlur=r.blur*l,c.shadowOffsetX=r.offsetX*l,c.shadowOffsetY=r.offsetY*l}},needsFullRender:function(){var m=new H.Color(this.color);return m.getAlpha()<1||!!this.shadow},_resetShadow:function(){var m=this.canvas.contextTop;m.shadowColor="",m.shadowBlur=m.shadowOffsetX=m.shadowOffsetY=0},_isOutSideCanvas:function(m){return m.x<0||m.x>this.canvas.getWidth()||m.y<0||m.y>this.canvas.getHeight()}}),function(){H.PencilBrush=H.util.createClass(H.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(m){this.canvas=m,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(m,r,c){var l=r.midPointFrom(c);return m.quadraticCurveTo(r.x,r.y,l.x,l.y),l},onMouseDown:function(m,r){!this.canvas._isMainEvent(r.e)||(this.drawStraightLine=r.e[this.straightLineKey],this._prepareForDrawing(m),this._captureDrawingPath(m),this._render())},onMouseMove:function(m,r){if(!!this.canvas._isMainEvent(r.e)&&(this.drawStraightLine=r.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m))&&this._captureDrawingPath(m)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,l=c.length,e=this.canvas.contextTop;this._saveAndTransform(e),this.oldEnd&&(e.beginPath(),e.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(e,c[l-2],c[l-1],!0),e.stroke(),e.restore()}},onMouseUp:function(m){return this.canvas._isMainEvent(m.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(m){var r=new H.Point(m.x,m.y);this._reset(),this._addPoint(r),this.canvas.contextTop.moveTo(r.x,r.y)},_addPoint:function(m){return this._points.length>1&&m.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(m),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(m){var r=new H.Point(m.x,m.y);return this._addPoint(r)},_render:function(m){var r,c,l=this._points[0],e=this._points[1];if(m=m||this.canvas.contextTop,this._saveAndTransform(m),m.beginPath(),this._points.length===2&&l.x===e.x&&l.y===e.y){var n=this.width/1e3;l=new H.Point(l.x,l.y),e=new H.Point(e.x,e.y),l.x-=n,e.x+=n}for(m.moveTo(l.x,l.y),r=1,c=this._points.length;r<c;r++)this._drawSegment(m,l,e),l=this._points[r],e=this._points[r+1];m.lineTo(l.x,l.y),m.stroke(),m.restore()},convertPointsToSVGPath:function(m){var r=this.width/1e3;return H.util.getSmoothPathFromPoints(m,r)},_isEmptySVGPath:function(m){var r=H.util.joinPath(m);return r==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(m){var r=new H.Path(m,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,r.shadow=new H.Shadow(this.shadow)),r},decimatePoints:function(m,r){if(m.length<=2)return m;var c=this.canvas.getZoom(),l=Math.pow(r/c,2),e,n=m.length-1,a=m[0],s=[a],u;for(e=1;e<n-1;e++)u=Math.pow(a.x-m[e].x,2)+Math.pow(a.y-m[e].y,2),u>=l&&(a=m[e],s.push(a));return s.push(m[n]),s},_finalizeAndAddPath:function(){var m=this.canvas.contextTop;m.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var r=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(r)){this.canvas.requestRenderAll();return}var c=this.createPath(r);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.requestRenderAll(),c.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:c})}})}(),H.CircleBrush=H.util.createClass(H.BaseBrush,{width:10,initialize:function(m){this.canvas=m,this.points=[]},drawDot:function(m){var r=this.addPoint(m),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,r),c.restore()},dot:function(m,r){m.fillStyle=r.fill,m.beginPath(),m.arc(r.x,r.y,r.radius,0,Math.PI*2,!1),m.closePath(),m.fill()},onMouseDown:function(m){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(m)},_render:function(){var m=this.canvas.contextTop,r,c,l=this.points;for(this._saveAndTransform(m),r=0,c=l.length;r<c;r++)this.dot(m,l[r]);m.restore()},onMouseMove:function(m){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(m),this._render()):this.drawDot(m))},onMouseUp:function(){var m=this.canvas.renderOnAddRemove,r,c;this.canvas.renderOnAddRemove=!1;var l=[];for(r=0,c=this.points.length;r<c;r++){var e=this.points[r],n=new H.Circle({radius:e.radius,left:e.x,top:e.y,originX:"center",originY:"center",fill:e.fill});this.shadow&&(n.shadow=new H.Shadow(this.shadow)),l.push(n)}var a=new H.Group(l);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=m,this.canvas.requestRenderAll()},addPoint:function(m){var r=new H.Point(m.x,m.y),c=H.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,l=new H.Color(this.color).setAlpha(H.util.getRandomInt(0,100)/100).toRgba();return r.radius=c,r.fill=l,this.points.push(r),r}}),H.SprayBrush=H.util.createClass(H.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(m){this.canvas=m,this.sprayChunks=[]},onMouseDown:function(m){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(m),this.render(this.sprayChunkPoints)},onMouseMove:function(m){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(m)||(this.addSprayChunk(m),this.render(this.sprayChunkPoints))},onMouseUp:function(){var m=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var r=[],c=0,l=this.sprayChunks.length;c<l;c++)for(var e=this.sprayChunks[c],n=0,a=e.length;n<a;n++){var s=new H.Rect({width:e[n].width,height:e[n].width,left:e[n].x+1,top:e[n].y+1,originX:"center",originY:"center",fill:this.color});r.push(s)}this.optimizeOverlapping&&(r=this._getOptimizedRects(r));var u=new H.Group(r);this.shadow&&u.set("shadow",new H.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=m,this.canvas.requestRenderAll()},_getOptimizedRects:function(m){var r={},c,l,e;for(l=0,e=m.length;l<e;l++)c=m[l].left+""+m[l].top,r[c]||(r[c]=m[l]);var n=[];for(c in r)n.push(r[c]);return n},render:function(m){var r=this.canvas.contextTop,c,l;for(r.fillStyle=this.color,this._saveAndTransform(r),c=0,l=m.length;c<l;c++){var e=m[c];typeof e.opacity!="undefined"&&(r.globalAlpha=e.opacity),r.fillRect(e.x,e.y,e.width,e.width)}r.restore()},_render:function(){var m=this.canvas.contextTop,r,c;for(m.fillStyle=this.color,this._saveAndTransform(m),r=0,c=this.sprayChunks.length;r<c;r++)this.render(this.sprayChunks[r]);m.restore()},addSprayChunk:function(m){this.sprayChunkPoints=[];var r,c,l,e=this.width/2,n;for(n=0;n<this.density;n++){r=H.util.getRandomInt(m.x-e,m.x+e),c=H.util.getRandomInt(m.y-e,m.y+e),this.dotWidthVariance?l=H.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):l=this.dotWidth;var a=new H.Point(r,c);a.width=l,this.randomOpacity&&(a.opacity=H.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),H.PatternBrush=H.util.createClass(H.PencilBrush,{getPatternSrc:function(){var m=20,r=5,c=H.util.createCanvasElement(),l=c.getContext("2d");return c.width=c.height=m+r,l.fillStyle=this.color,l.beginPath(),l.arc(m/2,m/2,m/2,0,Math.PI*2,!1),l.closePath(),l.fill(),c},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(m){return m.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(m){this.callSuper("_setBrushStyles",m),m.strokeStyle=this.getPattern(m)},createPath:function(m){var r=this.callSuper("createPath",m),c=r._getLeftTopCoords().scalarAdd(r.strokeWidth/2);return r.stroke=new H.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),r}}),function(){var m=H.util.getPointer,r=H.util.degreesToRadians,c=H.util.isTouchEvent;H.Canvas=H.util.createClass(H.StaticCanvas,{initialize:function(e,n){n||(n={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,n),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=H.PencilBrush&&new H.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var e=this.getActiveObjects(),n,a,s;if(e.length>0&&!this.preserveObjectStacking){a=[],s=[];for(var u=0,t=this._objects.length;u<t;u++)n=this._objects[u],e.indexOf(n)===-1?a.push(n):s.push(n);e.length>1&&(this._activeObject._objects=s),a.push.apply(a,s)}else a=this._objects;return a},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var e=this.contextContainer;return this.renderCanvas(e,this._chooseObjectsToRender()),this},renderTopLayer:function(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()},renderTop:function(){var e=this.contextTop;return this.clearContext(e),this.renderTopLayer(e),this.fire("after:render"),this},_normalizePointer:function(e,n){var a=e.calcTransformMatrix(),s=H.util.invertTransform(a),u=this.restorePointerVpt(n);return H.util.transformPoint(u,s)},isTargetTransparent:function(e,n,a){if(e.shouldCache()&&e._cacheCanvas&&e!==this._activeObject){var s=this._normalizePointer(e,{x:n,y:a}),u=Math.max(e.cacheTranslationX+s.x*e.zoomX,0),t=Math.max(e.cacheTranslationY+s.y*e.zoomY,0),y=H.util.isTransparent(e._cacheContext,Math.round(u),Math.round(t),this.targetFindTolerance);return y}var f=this.contextCache,h=e.selectionBackgroundColor,v=this.viewportTransform;e.selectionBackgroundColor="",this.clearContext(f),f.save(),f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),e.render(f),f.restore(),e.selectionBackgroundColor=h;var y=H.util.isTransparent(f,n,a,this.targetFindTolerance);return y},_isSelectionKeyPressed:function(e){var n=!1;return Array.isArray(this.selectionKey)?n=!!this.selectionKey.find(function(a){return e[a]===!0}):n=e[this.selectionKey],n},_shouldClearSelection:function(e,n){var a=this.getActiveObjects(),s=this._activeObject;return!n||n&&s&&a.length>1&&a.indexOf(n)===-1&&s!==n&&!this._isSelectionKeyPressed(e)||n&&!n.evented||n&&!n.selectable&&s&&s!==n},_shouldCenterTransform:function(e,n,a){if(!!e){var s;return n==="scale"||n==="scaleX"||n==="scaleY"||n==="resizing"?s=this.centeredScaling||e.centeredScaling:n==="rotate"&&(s=this.centeredRotation||e.centeredRotation),s?!a:a}},_getOriginFromCorner:function(e,n){var a={x:e.originX,y:e.originY};return n==="ml"||n==="tl"||n==="bl"?a.x="right":(n==="mr"||n==="tr"||n==="br")&&(a.x="left"),n==="tl"||n==="mt"||n==="tr"?a.y="bottom":(n==="bl"||n==="mb"||n==="br")&&(a.y="top"),a},_getActionFromCorner:function(e,n,a,s){if(!n||!e)return"drag";var u=s.controls[n];return u.getActionName(a,u,s)},_setupCurrentTransform:function(e,n,a){if(!!n){var s=this.getPointer(e),u=n.__corner,t=n.controls[u],f=a&&u?t.getActionHandler(e,n,t):H.controlsUtils.dragHandler,h=this._getActionFromCorner(a,u,e,n),v=this._getOriginFromCorner(n,u),y=e[this.centeredKey],p={target:n,action:h,actionHandler:f,corner:u,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:s.x-n.left,offsetY:s.y-n.top,originX:v.x,originY:v.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:r(n.angle),width:n.width*n.scaleX,shiftKey:e.shiftKey,altKey:y,original:H.util.saveObjectTransform(n)};this._shouldCenterTransform(n,h,y)&&(p.originX="center",p.originY="center"),p.original.originX=v.x,p.original.originY=v.y,this._currentTransform=p,this._beforeTransform(e)}},setCursor:function(e){this.upperCanvasEl.style.cursor=e},_drawSelection:function(e){var n=this._groupSelector,a=new H.Point(n.ex,n.ey),s=H.util.transformPoint(a,this.viewportTransform),u=new H.Point(n.ex+n.left,n.ey+n.top),t=H.util.transformPoint(u,this.viewportTransform),f=Math.min(s.x,t.x),h=Math.min(s.y,t.y),v=Math.max(s.x,t.x),y=Math.max(s.y,t.y),p=this.selectionLineWidth/2;this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(f,h,v-f,y-h)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,f+=p,h+=p,v-=p,y-=p,H.Object.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(f,h,v-f,y-h))},findTarget:function(e,n){if(!this.skipTargetFind){var a=!0,s=this.getPointer(e,a),u=this._activeObject,t=this.getActiveObjects(),f,h,v=c(e),y=t.length>1&&!n||t.length===1;if(this.targets=[],y&&u._findTargetCorner(s,v)||t.length>1&&!n&&u===this._searchPossibleTargets([u],s))return u;if(t.length===1&&u===this._searchPossibleTargets([u],s))if(this.preserveObjectStacking)f=u,h=this.targets,this.targets=[];else return u;var p=this._searchPossibleTargets(this._objects,s);return e[this.altSelectionKey]&&p&&f&&p!==f&&(p=f,this.targets=h),p}},_checkTarget:function(e,n,a){if(n&&n.visible&&n.evented&&n.containsPoint(e))if((this.perPixelTargetFind||n.perPixelTargetFind)&&!n.isEditing){var s=this.isTargetTransparent(n,a.x,a.y);if(!s)return!0}else return!0},_searchPossibleTargets:function(e,n){for(var a,s=e.length,u;s--;){var t=e[s],f=t.group?this._normalizePointer(t.group,n):n;if(this._checkTarget(f,t,n)){a=e[s],a.subTargetCheck&&a instanceof H.Group&&(u=this._searchPossibleTargets(a._objects,n),u&&this.targets.push(u));break}}return a},restorePointerVpt:function(e){return H.util.transformPoint(e,H.util.invertTransform(this.viewportTransform))},getPointer:function(e,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var a=m(e),s=this.upperCanvasEl,u=s.getBoundingClientRect(),t=u.width||0,f=u.height||0,h;(!t||!f)&&("top"in u&&"bottom"in u&&(f=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(t=Math.abs(u.right-u.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,n||(a=this.restorePointerVpt(a));var v=this.getRetinaScaling();return v!==1&&(a.x/=v,a.y/=v),t===0||f===0?h={width:1,height:1}:h={width:s.width/t,height:s.height/f},{x:a.x*h.width,y:a.y*h.height}},_createUpperCanvas:function(){var e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),n=this.lowerCanvasEl,a=this.upperCanvasEl;a?a.className="":(a=this._createCanvasElement(),this.upperCanvasEl=a),H.util.addClass(a,"upper-canvas "+e),this.wrapperEl.appendChild(a),this._copyCanvasStyle(n,a),this._applyCanvasStyle(a),this.contextTop=a.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=H.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),H.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),H.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(e){var n=this.width||e.width,a=this.height||e.height;H.util.setStyle(e,{position:"absolute",width:n+"px",height:a+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),e.width=n,e.height=a,H.util.makeElementUnselectable(e)},_copyCanvasStyle:function(e,n){n.style.cssText=e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var e=this._activeObject;return e?e.type==="activeSelection"&&e._objects?e._objects.slice(0):[e]:[]},_onObjectRemoved:function(e){e===this._activeObject&&(this.fire("before:selection:cleared",{target:e}),this._discardActiveObject(),this.fire("selection:cleared",{target:e}),e.fire("deselected")),e===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",e)},_fireSelectionEvents:function(e,n){var a=!1,s=this.getActiveObjects(),u=[],t=[];e.forEach(function(f){s.indexOf(f)===-1&&(a=!0,f.fire("deselected",{e:n,target:f}),t.push(f))}),s.forEach(function(f){e.indexOf(f)===-1&&(a=!0,f.fire("selected",{e:n,target:f}),u.push(f))}),e.length>0&&s.length>0?a&&this.fire("selection:updated",{e:n,selected:u,deselected:t}):s.length>0?this.fire("selection:created",{e:n,selected:u}):e.length>0&&this.fire("selection:cleared",{e:n,deselected:t})},setActiveObject:function(e,n){var a=this.getActiveObjects();return this._setActiveObject(e,n),this._fireSelectionEvents(a,n),this},_setActiveObject:function(e,n){return this._activeObject===e||!this._discardActiveObject(n,e)||e.onSelect({e:n})?!1:(this._activeObject=e,!0)},_discardActiveObject:function(e,n){var a=this._activeObject;if(a){if(a.onDeselect({e,object:n}))return!1;this._activeObject=null}return!0},discardActiveObject:function(e){var n=this.getActiveObjects(),a=this.getActiveObject();return n.length&&this.fire("before:selection:cleared",{target:a,e}),this._discardActiveObject(e),this._fireSelectionEvents(n,e),this},dispose:function(){var e=this.wrapperEl;return this.removeListeners(),e.removeChild(this.upperCanvasEl),e.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(n){H.util.cleanUpJsdomNode(this[n]),this[n]=void 0}.bind(this)),e.parentNode&&e.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,H.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(e){var n=this._activeObject;n&&n._renderControls(e)},_toObject:function(e,n,a){var s=this._realizeGroupTransformOnObject(e),u=this.callSuper("_toObject",e,n,a);return this._unwindGroupTransformOnObject(e,s),u},_realizeGroupTransformOnObject:function(e){if(e.group&&e.group.type==="activeSelection"&&this._activeObject===e.group){var n=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],a={};return n.forEach(function(s){a[s]=e[s]}),H.util.addTransformToObject(e,this._activeObject.calcOwnMatrix()),a}else return null},_unwindGroupTransformOnObject:function(e,n){n&&e.set(n)},_setSVGObject:function(e,n,a){var s=this._realizeGroupTransformOnObject(n);this.callSuper("_setSVGObject",e,n,a),this._unwindGroupTransformOnObject(n,s)},setViewportTransform:function(e){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),H.StaticCanvas.prototype.setViewportTransform.call(this,e)}});for(var l in H.StaticCanvas)l!=="prototype"&&(H.Canvas[l]=H.StaticCanvas[l])}(),function(){var m=H.util.addListener,r=H.util.removeListener,c=3,l=2,e=1,n={passive:!1};function a(s,u){return s.button&&s.button===u-1}H.util.object.extend(H.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(m,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(s,u){var t=this.upperCanvasEl,f=this._getEventPrefix();s(H.window,"resize",this._onResize),s(t,f+"down",this._onMouseDown),s(t,f+"move",this._onMouseMove,n),s(t,f+"out",this._onMouseOut),s(t,f+"enter",this._onMouseEnter),s(t,"wheel",this._onMouseWheel),s(t,"contextmenu",this._onContextMenu),s(t,"dblclick",this._onDoubleClick),s(t,"dragover",this._onDragOver),s(t,"dragenter",this._onDragEnter),s(t,"dragleave",this._onDragLeave),s(t,"drop",this._onDrop),this.enablePointerEvents||s(t,"touchstart",this._onTouchStart,n),typeof eventjs!="undefined"&&u in eventjs&&(eventjs[u](t,"gesture",this._onGesture),eventjs[u](t,"drag",this._onDrag),eventjs[u](t,"orientation",this._onOrientationChange),eventjs[u](t,"shake",this._onShake),eventjs[u](t,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(r,"remove");var s=this._getEventPrefix();r(H.document,s+"up",this._onMouseUp),r(H.document,"touchend",this._onTouchEnd,n),r(H.document,s+"move",this._onMouseMove,n),r(H.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(s,u){this.__onTransformGesture&&this.__onTransformGesture(s,u)},_onDrag:function(s,u){this.__onDrag&&this.__onDrag(s,u)},_onMouseWheel:function(s){this.__onMouseWheel(s)},_onMouseOut:function(s){var u=this._hoveredTarget;this.fire("mouse:out",{target:u,e:s}),this._hoveredTarget=null,u&&u.fire("mouseout",{e:s});var t=this;this._hoveredTargets.forEach(function(f){t.fire("mouse:out",{target:u,e:s}),f&&u.fire("mouseout",{e:s})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(f){f.isEditing&&f.hiddenTextarea.focus()})},_onMouseEnter:function(s){!this._currentTransform&&!this.findTarget(s)&&(this.fire("mouse:over",{target:null,e:s}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(s,u){this.__onOrientationChange&&this.__onOrientationChange(s,u)},_onShake:function(s,u){this.__onShake&&this.__onShake(s,u)},_onLongPress:function(s,u){this.__onLongPress&&this.__onLongPress(s,u)},_onDragOver:function(s){s.preventDefault();var u=this._simpleEventHandler("dragover",s);this._fireEnterLeaveEvents(u,s)},_onDrop:function(s){return this._simpleEventHandler("drop:before",s),this._simpleEventHandler("drop",s)},_onContextMenu:function(s){return this.stopContextMenu&&(s.stopPropagation(),s.preventDefault()),!1},_onDoubleClick:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"dblclick"),this._resetTransformEventData(s)},getPointerId:function(s){var u=s.changedTouches;return u?u[0]&&u[0].identifier:this.enablePointerEvents?s.pointerId:-1},_isMainEvent:function(s){return s.isPrimary===!0?!0:s.isPrimary===!1?!1:s.type==="touchend"&&s.touches.length===0?!0:s.changedTouches?s.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(s){s.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(s)),this.__onMouseDown(s),this._resetTransformEventData();var u=this.upperCanvasEl,t=this._getEventPrefix();m(H.document,"touchend",this._onTouchEnd,n),m(H.document,"touchmove",this._onMouseMove,n),r(u,t+"down",this._onMouseDown)},_onMouseDown:function(s){this.__onMouseDown(s),this._resetTransformEventData();var u=this.upperCanvasEl,t=this._getEventPrefix();r(u,t+"move",this._onMouseMove,n),m(H.document,t+"up",this._onMouseUp),m(H.document,t+"move",this._onMouseMove,n)},_onTouchEnd:function(s){if(!(s.touches.length>0)){this.__onMouseUp(s),this._resetTransformEventData(),this.mainTouchId=null;var u=this._getEventPrefix();r(H.document,"touchend",this._onTouchEnd,n),r(H.document,"touchmove",this._onMouseMove,n);var t=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){m(t.upperCanvasEl,u+"down",t._onMouseDown),t._willAddMouseDown=0},400)}},_onMouseUp:function(s){this.__onMouseUp(s),this._resetTransformEventData();var u=this.upperCanvasEl,t=this._getEventPrefix();this._isMainEvent(s)&&(r(H.document,t+"up",this._onMouseUp),r(H.document,t+"move",this._onMouseMove,n),m(u,t+"move",this._onMouseMove,n))},_onMouseMove:function(s){!this.allowTouchScrolling&&s.preventDefault&&s.preventDefault(),this.__onMouseMove(s)},_onResize:function(){this.calcOffset()},_shouldRender:function(s){var u=this._activeObject;return!!u!=!!s||u&&s&&u!==s?!0:(u&&u.isEditing,!1)},__onMouseUp:function(s){var u,t=this._currentTransform,f=this._groupSelector,h=!1,v=!f||f.left===0&&f.top===0;if(this._cacheTransformEventData(s),u=this._target,this._handleEvent(s,"up:before"),a(s,c)){this.fireRightClick&&this._handleEvent(s,"up",c,v);return}if(a(s,l)){this.fireMiddleClick&&this._handleEvent(s,"up",l,v),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(s);return}if(!!this._isMainEvent(s)){if(t&&(this._finalizeCurrentTransform(s),h=t.actionPerformed),!v){var y=u===this._activeObject;this._maybeGroupObjects(s),h||(h=this._shouldRender(u)||!y&&u===this._activeObject)}var p,g;if(u){if(p=u._findTargetCorner(this.getPointer(s,!0),H.util.isTouchEvent(s)),u.selectable&&u!==this._activeObject&&u.activeOn==="up")this.setActiveObject(u,s),h=!0;else{var d=u.controls[p],E=d&&d.getMouseUpHandler(s,u,d);E&&(g=this.getPointer(s),E(s,t,g.x,g.y))}u.isMoving=!1}if(t&&(t.target!==u||t.corner!==p)){var w=t.target&&t.target.controls[t.corner],D=w&&w.getMouseUpHandler(s,u,d);g=g||this.getPointer(s),D&&D(s,t,g.x,g.y)}this._setCursorFromEvent(s,u),this._handleEvent(s,"up",e,v),this._groupSelector=null,this._currentTransform=null,u&&(u.__corner=0),h?this.requestRenderAll():v||this.renderTop()}},_simpleEventHandler:function(s,u){var t=this.findTarget(u),f=this.targets,h={e:u,target:t,subTargets:f};if(this.fire(s,h),t&&t.fire(s,h),!f)return t;for(var v=0;v<f.length;v++)f[v].fire(s,h);return t},_handleEvent:function(s,u,t,f){var h=this._target,v=this.targets||[],y={e:s,target:h,subTargets:v,button:t||e,isClick:f||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};u==="up"&&(y.currentTarget=this.findTarget(s),y.currentSubTargets=this.targets),this.fire("mouse:"+u,y),h&&h.fire("mouse"+u,y);for(var p=0;p<v.length;p++)v[p].fire("mouse"+u,y)},_finalizeCurrentTransform:function(s){var u=this._currentTransform,t=u.target,f={e:s,target:t,transform:u,action:u.action};t._scaling&&(t._scaling=!1),t.setCoords(),(u.actionPerformed||this.stateful&&t.hasStateChanged())&&this._fire("modified",f)},_onMouseDownInDrawingMode:function(s){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(s).requestRenderAll();var u=this.getPointer(s);this.freeDrawingBrush.onMouseDown(u,{e:s,pointer:u}),this._handleEvent(s,"down")},_onMouseMoveInDrawingMode:function(s){if(this._isCurrentlyDrawing){var u=this.getPointer(s);this.freeDrawingBrush.onMouseMove(u,{e:s,pointer:u})}this.setCursor(this.freeDrawingCursor),this._handleEvent(s,"move")},_onMouseUpInDrawingMode:function(s){var u=this.getPointer(s);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:s,pointer:u}),this._handleEvent(s,"up")},__onMouseDown:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"down:before");var u=this._target;if(a(s,c)){this.fireRightClick&&this._handleEvent(s,"down",c);return}if(a(s,l)){this.fireMiddleClick&&this._handleEvent(s,"down",l);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(s);return}if(!!this._isMainEvent(s)&&!this._currentTransform){var t=this._pointer;this._previousPointer=t;var f=this._shouldRender(u),h=this._shouldGroup(s,u);if(this._shouldClearSelection(s,u)?this.discardActiveObject(s):h&&(this._handleGrouping(s,u),u=this._activeObject),this.selection&&(!u||!u.selectable&&!u.isEditing&&u!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),u){var v=u===this._activeObject;u.selectable&&u.activeOn==="down"&&this.setActiveObject(u,s);var y=u._findTargetCorner(this.getPointer(s,!0),H.util.isTouchEvent(s));if(u.__corner=y,u===this._activeObject&&(y||!h)){this._setupCurrentTransform(s,u,v);var p=u.controls[y],t=this.getPointer(s),g=p&&p.getMouseDownHandler(s,u,p);g&&g(s,this._currentTransform,t.x,t.y)}}this._handleEvent(s,"down"),(f||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(s){this._resetTransformEventData(),this._pointer=this.getPointer(s,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(s)||null},_beforeTransform:function(s){var u=this._currentTransform;this.stateful&&u.target.saveState(),this.fire("before:transform",{e:s,transform:u})},__onMouseMove:function(s){this._handleEvent(s,"move:before"),this._cacheTransformEventData(s);var u,t;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(s);return}if(!!this._isMainEvent(s)){var f=this._groupSelector;f?(t=this._absolutePointer,f.left=t.x-f.ex,f.top=t.y-f.ey,this.renderTop()):this._currentTransform?this._transformObject(s):(u=this.findTarget(s)||null,this._setCursorFromEvent(s,u),this._fireOverOutEvents(u,s)),this._handleEvent(s,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(s,u){var t=this._hoveredTarget,f=this._hoveredTargets,h=this.targets,v=Math.max(f.length,h.length);this.fireSyntheticInOutEvents(s,u,{oldTarget:t,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var y=0;y<v;y++)this.fireSyntheticInOutEvents(h[y],u,{oldTarget:f[y],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=s,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(s,u){var t=this._draggedoverTarget,f=this._hoveredTargets,h=this.targets,v=Math.max(f.length,h.length);this.fireSyntheticInOutEvents(s,u,{oldTarget:t,evtOut:"dragleave",evtIn:"dragenter"});for(var y=0;y<v;y++)this.fireSyntheticInOutEvents(h[y],u,{oldTarget:f[y],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=s},fireSyntheticInOutEvents:function(s,u,t){var f,h,v=t.oldTarget,y,p,g=v!==s,d=t.canvasEvtIn,E=t.canvasEvtOut;g&&(f={e:u,target:s,previousTarget:v},h={e:u,target:v,nextTarget:s}),p=s&&g,y=v&&g,y&&(E&&this.fire(E,h),v.fire(t.evtOut,h)),p&&(d&&this.fire(d,f),s.fire(t.evtIn,f))},__onMouseWheel:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"wheel"),this._resetTransformEventData()},_transformObject:function(s){var u=this.getPointer(s),t=this._currentTransform;t.reset=!1,t.shiftKey=s.shiftKey,t.altKey=s[this.centeredKey],this._performTransformAction(s,t,u),t.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(s,u,t){var f=t.x,h=t.y,v=u.action,y=!1,p=u.actionHandler;p&&(y=p(s,u,f,h)),v==="drag"&&y&&(u.target.isMoving=!0,this.setCursor(u.target.moveCursor||this.moveCursor)),u.actionPerformed=u.actionPerformed||y},_fire:H.controlsUtils.fireEvent,_setCursorFromEvent:function(s,u){if(!u)return this.setCursor(this.defaultCursor),!1;var t=u.hoverCursor||this.hoverCursor,f=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!f||!f.contains(u))&&u._findTargetCorner(this.getPointer(s,!0));h?this.setCursor(this.getCornerCursor(h,u,s)):(u.subTargetCheck&&this.targets.concat().reverse().map(function(v){t=v.hoverCursor||t}),this.setCursor(t))},getCornerCursor:function(s,u,t){var f=u.controls[s];return f.cursorStyleHandler(t,f,u)}})}(),function(){var m=Math.min,r=Math.max;H.util.object.extend(H.Canvas.prototype,{_shouldGroup:function(c,l){var e=this._activeObject;return e&&this._isSelectionKeyPressed(c)&&l&&l.selectable&&this.selection&&(e!==l||e.type==="activeSelection")&&!l.onSelect({e:c})},_handleGrouping:function(c,l){var e=this._activeObject;e.__corner||l===e&&(l=this.findTarget(c,!0),!l||!l.selectable)||(e&&e.type==="activeSelection"?this._updateActiveSelection(l,c):this._createActiveSelection(l,c))},_updateActiveSelection:function(c,l){var e=this._activeObject,n=e._objects.slice(0);e.contains(c)?(e.removeWithUpdate(c),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat(),e.size()===1&&this._setActiveObject(e.item(0),l)):(e.addWithUpdate(c),this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(n,l)},_createActiveSelection:function(c,l){var e=this.getActiveObjects(),n=this._createGroup(c);this._hoveredTarget=n,this._setActiveObject(n,l),this._fireSelectionEvents(e,l)},_createGroup:function(c){var l=this._objects,e=l.indexOf(this._activeObject)<l.indexOf(c),n=e?[this._activeObject,c]:[c,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new H.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(c){var l=this._collectObjects(c),e;l.length===1?this.setActiveObject(l[0],c):l.length>1&&(e=new H.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(e,c))},_collectObjects:function(c){for(var l=[],e,n=this._groupSelector.ex,a=this._groupSelector.ey,s=n+this._groupSelector.left,u=a+this._groupSelector.top,t=new H.Point(m(n,s),m(a,u)),f=new H.Point(r(n,s),r(a,u)),h=!this.selectionFullyContained,v=n===s&&a===u,y=this._objects.length;y--&&(e=this._objects[y],!(!(!e||!e.selectable||!e.visible)&&(h&&e.intersectsWithRect(t,f,!0)||e.isContainedWithinRect(t,f,!0)||h&&e.containsPoint(t,null,!0)||h&&e.containsPoint(f,null,!0))&&(l.push(e),v))););return l.length>1&&(l=l.filter(function(p){return!p.onSelect({e:c})})),l},_maybeGroupObjects:function(c){this.selection&&this._groupSelector&&this._groupSelectedObjects(c),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){H.util.object.extend(H.StaticCanvas.prototype,{toDataURL:function(m){m||(m={});var r=m.format||"png",c=m.quality||1,l=(m.multiplier||1)*(m.enableRetinaScaling?this.getRetinaScaling():1),e=this.toCanvasElement(l,m);return H.util.toDataURL(e,r,c)},toCanvasElement:function(m,r){m=m||1,r=r||{};var c=(r.width||this.width)*m,l=(r.height||this.height)*m,e=this.getZoom(),n=this.width,a=this.height,s=e*m,u=this.viewportTransform,t=(u[4]-(r.left||0))*m,f=(u[5]-(r.top||0))*m,h=this.interactive,v=[s,0,0,s,t,f],y=this.enableRetinaScaling,p=H.util.createCanvasElement(),g=this.contextTop;return p.width=c,p.height=l,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=v,this.width=c,this.height=l,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=u,this.width=n,this.height=a,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=y,this.contextTop=g,p}})}(),H.util.object.extend(H.StaticCanvas.prototype,{loadFromJSON:function(m,r,c){if(!!m){var l=typeof m=="string"?JSON.parse(m):H.util.object.clone(m),e=this,n=l.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete l.clipPath,this._enlivenObjects(l.objects,function(s){e.clear(),e._setBgOverlay(l,function(){n?e._enlivenObjects([n],function(u){e.clipPath=u[0],e.__setupCanvas.call(e,l,s,a,r)}):e.__setupCanvas.call(e,l,s,a,r)})},c),this}},__setupCanvas:function(m,r,c,l){var e=this;r.forEach(function(n,a){e.insertAt(n,a)}),this.renderOnAddRemove=c,delete m.objects,delete m.backgroundImage,delete m.overlayImage,delete m.background,delete m.overlay,this._setOptions(m),this.renderAll(),l&&l()},_setBgOverlay:function(m,r){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!m.backgroundImage&&!m.overlayImage&&!m.background&&!m.overlay){r&&r();return}var l=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&r&&r()};this.__setBgOverlay("backgroundImage",m.backgroundImage,c,l),this.__setBgOverlay("overlayImage",m.overlayImage,c,l),this.__setBgOverlay("backgroundColor",m.background,c,l),this.__setBgOverlay("overlayColor",m.overlay,c,l)},__setBgOverlay:function(m,r,c,l){var e=this;if(!r){c[m]=!0,l&&l();return}m==="backgroundImage"||m==="overlayImage"?H.util.enlivenObjects([r],function(n){e[m]=n[0],c[m]=!0,l&&l()}):this["set"+H.util.string.capitalize(m,!0)](r,function(){c[m]=!0,l&&l()})},_enlivenObjects:function(m,r,c){if(!m||m.length===0){r&&r([]);return}H.util.enlivenObjects(m,function(l){r&&r(l)},null,c)},_toDataURL:function(m,r){this.clone(function(c){r(c.toDataURL(m))})},_toDataURLWithMultiplier:function(m,r,c){this.clone(function(l){c(l.toDataURLWithMultiplier(m,r))})},clone:function(m,r){var c=JSON.stringify(this.toJSON(r));this.cloneWithoutData(function(l){l.loadFromJSON(c,function(){m&&m(l)})})},cloneWithoutData:function(m){var r=H.util.createCanvasElement();r.width=this.width,r.height=this.height;var c=new H.Canvas(r);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),m&&m(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):m&&m(c)}}),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.util.object.clone,e=r.util.toFixed,n=r.util.string.capitalize,a=r.util.degreesToRadians,s=!r.isLikelyNode,u=2;r.Object||(r.Object=r.util.createClass(r.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:s,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=r.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var f=r.perfLimitSizeTotal,h=t.width,v=t.height,y=r.maxCacheSideLimit,p=r.minCacheSideLimit;if(h<=y&&v<=y&&h*v<=f)return h<p&&(t.width=p),v<p&&(t.height=p),t;var g=h/v,d=r.util.limitDimsByArea(g,f),E=r.util.capValue,w=E(p,d.x,y),D=E(p,d.y,y);return h>w&&(t.zoomX/=h/w,t.width=w,t.capped=!0),v>D&&(t.zoomY/=v/D,t.height=D,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),f=this._getTransformedDimensions(0,0),h=f.x*t.scaleX/this.scaleX,v=f.y*t.scaleY/this.scaleY;return{width:h+u,height:v+u,zoomX:t.scaleX,zoomY:t.scaleY,x:h,y:v}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var f=t._currentTransform.target,h=t._currentTransform.action;if(this===f&&h.slice&&h.slice(0,5)==="scale")return!1}var v=this._cacheCanvas,y=this._limitCacheSize(this._getCacheCanvasDimensions()),p=r.minCacheSideLimit,g=y.width,d=y.height,E,w,D=y.zoomX,b=y.zoomY,S=g!==this.cacheWidth||d!==this.cacheHeight,C=this.zoomX!==D||this.zoomY!==b,P=S||C,R=0,L=0,O=!1;if(S){var _=this._cacheCanvas.width,x=this._cacheCanvas.height,A=g>_||d>x,k=(g<_*.9||d<x*.9)&&_>p&&x>p;O=A||k,A&&!y.capped&&(g>p||d>p)&&(R=g*.1,L=d*.1)}return this instanceof r.Text&&this.path&&(P=!0,O=!0,R+=this.getHeightOfLine(0)*this.zoomX,L+=this.getHeightOfLine(0)*this.zoomY),P?(O?(v.width=Math.ceil(g+R),v.height=Math.ceil(d+L)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,v.width,v.height)),E=y.x/2,w=y.y/2,this.cacheTranslationX=Math.round(v.width/2-E)+E,this.cacheTranslationY=Math.round(v.height/2-w)+w,this.cacheWidth=g,this.cacheHeight=d,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(D,b),this.zoomX=D,this.zoomY=b,!0):!1},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var f=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,h=this.calcTransformMatrix(!f);t.transform(h[0],h[1],h[2],h[3],h[4],h[5])},toObject:function(t){var f=r.Object.NUM_FRACTION_DIGITS,h={type:this.type,version:r.version,originX:this.originX,originY:this.originY,left:e(this.left,f),top:e(this.top,f),width:e(this.width,f),height:e(this.height,f),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:e(this.strokeWidth,f),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:e(this.strokeMiterLimit,f),scaleX:e(this.scaleX,f),scaleY:e(this.scaleY,f),angle:e(this.angle,f),flipX:this.flipX,flipY:this.flipY,opacity:e(this.opacity,f),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:e(this.skewX,f),skewY:e(this.skewY,f)};return this.clipPath&&!this.clipPath.excludeFromExport&&(h.clipPath=this.clipPath.toObject(t),h.clipPath.inverted=this.clipPath.inverted,h.clipPath.absolutePositioned=this.clipPath.absolutePositioned),r.util.populateWithProperties(this,h,t),this.includeDefaultValues||(h=this._removeDefaultValues(h)),h},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var f=r.util.getKlass(t.type).prototype,h=f.stateProperties;return h.forEach(function(v){v==="left"||v==="top"||(t[v]===f[v]&&delete t[v],Array.isArray(t[v])&&Array.isArray(f[v])&&t[v].length===0&&f[v].length===0&&delete t[v])}),t},toString:function(){return"#<fabric."+n(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var t=r.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),f=t.scaleX,h=t.scaleY;if(this.canvas){var v=this.canvas.getZoom(),y=this.canvas.getRetinaScaling();f*=v*y,h*=v*y}return{scaleX:f,scaleY:h}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,f){var h=t==="scaleX"||t==="scaleY",v=this[t]!==f,y=!1;return h&&(f=this._constrainScale(f)),t==="scaleX"&&f<0?(this.flipX=!this.flipX,f*=-1):t==="scaleY"&&f<0?(this.flipY=!this.flipY,f*=-1):t==="shadow"&&f&&!(f instanceof r.Shadow)?f=new r.Shadow(f):t==="dirty"&&this.group&&this.group.set("dirty",f),this[t]=f,v&&(y=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,y&&this.group.set("dirty",!0)):y&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:r.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(t,f){if(t.save(),f.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",f.absolutePositioned){var h=r.util.invertTransform(this.calcTransformMatrix());t.transform(h[0],h[1],h[2],h[3],h[4],h[5])}f.transform(t),t.scale(1/f.zoomX,1/f.zoomY),t.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),t.restore()},drawObject:function(t,f){var h=this.fill,v=this.stroke;f?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t,this.clipPath),this.fill=h,this.stroke=v},_drawClipPath:function(t,f){!f||(f.canvas=this.canvas,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCache(t,f))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!t){var f=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-f/2,-h/2,f,h)}return!0}return!1},_renderBackground:function(t){if(!!this.backgroundColor){var f=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-f.x/2,-f.y/2,f.x,f.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,f){var h=f.stroke;h&&(t.lineWidth=f.strokeWidth,t.lineCap=f.strokeLineCap,t.lineDashOffset=f.strokeDashOffset,t.lineJoin=f.strokeLineJoin,t.miterLimit=f.strokeMiterLimit,h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?this._applyPatternForTransformedGradient(t,h):(t.strokeStyle=h.toLive(t,this),this._applyPatternGradientTransform(t,h)):t.strokeStyle=f.stroke)},_setFillStyles:function(t,f){var h=f.fill;h&&(h.toLive?(t.fillStyle=h.toLive(t,this),this._applyPatternGradientTransform(t,f.fill)):t.fillStyle=h)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,f){!f||f.length===0||(1&f.length&&f.push.apply(f,f),t.setLineDash(f))},_renderControls:function(t,f){var h=this.getViewportTransform(),v=this.calcTransformMatrix(),y,p,g;f=f||{},p=typeof f.hasBorders!="undefined"?f.hasBorders:this.hasBorders,g=typeof f.hasControls!="undefined"?f.hasControls:this.hasControls,v=r.util.multiplyTransformMatrices(h,v),y=r.util.qrDecompose(v),t.save(),t.translate(y.translateX,y.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(y.angle-=180),t.rotate(a(this.group?y.angle:this.angle)),f.forActiveSelection||this.group?p&&this.drawBordersInGroup(t,y,f):p&&this.drawBorders(t,f),g&&this.drawControls(t,f),t.restore()},_setShadow:function(t){if(!!this.shadow){var f=this.shadow,h=this.canvas,v,y=h&&h.viewportTransform[0]||1,p=h&&h.viewportTransform[3]||1;f.nonScaling?v={scaleX:1,scaleY:1}:v=this.getObjectScaling(),h&&h._isRetinaScaling()&&(y*=r.devicePixelRatio,p*=r.devicePixelRatio),t.shadowColor=f.color,t.shadowBlur=f.blur*r.browserShadowBlurConstant*(y+p)*(v.scaleX+v.scaleY)/4,t.shadowOffsetX=f.offsetX*y*v.scaleX,t.shadowOffsetY=f.offsetY*p*v.scaleY}},_removeShadow:function(t){!this.shadow||(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,f){if(!f||!f.toLive)return{offsetX:0,offsetY:0};var h=f.gradientTransform||f.patternTransform,v=-this.width/2+f.offsetX||0,y=-this.height/2+f.offsetY||0;return f.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,v,y):t.transform(1,0,0,1,v,y),h&&t.transform(h[0],h[1],h[2],h[3],h[4],h[5]),{offsetX:v,offsetY:y}},_renderPaintInOrder:function(t){this.paintFirst==="stroke"?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){!this.fill||(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var f=this.getObjectScaling();t.scale(1/f.scaleX,1/f.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,f){var h=this._limitCacheSize(this._getCacheCanvasDimensions()),v=r.util.createCanvasElement(),y,p=this.canvas.getRetinaScaling(),g=h.x/this.scaleX/p,d=h.y/this.scaleY/p;v.width=g,v.height=d,y=v.getContext("2d"),y.beginPath(),y.moveTo(0,0),y.lineTo(g,0),y.lineTo(g,d),y.lineTo(0,d),y.closePath(),y.translate(g/2,d/2),y.scale(h.zoomX/this.scaleX/p,h.zoomY/this.scaleY/p),this._applyPatternGradientTransform(y,f),y.fillStyle=f.toLive(t),y.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(p*this.scaleX/h.zoomX,p*this.scaleY/h.zoomY),t.strokeStyle=y.createPattern(v,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=r.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var f=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),f=r.util.transformPoint(f,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,f.x+=t.offsetLeft,f.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(f,"center","center")},clone:function(t,f){var h=this.toObject(f);this.constructor.fromObject?this.constructor.fromObject(h,t):r.Object._fromObject("Object",h,t)},cloneAsImage:function(t,f){var h=this.toCanvasElement(f);return t&&t(new r.Image(h)),this},toCanvasElement:function(t){t||(t={});var f=r.util,h=f.saveObjectTransform(this),v=this.group,y=this.shadow,p=Math.abs,g=(t.multiplier||1)*(t.enableRetinaScaling?r.devicePixelRatio:1);delete this.group,t.withoutTransform&&f.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var d=r.util.createCanvasElement(),E=this.getBoundingRect(!0,!0),w=this.shadow,D,b={x:0,y:0},S,C,P;w&&(S=w.blur,w.nonScaling?D={scaleX:1,scaleY:1}:D=this.getObjectScaling(),b.x=2*Math.round(p(w.offsetX)+S)*p(D.scaleX),b.y=2*Math.round(p(w.offsetY)+S)*p(D.scaleY)),C=E.width+b.x,P=E.height+b.y,d.width=Math.ceil(C),d.height=Math.ceil(P);var R=new r.StaticCanvas(d,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});t.format==="jpeg"&&(R.backgroundColor="#fff"),this.setPositionByOrigin(new r.Point(R.width/2,R.height/2),"center","center");var L=this.canvas;R.add(this);var O=R.toCanvasElement(g||1,t);return this.shadow=y,this.set("canvas",L),v&&(this.group=v),this.set(h).setCoords(),R._objects=[],R.dispose(),R=null,O},toDataURL:function(t){return t||(t={}),r.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var f=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return f&&this._setOriginToCenter(),this.set("angle",t),f&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,f){f=f||this.canvas.getPointer(t);var h=new r.Point(f.x,f.y),v=this._getLeftTopCoords();return this.angle&&(h=r.util.rotatePoint(h,v,a(-this.angle))),{x:h.x-v.x,y:h.y-v.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){r.runningAnimations&&r.runningAnimations.cancelByTarget(this)}}),r.util.createAccessors&&r.util.createAccessors(r.Object),c(r.Object.prototype,r.Observable),r.Object.NUM_FRACTION_DIGITS=2,r.Object.ENLIVEN_PROPS=["clipPath"],r.Object._fromObject=function(t,f,h,v){var y=r[t];f=l(f,!0),r.util.enlivenPatterns([f.fill,f.stroke],function(p){typeof p[0]!="undefined"&&(f.fill=p[0]),typeof p[1]!="undefined"&&(f.stroke=p[1]),r.util.enlivenObjectEnlivables(f,f,function(){var g=v?new y(f[v],f):new y(f);h&&h(g)})})},r.Object.__uid=0)}(be),function(){var m=H.util.degreesToRadians,r={left:-.5,center:0,right:.5},c={top:-.5,center:0,bottom:.5};H.util.object.extend(H.Object.prototype,{translateToGivenOrigin:function(l,e,n,a,s){var u=l.x,t=l.y,f,h,v;return typeof e=="string"?e=r[e]:e-=.5,typeof a=="string"?a=r[a]:a-=.5,f=a-e,typeof n=="string"?n=c[n]:n-=.5,typeof s=="string"?s=c[s]:s-=.5,h=s-n,(f||h)&&(v=this._getTransformedDimensions(),u=l.x+f*v.x,t=l.y+h*v.y),new H.Point(u,t)},translateToCenterPoint:function(l,e,n){var a=this.translateToGivenOrigin(l,e,n,"center","center");return this.angle?H.util.rotatePoint(a,l,m(this.angle)):a},translateToOriginPoint:function(l,e,n){var a=this.translateToGivenOrigin(l,"center","center",e,n);return this.angle?H.util.rotatePoint(a,l,m(this.angle)):a},getCenterPoint:function(){var l=new H.Point(this.left,this.top);return this.translateToCenterPoint(l,this.originX,this.originY)},getPointByOrigin:function(l,e){var n=this.getCenterPoint();return this.translateToOriginPoint(n,l,e)},toLocalPoint:function(l,e,n){var a=this.getCenterPoint(),s,u;return typeof e!="undefined"&&typeof n!="undefined"?s=this.translateToGivenOrigin(a,"center","center",e,n):s=new H.Point(this.left,this.top),u=new H.Point(l.x,l.y),this.angle&&(u=H.util.rotatePoint(u,a,-m(this.angle))),u.subtractEquals(s)},setPositionByOrigin:function(l,e,n){var a=this.translateToCenterPoint(l,e,n),s=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(l){var e=m(this.angle),n=this.getScaledWidth(),a=H.util.cos(e)*n,s=H.util.sin(e)*n,u,t;typeof this.originX=="string"?u=r[this.originX]:u=this.originX-.5,typeof l=="string"?t=r[l]:t=l-.5,this.left+=a*(t-u),this.top+=s*(t-u),this.setCoords(),this.originX=l},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var l=this.getCenterPoint();this.originX="center",this.originY="center",this.left=l.x,this.top=l.y},_resetOrigin:function(){var l=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=l.x,this.top=l.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function m(n){return[new H.Point(n.tl.x,n.tl.y),new H.Point(n.tr.x,n.tr.y),new H.Point(n.br.x,n.br.y),new H.Point(n.bl.x,n.bl.y)]}var r=H.util,c=r.degreesToRadians,l=r.multiplyTransformMatrices,e=r.transformPoint;r.object.extend(H.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,a){return a?n?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,a){return m(this._getCoords(n,a))},intersectsWithRect:function(n,a,s,u){var t=this.getCoords(s,u),f=H.Intersection.intersectPolygonRectangle(t,n,a);return f.status==="Intersection"},intersectsWithObject:function(n,a,s){var u=H.Intersection.intersectPolygonPolygon(this.getCoords(a,s),n.getCoords(a,s));return u.status==="Intersection"||n.isContainedWithinObject(this,a,s)||this.isContainedWithinObject(n,a,s)},isContainedWithinObject:function(n,a,s){for(var u=this.getCoords(a,s),t=a?n.aCoords:n.lineCoords,f=0,h=n._getImageLines(t);f<4;f++)if(!n.containsPoint(u[f],h))return!1;return!0},isContainedWithinRect:function(n,a,s,u){var t=this.getBoundingRect(s,u);return t.left>=n.x&&t.left+t.width<=a.x&&t.top>=n.y&&t.top+t.height<=a.y},containsPoint:function(n,a,s,u){var t=this._getCoords(s,u),a=a||this._getImageLines(t),f=this._findCrossPoints(n,a);return f!==0&&f%2==1},isOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br,u=this.getCoords(!0,n);return u.some(function(t){return t.x<=s.x&&t.x>=a.x&&t.y<=s.y&&t.y>=a.y})||this.intersectsWithRect(a,s,!0,n)?!0:this._containsCenterOfCanvas(a,s,n)},_containsCenterOfCanvas:function(n,a,s){var u={x:(n.x+a.x)/2,y:(n.y+a.y)/2};return!!this.containsPoint(u,null,!0,s)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br;if(this.intersectsWithRect(a,s,!0,n))return!0;var u=this.getCoords(!0,n).every(function(t){return(t.x>=s.x||t.x<=a.x)&&(t.y>=s.y||t.y<=a.y)});return u&&this._containsCenterOfCanvas(a,s,n)},_getImageLines:function(n){var a={topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}};return a},_findCrossPoints:function(n,a){var s,u,t,f,h,v=0,y;for(var p in a)if(y=a[p],!(y.o.y<n.y&&y.d.y<n.y)&&!(y.o.y>=n.y&&y.d.y>=n.y)&&(y.o.x===y.d.x&&y.o.x>=n.x?h=y.o.x:(s=0,u=(y.d.y-y.o.y)/(y.d.x-y.o.x),t=n.y-s*n.x,f=y.o.y-u*y.o.x,h=-(t-f)/(s-u)),h>=n.x&&(v+=1),v===2))break;return v},getBoundingRect:function(n,a){var s=this.getCoords(n,a);return r.makeBoundingBoxFromPoints(s)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,a){var s=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(n/this.width/s)},scaleToHeight:function(n,a){var s=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(n/this.height/s)},calcLineCoords:function(){var n=this.getViewportTransform(),a=this.padding,s=c(this.angle),u=r.cos(s),t=r.sin(s),f=u*a,h=t*a,v=f+h,y=f-h,p=this.calcACoords(),g={tl:e(p.tl,n),tr:e(p.tr,n),bl:e(p.bl,n),br:e(p.br,n)};return a&&(g.tl.x-=y,g.tl.y-=v,g.tr.x+=v,g.tr.y-=y,g.bl.x-=v,g.bl.y+=y,g.br.x+=y,g.br.y+=v),g},calcOCoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=this.getViewportTransform(),u=l(s,a),t=l(u,n),t=l(t,[1/s[0],0,0,1/s[3],0,0]),f=this._calculateCurrentDimensions(),h={};return this.forEachControl(function(v,y,p){h[y]=v.positionHandler(f,t,p)}),h},calcACoords:function(){var n=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=l(a,n),u=this._getTransformedDimensions(),t=u.x/2,f=u.y/2;return{tl:e({x:-t,y:-f},s),tr:e({x:t,y:-f},s),bl:e({x:-t,y:f},s),br:e({x:t,y:f},s)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return r.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var a="_",s="";return!n&&this.group&&(s=this.group.transformMatrixKey(n)+a),s+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var a=this.calcOwnMatrix();if(n||!this.group)return a;var s=this.transformMatrixKey(n),u=this.matrixCache||(this.matrixCache={});return u.key===s?u.value:(this.group&&(a=l(this.group.calcTransformMatrix(!1),a)),u.key=s,u.value=a,a)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===n)return a.value;var s=this._calcTranslateMatrix(),u={angle:this.angle,translateX:s[4],translateY:s[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=n,a.value=r.composeMatrix(u),a.value},_getNonTransformedDimensions:function(){var n=this.strokeWidth,a=this.width+n,s=this.height+n;return{x:a,y:s}},_getTransformedDimensions:function(n,a){typeof n=="undefined"&&(n=this.skewX),typeof a=="undefined"&&(a=this.skewY);var s,u,t,f=n===0&&a===0;if(this.strokeUniform?(u=this.width,t=this.height):(s=this._getNonTransformedDimensions(),u=s.x,t=s.y),f)return this._finalizeDimensions(u*this.scaleX,t*this.scaleY);var h=r.sizeAfterTransform(u,t,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:a});return this._finalizeDimensions(h.x,h.y)},_finalizeDimensions:function(n,a){return this.strokeUniform?{x:n+this.strokeWidth,y:a+this.strokeWidth}:{x:n,y:a}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),a=this._getTransformedDimensions(),s=e(a,n,!0);return s.scalarAdd(2*this.padding)}})}(),H.util.object.extend(H.Object.prototype,{sendToBack:function(){return this.group?H.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?H.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(m){return this.group?H.StaticCanvas.prototype.sendBackwards.call(this.group,this,m):this.canvas&&this.canvas.sendBackwards(this,m),this},bringForward:function(m){return this.group?H.StaticCanvas.prototype.bringForward.call(this.group,this,m):this.canvas&&this.canvas.bringForward(this,m),this},moveTo:function(m){return this.group&&this.group.type!=="activeSelection"?H.StaticCanvas.prototype.moveTo.call(this.group,this,m):this.canvas&&this.canvas.moveTo(this,m),this}}),function(){function m(c,l){if(l){if(l.toLive)return c+": url(#SVGID_"+l.id+"); ";var e=new H.Color(l),n=c+": "+e.toRgb()+"; ",a=e.getAlpha();return a!==1&&(n+=c+"-opacity: "+a.toString()+"; "),n}else return c+": none; "}var r=H.util.toFixed;H.util.object.extend(H.Object.prototype,{getSvgStyles:function(c){var l=this.fillRule?this.fillRule:"nonzero",e=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",u=this.strokeLineJoin?this.strokeLineJoin:"miter",t=this.strokeMiterLimit?this.strokeMiterLimit:"4",f=typeof this.opacity!="undefined"?this.opacity:"1",h=this.visible?"":" visibility: hidden;",v=c?"":this.getSvgFilter(),y=m("fill",this.fill),p=m("stroke",this.stroke);return[p,"stroke-width: ",e,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",u,"; ","stroke-miterlimit: ",t,"; ",y,"fill-rule: ",l,"; ","opacity: ",f,";",v,h].join("")},getSvgSpanStyles:function(c,l){var e="; ",n=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+e:"",a=c.strokeWidth?"stroke-width: "+c.strokeWidth+e:"",n=n,s=c.fontSize?"font-size: "+c.fontSize+"px"+e:"",u=c.fontStyle?"font-style: "+c.fontStyle+e:"",t=c.fontWeight?"font-weight: "+c.fontWeight+e:"",f=c.fill?m("fill",c.fill):"",h=c.stroke?m("stroke",c.stroke):"",v=this.getSvgTextDecoration(c),y=c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"";return v&&(v="text-decoration: "+v+e),[h,a,n,s,u,t,v,f,y,l?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(l){return c[l.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,l){var e=c?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'+H.util.matrixToSVG(e);return n+(l||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var l=H.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,l),'" y="',r(-this.height/2,l),'" width="',r(this.width,l),'" height="',r(this.height,l),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,l){l=l||{};var e=l.reviver,n=l.additionalTransform||"",a=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),s=c.indexOf("COMMON_PARTS");return c[s]=a,e?e(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,l){l=l||{};var e=l.noStyle,n=l.reviver,a=e?"":'style="'+this.getSvgStyles()+'" ',s=l.withShadow?'style="'+this.getSvgFilter()+'" ':"",u=this.clipPath,t=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",f=u&&u.absolutePositioned,h=this.stroke,v=this.fill,y=this.shadow,p,g=[],d,E=c.indexOf("COMMON_PARTS"),w=l.additionalTransform;return u&&(u.clipPathId="CLIPPATH_"+H.Object.__uid++,d='<clipPath id="'+u.clipPathId+`" >
`+u.toClipPathSVG(n)+`</clipPath>
`),f&&g.push("<g ",s,this.getSvgCommons(),` >
`),g.push("<g ",this.getSvgTransform(!1),f?"":s+this.getSvgCommons(),` >
`),p=[a,t,e?"":this.addPaintOrder()," ",w?'transform="'+w+'" ':""].join(""),c[E]=p,v&&v.toLive&&g.push(v.toSVG(this)),h&&h.toLive&&g.push(h.toSVG(this)),y&&g.push(y.toSVG(this)),u&&g.push(d),g.push(c.join("")),g.push(`</g>
`),f&&g.push(`</g>
`),n?n(g.join("")):g.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var m=H.util.object.extend,r="stateProperties";function c(e,n,a){var s={},u=!0;a.forEach(function(t){s[t]=e[t]}),m(e[n],s,u)}function l(e,n,a){if(e===n)return!0;if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var s=0,u=e.length;s<u;s++)if(!l(e[s],n[s]))return!1;return!0}else if(e&&typeof e=="object"){var t=Object.keys(e),f;if(!n||typeof n!="object"||!a&&t.length!==Object.keys(n).length)return!1;for(var s=0,u=t.length;s<u;s++)if(f=t[s],!(f==="canvas"||f==="group")&&!l(e[f],n[f]))return!1;return!0}}H.util.object.extend(H.Object.prototype,{hasStateChanged:function(e){e=e||r;var n="_"+e;return Object.keys(this[n]).length<this[e].length?!0:!l(this[n],this,!0)},saveState:function(e){var n=e&&e.propertySet||r,a="_"+n;return this[a]?(c(this,a,this[n]),e&&e.stateProperties&&c(this,a,e.stateProperties),this):this.setupState(e)},setupState:function(e){e=e||{};var n=e.propertySet||r;return e.propertySet=n,this["_"+n]={},this.saveState(e),this}})}(),function(){var m=H.util.degreesToRadians;H.util.object.extend(H.Object.prototype,{_findTargetCorner:function(r,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l=r.x,e=r.y,n,a,s=Object.keys(this.oCoords),u=s.length-1,t;for(this.__corner=0;u>=0;u--)if(t=s[u],!!this.isControlVisible(t)&&(a=this._getImageLines(c?this.oCoords[t].touchCorner:this.oCoords[t].corner),n=this._findCrossPoints({x:l,y:e},a),n!==0&&n%2==1))return this.__corner=t,t;return!1},forEachControl:function(r){for(var c in this.controls)r(this.controls[c],c,this)},_setCornerCoords:function(){var r=this.oCoords;for(var c in r){var l=this.controls[c];r[c].corner=l.calcCornerCoords(this.angle,this.cornerSize,r[c].x,r[c].y,!1),r[c].touchCorner=l.calcCornerCoords(this.angle,this.touchCornerSize,r[c].x,r[c].y,!0)}},drawSelectionBackground:function(r){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;r.save();var c=this.getCenterPoint(),l=this._calculateCurrentDimensions(),e=this.canvas.viewportTransform;return r.translate(c.x,c.y),r.scale(1/e[0],1/e[3]),r.rotate(m(this.angle)),r.fillStyle=this.selectionBackgroundColor,r.fillRect(-l.x/2,-l.y/2,l.x,l.y),r.restore(),this},drawBorders:function(r,c){c=c||{};var l=this._calculateCurrentDimensions(),e=this.borderScaleFactor,n=l.x+e,a=l.y+e,s=typeof c.hasControls!="undefined"?c.hasControls:this.hasControls,u=!1;return r.save(),r.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(r,c.borderDashArray||this.borderDashArray),r.strokeRect(-n/2,-a/2,n,a),s&&(r.beginPath(),this.forEachControl(function(t,f,h){t.withConnection&&t.getVisibility(h,f)&&(u=!0,r.moveTo(t.x*n,t.y*a),r.lineTo(t.x*n+t.offsetX,t.y*a+t.offsetY))}),u&&r.stroke()),r.restore(),this},drawBordersInGroup:function(r,c,l){l=l||{};var e=H.util.sizeAfterTransform(this.width,this.height,c),n=this.strokeWidth,a=this.strokeUniform,s=this.borderScaleFactor,u=e.x+n*(a?this.canvas.getZoom():c.scaleX)+s,t=e.y+n*(a?this.canvas.getZoom():c.scaleY)+s;return r.save(),this._setLineDash(r,l.borderDashArray||this.borderDashArray),r.strokeStyle=l.borderColor||this.borderColor,r.strokeRect(-u/2,-t/2,u,t),r.restore(),this},drawControls:function(r,c){c=c||{},r.save();var l=this.canvas.getRetinaScaling(),e,n;return r.setTransform(l,0,0,l,0,0),r.strokeStyle=r.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(r.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(r,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(e=this.group.calcTransformMatrix()),this.forEachControl(function(a,s,u){n=u.oCoords[s],a.getVisibility(u,s)&&(e&&(n=H.util.transformPoint(n,e)),a.render(r,n.x,n.y,c,u))}),r.restore(),this},isControlVisible:function(r){return this.controls[r]&&this.controls[r].getVisibility(this,r)},setControlVisible:function(r,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[r]=c,this},setControlsVisibility:function(r){r||(r={});for(var c in r)this.setControlVisible(c,r[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),H.util.object.extend(H.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(m,r){r=r||{};var c=function(){},l=r.onComplete||c,e=r.onChange||c,n=this;return H.util.animate({target:this,startValue:m.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(a){m.set("left",a),n.requestRenderAll(),e()},onComplete:function(){m.setCoords(),l()}})},fxCenterObjectV:function(m,r){r=r||{};var c=function(){},l=r.onComplete||c,e=r.onChange||c,n=this;return H.util.animate({target:this,startValue:m.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(a){m.set("top",a),n.requestRenderAll(),e()},onComplete:function(){m.setCoords(),l()}})},fxRemove:function(m,r){r=r||{};var c=function(){},l=r.onComplete||c,e=r.onChange||c,n=this;return H.util.animate({target:this,startValue:m.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(a){m.set("opacity",a),n.requestRenderAll(),e()},onComplete:function(){n.remove(m),l()}})}}),H.util.object.extend(H.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var m=[],r,c,l=[];for(r in arguments[0])m.push(r);for(var e=0,n=m.length;e<n;e++)r=m[e],c=e!==n-1,l.push(this._animate(r,arguments[0][r],arguments[1],c));return l}else return this._animate.apply(this,arguments)},_animate:function(m,r,c,l){var e=this,n;r=r.toString(),c?c=H.util.object.clone(c):c={},~m.indexOf(".")&&(n=m.split("."));var a=e.colorProperties.indexOf(m)>-1||n&&e.colorProperties.indexOf(n[1])>-1,s=n?this.get(n[0])[n[1]]:this.get(m);"from"in c||(c.from=s),a||(~r.indexOf("=")?r=s+parseFloat(r.replace("=","")):r=parseFloat(r));var u={target:this,startValue:c.from,endValue:r,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(t,f,h){return c.abort.call(e,t,f,h)},onChange:function(t,f,h){n?e[n[0]][n[1]]=t:e.set(m,t),!l&&c.onChange&&c.onChange(t,f,h)},onComplete:function(t,f,h){l||(e.setCoords(),c.onComplete&&c.onComplete(t,f,h))}};return a?H.util.animateColor(u.startValue,u.endValue,u.duration,u):H.util.animate(u)}}),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.util.object.clone,e={x1:1,x2:1,y1:1,y2:1};if(r.Line){r.warn("fabric.Line is already defined");return}r.Line=r.util.createClass(r.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:r.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(a,s){a||(a=[0,0,0,0]),this.callSuper("initialize",s),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(s)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,s){return this.callSuper("_set",a,s),typeof e[a]!="undefined"&&this._setWidthHeight(),this},_getLeftToOriginX:n({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:n({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var s=this.calcLinePoints();a.moveTo(s.x1,s.y1),a.lineTo(s.x2,s.y2),a.lineWidth=this.strokeWidth;var u=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=u},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(a){return c(this.callSuper("toObject",a),this.calcLinePoints())},_getNonTransformedDimensions:function(){var a=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(a.y-=this.strokeWidth),this.height===0&&(a.x-=this.strokeWidth)),a},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,s=this.y1<=this.y2?-1:1,u=a*this.width*.5,t=s*this.height*.5,f=a*this.width*-.5,h=s*this.height*-.5;return{x1:u,x2:f,y1:t,y2:h}},_toSVG:function(){var a=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`" />
`]}}),r.Line.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),r.Line.fromElement=function(a,s,u){u=u||{};var t=r.parseAttributes(a,r.Line.ATTRIBUTE_NAMES),f=[t.x1||0,t.y1||0,t.x2||0,t.y2||0];s(new r.Line(f,c(t,u)))},r.Line.fromObject=function(a,s){function u(f){delete f.points,s&&s(f)}var t=l(a,!0);t.points=[a.x1,a.y1,a.x2,a.y2],r.Object._fromObject("Line",t,u,"points")};function n(a,s){var u=a.origin,t=a.axis1,f=a.axis2,h=a.dimension,v=s.nearest,y=s.center,p=s.farthest;return function(){switch(this.get(u)){case v:return Math.min(this.get(t),this.get(f));case y:return Math.min(this.get(t),this.get(f))+.5*this.get(h);case p:return Math.max(this.get(t),this.get(f))}}}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.degreesToRadians;if(r.Circle){r.warn("fabric.Circle is already defined.");return}r.Circle=r.util.createClass(r.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:r.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(e,n){return this.callSuper("_set",e,n),e==="radius"&&this.setRadius(n),this},toObject:function(e){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(e))},_toSVG:function(){var e,n=0,a=0,s=(this.endAngle-this.startAngle)%360;if(s===0)e=["<circle ","COMMON_PARTS",'cx="'+n+'" cy="'+a+'" ','r="',this.radius,`" />
`];else{var u=c(this.startAngle),t=c(this.endAngle),f=this.radius,h=r.util.cos(u)*f,v=r.util.sin(u)*f,y=r.util.cos(t)*f,p=r.util.sin(t)*f,g=s>180?"1":"0";e=['<path d="M '+h+" "+v," A "+f+" "+f," 0 ",+g+" 1"," "+y+" "+p,'" ',"COMMON_PARTS",` />
`]}return e},_render:function(e){e.beginPath(),e.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(e){return this.radius=e,this.set("width",e*2).set("height",e*2)}}),r.Circle.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),r.Circle.fromElement=function(e,n){var a=r.parseAttributes(e,r.Circle.ATTRIBUTE_NAMES);if(!l(a))throw new Error("value of `r` attribute is required and can not be negative");a.left=(a.left||0)-a.radius,a.top=(a.top||0)-a.radius,n(new r.Circle(a))};function l(e){return"radius"in e&&e.radius>=0}r.Circle.fromObject=function(e,n){r.Object._fromObject("Circle",e,n)}}(be),function(m){var r=m.fabric||(m.fabric={});if(r.Triangle){r.warn("fabric.Triangle is already defined");return}r.Triangle=r.util.createClass(r.Object,{type:"triangle",width:100,height:100,_render:function(c){var l=this.width/2,e=this.height/2;c.beginPath(),c.moveTo(-l,e),c.lineTo(0,-e),c.lineTo(l,e),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,l=this.height/2,e=[-c+" "+l,"0 "+-l,c+" "+l].join(",");return["<polygon ","COMMON_PARTS",'points="',e,'" />']}}),r.Triangle.fromObject=function(c,l){return r.Object._fromObject("Triangle",c,l)}}(be),function(m){var r=m.fabric||(m.fabric={}),c=Math.PI*2;if(r.Ellipse){r.warn("fabric.Ellipse is already defined.");return}r.Ellipse=r.util.createClass(r.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this.set("rx",l&&l.rx||0),this.set("ry",l&&l.ry||0)},_set:function(l,e){switch(this.callSuper("_set",l,e),l){case"rx":this.rx=e,this.set("width",e*2);break;case"ry":this.ry=e,this.set("height",e*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(l){l.beginPath(),l.save(),l.transform(1,0,0,this.ry/this.rx,0,0),l.arc(0,0,this.rx,0,c,!1),l.restore(),this._renderPaintInOrder(l)}}),r.Ellipse.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),r.Ellipse.fromElement=function(l,e){var n=r.parseAttributes(l,r.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,e(new r.Ellipse(n))},r.Ellipse.fromObject=function(l,e){r.Object._fromObject("Ellipse",l,e)}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend;if(r.Rect){r.warn("fabric.Rect is already defined");return}r.Rect=r.util.createClass(r.Object,{stateProperties:r.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(l){var e=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,a=this.width,s=this.height,u=-this.width/2,t=-this.height/2,f=e!==0||n!==0,h=1-.5522847498;l.beginPath(),l.moveTo(u+e,t),l.lineTo(u+a-e,t),f&&l.bezierCurveTo(u+a-h*e,t,u+a,t+h*n,u+a,t+n),l.lineTo(u+a,t+s-n),f&&l.bezierCurveTo(u+a,t+s-h*n,u+a-h*e,t+s,u+a-e,t+s),l.lineTo(u+e,t+s),f&&l.bezierCurveTo(u+h*e,t+s,u,t+s-h*n,u,t+s-n),l.lineTo(u,t+n),f&&l.bezierCurveTo(u,t+h*n,u+h*e,t,u+e,t),l.closePath(),this._renderPaintInOrder(l)},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){var l=-this.width/2,e=-this.height/2;return["<rect ","COMMON_PARTS",'x="',l,'" y="',e,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),r.Rect.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),r.Rect.fromElement=function(l,e,n){if(!l)return e(null);n=n||{};var a=r.parseAttributes(l,r.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var s=new r.Rect(c(n?r.util.object.clone(n):{},a));s.visible=s.visible&&s.width>0&&s.height>0,e(s)},r.Rect.fromObject=function(l,e){return r.Object._fromObject("Rect",l,e)}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.util.array.min,e=r.util.array.max,n=r.util.toFixed,a=r.util.projectStrokeOnPoints;if(r.Polyline){r.warn("fabric.Polyline is already defined");return}r.Polyline=r.util.createClass(r.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:r.Object.prototype.cacheProperties.concat("points"),initialize:function(s,u){u=u||{},this.points=s||[],this.callSuper("initialize",u),this._setPositionDimensions(u)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(s){var u=this._calcDimensions(s),t,f=this.exactBoundingBox?this.strokeWidth:0;this.width=u.width-f,this.height=u.height-f,s.fromSVG||(t=this.translateToGivenOrigin({x:u.left-this.strokeWidth/2+f/2,y:u.top-this.strokeWidth/2+f/2},"left","top",this.originX,this.originY)),typeof s.left=="undefined"&&(this.left=s.fromSVG?u.left:t.x),typeof s.top=="undefined"&&(this.top=s.fromSVG?u.top:t.y),this.pathOffset={x:u.left+this.width/2+f/2,y:u.top+this.height/2+f/2}},_calcDimensions:function(){var s=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,u=l(s,"x")||0,t=l(s,"y")||0,f=e(s,"x")||0,h=e(s,"y")||0,v=f-u,y=h-t;return{left:u,top:t,width:v,height:y}},toObject:function(s){return c(this.callSuper("toObject",s),{points:this.points.concat()})},_toSVG:function(){for(var s=[],u=this.pathOffset.x,t=this.pathOffset.y,f=r.Object.NUM_FRACTION_DIGITS,h=0,v=this.points.length;h<v;h++)s.push(n(this.points[h].x-u,f),",",n(this.points[h].y-t,f)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',s.join(""),`" />
`]},commonRender:function(s){var u,t=this.points.length,f=this.pathOffset.x,h=this.pathOffset.y;if(!t||isNaN(this.points[t-1].y))return!1;s.beginPath(),s.moveTo(this.points[0].x-f,this.points[0].y-h);for(var v=0;v<t;v++)u=this.points[v],s.lineTo(u.x-f,u.y-h);return!0},_render:function(s){!this.commonRender(s)||this._renderPaintInOrder(s)},complexity:function(){return this.get("points").length}}),r.Polyline.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polyline.fromElementGenerator=function(s){return function(u,t,f){if(!u)return t(null);f||(f={});var h=r.parsePointsAttribute(u.getAttribute("points")),v=r.parseAttributes(u,r[s].ATTRIBUTE_NAMES);v.fromSVG=!0,t(new r[s](h,c(v,f)))}},r.Polyline.fromElement=r.Polyline.fromElementGenerator("Polyline"),r.Polyline.fromObject=function(s,u){return r.Object._fromObject("Polyline",s,u,"points")}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.projectStrokeOnPoints;if(r.Polygon){r.warn("fabric.Polygon is already defined");return}r.Polygon=r.util.createClass(r.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(l){!this.commonRender(l)||(l.closePath(),this._renderPaintInOrder(l))}}),r.Polygon.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polygon.fromElement=r.Polyline.fromElementGenerator("Polygon"),r.Polygon.fromObject=function(l,e){r.Object._fromObject("Polygon",l,e,"points")}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.array.min,l=r.util.array.max,e=r.util.object.extend,n=r.util.object.clone,a=r.util.toFixed;if(r.Path){r.warn("fabric.Path is already defined");return}r.Path=r.util.createClass(r.Object,{type:"path",path:null,cacheProperties:r.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:r.Object.prototype.stateProperties.concat("path"),initialize:function(s,u){u=n(u||{}),delete u.path,this.callSuper("initialize",u),this._setPath(s||[],u)},_setPath:function(s,u){this.path=r.util.makePathSimpler(Array.isArray(s)?s:r.util.parsePath(s)),r.Polyline.prototype._setPositionDimensions.call(this,u||{})},_renderPathCommands:function(s){var u,t=0,f=0,h=0,v=0,y=0,p=0,g=-this.pathOffset.x,d=-this.pathOffset.y;s.beginPath();for(var E=0,w=this.path.length;E<w;++E)switch(u=this.path[E],u[0]){case"L":h=u[1],v=u[2],s.lineTo(h+g,v+d);break;case"M":h=u[1],v=u[2],t=h,f=v,s.moveTo(h+g,v+d);break;case"C":h=u[5],v=u[6],y=u[3],p=u[4],s.bezierCurveTo(u[1]+g,u[2]+d,y+g,p+d,h+g,v+d);break;case"Q":s.quadraticCurveTo(u[1]+g,u[2]+d,u[3]+g,u[4]+d),h=u[3],v=u[4],y=u[1],p=u[2];break;case"z":case"Z":h=t,v=f,s.closePath();break}},_render:function(s){this._renderPathCommands(s),this._renderPaintInOrder(s)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(s){return e(this.callSuper("toObject",s),{path:this.path.map(function(u){return u.slice()})})},toDatalessObject:function(s){var u=this.toObject(["sourcePath"].concat(s));return u.sourcePath&&delete u.path,u},_toSVG:function(){var s=r.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',s,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var s=r.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,s)+", "+a(-this.pathOffset.y,s)+")"},toClipPathSVG:function(s){var u=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:u})},toSVG:function(s){var u=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:u})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var s=[],u=[],t,f=0,h=0,v=0,y=0,p,g=0,d=this.path.length;g<d;++g){switch(t=this.path[g],t[0]){case"L":v=t[1],y=t[2],p=[];break;case"M":v=t[1],y=t[2],f=v,h=y,p=[];break;case"C":p=r.util.getBoundsOfCurve(v,y,t[1],t[2],t[3],t[4],t[5],t[6]),v=t[5],y=t[6];break;case"Q":p=r.util.getBoundsOfCurve(v,y,t[1],t[2],t[1],t[2],t[3],t[4]),v=t[3],y=t[4];break;case"z":case"Z":v=f,y=h;break}p.forEach(function(P){s.push(P.x),u.push(P.y)}),s.push(v),u.push(y)}var E=c(s)||0,w=c(u)||0,D=l(s)||0,b=l(u)||0,S=D-E,C=b-w;return{left:E,top:w,width:S,height:C}}}),r.Path.fromObject=function(s,u){if(typeof s.sourcePath=="string"){var t=s.sourcePath;r.loadSVGFromURL(t,function(f){var h=f[0];h.setOptions(s),u&&u(h)})}else r.Object._fromObject("Path",s,u,"path")},r.Path.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(["d"]),r.Path.fromElement=function(s,u,t){var f=r.parseAttributes(s,r.Path.ATTRIBUTE_NAMES);f.fromSVG=!0,u(new r.Path(f.d,e(f,t)))}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.array.min,l=r.util.array.max;r.Group||(r.Group=r.util.createClass(r.Object,r.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(e,n,a){n=n||{},this._objects=[],a&&this.callSuper("initialize",n),this._objects=e||[];for(var s=this._objects.length;s--;)this._objects[s].group=this;if(a)this._updateObjectsACoords();else{var u=n&&n.centerPoint;n.originX!==void 0&&(this.originX=n.originX),n.originY!==void 0&&(this.originY=n.originY),u||this._calcBounds(),this._updateObjectsCoords(u),delete n.centerPoint,this.callSuper("initialize",n)}this.setCoords()},_updateObjectsACoords:function(){for(var e=!0,n=this._objects.length;n--;)this._objects[n].setCoords(e)},_updateObjectsCoords:function(e){for(var e=e||this.getCenterPoint(),n=this._objects.length;n--;)this._updateObjectCoords(this._objects[n],e)},_updateObjectCoords:function(e,n){var a=e.left,s=e.top,u=!0;e.set({left:a-n.x,top:s-n.y}),e.group=this,e.setCoords(u)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(e){var n=!!this.group;return this._restoreObjectsState(),r.util.resetObjectTransform(this),e&&(n&&r.util.removeTransformFromObject(e,this.group.calcTransformMatrix()),this._objects.push(e),e.group=this,e._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(e){return this._restoreObjectsState(),r.util.resetObjectTransform(this),this.remove(e),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(e){this.dirty=!0,e.group=this,e._set("canvas",this.canvas)},_onObjectRemoved:function(e){this.dirty=!0,delete e.group},_set:function(e,n){var a=this._objects.length;if(this.useSetOnGroup)for(;a--;)this._objects[a].setOnGroup(e,n);if(e==="canvas")for(;a--;)this._objects[a]._set(e,n);r.Object.prototype._set.call(this,e,n)},toObject:function(e){var n=this.includeDefaultValues,a=this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){var t=u.includeDefaultValues;u.includeDefaultValues=n;var f=u.toObject(e);return u.includeDefaultValues=t,f}),s=r.Object.prototype.toObject.call(this,e);return s.objects=a,s},toDatalessObject:function(e){var n,a=this.sourcePath;if(a)n=a;else{var s=this.includeDefaultValues;n=this._objects.map(function(t){var f=t.includeDefaultValues;t.includeDefaultValues=s;var h=t.toDatalessObject(e);return t.includeDefaultValues=f,h})}var u=r.Object.prototype.toDatalessObject.call(this,e);return u.objects=n,u},render:function(e){this._transformDone=!0,this.callSuper("render",e),this._transformDone=!1},shouldCache:function(){var e=r.Object.prototype.shouldCache.call(this);if(e){for(var n=0,a=this._objects.length;n<a;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return e},willDrawShadow:function(){if(r.Object.prototype.willDrawShadow.call(this))return!0;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(e){for(var n=0,a=this._objects.length;n<a;n++)this._objects[n].render(e);this._drawClipPath(e,this.clipPath)},isCacheDirty:function(e){if(this.callSuper("isCacheDirty",e))return!0;if(!this.statefullCache)return!1;for(var n=0,a=this._objects.length;n<a;n++)if(this._objects[n].isCacheDirty(!0)){if(this._cacheCanvas){var s=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-s/2,-u/2,s,u)}return!0}return!1},_restoreObjectsState:function(){var e=this.calcOwnMatrix();return this._objects.forEach(function(n){r.util.addTransformToObject(n,e),delete n.group,n.setCoords()}),this},destroy:function(){return this._objects.forEach(function(e){e.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(e){e.dispose&&e.dispose()}),this._objects=[]},toActiveSelection:function(){if(!!this.canvas){var e=this._objects,n=this.canvas;this._objects=[];var a=this.toObject();delete a.objects;var s=new r.ActiveSelection([]);return s.set(a),s.type="activeSelection",n.remove(this),e.forEach(function(u){u.group=s,u.dirty=!0,n.add(u)}),s.canvas=n,s._objects=e,n._activeObject=s,s.setCoords(),s}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var e=!0;return this.forEachObject(function(n){n.setCoords(e)}),this},_calcBounds:function(e){for(var n=[],a=[],s,u,t,f=["tr","br","bl","tl"],h=0,v=this._objects.length,y,p=f.length;h<v;++h){for(s=this._objects[h],t=s.calcACoords(),y=0;y<p;y++)u=f[y],n.push(t[u].x),a.push(t[u].y);s.aCoords=t}this._getBounds(n,a,e)},_getBounds:function(e,n,a){var s=new r.Point(c(e),c(n)),u=new r.Point(l(e),l(n)),t=s.y||0,f=s.x||0,h=u.x-s.x||0,v=u.y-s.y||0;this.width=h,this.height=v,a||this.setPositionByOrigin({x:f,y:t},"left","top")},_toSVG:function(e){for(var n=["<g ","COMMON_PARTS",` >
`],a=0,s=this._objects.length;a<s;a++)n.push("		",this._objects[a].toSVG(e));return n.push(`</g>
`),n},getSvgStyles:function(){var e=typeof this.opacity!="undefined"&&this.opacity!==1?"opacity: "+this.opacity+";":"",n=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),n].join("")},toClipPathSVG:function(e){for(var n=[],a=0,s=this._objects.length;a<s;a++)n.push("	",this._objects[a].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(n,{reviver:e})}}),r.Group.fromObject=function(e,n){var a=e.objects,s=r.util.object.clone(e,!0);if(delete s.objects,typeof a=="string"){r.loadSVGFromURL(a,function(u){var t=r.util.groupSVGElements(u,e,a);t.set(s),n&&n(t)});return}r.util.enlivenObjects(a,function(u){var t=r.util.object.clone(e,!0);delete t.objects,r.util.enlivenObjectEnlivables(e,t,function(){n&&n(new r.Group(u,t,!0))})})})}(be),function(m){var r=m.fabric||(m.fabric={});r.ActiveSelection||(r.ActiveSelection=r.util.createClass(r.Group,{type:"activeSelection",initialize:function(c,l){l=l||{},this._objects=c||[];for(var e=this._objects.length;e--;)this._objects[e].group=this;l.originX&&(this.originX=l.originX),l.originY&&(this.originY=l.originY),this._calcBounds(),this._updateObjectsCoords(),r.Object.prototype.initialize.call(this,l),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var l=r.Object.prototype.toObject.call(this),e=new r.Group([]);if(delete l.type,e.set(l),c.forEach(function(a){a.canvas.remove(a),a.group=e}),e._objects=c,!this.canvas)return e;var n=this.canvas;return n.add(e),n._activeObject=e,e.setCoords(),e},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,l,e){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,l),e=e||{},typeof e.hasControls=="undefined"&&(e.hasControls=!1),e.forActiveSelection=!0;for(var n=0,a=this._objects.length;n<a;n++)this._objects[n]._renderControls(c,e);c.restore()}}),r.ActiveSelection.fromObject=function(c,l){r.util.enlivenObjects(c.objects,function(e){delete c.objects,l&&l(new r.ActiveSelection(e,c,!0))})})}(be),function(m){var r=H.util.object.extend;if(m.fabric||(m.fabric={}),m.fabric.Image){H.warn("fabric.Image is already defined.");return}H.Image=H.util.createClass(H.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:H.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:H.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,l){l||(l={}),this.filters=[],this.cacheKey="texture"+H.Object.__uid++,this.callSuper("initialize",l),this._initElement(c,l)},getElement:function(){return this._element||{}},setElement:function(c,l){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(l),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var l=H.filterBackend;l&&l.evictCachesForKey&&l.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(c){H.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(!(!this.stroke||this.strokeWidth===0)){var l=this.width/2,e=this.height/2;c.beginPath(),c.moveTo(-l,-e),c.lineTo(l,-e),c.lineTo(l,e),c.lineTo(-l,e),c.lineTo(-l,-e),c.closePath()}},toObject:function(c){var l=[];this.filters.forEach(function(n){n&&l.push(n.toObject())});var e=r(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:l});return this.resizeFilter&&(e.resizeFilter=this.resizeFilter.toObject()),e},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c=[],l=[],e,n=this._element,a=-this.width/2,s=-this.height/2,u="",t="";if(!n)return[];if(this.hasCrop()){var f=H.Object.__uid++;c.push('<clipPath id="imageCrop_'+f+`">
`,'	<rect x="'+a+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),u=' clip-path="url(#imageCrop_'+f+')" '}if(this.imageSmoothing||(t='" image-rendering="optimizeSpeed'),l.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',a-this.cropX,'" y="',s-this.cropY,'" width="',n.width||n.naturalWidth,'" height="',n.height||n.height,t,'"',u,`></image>
`),this.stroke||this.strokeDashArray){var h=this.fill;this.fill=null,e=["	<rect ",'x="',a,'" y="',s,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=h}return this.paintFirst!=="fill"?c=c.concat(e,l):c=c.concat(l,e),c},getSrc:function(c){var l=c?this._element:this._originalElement;return l?l.toDataURL?l.toDataURL():this.srcFromAttribute?l.getAttribute("src"):l.src:this.src||""},setSrc:function(c,l,e){return H.util.loadImage(c,function(n,a){this.setElement(n,e),this._setWidthHeight(),l&&l(this,a)},this,e&&e.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,l=this.minimumScaleTrigger,e=this.getTotalObjectScaling(),n=e.scaleX,a=e.scaleY,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||n>l&&a>l){this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,this._lastScaleY=a;return}H.filterBackend||(H.filterBackend=H.initFilterBackend());var u=H.util.createCanvasElement(),t=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,f=s.width,h=s.height;u.width=f,u.height=h,this._element=u,this._lastScaleX=c.scaleX=n,this._lastScaleY=c.scaleY=a,H.filterBackend.applyFilters([c],s,f,h,this._element,t),this._filterScalingX=u.width/this._originalElement.width,this._filterScalingY=u.height/this._originalElement.height},applyFilters:function(c){if(c=c||this.filters||[],c=c.filter(function(s){return s&&!s.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var l=this._originalElement,e=l.naturalWidth||l.width,n=l.naturalHeight||l.height;if(this._element===this._originalElement){var a=H.util.createCanvasElement();a.width=e,a.height=n,this._element=a,this._filteredEl=a}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,e,n),this._lastScaleX=1,this._lastScaleY=1;return H.filterBackend||(H.filterBackend=H.initFilterBackend()),H.filterBackend.applyFilters(c,this._originalElement,e,n,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){H.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){H.util.setImageSmoothing(c,this.imageSmoothing),H.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var l=this._element;if(!!l){var e=this._filterScalingX,n=this._filterScalingY,a=this.width,s=this.height,u=Math.min,t=Math.max,f=t(this.cropX,0),h=t(this.cropY,0),v=l.naturalWidth||l.width,y=l.naturalHeight||l.height,p=f*e,g=h*n,d=u(a*e,v-p),E=u(s*n,y-g),w=-a/2,D=-s/2,b=u(a,v/e-f),S=u(s,y/n-h);l&&c.drawImage(l,p,g,d,E,w,D,b,S)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,l){this.setElement(H.util.getById(c),l),H.util.addClass(this.getElement(),H.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,l){c&&c.length?H.util.enlivenObjects(c,function(e){l&&l(e)},"fabric.Image.filters"):l&&l()},_setWidthHeight:function(c){c||(c={});var l=this.getElement();this.width=c.width||l.naturalWidth||l.width||0,this.height=c.height||l.naturalHeight||l.height||0},parsePreserveAspectRatioAttribute:function(){var c=H.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),l=this._element.width,e=this._element.height,n=1,a=1,s=0,u=0,t=0,f=0,h,v=this.width,y=this.height,p={width:v,height:y};return c&&(c.alignX!=="none"||c.alignY!=="none")?(c.meetOrSlice==="meet"&&(n=a=H.util.findScaleToFit(this._element,p),h=(v-l*n)/2,c.alignX==="Min"&&(s=-h),c.alignX==="Max"&&(s=h),h=(y-e*a)/2,c.alignY==="Min"&&(u=-h),c.alignY==="Max"&&(u=h)),c.meetOrSlice==="slice"&&(n=a=H.util.findScaleToCover(this._element,p),h=l-v/n,c.alignX==="Mid"&&(t=h/2),c.alignX==="Max"&&(t=h),h=e-y/a,c.alignY==="Mid"&&(f=h/2),c.alignY==="Max"&&(f=h),l=v/n,e=y/a)):(n=v/l,a=y/e),{width:l,height:e,scaleX:n,scaleY:a,offsetLeft:s,offsetTop:u,cropX:t,cropY:f}}}),H.Image.CSS_CANVAS="canvas-img",H.Image.prototype.getSvgSrc=H.Image.prototype.getSrc,H.Image.fromObject=function(c,l){var e=H.util.object.clone(c);H.util.loadImage(e.src,function(n,a){if(a){l&&l(null,!0);return}H.Image.prototype._initFilters.call(e,e.filters,function(s){e.filters=s||[],H.Image.prototype._initFilters.call(e,[e.resizeFilter],function(u){e.resizeFilter=u[0],H.util.enlivenObjectEnlivables(e,e,function(){var t=new H.Image(n,e);l(t,!1)})})})},null,e.crossOrigin)},H.Image.fromURL=function(c,l,e){H.util.loadImage(c,function(n,a){l&&l(new H.Image(n,e),a)},null,e&&e.crossOrigin)},H.Image.ATTRIBUTE_NAMES=H.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),H.Image.fromElement=function(c,l,e){var n=H.parseAttributes(c,H.Image.ATTRIBUTE_NAMES);H.Image.fromURL(n["xlink:href"],l,r(e?H.util.object.clone(e):{},n))}}(be),H.util.object.extend(H.Object.prototype,{_getAngleValueForStraighten:function(){var m=this.angle%360;return m>0?Math.round((m-1)/90)*90:Math.round(m/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(m){m=m||{};var r=function(){},c=m.onComplete||r,l=m.onChange||r,e=this;return H.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(n){e.rotate(n),l()},onComplete:function(){e.setCoords(),c()}})}}),H.util.object.extend(H.StaticCanvas.prototype,{straightenObject:function(m){return m.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(m){return m.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function m(c,l){var e="precision "+l+` float;
void main(){}`,n=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(n,e),c.compileShader(n),!!c.getShaderParameter(n,c.COMPILE_STATUS)}H.isWebglSupported=function(c){if(H.isLikelyNode)return!1;c=c||H.WebglFilterBackend.prototype.tileSize;var l=document.createElement("canvas"),e=l.getContext("webgl")||l.getContext("experimental-webgl"),n=!1;if(e){H.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),n=H.maxTextureSize>=c;for(var a=["highp","mediump","lowp"],s=0;s<3;s++)if(m(e,a[s])){H.webGlPrecision=a[s];break}}return this.isSupported=n,n},H.WebglFilterBackend=r;function r(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}r.prototype={tileSize:2048,resources:{},setupGLContext:function(c,l){this.dispose(),this.createWebGLCanvas(c,l),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,l)},chooseFastestCopyGLTo2DMethod:function(c,l){var e=typeof window.performance!="undefined",n;try{new ImageData(1,1),n=!0}catch{n=!1}var a=typeof ArrayBuffer!="undefined",s=typeof Uint8ClampedArray!="undefined";if(!!(e&&n&&a&&s)){var u=H.util.createCanvasElement(),t=new ArrayBuffer(c*l*4);if(H.forceGLPutImageData){this.imageBuffer=t,this.copyGLTo2D=G;return}var f={imageBuffer:t,destinationWidth:c,destinationHeight:l,targetCanvas:u},h,v,y;u.width=c,u.height=l,h=window.performance.now(),F.call(f,this.gl,f),v=window.performance.now()-h,h=window.performance.now(),G.call(f,this.gl,f),y=window.performance.now()-h,v>y?(this.imageBuffer=t,this.copyGLTo2D=G):this.copyGLTo2D=F}},createWebGLCanvas:function(c,l){var e=H.util.createCanvasElement();e.width=c,e.height=l;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},a=e.getContext("webgl",n);a||(a=e.getContext("experimental-webgl",n)),!!a&&(a.clearColor(0,0,0,0),this.canvas=e,this.gl=a)},applyFilters:function(c,l,e,n,a,s){var u=this.gl,t;s&&(t=this.getCachedTexture(s,l));var f={originalWidth:l.width||l.originalWidth,originalHeight:l.height||l.originalHeight,sourceWidth:e,sourceHeight:n,destinationWidth:e,destinationHeight:n,context:u,sourceTexture:this.createTexture(u,e,n,!t&&l),targetTexture:this.createTexture(u,e,n),originalTexture:t||this.createTexture(u,e,n,!t&&l),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},h=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,h),c.forEach(function(v){v&&v.applyTo(f)}),K(f),this.copyGLTo2D(u,f),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(f.sourceTexture),u.deleteTexture(f.targetTexture),u.deleteFramebuffer(h),a.getContext("2d").setTransform(1,0,0,1,0,0),f},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,l,e,n){var a=c.createTexture();return c.bindTexture(c.TEXTURE_2D,a),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),n?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,n):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,l,e,0,c.RGBA,c.UNSIGNED_BYTE,null),a},getCachedTexture:function(c,l){if(this.textureCache[c])return this.textureCache[c];var e=this.createTexture(this.gl,l.width,l.height,l);return this.textureCache[c]=e,e},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:F,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,l={renderer:"",vendor:""};if(!c)return l;var e=c.getExtension("WEBGL_debug_renderer_info");if(e){var n=c.getParameter(e.UNMASKED_RENDERER_WEBGL),a=c.getParameter(e.UNMASKED_VENDOR_WEBGL);n&&(l.renderer=n.toLowerCase()),a&&(l.vendor=a.toLowerCase())}return this.gpuInfo=l,l}}}();function K(m){var r=m.targetCanvas,c=r.width,l=r.height,e=m.destinationWidth,n=m.destinationHeight;(c!==e||l!==n)&&(r.width=e,r.height=n)}function F(m,r){var c=m.canvas,l=r.targetCanvas,e=l.getContext("2d");e.translate(0,l.height),e.scale(1,-1);var n=c.height-l.height;e.drawImage(c,0,n,l.width,l.height,0,0,l.width,l.height)}function G(m,r){var c=r.targetCanvas,l=c.getContext("2d"),e=r.destinationWidth,n=r.destinationHeight,a=e*n*4,s=new Uint8Array(this.imageBuffer,0,a),u=new Uint8ClampedArray(this.imageBuffer,0,a);m.readPixels(0,0,e,n,m.RGBA,m.UNSIGNED_BYTE,s);var t=new ImageData(u,e,n);l.putImageData(t,0,0)}(function(){var m=function(){};H.Canvas2dFilterBackend=r;function r(){}r.prototype={evictCachesForKey:m,dispose:m,clearWebGLCaches:m,resources:{},applyFilters:function(c,l,e,n,a){var s=a.getContext("2d");s.drawImage(l,0,0,e,n);var u=s.getImageData(0,0,e,n),t=s.getImageData(0,0,e,n),f={sourceWidth:e,sourceHeight:n,imageData:u,originalEl:l,originalImageData:t,canvasEl:a,ctx:s,filterBackend:this};return c.forEach(function(h){h.applyTo(f)}),(f.imageData.width!==e||f.imageData.height!==n)&&(a.width=f.imageData.width,a.height=f.imageData.height),s.putImageData(f.imageData,0,0),f}}})(),H.Image=H.Image||{},H.Image.filters=H.Image.filters||{},H.Image.filters.BaseFilter=H.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(m){m&&this.setOptions(m)},setOptions:function(m){for(var r in m)this[r]=m[r]},createProgram:function(m,r,c){r=r||this.fragmentSource,c=c||this.vertexSource,H.webGlPrecision!=="highp"&&(r=r.replace(/precision highp float/g,"precision "+H.webGlPrecision+" float"));var l=m.createShader(m.VERTEX_SHADER);if(m.shaderSource(l,c),m.compileShader(l),!m.getShaderParameter(l,m.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+m.getShaderInfoLog(l));var e=m.createShader(m.FRAGMENT_SHADER);if(m.shaderSource(e,r),m.compileShader(e),!m.getShaderParameter(e,m.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+m.getShaderInfoLog(e));var n=m.createProgram();if(m.attachShader(n,l),m.attachShader(n,e),m.linkProgram(n),!m.getProgramParameter(n,m.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+m.getProgramInfoLog(n));var a=this.getAttributeLocations(m,n),s=this.getUniformLocations(m,n)||{};return s.uStepW=m.getUniformLocation(n,"uStepW"),s.uStepH=m.getUniformLocation(n,"uStepH"),{program:n,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(m,r){return{aPosition:m.getAttribLocation(r,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(m,r,c){var l=r.aPosition,e=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,e),m.enableVertexAttribArray(l),m.vertexAttribPointer(l,2,m.FLOAT,!1,0,0),m.bufferData(m.ARRAY_BUFFER,c,m.STATIC_DRAW)},_setupFrameBuffer:function(m){var r=m.context,c,l;m.passes>1?(c=m.destinationWidth,l=m.destinationHeight,(m.sourceWidth!==c||m.sourceHeight!==l)&&(r.deleteTexture(m.targetTexture),m.targetTexture=m.filterBackend.createTexture(r,c,l)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,m.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(m){m.passes--,m.pass++;var r=m.targetTexture;m.targetTexture=m.sourceTexture,m.sourceTexture=r},isNeutralState:function(){var m=this.mainParameter,r=H.Image.filters[this.type].prototype;if(m)if(Array.isArray(r[m])){for(var c=r[m].length;c--;)if(this[m][c]!==r[m][c])return!1;return!0}else return r[m]===this[m];else return!1},applyTo:function(m){m.webgl?(this._setupFrameBuffer(m),this.applyToWebGL(m),this._swapTextures(m)):this.applyTo2d(m)},retrieveShader:function(m){return m.programCache.hasOwnProperty(this.type)||(m.programCache[this.type]=this.createProgram(m.context)),m.programCache[this.type]},applyToWebGL:function(m){var r=m.context,c=this.retrieveShader(m);m.pass===0&&m.originalTexture?r.bindTexture(r.TEXTURE_2D,m.originalTexture):r.bindTexture(r.TEXTURE_2D,m.sourceTexture),r.useProgram(c.program),this.sendAttributeData(r,c.attributeLocations,m.aPosition),r.uniform1f(c.uniformLocations.uStepW,1/m.sourceWidth),r.uniform1f(c.uniformLocations.uStepH,1/m.sourceHeight),this.sendUniformData(r,c.uniformLocations),r.viewport(0,0,m.destinationWidth,m.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(m,r,c){m.activeTexture(c),m.bindTexture(m.TEXTURE_2D,r),m.activeTexture(m.TEXTURE0)},unbindAdditionalTexture:function(m,r){m.activeTexture(r),m.bindTexture(m.TEXTURE_2D,null),m.activeTexture(m.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(m){this[this.mainParameter]=m},sendUniformData:function(){},createHelpLayer:function(m){if(!m.helpLayer){var r=document.createElement("canvas");r.width=m.sourceWidth,r.height=m.sourceHeight,m.helpLayer=r}},toObject:function(){var m={type:this.type},r=this.mainParameter;return r&&(m[r]=this[r]),m},toJSON:function(){return this.toObject()}}),H.Image.filters.BaseFilter.fromObject=function(m,r){var c=new H.Image.filters[m.type](m);return r&&r(c),c},function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.ColorMatrix=l(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(e){this.callSuper("initialize",e),this.matrix=this.matrix.slice(0)},applyTo2d:function(e){var n=e.imageData,a=n.data,s=a.length,u=this.matrix,t,f,h,v,y,p=this.colorsOnly;for(y=0;y<s;y+=4)t=a[y],f=a[y+1],h=a[y+2],p?(a[y]=t*u[0]+f*u[1]+h*u[2]+u[4]*255,a[y+1]=t*u[5]+f*u[6]+h*u[7]+u[9]*255,a[y+2]=t*u[10]+f*u[11]+h*u[12]+u[14]*255):(v=a[y+3],a[y]=t*u[0]+f*u[1]+h*u[2]+v*u[3]+u[4]*255,a[y+1]=t*u[5]+f*u[6]+h*u[7]+v*u[8]+u[9]*255,a[y+2]=t*u[10]+f*u[11]+h*u[12]+v*u[13]+u[14]*255,a[y+3]=t*u[15]+f*u[16]+h*u[17]+v*u[18]+u[19]*255)},getUniformLocations:function(e,n){return{uColorMatrix:e.getUniformLocation(n,"uColorMatrix"),uConstants:e.getUniformLocation(n,"uConstants")}},sendUniformData:function(e,n){var a=this.matrix,s=[a[0],a[1],a[2],a[3],a[5],a[6],a[7],a[8],a[10],a[11],a[12],a[13],a[15],a[16],a[17],a[18]],u=[a[4],a[9],a[14],a[19]];e.uniformMatrix4fv(n.uColorMatrix,!1,s),e.uniform4fv(n.uConstants,u)}}),r.Image.filters.ColorMatrix.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Brightness=l(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(e){if(this.brightness!==0){var n=e.imageData,a=n.data,s,u=a.length,t=Math.round(this.brightness*255);for(s=0;s<u;s+=4)a[s]=a[s]+t,a[s+1]=a[s+1]+t,a[s+2]=a[s+2]+t}},getUniformLocations:function(e,n){return{uBrightness:e.getUniformLocation(n,"uBrightness")}},sendUniformData:function(e,n){e.uniform1f(n.uBrightness,this.brightness)}}),r.Image.filters.Brightness.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.Image.filters,e=r.util.createClass;l.Convolute=e(l.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(n){var a=Math.sqrt(this.matrix.length),s=this.type+"_"+a+"_"+(this.opaque?1:0),u=this.fragmentSource[s];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,u)),n.programCache[s]},applyTo2d:function(n){var a=n.imageData,s=a.data,u=this.matrix,t=Math.round(Math.sqrt(u.length)),f=Math.floor(t/2),h=a.width,v=a.height,y=n.ctx.createImageData(h,v),p=y.data,g=this.opaque?1:0,d,E,w,D,b,S,C,P,R,L,O,_,x;for(O=0;O<v;O++)for(L=0;L<h;L++){for(b=(O*h+L)*4,d=0,E=0,w=0,D=0,x=0;x<t;x++)for(_=0;_<t;_++)C=O+x-f,S=L+_-f,!(C<0||C>=v||S<0||S>=h)&&(P=(C*h+S)*4,R=u[x*t+_],d+=s[P]*R,E+=s[P+1]*R,w+=s[P+2]*R,g||(D+=s[P+3]*R));p[b]=d,p[b+1]=E,p[b+2]=w,g?p[b+3]=s[b+3]:p[b+3]=D}n.imageData=y},getUniformLocations:function(n,a){return{uMatrix:n.getUniformLocation(a,"uMatrix"),uOpaque:n.getUniformLocation(a,"uOpaque"),uHalfSize:n.getUniformLocation(a,"uHalfSize"),uSize:n.getUniformLocation(a,"uSize")}},sendUniformData:function(n,a){n.uniform1fv(a.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),r.Image.filters.Convolute.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Grayscale=l(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(e){var n=e.imageData,a=n.data,s,u=a.length,t,f=this.mode;for(s=0;s<u;s+=4)f==="average"?t=(a[s]+a[s+1]+a[s+2])/3:f==="lightness"?t=(Math.min(a[s],a[s+1],a[s+2])+Math.max(a[s],a[s+1],a[s+2]))/2:f==="luminosity"&&(t=.21*a[s]+.72*a[s+1]+.07*a[s+2]),a[s]=t,a[s+1]=t,a[s+2]=t},retrieveShader:function(e){var n=this.type+"_"+this.mode;if(!e.programCache.hasOwnProperty(n)){var a=this.fragmentSource[this.mode];e.programCache[n]=this.createProgram(e.context,a)}return e.programCache[n]},getUniformLocations:function(e,n){return{uMode:e.getUniformLocation(n,"uMode")}},sendUniformData:function(e,n){var a=1;e.uniform1i(n.uMode,a)},isNeutralState:function(){return!1}}),r.Image.filters.Grayscale.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Invert=l(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(e){var n=e.imageData,a=n.data,s,u=a.length;for(s=0;s<u;s+=4)a[s]=255-a[s],a[s+1]=255-a[s+1],a[s+2]=255-a[s+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(e,n){return{uInvert:e.getUniformLocation(n,"uInvert")}},sendUniformData:function(e,n){e.uniform1i(n.uInvert,this.invert)}}),r.Image.filters.Invert.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.Image.filters,e=r.util.createClass;l.Noise=e(l.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(n){if(this.noise!==0){var a=n.imageData,s=a.data,u,t=s.length,f=this.noise,h;for(u=0,t=s.length;u<t;u+=4)h=(.5-Math.random())*f,s[u]+=h,s[u+1]+=h,s[u+2]+=h}},getUniformLocations:function(n,a){return{uNoise:n.getUniformLocation(a,"uNoise"),uSeed:n.getUniformLocation(a,"uSeed")}},sendUniformData:function(n,a){n.uniform1f(a.uNoise,this.noise/255),n.uniform1f(a.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),r.Image.filters.Noise.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Pixelate=l(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(e){var n=e.imageData,a=n.data,s=n.height,u=n.width,t,f,h,v,y,p,g,d,E,w,D;for(f=0;f<s;f+=this.blocksize)for(h=0;h<u;h+=this.blocksize)for(t=f*4*u+h*4,v=a[t],y=a[t+1],p=a[t+2],g=a[t+3],w=Math.min(f+this.blocksize,s),D=Math.min(h+this.blocksize,u),d=f;d<w;d++)for(E=h;E<D;E++)t=d*4*u+E*4,a[t]=v,a[t+1]=y,a[t+2]=p,a[t+3]=g},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(e,n){return{uBlocksize:e.getUniformLocation(n,"uBlocksize"),uStepW:e.getUniformLocation(n,"uStepW"),uStepH:e.getUniformLocation(n,"uStepH")}},sendUniformData:function(e,n){e.uniform1f(n.uBlocksize,this.blocksize)}}),r.Image.filters.Pixelate.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.extend,l=r.Image.filters,e=r.util.createClass;l.RemoveColor=e(l.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(n){var a=n.imageData,s=a.data,u,t=this.distance*255,f,h,v,y=new r.Color(this.color).getSource(),p=[y[0]-t,y[1]-t,y[2]-t],g=[y[0]+t,y[1]+t,y[2]+t];for(u=0;u<s.length;u+=4)f=s[u],h=s[u+1],v=s[u+2],f>p[0]&&h>p[1]&&v>p[2]&&f<g[0]&&h<g[1]&&v<g[2]&&(s[u+3]=0)},getUniformLocations:function(n,a){return{uLow:n.getUniformLocation(a,"uLow"),uHigh:n.getUniformLocation(a,"uHigh")}},sendUniformData:function(n,a){var s=new r.Color(this.color).getSource(),u=parseFloat(this.distance),t=[0+s[0]/255-u,0+s[1]/255-u,0+s[2]/255-u,1],f=[s[0]/255+u,s[1]/255+u,s[2]/255+u,1];n.uniform4fv(a.uLow,t),n.uniform4fv(a.uHigh,f)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),r.Image.filters.RemoveColor.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass,e={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var n in e)c[n]=l(c.ColorMatrix,{type:n,matrix:e[n],mainParameter:!1,colorsOnly:!0}),r.Image.filters[n].fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric,c=r.Image.filters,l=r.util.createClass;c.BlendColor=l(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(e){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[e]+`}
}`},retrieveShader:function(e){var n=this.type+"_"+this.mode,a;return e.programCache.hasOwnProperty(n)||(a=this.buildSource(this.mode),e.programCache[n]=this.createProgram(e.context,a)),e.programCache[n]},applyTo2d:function(e){var n=e.imageData,a=n.data,s=a.length,u,t,f,h,v,y,p,g=1-this.alpha;p=new r.Color(this.color).getSource(),u=p[0]*this.alpha,t=p[1]*this.alpha,f=p[2]*this.alpha;for(var d=0;d<s;d+=4)switch(h=a[d],v=a[d+1],y=a[d+2],this.mode){case"multiply":a[d]=h*u/255,a[d+1]=v*t/255,a[d+2]=y*f/255;break;case"screen":a[d]=255-(255-h)*(255-u)/255,a[d+1]=255-(255-v)*(255-t)/255,a[d+2]=255-(255-y)*(255-f)/255;break;case"add":a[d]=h+u,a[d+1]=v+t,a[d+2]=y+f;break;case"diff":case"difference":a[d]=Math.abs(h-u),a[d+1]=Math.abs(v-t),a[d+2]=Math.abs(y-f);break;case"subtract":a[d]=h-u,a[d+1]=v-t,a[d+2]=y-f;break;case"darken":a[d]=Math.min(h,u),a[d+1]=Math.min(v,t),a[d+2]=Math.min(y,f);break;case"lighten":a[d]=Math.max(h,u),a[d+1]=Math.max(v,t),a[d+2]=Math.max(y,f);break;case"overlay":a[d]=u<128?2*h*u/255:255-2*(255-h)*(255-u)/255,a[d+1]=t<128?2*v*t/255:255-2*(255-v)*(255-t)/255,a[d+2]=f<128?2*y*f/255:255-2*(255-y)*(255-f)/255;break;case"exclusion":a[d]=u+h-2*u*h/255,a[d+1]=t+v-2*t*v/255,a[d+2]=f+y-2*f*y/255;break;case"tint":a[d]=u+h*g,a[d+1]=t+v*g,a[d+2]=f+y*g}},getUniformLocations:function(e,n){return{uColor:e.getUniformLocation(n,"uColor")}},sendUniformData:function(e,n){var a=new r.Color(this.color).getSource();a[0]=this.alpha*a[0]/255,a[1]=this.alpha*a[1]/255,a[2]=this.alpha*a[2]/255,a[3]=this.alpha,e.uniform4fv(n.uColor,a)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendColor.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric,c=r.Image.filters,l=r.util.createClass;c.BlendImage=l(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(e){var n=this.type+"_"+this.mode,a=this.fragmentSource[this.mode];return e.programCache.hasOwnProperty(n)||(e.programCache[n]=this.createProgram(e.context,a)),e.programCache[n]},applyToWebGL:function(e){var n=e.context,a=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(n,a,n.TEXTURE1),this.callSuper("applyToWebGL",e),this.unbindAdditionalTexture(n,n.TEXTURE1)},createTexture:function(e,n){return e.getCachedTexture(n.cacheKey,n._element)},calculateMatrix:function(){var e=this.image,n=e._element.width,a=e._element.height;return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/n,-e.top/a,1]},applyTo2d:function(e){var n=e.imageData,a=e.filterBackend.resources,s=n.data,u=s.length,t=n.width,f=n.height,h,v,y,p,g,d,E,w,D,b,S=this.image,C;a.blendImage||(a.blendImage=r.util.createCanvasElement()),D=a.blendImage,b=D.getContext("2d"),D.width!==t||D.height!==f?(D.width=t,D.height=f):b.clearRect(0,0,t,f),b.setTransform(S.scaleX,0,0,S.scaleY,S.left,S.top),b.drawImage(S._element,0,0,t,f),C=b.getImageData(0,0,t,f).data;for(var P=0;P<u;P+=4)switch(g=s[P],d=s[P+1],E=s[P+2],w=s[P+3],h=C[P],v=C[P+1],y=C[P+2],p=C[P+3],this.mode){case"multiply":s[P]=g*h/255,s[P+1]=d*v/255,s[P+2]=E*y/255,s[P+3]=w*p/255;break;case"mask":s[P+3]=p;break}},getUniformLocations:function(e,n){return{uTransformMatrix:e.getUniformLocation(n,"uTransformMatrix"),uImage:e.getUniformLocation(n,"uImage")}},sendUniformData:function(e,n){var a=this.calculateMatrix();e.uniform1i(n.uImage,1),e.uniformMatrix3fv(n.uTransformMatrix,!1,a)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendImage.fromObject=function(e,n){r.Image.fromObject(e.image,function(a){var s=r.util.object.clone(e);s.image=a,n(new r.Image.filters.BlendImage(s))})}}(be),function(m){var r=m.fabric||(m.fabric={}),c=Math.pow,l=Math.floor,e=Math.sqrt,n=Math.abs,a=Math.round,s=Math.sin,u=Math.ceil,t=r.Image.filters,f=r.util.createClass;t.Resize=f(t.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(h,v){return{uDelta:h.getUniformLocation(v,"uDelta"),uTaps:h.getUniformLocation(v,"uTaps")}},sendUniformData:function(h,v){h.uniform2fv(v.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),h.uniform1fv(v.uTaps,this.taps)},retrieveShader:function(h){var v=this.getFilterWindow(),y=this.type+"_"+v;if(!h.programCache.hasOwnProperty(y)){var p=this.generateShader(v);h.programCache[y]=this.createProgram(h.context,p)}return h.programCache[y]},getFilterWindow:function(){var h=this.tempScale;return Math.ceil(this.lanczosLobes/h)},getTaps:function(){for(var h=this.lanczosCreate(this.lanczosLobes),v=this.tempScale,y=this.getFilterWindow(),p=new Array(y),g=1;g<=y;g++)p[g-1]=h(g*v);return p},generateShader:function(h){for(var v=new Array(h),y=this.fragmentSourceTOP,h,p=1;p<=h;p++)v[p-1]=p+".0 * uDelta";return y+="uniform float uTaps["+h+`];
`,y+=`void main() {
`,y+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,y+=`  float sum = 1.0;
`,v.forEach(function(g,d){y+="  color += texture2D(uTexture, vTexCoord + "+g+") * uTaps["+d+`];
`,y+="  color += texture2D(uTexture, vTexCoord - "+g+") * uTaps["+d+`];
`,y+="  sum += 2.0 * uTaps["+d+`];
`}),y+=`  gl_FragColor = color / sum;
`,y+="}",y},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(h){h.webgl?(h.passes++,this.width=h.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=h.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),h.destinationWidth=this.dW,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceWidth=h.destinationWidth,this.height=h.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),h.destinationHeight=this.dH,this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h),h.sourceHeight=h.destinationHeight):this.applyTo2d(h)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(h){return function(v){if(v>=h||v<=-h)return 0;if(v<11920929e-14&&v>-11920929e-14)return 1;v*=Math.PI;var y=v/h;return s(v)/v*s(y)/y}},applyTo2d:function(h){var v=h.imageData,y=this.scaleX,p=this.scaleY;this.rcpScaleX=1/y,this.rcpScaleY=1/p;var g=v.width,d=v.height,E=a(g*y),w=a(d*p),D;this.resizeType==="sliceHack"?D=this.sliceByTwo(h,g,d,E,w):this.resizeType==="hermite"?D=this.hermiteFastResize(h,g,d,E,w):this.resizeType==="bilinear"?D=this.bilinearFiltering(h,g,d,E,w):this.resizeType==="lanczos"&&(D=this.lanczosResize(h,g,d,E,w)),h.imageData=D},sliceByTwo:function(h,v,y,p,g){var d=h.imageData,E=.5,w=!1,D=!1,b=v*E,S=y*E,C=r.filterBackend.resources,P,R,L=0,O=0,_=v,x=0;for(C.sliceByTwo||(C.sliceByTwo=document.createElement("canvas")),P=C.sliceByTwo,(P.width<v*1.5||P.height<y)&&(P.width=v*1.5,P.height=y),R=P.getContext("2d"),R.clearRect(0,0,v*1.5,y),R.putImageData(d,0,0),p=l(p),g=l(g);!w||!D;)v=b,y=S,p<l(b*E)?b=l(b*E):(b=p,w=!0),g<l(S*E)?S=l(S*E):(S=g,D=!0),R.drawImage(P,L,O,v,y,_,x,b,S),L=_,O=x,x+=S;return R.getImageData(L,O,p,g)},lanczosResize:function(h,v,y,p,g){function d(k){var M,N,U,j,z,J,te,re,oe,se,me;for(x.x=(k+.5)*S,A.x=l(x.x),M=0;M<g;M++){for(x.y=(M+.5)*C,A.y=l(x.y),z=0,J=0,te=0,re=0,oe=0,N=A.x-L;N<=A.x+L;N++)if(!(N<0||N>=v)){se=l(1e3*n(N-x.x)),_[se]||(_[se]={});for(var fe=A.y-O;fe<=A.y+O;fe++)fe<0||fe>=y||(me=l(1e3*n(fe-x.y)),_[se][me]||(_[se][me]=b(e(c(se*P,2)+c(me*R,2))/1e3)),U=_[se][me],U>0&&(j=(fe*v+N)*4,z+=U,J+=U*E[j],te+=U*E[j+1],re+=U*E[j+2],oe+=U*E[j+3]))}j=(M*p+k)*4,D[j]=J/z,D[j+1]=te/z,D[j+2]=re/z,D[j+3]=oe/z}return++k<p?d(k):w}var E=h.imageData.data,w=h.ctx.createImageData(p,g),D=w.data,b=this.lanczosCreate(this.lanczosLobes),S=this.rcpScaleX,C=this.rcpScaleY,P=2/this.rcpScaleX,R=2/this.rcpScaleY,L=u(S*this.lanczosLobes/2),O=u(C*this.lanczosLobes/2),_={},x={},A={};return d(0)},bilinearFiltering:function(h,v,y,p,g){var d,E,w,D,b,S,C,P,R,L,O,_,x=0,A,k=this.rcpScaleX,M=this.rcpScaleY,N=4*(v-1),U=h.imageData,j=U.data,z=h.ctx.createImageData(p,g),J=z.data;for(C=0;C<g;C++)for(P=0;P<p;P++)for(b=l(k*P),S=l(M*C),R=k*P-b,L=M*C-S,A=4*(S*v+b),O=0;O<4;O++)d=j[A+O],E=j[A+4+O],w=j[A+N+O],D=j[A+N+4+O],_=d*(1-R)*(1-L)+E*R*(1-L)+w*L*(1-R)+D*R*L,J[x++]=_;return z},hermiteFastResize:function(h,v,y,p,g){for(var d=this.rcpScaleX,E=this.rcpScaleY,w=u(d/2),D=u(E/2),b=h.imageData,S=b.data,C=h.ctx.createImageData(p,g),P=C.data,R=0;R<g;R++)for(var L=0;L<p;L++){for(var O=(L+R*p)*4,_=0,x=0,A=0,k=0,M=0,N=0,U=0,j=(R+.5)*E,z=l(R*E);z<(R+1)*E;z++)for(var J=n(j-(z+.5))/D,te=(L+.5)*d,re=J*J,oe=l(L*d);oe<(L+1)*d;oe++){var se=n(te-(oe+.5))/w,me=e(re+se*se);me>1&&me<-1||(_=2*me*me*me-3*me*me+1,_>0&&(se=4*(oe+z*v),U+=_*S[se+3],A+=_,S[se+3]<255&&(_=_*S[se+3]/250),k+=_*S[se],M+=_*S[se+1],N+=_*S[se+2],x+=_))}P[O]=k/x,P[O+1]=M/x,P[O+2]=N/x,P[O+3]=U/A}return C},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),r.Image.filters.Resize.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Contrast=l(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(e){if(this.contrast!==0){var n=e.imageData,a,s,u=n.data,s=u.length,t=Math.floor(this.contrast*255),f=259*(t+255)/(255*(259-t));for(a=0;a<s;a+=4)u[a]=f*(u[a]-128)+128,u[a+1]=f*(u[a+1]-128)+128,u[a+2]=f*(u[a+2]-128)+128}},getUniformLocations:function(e,n){return{uContrast:e.getUniformLocation(n,"uContrast")}},sendUniformData:function(e,n){e.uniform1f(n.uContrast,this.contrast)}}),r.Image.filters.Contrast.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Saturation=l(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(e){if(this.saturation!==0){var n=e.imageData,a=n.data,s=a.length,u=-this.saturation,t,f;for(t=0;t<s;t+=4)f=Math.max(a[t],a[t+1],a[t+2]),a[t]+=f!==a[t]?(f-a[t])*u:0,a[t+1]+=f!==a[t+1]?(f-a[t+1])*u:0,a[t+2]+=f!==a[t+2]?(f-a[t+2])*u:0}},getUniformLocations:function(e,n){return{uSaturation:e.getUniformLocation(n,"uSaturation")}},sendUniformData:function(e,n){e.uniform1f(n.uSaturation,-this.saturation)}}),r.Image.filters.Saturation.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Vibrance=l(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(e){if(this.vibrance!==0){var n=e.imageData,a=n.data,s=a.length,u=-this.vibrance,t,f,h,v;for(t=0;t<s;t+=4)f=Math.max(a[t],a[t+1],a[t+2]),h=(a[t]+a[t+1]+a[t+2])/3,v=Math.abs(f-h)*2/255*u,a[t]+=f!==a[t]?(f-a[t])*v:0,a[t+1]+=f!==a[t+1]?(f-a[t+1])*v:0,a[t+2]+=f!==a[t+2]?(f-a[t+2])*v:0}},getUniformLocations:function(e,n){return{uVibrance:e.getUniformLocation(n,"uVibrance")}},sendUniformData:function(e,n){e.uniform1f(n.uVibrance,-this.vibrance)}}),r.Image.filters.Vibrance.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Blur=l(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(e){e.webgl?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},applyTo2d:function(e){e.imageData=this.simpleBlur(e)},simpleBlur:function(e){var n=e.filterBackend.resources,a,s,u=e.imageData.width,t=e.imageData.height;n.blurLayer1||(n.blurLayer1=r.util.createCanvasElement(),n.blurLayer2=r.util.createCanvasElement()),a=n.blurLayer1,s=n.blurLayer2,(a.width!==u||a.height!==t)&&(s.width=a.width=u,s.height=a.height=t);var f=a.getContext("2d"),h=s.getContext("2d"),v=15,y,p,g,d,E=this.blur*.06*.5;for(f.putImageData(e.imageData,0,0),h.clearRect(0,0,u,t),d=-v;d<=v;d++)y=(Math.random()-.5)/4,p=d/v,g=E*p*u+y,h.globalAlpha=1-Math.abs(p),h.drawImage(a,g,y),f.drawImage(s,0,0),h.globalAlpha=1,h.clearRect(0,0,s.width,s.height);for(d=-v;d<=v;d++)y=(Math.random()-.5)/4,p=d/v,g=E*p*t+y,h.globalAlpha=1-Math.abs(p),h.drawImage(a,y,g),f.drawImage(s,0,0),h.globalAlpha=1,h.clearRect(0,0,s.width,s.height);e.ctx.drawImage(a,0,0);var w=e.ctx.getImageData(0,0,a.width,a.height);return f.globalAlpha=1,f.clearRect(0,0,a.width,a.height),w},getUniformLocations:function(e,n){return{delta:e.getUniformLocation(n,"uDelta")}},sendUniformData:function(e,n){var a=this.chooseRightDelta();e.uniform2fv(n.delta,a)},chooseRightDelta:function(){var e=1,n=[0,0],a;return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),a=e*this.blur*.12,this.horizontal?n[0]=a:n[1]=a,n}}),c.Blur.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Gamma=l(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(e){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,e)},applyTo2d:function(e){var n=e.imageData,a=n.data,s=this.gamma,u=a.length,t=1/s[0],f=1/s[1],h=1/s[2],v;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),v=0,u=256;v<u;v++)this.rVals[v]=Math.pow(v/255,t)*255,this.gVals[v]=Math.pow(v/255,f)*255,this.bVals[v]=Math.pow(v/255,h)*255;for(v=0,u=a.length;v<u;v+=4)a[v]=this.rVals[a[v]],a[v+1]=this.gVals[a[v+1]],a[v+2]=this.bVals[a[v+2]]},getUniformLocations:function(e,n){return{uGamma:e.getUniformLocation(n,"uGamma")}},sendUniformData:function(e,n){e.uniform3fv(n.uGamma,this.gamma)}}),r.Image.filters.Gamma.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.Composed=l(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(e){this.callSuper("initialize",e),this.subFilters=this.subFilters.slice(0)},applyTo:function(e){e.passes+=this.subFilters.length-1,this.subFilters.forEach(function(n){n.applyTo(e)})},toObject:function(){return r.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(e){return e.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(e){return!e.isNeutralState()})}}),r.Image.filters.Composed.fromObject=function(e,n){var a=e.subFilters||[],s=a.map(function(t){return new r.Image.filters[t.type](t)}),u=new r.Image.filters.Composed({subFilters:s});return n&&n(u),u}}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.Image.filters,l=r.util.createClass;c.HueRotation=l(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var e=this.rotation*Math.PI,n=r.util.cos(e),a=r.util.sin(e),s=1/3,u=Math.sqrt(s)*a,t=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+t/3,this.matrix[1]=s*t-u,this.matrix[2]=s*t+u,this.matrix[5]=s*t+u,this.matrix[6]=n+s*t,this.matrix[7]=s*t-u,this.matrix[10]=s*t-u,this.matrix[11]=s*t+u,this.matrix[12]=n+s*t},isNeutralState:function(e){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,e)},applyTo:function(e){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,e)}}),r.Image.filters.HueRotation.fromObject=r.Image.filters.BaseFilter.fromObject}(be),function(m){var r=m.fabric||(m.fabric={}),c=r.util.object.clone;if(r.Text){r.warn("fabric.Text is already defined");return}var l="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");r.Text=r.util.createClass(r.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:r.Object.prototype.stateProperties.concat(l),cacheProperties:r.Object.prototype.cacheProperties.concat(l),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(e,n){this.styles=n?n.styles||{}:{},this.text=e,this.__skipDimension=!0,this.callSuper("initialize",n),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var e=this.path;e&&(e.segmentsInfo=r.util.getPathSegmentsInfo(e.path))},getMeasuringContext:function(){return r._measuringContext||(r._measuringContext=this.canvas&&this.canvas.contextCache||r.util.createCanvasElement().getContext("2d")),r._measuringContext},_splitText:function(){var e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var e,n,a,s,u,t,f,h=0,v=this._textLines.length;h<v;h++)if(!(this.textAlign!=="justify"&&(h===v-1||this.isEndOfWrapping(h)))&&(s=0,u=this._textLines[h],n=this.getLineWidth(h),n<this.width&&(f=this.textLines[h].match(this._reSpacesAndTabs)))){a=f.length,e=(this.width-n)/a;for(var y=0,p=u.length;y<=p;y++)t=this.__charBounds[h][y],this._reSpaceAndTab.test(u[y])?(t.width+=e,t.kernedWidth+=e,t.left+=s,s+=e):t.left+=s}},isEndOfWrapping:function(e){return e===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var e=this.callSuper("_getCacheCanvasDimensions"),n=this.fontSize;return e.width+=n*e.zoomX,e.height+=n*e.zoomY,e},_render:function(e){var n=this.path;n&&!n.isNotVisible()&&n._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")},_renderText:function(e){this.paintFirst==="stroke"?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))},_setTextStyles:function(e,n,a){if(e.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":e.textBaseline="middle";break;case"ascender":e.textBaseline="top";break;case"descender":e.textBaseline="bottom";break}e.font=this._getFontDeclaration(n,a)},calcTextWidth:function(){for(var e=this.getLineWidth(0),n=1,a=this._textLines.length;n<a;n++){var s=this.getLineWidth(n);s>e&&(e=s)}return e},_renderTextLine:function(e,n,a,s,u,t){this._renderChars(e,n,a,s,u,t)},_renderTextLinesBackground:function(e){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var n,a,s=e.fillStyle,u,t,f=this._getLeftOffset(),h=this._getTopOffset(),v=0,y=0,p,g,d=this.path,E,w=0,D=this._textLines.length;w<D;w++){if(n=this.getHeightOfLine(w),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",w)){h+=n;continue}u=this._textLines[w],a=this._getLineLeftOffset(w),y=0,v=0,t=this.getValueOfPropertyAt(w,0,"textBackgroundColor");for(var b=0,S=u.length;b<S;b++)p=this.__charBounds[w][b],g=this.getValueOfPropertyAt(w,b,"textBackgroundColor"),d?(e.save(),e.translate(p.renderLeft,p.renderTop),e.rotate(p.angle),e.fillStyle=g,g&&e.fillRect(-p.width/2,-n/this.lineHeight*(1-this._fontSizeFraction),p.width,n/this.lineHeight),e.restore()):g!==t?(E=f+a+v,this.direction==="rtl"&&(E=this.width-E-y),e.fillStyle=t,t&&e.fillRect(E,h,y,n/this.lineHeight),v=p.left,y=p.width,t=g):y+=p.kernedWidth;g&&!d&&(E=f+a+v,this.direction==="rtl"&&(E=this.width-E-y),e.fillStyle=g,e.fillRect(E,h,y,n/this.lineHeight)),h+=n}e.fillStyle=s,this._removeShadow(e)}},getFontCache:function(e){var n=e.fontFamily.toLowerCase();r.charWidthsCache[n]||(r.charWidthsCache[n]={});var a=r.charWidthsCache[n],s=e.fontStyle.toLowerCase()+"_"+(e.fontWeight+"").toLowerCase();return a[s]||(a[s]={}),a[s]},_measureChar:function(e,n,a,s){var u=this.getFontCache(n),t=this._getFontDeclaration(n),f=this._getFontDeclaration(s),h=a+e,v=t===f,y,p,g,d=n.fontSize/this.CACHE_FONT_SIZE,E;if(a&&u[a]!==void 0&&(g=u[a]),u[e]!==void 0&&(E=y=u[e]),v&&u[h]!==void 0&&(p=u[h],E=p-g),y===void 0||g===void 0||p===void 0){var w=this.getMeasuringContext();this._setTextStyles(w,n,!0)}return y===void 0&&(E=y=w.measureText(e).width,u[e]=y),g===void 0&&v&&a&&(g=w.measureText(a).width,u[a]=g),v&&p===void 0&&(p=w.measureText(h).width,u[h]=p,E=p-g),{width:y*d,kernedWidth:E*d}},getHeightOfChar:function(e,n){return this.getValueOfPropertyAt(e,n,"fontSize")},measureLine:function(e){var n=this._measureLine(e);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n},_measureLine:function(e){var n=0,a,s,u=this._textLines[e],t,f,h=0,v=new Array(u.length),y=0,p,g,d=this.path,E=this.pathSide==="right";for(this.__charBounds[e]=v,a=0;a<u.length;a++)s=u[a],f=this._getGraphemeBox(s,e,a,t),v[a]=f,n+=f.kernedWidth,t=s;if(v[a]={left:f?f.left+f.width:0,width:0,kernedWidth:0,height:this.fontSize},d){switch(g=d.segmentsInfo[d.segmentsInfo.length-1].length,p=r.util.getPointOnPath(d.path,0,d.segmentsInfo),p.x+=d.pathOffset.x,p.y+=d.pathOffset.y,this.textAlign){case"left":y=E?g-n:0;break;case"center":y=(g-n)/2;break;case"right":y=E?0:g-n;break}for(y+=this.pathStartOffset*(E?-1:1),a=E?u.length-1:0;E?a>=0:a<u.length;E?a--:a++)f=v[a],y>g?y%=g:y<0&&(y+=g),this._setGraphemeOnPath(y,f,p),y+=f.kernedWidth}return{width:n,numOfSpaces:h}},_setGraphemeOnPath:function(e,n,a){var s=e+n.kernedWidth/2,u=this.path,t=r.util.getPointOnPath(u.path,s,u.segmentsInfo);n.renderLeft=t.x-a.x,n.renderTop=t.y-a.y,n.angle=t.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(e,n,a,s,u){var t=this.getCompleteStyleDeclaration(n,a),f=s?this.getCompleteStyleDeclaration(n,a-1):{},h=this._measureChar(e,t,s,f),v=h.kernedWidth,y=h.width,p;this.charSpacing!==0&&(p=this._getWidthOfCharSpacing(),y+=p,v+=p);var g={width:y,left:0,height:t.fontSize,kernedWidth:v,deltaY:t.deltaY};if(a>0&&!u){var d=this.__charBounds[n][a-1];g.left=d.left+d.width+h.kernedWidth-h.width}return g},getHeightOfLine:function(e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var n=this._textLines[e],a=this.getHeightOfChar(e,0),s=1,u=n.length;s<u;s++)a=Math.max(this.getHeightOfChar(e,s),a);return this.__lineHeights[e]=a*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var e,n=0,a=0,s=this._textLines.length;a<s;a++)e=this.getHeightOfLine(a),n+=a===s-1?e/this.lineHeight:e;return n},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(e,n){e.save();for(var a=0,s=this._getLeftOffset(),u=this._getTopOffset(),t=0,f=this._textLines.length;t<f;t++){var h=this.getHeightOfLine(t),v=h/this.lineHeight,y=this._getLineLeftOffset(t);this._renderTextLine(n,e,this._textLines[t],s+y,u+a+v,t),a+=h}e.restore()},_renderTextFill:function(e){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(e,"fillText")},_renderTextStroke:function(e){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())},_renderChars:function(e,n,a,s,u,t){var f=this.getHeightOfLine(t),h=this.textAlign.indexOf("justify")!==-1,v,y,p="",g,d=0,E,w=this.path,D=!h&&this.charSpacing===0&&this.isEmptyStyles(t)&&!w,b=this.direction==="ltr",S=this.direction==="ltr"?1:-1,C,P=n.canvas.getAttribute("dir");if(n.save(),P!==this.direction&&(n.canvas.setAttribute("dir",b?"ltr":"rtl"),n.direction=b?"ltr":"rtl",n.textAlign=b?"left":"right"),u-=f*this._fontSizeFraction/this.lineHeight,D){this._renderChar(e,n,t,0,a.join(""),s,u,f),n.restore();return}for(var R=0,L=a.length-1;R<=L;R++)E=R===L||this.charSpacing||w,p+=a[R],g=this.__charBounds[t][R],d===0?(s+=S*(g.kernedWidth-g.width),d+=g.width):d+=g.kernedWidth,h&&!E&&this._reSpaceAndTab.test(a[R])&&(E=!0),E||(v=v||this.getCompleteStyleDeclaration(t,R),y=this.getCompleteStyleDeclaration(t,R+1),E=this._hasStyleChanged(v,y)),E&&(w?(n.save(),n.translate(g.renderLeft,g.renderTop),n.rotate(g.angle),this._renderChar(e,n,t,R,p,-d/2,0,f),n.restore()):(C=s,this._renderChar(e,n,t,R,p,C,u,f)),p="",v=y,s+=S*d,d=0);n.restore()},_applyPatternGradientTransformText:function(e){var n=r.util.createCanvasElement(),a,s=this.width+this.strokeWidth,u=this.height+this.strokeWidth;return n.width=s,n.height=u,a=n.getContext("2d"),a.beginPath(),a.moveTo(0,0),a.lineTo(s,0),a.lineTo(s,u),a.lineTo(0,u),a.closePath(),a.translate(s/2,u/2),a.fillStyle=e.toLive(a),this._applyPatternGradientTransform(a,e),a.fill(),a.createPattern(n,"no-repeat")},handleFiller:function(e,n,a){var s,u;return a.toLive?a.gradientUnits==="percentage"||a.gradientTransform||a.patternTransform?(s=-this.width/2,u=-this.height/2,e.translate(s,u),e[n]=this._applyPatternGradientTransformText(a),{offsetX:s,offsetY:u}):(e[n]=a.toLive(e,this),this._applyPatternGradientTransform(e,a)):(e[n]=a,{offsetX:0,offsetY:0})},_setStrokeStyles:function(e,n){return e.lineWidth=n.strokeWidth,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n.stroke)},_setFillStyles:function(e,n){return this.handleFiller(e,"fillStyle",n.fill)},_renderChar:function(e,n,a,s,u,t,f){var h=this._getStyleDeclaration(a,s),v=this.getCompleteStyleDeclaration(a,s),y=e==="fillText"&&v.fill,p=e==="strokeText"&&v.stroke&&v.strokeWidth,g,d;!p&&!y||(n.save(),y&&(g=this._setFillStyles(n,v)),p&&(d=this._setStrokeStyles(n,v)),n.font=this._getFontDeclaration(v),h&&h.textBackgroundColor&&this._removeShadow(n),h&&h.deltaY&&(f+=h.deltaY),y&&n.fillText(u,t-g.offsetX,f-g.offsetY),p&&n.strokeText(u,t-d.offsetX,f-d.offsetY),n.restore())},setSuperscript:function(e,n){return this._setScript(e,n,this.superscript)},setSubscript:function(e,n){return this._setScript(e,n,this.subscript)},_setScript:function(e,n,a){var s=this.get2DCursorLocation(e,!0),u=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),t=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),f={fontSize:u*a.size,deltaY:t+u*a.baseline};return this.setSelectionStyles(f,e,n),this},_hasStyleChanged:function(e,n){return e.fill!==n.fill||e.stroke!==n.stroke||e.strokeWidth!==n.strokeWidth||e.fontSize!==n.fontSize||e.fontFamily!==n.fontFamily||e.fontWeight!==n.fontWeight||e.fontStyle!==n.fontStyle||e.deltaY!==n.deltaY},_hasStyleChangedForSvg:function(e,n){return this._hasStyleChanged(e,n)||e.overline!==n.overline||e.underline!==n.underline||e.linethrough!==n.linethrough},_getLineLeftOffset:function(e){var n=this.getLineWidth(e),a=this.width-n,s=this.textAlign,u=this.direction,t,f=0,t=this.isEndOfWrapping(e);return s==="justify"||s==="justify-center"&&!t||s==="justify-right"&&!t||s==="justify-left"&&!t?0:(s==="center"&&(f=a/2),s==="right"&&(f=a),s==="justify-center"&&(f=a/2),s==="justify-right"&&(f=a),u==="rtl"&&(f-=a),f)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var e=this._forceClearCache;return e||(e=this.hasStateChanged("_dimensionAffectingProps")),e&&(this.dirty=!0,this._forceClearCache=!1),e},getLineWidth:function(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];var n=this.measureLine(e),a=n.width;return this.__lineWidths[e]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(e,n,a){var s=this._getStyleDeclaration(e,n);return s&&typeof s[a]!="undefined"?s[a]:this[a]},_renderTextDecoration:function(e,n){if(!(!this[n]&&!this.styleHas(n))){for(var a,s,u,t,f,h,v,y,p=this._getLeftOffset(),g=this._getTopOffset(),d,E,w,D,b,S,C,P,R=this.path,L=this._getWidthOfCharSpacing(),O=this.offsets[n],_=0,x=this._textLines.length;_<x;_++){if(a=this.getHeightOfLine(_),!this[n]&&!this.styleHas(n,_)){g+=a;continue}v=this._textLines[_],S=a/this.lineHeight,t=this._getLineLeftOffset(_),E=0,w=0,y=this.getValueOfPropertyAt(_,0,n),P=this.getValueOfPropertyAt(_,0,"fill"),d=g+S*(1-this._fontSizeFraction),s=this.getHeightOfChar(_,0),f=this.getValueOfPropertyAt(_,0,"deltaY");for(var A=0,k=v.length;A<k;A++)if(D=this.__charBounds[_][A],b=this.getValueOfPropertyAt(_,A,n),C=this.getValueOfPropertyAt(_,A,"fill"),u=this.getHeightOfChar(_,A),h=this.getValueOfPropertyAt(_,A,"deltaY"),R&&b&&C)e.save(),e.fillStyle=P,e.translate(D.renderLeft,D.renderTop),e.rotate(D.angle),e.fillRect(-D.kernedWidth/2,O*u+h,D.kernedWidth,this.fontSize/15),e.restore();else if((b!==y||C!==P||u!==s||h!==f)&&w>0){var M=p+t+E;this.direction==="rtl"&&(M=this.width-M-w),y&&P&&(e.fillStyle=P,e.fillRect(M,d+O*s+f,w,this.fontSize/15)),E=D.left,w=D.width,y=b,P=C,s=u,f=h}else w+=D.kernedWidth;var M=p+t+E;this.direction==="rtl"&&(M=this.width-M-w),e.fillStyle=C,b&&C&&e.fillRect(M,d+O*s+f,w-L,this.fontSize/15),g+=a}this._removeShadow(e)}},_getFontDeclaration:function(e,n){var a=e||this,s=this.fontFamily,u=r.Text.genericFonts.indexOf(s.toLowerCase())>-1,t=s===void 0||s.indexOf("'")>-1||s.indexOf(",")>-1||s.indexOf('"')>-1||u?a.fontFamily:'"'+a.fontFamily+'"';return[r.isLikelyNode?a.fontWeight:a.fontStyle,r.isLikelyNode?a.fontStyle:a.fontWeight,n?this.CACHE_FONT_SIZE+"px":a.fontSize+"px",t].join(" ")},render:function(e){!this.visible||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",e))},_splitTextIntoLines:function(e){for(var n=e.split(this._reNewline),a=new Array(n.length),s=[`
`],u=[],t=0;t<n.length;t++)a[t]=r.util.string.graphemeSplit(n[t]),u=u.concat(a[t],s);return u.pop(),{_unwrappedLines:a,lines:n,graphemeText:u,graphemeLines:a}},toObject:function(e){var n=l.concat(e),a=this.callSuper("toObject",n);return a.styles=c(this.styles,!0),a.path&&(a.path=this.path.toObject()),a},set:function(e,n){this.callSuper("set",e,n);var a=!1,s=!1;if(typeof e=="object")for(var u in e)u==="path"&&this.setPathInfo(),a=a||this._dimensionAffectingProps.indexOf(u)!==-1,s=s||u==="path";else a=this._dimensionAffectingProps.indexOf(e)!==-1,s=e==="path";return s&&this.setPathInfo(),a&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),r.Text.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),r.Text.DEFAULT_SVG_FONT_SIZE=16,r.Text.fromElement=function(e,n,a){if(!e)return n(null);var s=r.parseAttributes(e,r.Text.ATTRIBUTE_NAMES),u=s.textAnchor||"left";if(a=r.util.object.extend(a?c(a):{},s),a.top=a.top||0,a.left=a.left||0,s.textDecoration){var t=s.textDecoration;t.indexOf("underline")!==-1&&(a.underline=!0),t.indexOf("overline")!==-1&&(a.overline=!0),t.indexOf("line-through")!==-1&&(a.linethrough=!0),delete a.textDecoration}"dx"in s&&(a.left+=s.dx),"dy"in s&&(a.top+=s.dy),"fontSize"in a||(a.fontSize=r.Text.DEFAULT_SVG_FONT_SIZE);var f="";"textContent"in e?f=e.textContent:"firstChild"in e&&e.firstChild!==null&&"data"in e.firstChild&&e.firstChild.data!==null&&(f=e.firstChild.data),f=f.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var h=a.strokeWidth;a.strokeWidth=0;var v=new r.Text(f,a),y=v.getScaledHeight()/v.height,p=(v.height+v.strokeWidth)*v.lineHeight-v.height,g=p*y,d=v.getScaledHeight()+g,E=0;u==="center"&&(E=v.getScaledWidth()/2),u==="right"&&(E=v.getScaledWidth()),v.set({left:v.left-E,top:v.top-(d-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:typeof h!="undefined"?h:1}),n(v)},r.Text.fromObject=function(e,n){var a=c(e),s=e.path;return delete a.path,r.Object._fromObject("Text",a,function(u){s?r.Object._fromObject("Path",s,function(t){u.set("path",t),n(u)},"path"):n(u)},"text")},r.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],r.util.createAccessors&&r.util.createAccessors(r.Text)}(be),function(){H.util.object.extend(H.Text.prototype,{isEmptyStyles:function(m){if(!this.styles||typeof m!="undefined"&&!this.styles[m])return!0;var r=typeof m=="undefined"?this.styles:{line:this.styles[m]};for(var c in r)for(var l in r[c])for(var e in r[c][l])return!1;return!0},styleHas:function(m,r){if(!this.styles||!m||m===""||typeof r!="undefined"&&!this.styles[r])return!1;var c=typeof r=="undefined"?this.styles:{0:this.styles[r]};for(var l in c)for(var e in c[l])if(typeof c[l][e][m]!="undefined")return!0;return!1},cleanStyle:function(m){if(!this.styles||!m||m==="")return!1;var r=this.styles,c=0,l,e,n=!0,a=0,s;for(var u in r){l=0;for(var t in r[u]){var s=r[u][t],f=s.hasOwnProperty(m);c++,f?(e?s[m]!==e&&(n=!1):e=s[m],s[m]===this[m]&&delete s[m]):n=!1,Object.keys(s).length!==0?l++:delete r[u][t]}l===0&&delete r[u]}for(var h=0;h<this._textLines.length;h++)a+=this._textLines[h].length;n&&c===a&&(this[m]=e,this.removeStyle(m))},removeStyle:function(m){if(!(!this.styles||!m||m==="")){var r=this.styles,c,l,e;for(l in r){c=r[l];for(e in c)delete c[e][m],Object.keys(c[e]).length===0&&delete c[e];Object.keys(c).length===0&&delete r[l]}}},_extendStyles:function(m,r){var c=this.get2DCursorLocation(m);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),H.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),r)},get2DCursorLocation:function(m,r){typeof m=="undefined"&&(m=this.selectionStart);for(var c=r?this._unwrappedTextLines:this._textLines,l=c.length,e=0;e<l;e++){if(m<=c[e].length)return{lineIndex:e,charIndex:m};m-=c[e].length+this.missingNewlineOffset(e)}return{lineIndex:e-1,charIndex:c[e-1].length<m?c[e-1].length:m}},getSelectionStyles:function(m,r,c){typeof m=="undefined"&&(m=this.selectionStart||0),typeof r=="undefined"&&(r=this.selectionEnd||m);for(var l=[],e=m;e<r;e++)l.push(this.getStyleAtPosition(e,c));return l},getStyleAtPosition:function(m,r){var c=this.get2DCursorLocation(m),l=r?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex);return l||{}},setSelectionStyles:function(m,r,c){typeof r=="undefined"&&(r=this.selectionStart||0),typeof c=="undefined"&&(c=this.selectionEnd||r);for(var l=r;l<c;l++)this._extendStyles(l,m);return this._forceClearCache=!0,this},_getStyleDeclaration:function(m,r){var c=this.styles&&this.styles[m];return c?c[r]:null},getCompleteStyleDeclaration:function(m,r){for(var c=this._getStyleDeclaration(m,r)||{},l={},e,n=0;n<this._styleProperties.length;n++)e=this._styleProperties[n],l[e]=typeof c[e]=="undefined"?this[e]:c[e];return l},_setStyleDeclaration:function(m,r,c){this.styles[m][r]=c},_deleteStyleDeclaration:function(m,r){delete this.styles[m][r]},_getLineStyle:function(m){return!!this.styles[m]},_setLineStyle:function(m){this.styles[m]={}},_deleteLineStyle:function(m){delete this.styles[m]}})}(),function(){function m(r){r.textDecoration&&(r.textDecoration.indexOf("underline")>-1&&(r.underline=!0),r.textDecoration.indexOf("line-through")>-1&&(r.linethrough=!0),r.textDecoration.indexOf("overline")>-1&&(r.overline=!0),delete r.textDecoration)}H.IText=H.util.createClass(H.Text,H.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(r,c){this.callSuper("initialize",r,c),this.initBehavior()},setSelectionStart:function(r){r=Math.max(r,0),this._updateAndFire("selectionStart",r)},setSelectionEnd:function(r){r=Math.min(r,this.text.length),this._updateAndFire("selectionEnd",r)},_updateAndFire:function(r,c){this[r]!==c&&(this._fireSelectionChanged(),this[r]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(r){this.clearContextTop(),this.callSuper("render",r),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(r){this.callSuper("_render",r)},clearContextTop:function(r){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var c=this.canvas.contextTop,l=this.canvas.viewportTransform;c.save(),c.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.transform(c),this._clearTextArea(c),r||c.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var r=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(r,c):this.renderSelection(r,c),c.restore()}},_clearTextArea:function(r){var c=this.width+4,l=this.height+4;r.clearRect(-c/2,-l/2,c,l)},_getCursorBoundaries:function(r){typeof r=="undefined"&&(r=this.selectionStart);var c=this._getLeftOffset(),l=this._getTopOffset(),e=this._getCursorBoundariesOffsets(r);return{left:c,top:l,leftOffset:e.left,topOffset:e.top}},_getCursorBoundariesOffsets:function(r){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,l,e,n=0,a=0,s,u=this.get2DCursorLocation(r);e=u.charIndex,l=u.lineIndex;for(var t=0;t<l;t++)n+=this.getHeightOfLine(t);c=this._getLineLeftOffset(l);var f=this.__charBounds[l][e];return f&&(a=f.left),this.charSpacing!==0&&e===this._textLines[l].length&&(a-=this._getWidthOfCharSpacing()),s={top:n,left:c+(a>0?a:0)},this.direction==="rtl"&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(r,c){var l=this.get2DCursorLocation(),e=l.lineIndex,n=l.charIndex>0?l.charIndex-1:0,a=this.getValueOfPropertyAt(e,n,"fontSize"),s=this.scaleX*this.canvas.getZoom(),u=this.cursorWidth/s,t=r.topOffset,f=this.getValueOfPropertyAt(e,n,"deltaY");t+=(1-this._fontSizeFraction)*this.getHeightOfLine(e)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(r,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(e,n,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(r.left+r.leftOffset-u/2,t+r.top+f,u,a)},renderSelection:function(r,c){for(var l=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,e=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=this.textAlign.indexOf("justify")!==-1,a=this.get2DCursorLocation(l),s=this.get2DCursorLocation(e),u=a.lineIndex,t=s.lineIndex,f=a.charIndex<0?0:a.charIndex,h=s.charIndex<0?0:s.charIndex,v=u;v<=t;v++){var y=this._getLineLeftOffset(v)||0,p=this.getHeightOfLine(v),g=0,d=0,E=0;if(v===u&&(d=this.__charBounds[u][f].left),v>=u&&v<t)E=n&&!this.isEndOfWrapping(v)?this.width:this.getLineWidth(v)||5;else if(v===t)if(h===0)E=this.__charBounds[t][h].left;else{var w=this._getWidthOfCharSpacing();E=this.__charBounds[t][h-1].left+this.__charBounds[t][h-1].width-w}g=p,(this.lineHeight<1||v===t&&this.lineHeight>1)&&(p/=this.lineHeight);var D=r.left+y+d,b=E-d,S=p,C=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",S=1,C=p):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(D=this.width-D-b),c.fillRect(D,r.top+r.topOffset+C,b,S),r.topOffset+=g}},getCurrentCharFontSize:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fontSize")},getCurrentCharColor:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fill")},_getCurrentCharIndex:function(){var r=this.get2DCursorLocation(this.selectionStart,!0),c=r.charIndex>0?r.charIndex-1:0;return{l:r.lineIndex,c}}}),H.IText.fromObject=function(r,c){if(m(r),r.styles)for(var l in r.styles)for(var e in r.styles[l])m(r.styles[l][e]);H.Object._fromObject("IText",r,c,"text")}}(),function(){var m=H.util.object.clone;H.util.object.extend(H.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var r=this;this.on("added",function(){var c=r.canvas;c&&(c._hasITextHandlers||(c._hasITextHandlers=!0,r._initCanvasHandlers(c)),c._iTextInstances=c._iTextInstances||[],c._iTextInstances.push(r))})},initRemovedHandler:function(){var r=this;this.on("removed",function(){var c=r.canvas;c&&(c._iTextInstances=c._iTextInstances||[],H.util.removeFromArray(c._iTextInstances,r),c._iTextInstances.length===0&&(c._hasITextHandlers=!1,r._removeCanvasHandlers(c)))})},_initCanvasHandlers:function(r){r._mouseUpITextHandler=function(){r._iTextInstances&&r._iTextInstances.forEach(function(c){c.__isMousedown=!1})},r.on("mouse:up",r._mouseUpITextHandler)},_removeCanvasHandlers:function(r){r.off("mouse:up",r._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(r,c,l,e){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},r.animate("_currentCursorOpacity",c,{duration:l,onComplete:function(){n.isAborted||r[e]()},onChange:function(){r.canvas&&r.selectionStart===r.selectionEnd&&r.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var r=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){r._currentTickCompleteState=r._animateCursor(r,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(r){var c=this,l=r?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){c._tick()},l)},abortCursorAnimation:function(){var r=this._currentTickState||this._currentTickCompleteState,c=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,r&&c&&c.clearContext(c.contextTop||c.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(r){var c=0,l=r-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l--;for(;/\S/.test(this._text[l])&&l>-1;)c++,l--;return r-c},findWordBoundaryRight:function(r){var c=0,l=r;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)c++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)c++,l++;return r+c},findLineBoundaryLeft:function(r){for(var c=0,l=r-1;!/\n/.test(this._text[l])&&l>-1;)c++,l--;return r-c},findLineBoundaryRight:function(r){for(var c=0,l=r;!/\n/.test(this._text[l])&&l<this._text.length;)c++,l++;return r+c},searchWordBoundary:function(r,c){for(var l=this._text,e=this._reSpace.test(l[r])?r-1:r,n=l[e],a=H.reNonWord;!a.test(n)&&e>0&&e<l.length;)e+=c,n=l[e];return a.test(n)&&(e+=c===1?0:1),e},selectWord:function(r){r=r||this.selectionStart;var c=this.searchWordBoundary(r,-1),l=this.searchWordBoundary(r,1);this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(r){r=r||this.selectionStart;var c=this.findLineBoundaryLeft(r),l=this.findLineBoundaryRight(r);return this.selectionStart=c,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(r){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(r),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(r){r._iTextInstances&&r._iTextInstances.forEach(function(c){c.selected=!1,c.isEditing&&c.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(r){if(!(!this.__isMousedown||!this.isEditing)){var c=this.getSelectionStartFromPointer(r.e),l=this.selectionStart,e=this.selectionEnd;(c!==this.__selectionStartOnMouseDown||l===e)&&(l===c||e===c)||(c>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=c):(this.selectionStart=c,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==l||this.selectionEnd!==e)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(r,c,l){var e=l.slice(0,r),n=H.util.string.graphemeSplit(e).length;if(r===c)return{selectionStart:n,selectionEnd:n};var a=l.slice(r,c),s=H.util.string.graphemeSplit(a).length;return{selectionStart:n,selectionEnd:n+s}},fromGraphemeToStringSelection:function(r,c,l){var e=l.slice(0,r),n=e.join("").length;if(r===c)return{selectionStart:n,selectionEnd:n};var a=l.slice(r,c),s=a.join("").length;return{selectionStart:n,selectionEnd:n+s}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var r=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=r.selectionStart,this.hiddenTextarea.selectionEnd=r.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(!!this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var r=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=r.selectionEnd,this.inCompositionMode||(this.selectionStart=r.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var r=this._calcTextareaPosition();this.hiddenTextarea.style.left=r.left,this.hiddenTextarea.style.top=r.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var r=this.inCompositionMode?this.compositionStart:this.selectionStart,c=this._getCursorBoundaries(r),l=this.get2DCursorLocation(r),e=l.lineIndex,n=l.charIndex,a=this.getValueOfPropertyAt(e,n,"fontSize")*this.lineHeight,s=c.leftOffset,u=this.calcTransformMatrix(),t={x:c.left+s,y:c.top+c.topOffset+a},f=this.canvas.getRetinaScaling(),h=this.canvas.upperCanvasEl,v=h.width/f,y=h.height/f,p=v-a,g=y-a,d=h.clientWidth/v,E=h.clientHeight/y;return t=H.util.transformPoint(t,u),t=H.util.transformPoint(t,this.canvas.viewportTransform),t.x*=d,t.y*=E,t.x<0&&(t.x=0),t.x>p&&(t.x=p),t.y<0&&(t.y=0),t.y>g&&(t.y=g),t.x+=this.canvas._offset.left,t.y+=this.canvas._offset.top,{left:t.x+"px",top:t.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){!this._savedProps||(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var r=this._textBeforeEdit!==this.text,c=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,c&&(c.blur&&c.blur(),c.parentNode&&c.parentNode.removeChild(c)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),r&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),r&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var r in this.styles)this._textLines[r]||delete this.styles[r]},removeStyleFromTo:function(r,c){var l=this.get2DCursorLocation(r,!0),e=this.get2DCursorLocation(c,!0),n=l.lineIndex,a=l.charIndex,s=e.lineIndex,u=e.charIndex,t,f;if(n!==s){if(this.styles[n])for(t=a;t<this._unwrappedTextLines[n].length;t++)delete this.styles[n][t];if(this.styles[s])for(t=u;t<this._unwrappedTextLines[s].length;t++)f=this.styles[s][t],f&&(this.styles[n]||(this.styles[n]={}),this.styles[n][a+t-u]=f);for(t=n+1;t<=s;t++)delete this.styles[t];this.shiftLineStyles(s,n-s)}else if(this.styles[n]){f=this.styles[n];var h=u-a,v,y;for(t=a;t<u;t++)delete f[t];for(y in this.styles[n])v=parseInt(y,10),v>=u&&(f[v-h]=f[y],delete f[y])}},shiftLineStyles:function(r,c){var l=m(this.styles);for(var e in this.styles){var n=parseInt(e,10);n>r&&(this.styles[n+c]=l[n],l[n-c]||delete this.styles[n])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(r,c,l,e){var n,a={},s=!1,u=this._unwrappedTextLines[r].length===c;l||(l=1),this.shiftLineStyles(r,l),this.styles[r]&&(n=this.styles[r][c===0?c:c-1]);for(var t in this.styles[r]){var f=parseInt(t,10);f>=c&&(s=!0,a[f-c]=this.styles[r][t],u&&c===0||delete this.styles[r][t])}var h=!1;for(s&&!u&&(this.styles[r+l]=a,h=!0),h&&l--;l>0;)e&&e[l-1]?this.styles[r+l]={0:m(e[l-1])}:n?this.styles[r+l]={0:m(n)}:delete this.styles[r+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(r,c,l,e){this.styles||(this.styles={});var n=this.styles[r],a=n?m(n):{};l||(l=1);for(var s in a){var u=parseInt(s,10);u>=c&&(n[u+l]=a[u],a[u-l]||delete n[u])}if(this._forceClearCache=!0,e){for(;l--;)!Object.keys(e[l]).length||(this.styles[r]||(this.styles[r]={}),this.styles[r][c+l]=m(e[l]));return}if(!!n)for(var t=n[c?c-1:1];t&&l--;)this.styles[r][c+l]=m(t)},insertNewStyleBlock:function(r,c,l){for(var e=this.get2DCursorLocation(c,!0),n=[0],a=0,s=0;s<r.length;s++)r[s]===`
`?(a++,n[a]=0):n[a]++;n[0]>0&&(this.insertCharStyleObject(e.lineIndex,e.charIndex,n[0],l),l=l&&l.slice(n[0]+1)),a&&this.insertNewlineStyleObject(e.lineIndex,e.charIndex+n[0],a);for(var s=1;s<a;s++)n[s]>0?this.insertCharStyleObject(e.lineIndex+s,0,n[s],l):l&&this.styles[e.lineIndex+s]&&l[0]&&(this.styles[e.lineIndex+s][0]=l[0]),l=l&&l.slice(n[s]+1);n[s]>0&&this.insertCharStyleObject(e.lineIndex+s,0,n[s],l)},setSelectionStartEndWithShift:function(r,c,l){l<=r?(c===r?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=r),this.selectionStart=l):l>r&&l<c?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(c===r?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=c),this.selectionEnd=l)},setSelectionInBoundaries:function(){var r=this.text.length;this.selectionStart>r?this.selectionStart=r:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>r?this.selectionEnd=r:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),H.util.object.extend(H.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(m){if(!!this.canvas){this.__newClickTime=+new Date;var r=m.pointer;this.isTripleClick(r)&&(this.fire("tripleclick",m),this._stopEvent(m.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=r,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(m){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===m.x&&this.__lastPointer.y===m.y},_stopEvent:function(m){m.preventDefault&&m.preventDefault(),m.stopPropagation&&m.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(m){!this.isEditing||this.selectWord(this.getSelectionStartFromPointer(m.e))},tripleClickHandler:function(m){!this.isEditing||this.selectLine(this.getSelectionStartFromPointer(m.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(m){!this.canvas||!this.editable||m.e.button&&m.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(m.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(m){!this.canvas||!this.editable||m.e.button&&m.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(m){if(this.__isMousedown=!1,!(!this.editable||this.group||m.transform&&m.transform.actionPerformed||m.e.button&&m.e.button!==1)){if(this.canvas){var r=this.canvas._activeObject;if(r&&r!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(m.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(m){var r=this.getSelectionStartFromPointer(m),c=this.selectionStart,l=this.selectionEnd;m.shiftKey?this.setSelectionStartEndWithShift(c,l,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(m){for(var r=this.getLocalPointer(m),c=0,l=0,e=0,n=0,a=0,s,u,t=0,f=this._textLines.length;t<f&&e<=r.y;t++)e+=this.getHeightOfLine(t)*this.scaleY,a=t,t>0&&(n+=this._textLines[t-1].length+this.missingNewlineOffset(t-1));s=this._getLineLeftOffset(a),l=s*this.scaleX,u=this._textLines[a],this.direction==="rtl"&&(r.x=this.width*this.scaleX-r.x+l);for(var h=0,v=u.length;h<v&&(c=l,l+=this.__charBounds[a][h].kernedWidth*this.scaleX,l<=r.x);h++)n++;return this._getNewSelectionStartFromOffset(r,c,l,n,v)},_getNewSelectionStartFromOffset:function(m,r,c,l,e){var n=m.x-r,a=c-m.x,s=a>n||a<0?0:1,u=l+s;return this.flipX&&(u=e-u),u>this._text.length&&(u=this._text.length),u}}),H.util.object.extend(H.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=H.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var m=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+m.top+"; left: "+m.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+m.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):H.document.body.appendChild(this.hiddenTextarea),H.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),H.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),H.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),H.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),H.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),H.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),H.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),H.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),H.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(H.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(m){if(!!this.isEditing){var r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(m.keyCode in r)this[r[m.keyCode]](m);else if(m.keyCode in this.ctrlKeysMapDown&&(m.ctrlKey||m.metaKey))this[this.ctrlKeysMapDown[m.keyCode]](m);else return;m.stopImmediatePropagation(),m.preventDefault(),m.keyCode>=33&&m.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(m){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(m.keyCode in this.ctrlKeysMapUp&&(m.ctrlKey||m.metaKey))this[this.ctrlKeysMapUp[m.keyCode]](m);else return;m.stopImmediatePropagation(),m.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(m){var r=this.fromPaste;if(this.fromPaste=!1,m&&m.stopPropagation(),!!this.isEditing){var c=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,e=c.length,n,a,s=e-l,u=this.selectionStart,t=this.selectionEnd,f=u!==t,h,v,y;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var p=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),g=u>p.selectionStart;f?(n=this._text.slice(u,t),s+=t-u):e<l&&(g?n=this._text.slice(t+s,t):n=this._text.slice(u,u-s)),a=c.slice(p.selectionEnd-s,p.selectionEnd),n&&n.length&&(a.length&&(h=this.getSelectionStyles(u,u+1,!1),h=a.map(function(){return h[0]})),f?(v=u,y=t):g?(v=t-n.length,y=t):(v=t,y=t+n.length),this.removeStyleFromTo(v,y)),a.length&&(r&&a.join("")===H.copiedText&&!H.disableStyleCopyPaste&&(h=H.copiedTextStyle),this.insertNewStyleBlock(a,u,h)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(m){this.compositionStart=m.target.selectionStart,this.compositionEnd=m.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(H.copiedText=this.getSelectedText(),H.disableStyleCopyPaste?H.copiedTextStyle=null:H.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(m){return m&&m.clipboardData||H.window.clipboardData},_getWidthBeforeCursor:function(m,r){var c=this._getLineLeftOffset(m),l;return r>0&&(l=this.__charBounds[m][r-1],c+=l.left+l.width),c},getDownCursorOffset:function(m,r){var c=this._getSelectionForOffset(m,r),l=this.get2DCursorLocation(c),e=l.lineIndex;if(e===this._textLines.length-1||m.metaKey||m.keyCode===34)return this._text.length-c;var n=l.charIndex,a=this._getWidthBeforeCursor(e,n),s=this._getIndexOnLine(e+1,a),u=this._textLines[e].slice(n);return u.length+s+1+this.missingNewlineOffset(e)},_getSelectionForOffset:function(m,r){return m.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(m,r){var c=this._getSelectionForOffset(m,r),l=this.get2DCursorLocation(c),e=l.lineIndex;if(e===0||m.metaKey||m.keyCode===33)return-c;var n=l.charIndex,a=this._getWidthBeforeCursor(e,n),s=this._getIndexOnLine(e-1,a),u=this._textLines[e].slice(0,n),t=this.missingNewlineOffset(e-1);return-this._textLines[e-1].length+s-u.length+(1-t)},_getIndexOnLine:function(m,r){for(var c=this._textLines[m],l=this._getLineLeftOffset(m),e=l,n=0,a,s,u=0,t=c.length;u<t;u++)if(a=this.__charBounds[m][u].width,e+=a,e>r){s=!0;var f=e-a,h=e,v=Math.abs(f-r),y=Math.abs(h-r);n=y<v?u:u-1;break}return s||(n=c.length-1),n},moveCursorDown:function(m){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",m)},moveCursorUp:function(m){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",m)},_moveCursorUpOrDown:function(m,r){var c="get"+m+"CursorOffset",l=this[c](r,this._selectionDirection==="right");r.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(m){var r=this._selectionDirection==="left"?this.selectionStart+m:this.selectionEnd+m;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),m!==0},moveCursorWithoutShift:function(m){return m<0?(this.selectionStart+=m,this.selectionEnd=this.selectionStart):(this.selectionEnd+=m,this.selectionStart=this.selectionEnd),m!==0},moveCursorLeft:function(m){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",m)},_move:function(m,r,c){var l;if(m.altKey)l=this["findWordBoundary"+c](this[r]);else if(m.metaKey||m.keyCode===35||m.keyCode===36)l=this["findLineBoundary"+c](this[r]);else return this[r]+=c==="Left"?-1:1,!0;if(typeof l!==void 0&&this[r]!==l)return this[r]=l,!0},_moveLeft:function(m,r){return this._move(m,r,"Left")},_moveRight:function(m,r){return this._move(m,r,"Right")},moveCursorLeftWithoutShift:function(m){var r=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(m,"selectionStart")),this.selectionEnd=this.selectionStart,r},moveCursorLeftWithShift:function(m){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(m,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(m,"selectionStart")},moveCursorRight:function(m){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",m)},_moveCursorLeftOrRight:function(m,r){var c="moveCursor"+m+"With";this._currentCursorOpacity=1,r.shiftKey?c+="Shift":c+="outShift",this[c](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(m){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(m,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(m,"selectionEnd")},moveCursorRightWithoutShift:function(m){var r=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(r=this._moveRight(m,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r},removeChars:function(m,r){typeof r=="undefined"&&(r=m+1),this.removeStyleFromTo(m,r),this._text.splice(m,r-m),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(m,r,c,l){typeof l=="undefined"&&(l=c),l>c&&this.removeStyleFromTo(c,l);var e=H.util.string.graphemeSplit(m);this.insertNewStyleBlock(e,c,r),this._text=[].concat(this._text.slice(0,c),e,this._text.slice(l)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var m=H.util.toFixed,r=/  +/g;H.util.object.extend(H.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var l=!0,e=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(l),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,l){var e=[],n=[],a=c,s;this._setSVGBg(n);for(var u=0,t=this._textLines.length;u<t;u++)s=this._getLineLeftOffset(u),(this.textBackgroundColor||this.styleHas("textBackgroundColor",u))&&this._setSVGTextLineBg(n,u,l+s,a),this._setSVGTextLineText(e,u,l+s,a),a+=this.getHeightOfLine(u);return{textSpans:e,textBgRects:n}},_createTextCharSpan:function(c,l,e,n){var a=c!==c.trim()||c.match(r),s=this.getSvgSpanStyles(l,a),u=s?'style="'+s+'"':"",t=l.deltaY,f="",h=H.Object.NUM_FRACTION_DIGITS;return t&&(f=' dy="'+m(t,h)+'" '),['<tspan x="',m(e,h),'" y="',m(n,h),'" ',f,u,">",H.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,l,e,n){var a=this.getHeightOfLine(l),s=this.textAlign.indexOf("justify")!==-1,u,t,f="",h,v,y=0,p=this._textLines[l],g;n+=a*(1-this._fontSizeFraction)/this.lineHeight;for(var d=0,E=p.length-1;d<=E;d++)g=d===E||this.charSpacing,f+=p[d],h=this.__charBounds[l][d],y===0?(e+=h.kernedWidth-h.width,y+=h.width):y+=h.kernedWidth,s&&!g&&this._reSpaceAndTab.test(p[d])&&(g=!0),g||(u=u||this.getCompleteStyleDeclaration(l,d),t=this.getCompleteStyleDeclaration(l,d+1),g=this._hasStyleChangedForSvg(u,t)),g&&(v=this._getStyleDeclaration(l,d)||{},c.push(this._createTextCharSpan(f,v,e,n)),f="",u=t,e+=y,y=0)},_pushTextBgRect:function(c,l,e,n,a,s){var u=H.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(l),' x="',m(e,u),'" y="',m(n,u),'" width="',m(a,u),'" height="',m(s,u),`"></rect>
`)},_setSVGTextLineBg:function(c,l,e,n){for(var a=this._textLines[l],s=this.getHeightOfLine(l)/this.lineHeight,u=0,t=0,f,h,v=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),y=0,p=a.length;y<p;y++)f=this.__charBounds[l][y],h=this.getValueOfPropertyAt(l,y,"textBackgroundColor"),h!==v?(v&&this._pushTextBgRect(c,v,e+t,n,u,s),t=f.left,u=f.width,v=h):u+=f.kernedWidth;h&&this._pushTextBgRect(c,h,e+t,n,u,s)},_getFillAttributes:function(c){var l=c&&typeof c=="string"?new H.Color(c):"";return!l||!l.getSource()||l.getAlpha()===1?'fill="'+c+'"':'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(c){for(var l=0,e=0,n=0;n<c;n++)l+=this.getHeightOfLine(n);return e=this.getHeightOfLine(n),{lineTop:l,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){var l=H.Object.prototype.getSvgStyles.call(this,c);return l+" white-space: pre;"}})}(),function(m){var r=m.fabric||(m.fabric={});r.Textbox=r.util.createClass(r.IText,r.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:r.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var l=0,e=0,n=0,a={},s=0;s<c.graphemeLines.length;s++)c.graphemeText[n]===`
`&&s>0?(e=0,n++,l++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[n])&&s>0&&(e++,n++),a[s]={line:l,offset:e},n+=c.graphemeLines[s].length,e+=c.graphemeLines[s].length;return a},styleHas:function(c,l){if(this._styleMap&&!this.isWrapping){var e=this._styleMap[l];e&&(l=e.line)}return r.Text.prototype.styleHas.call(this,c,l)},isEmptyStyles:function(c){if(!this.styles)return!0;var l=0,e=c+1,n,a,s=!1,u=this._styleMap[c],t=this._styleMap[c+1];u&&(c=u.line,l=u.offset),t&&(e=t.line,s=e===c,n=t.offset),a=typeof c=="undefined"?this.styles:{line:this.styles[c]};for(var f in a)for(var h in a[f])if(h>=l&&(!s||h<n))for(var v in a[f][h])return!1;return!0},_getStyleDeclaration:function(c,l){if(this._styleMap&&!this.isWrapping){var e=this._styleMap[c];if(!e)return null;c=e.line,l=e.offset+l}return this.callSuper("_getStyleDeclaration",c,l)},_setStyleDeclaration:function(c,l,e){var n=this._styleMap[c];c=n.line,l=n.offset+l,this.styles[c][l]=e},_deleteStyleDeclaration:function(c,l){var e=this._styleMap[c];c=e.line,l=e.offset+l,delete this.styles[c][l]},_getLineStyle:function(c){var l=this._styleMap[c];return!!this.styles[l.line]},_setLineStyle:function(c){var l=this._styleMap[c];this.styles[l.line]={}},_wrapText:function(c,l){var e=[],n;for(this.isWrapping=!0,n=0;n<c.length;n++)e=e.concat(this._wrapLine(c[n],n,l));return this.isWrapping=!1,e},_measureWord:function(c,l,e){var n=0,a,s=!0;e=e||0;for(var u=0,t=c.length;u<t;u++){var f=this._getGraphemeBox(c[u],l,u+e,a,s);n+=f.kernedWidth,a=c[u]}return n},_wrapLine:function(c,l,e,n){var a=0,s=this.splitByGrapheme,u=[],t=[],f=s?r.util.string.graphemeSplit(c):c.split(this._wordJoiners),h="",v=0,y=s?"":" ",p=0,g=0,d=0,E=!0,w=this._getWidthOfCharSpacing(),n=n||0;f.length===0&&f.push([]),e-=n;for(var D=0;D<f.length;D++)h=s?f[D]:r.util.string.graphemeSplit(f[D]),p=this._measureWord(h,l,v),v+=h.length,a+=g+p-w,a>e&&!E?(u.push(t),t=[],a=p,E=!0):a+=w,!E&&!s&&t.push(y),t=t.concat(h),g=s?0:this._measureWord([y],l,v),v++,E=!1,p>d&&(d=p);return D&&u.push(t),d+n>this.dynamicMinWidth&&(this.dynamicMinWidth=d-w+n),u},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var l=r.Text.prototype._splitTextIntoLines.call(this,c),e=this._wrapText(l.lines,this.width),n=new Array(e.length),a=0;a<e.length;a++)n[a]=e[a].join("");return l.lines=n,l.graphemeLines=e,l},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var l in this._styleMap)this._textLines[l]&&(c[this._styleMap[l].line]=1);for(var l in this.styles)c[l]||delete this.styles[l]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),r.Textbox.fromObject=function(c,l){return r.Object._fromObject("Textbox",c,l,"text")}}(be),function(){var m=H.controlsUtils,r=m.scaleSkewCursorStyleHandler,c=m.scaleCursorStyleHandler,l=m.scalingEqually,e=m.scalingYOrSkewingX,n=m.scalingXOrSkewingY,a=m.scaleOrSkewActionName,s=H.Object.prototype.controls;if(s.ml=new H.Control({x:-.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:a}),s.mr=new H.Control({x:.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:a}),s.mb=new H.Control({x:0,y:.5,cursorStyleHandler:r,actionHandler:e,getActionName:a}),s.mt=new H.Control({x:0,y:-.5,cursorStyleHandler:r,actionHandler:e,getActionName:a}),s.tl=new H.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),s.tr=new H.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:l}),s.bl=new H.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:l}),s.br=new H.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:l}),s.mtr=new H.Control({x:0,y:-.5,actionHandler:m.rotationWithSnapping,cursorStyleHandler:m.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),H.Textbox){var u=H.Textbox.prototype.controls={};u.mtr=s.mtr,u.tr=s.tr,u.br=s.br,u.tl=s.tl,u.bl=s.bl,u.mt=s.mt,u.mb=s.mb,u.mr=new H.Control({x:.5,y:0,actionHandler:m.changeWidth,cursorStyleHandler:r,actionName:"resizing"}),u.ml=new H.Control({x:-.5,y:0,actionHandler:m.changeWidth,cursorStyleHandler:r,actionName:"resizing"})}}()})(fabric);var dist$2={exports:{}};(function(be,H){(function(I,K){be.exports=K()})(commonjsGlobal,function(){return function(X){var I={};function K(F){if(I[F])return I[F].exports;var G=I[F]={i:F,l:!1,exports:{}};return X[F].call(G.exports,G,G.exports,K),G.l=!0,G.exports}return K.m=X,K.c=I,K.d=function(F,G,m){K.o(F,G)||Object.defineProperty(F,G,{enumerable:!0,get:m})},K.r=function(F){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})},K.t=function(F,G){if(G&1&&(F=K(F)),G&8||G&4&&typeof F=="object"&&F&&F.__esModule)return F;var m=Object.create(null);if(K.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:F}),G&2&&typeof F!="string")for(var r in F)K.d(m,r,function(c){return F[c]}.bind(null,r));return m},K.n=function(F){var G=F&&F.__esModule?function(){return F.default}:function(){return F};return K.d(G,"a",G),G},K.o=function(F,G){return Object.prototype.hasOwnProperty.call(F,G)},K.p="",K(K.s=79)}([function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0}),I.util=I.PresentationMode=void 0,I.createDom=r,I.hasClass=c,I.addClass=l,I.removeClass=e,I.toggleClass=n,I.findDom=a,I.padStart=s,I.format=u,I.event=t,I.typeOf=f,I.deepCopy=h,I.getBgImage=v,I.copyDom=y,I._setInterval=p,I._clearInterval=g,I.createImgBtn=d,I.isWeiXin=E,I.isUc=w,I.computeWatchDur=D,I.offInDestroy=b,I.on=S,I.once=C,I.getBuffered2=P,I.checkIsBrowser=R,I.setStyle=L,I.checkWebkitSetPresentationMode=O;var F=K(7),G=m(F);function m(_){return _&&_.__esModule?_:{default:_}}function r(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",M=document.createElement(_);return M.className=k,M.innerHTML=x,Object.keys(A).forEach(function(N){var U=N,j=A[N];_==="video"||_==="audio"?j&&M.setAttribute(U,j):M.setAttribute(U,j)}),M}function c(_,x){return _?_.classList?Array.prototype.some.call(_.classList,function(A){return A===x}):_.className?!!_.className.match(new RegExp("(\\s|^)"+x+"(\\s|$)")):!1:!1}function l(_,x){!_||(_.classList?x.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(A){A&&_.classList.add(A)}):c(_,x)||(_.className+=" "+x))}function e(_,x){!_||(_.classList?x.split(/\s+/g).forEach(function(A){_.classList.remove(A)}):c(_,x)&&x.split(/\s+/g).forEach(function(A){var k=new RegExp("(\\s|^)"+A+"(\\s|$)");_.className=_.className.replace(k," ")}))}function n(_,x){!_||x.split(/\s+/g).forEach(function(A){c(_,A)?e(_,A):l(_,A)})}function a(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,x=arguments[1],A=void 0;try{A=_.querySelector(x)}catch{x.indexOf("#")===0&&(A=_.getElementById(x.slice(1)))}return A}function s(_,x,A){for(var k=String(A),M=x>>0,N=Math.ceil(M/k.length),U=[],j=String(_);N--;)U.push(k);return U.join("").substring(0,M-j.length)+j}function u(_){if(window.isNaN(_))return"";var x=s(Math.floor(_/3600),2,0),A=s(Math.floor((_-x*3600)/60),2,0),k=s(Math.floor(_-x*3600-A*60),2,0);return(x==="00"?[A,k]:[x,A,k]).join(":")}function t(_){if(_.touches){var x=_.touches[0]||_.changedTouches[0];_.clientX=x.clientX||0,_.clientY=x.clientY||0,_.offsetX=x.pageX-x.target.offsetLeft,_.offsetY=x.pageY-x.target.offsetTop}_._target=_.target||_.srcElement}function f(_){return Object.prototype.toString.call(_).match(/([^\s.*]+)(?=]$)/g)[0]}function h(_,x){if(f(x)==="Object"&&f(_)==="Object")return Object.keys(x).forEach(function(A){f(x[A])==="Object"&&!(x[A]instanceof Node)?_[A]?h(_[A],x[A]):_[A]=x[A]:f(x[A])==="Array"?_[A]=f(_[A])==="Array"?_[A].concat(x[A]):x[A]:_[A]=x[A]}),_}function v(_){var x=(_.currentStyle||window.getComputedStyle(_,null)).backgroundImage;if(!x||x==="none")return"";var A=document.createElement("a");return A.href=x.replace(/url\("|"\)/g,""),A.href}function y(_){if(_&&_.nodeType===1){var x=document.createElement(_.tagName);return Array.prototype.forEach.call(_.attributes,function(A){x.setAttribute(A.name,A.value)}),_.innerHTML&&(x.innerHTML=_.innerHTML),x}else return""}function p(_,x,A,k){_._interval[x]||(_._interval[x]=setInterval(A.bind(_),k))}function g(_,x){clearInterval(_._interval[x]),_._interval[x]=null}function d(_,x,A,k){var M=r("xg-"+_,"",{},"xgplayer-"+_+"-img");if(M.style.backgroundImage='url("'+x+'")',A&&k){var N=void 0,U=void 0,j=void 0;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(z){return A.indexOf(z)>-1&&k.indexOf(z)>-1?(N=Number(A.slice(0,A.indexOf(z)).trim()),U=Number(k.slice(0,k.indexOf(z)).trim()),j=z,!1):!0}),M.style.width=""+N+j,M.style.height=""+U+j,M.style.backgroundSize=""+N+j+" "+U+j,_==="start"?M.style.margin="-"+U/2+j+" auto auto -"+N/2+j:M.style.margin="auto 5px auto 5px"}return M}function E(){var _=window.navigator.userAgent.toLowerCase();return _.indexOf("micromessenger")>-1}function w(){var _=window.navigator.userAgent.toLowerCase();return _.indexOf("ucbrowser")>-1}function D(){for(var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],x=[],A=0;A<_.length;A++)if(!(!_[A].end||_[A].begin<0||_[A].end<0||_[A].end<_[A].begin))if(x.length<1)x.push({begin:_[A].begin,end:_[A].end});else for(var k=0;k<x.length;k++){var M=_[A].begin,N=_[A].end;if(N<x[k].begin){x.splice(k,0,{begin:M,end:N});break}else if(M>x[k].end){if(k>x.length-2){x.push({begin:M,end:N});break}}else{var U=x[k].begin,j=x[k].end;x[k].begin=Math.min(M,U),x[k].end=Math.max(N,j);break}}for(var z=0,J=0;J<x.length;J++)z+=x[J].end-x[J].begin;return z}function b(_,x,A,k){function M(){_.off(x,A),_.off(k,M)}_.once(k,M)}function S(_,x,A,k){if(k)_.on(x,A),b(_,x,A,k);else{var M=function N(U){A(U),_.off(x,N)};_.on(x,M)}}function C(_,x,A,k){if(k)_.once(x,A),b(_,x,A,k);else{var M=function N(U){A(U),_.off(x,N)};_.once(x,M)}}function P(_){for(var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,A=[],k=0;k<_.length;k++)A.push({start:_.start(k)<.5?0:_.start(k),end:_.end(k)});A.sort(function(z,J){var te=z.start-J.start;return te||J.end-z.end});var M=[];if(x)for(var N=0;N<A.length;N++){var U=M.length;if(U){var j=M[U-1].end;A[N].start-j<x?A[N].end>j&&(M[U-1].end=A[N].end):M.push(A[N])}else M.push(A[N])}else M=A;return new G.default(M)}function R(){return!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined")}function L(_,x,A){var k=_.style;try{k[x]=A}catch{k.setProperty(x,A)}}I.PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"};function O(_){return typeof _.webkitSetPresentationMode=="function"}I.util={createDom:r,hasClass:c,addClass:l,removeClass:e,toggleClass:n,findDom:a,padStart:s,format:u,event:t,typeOf:f,deepCopy:h,getBgImage:v,copyDom:y,setInterval:p,clearInterval:g,createImgBtn:d,isWeiXin:E,isUc:w,computeWatchDur:D,offInDestroy:b,on:S,once:C,getBuffered2:P,checkIsBrowser:R,setStyle:L}},function(X,I){X.exports=function(G){var m=[];return m.toString=function(){return this.map(function(c){var l=K(c,G);return c[2]?"@media "+c[2]+"{"+l+"}":l}).join("")},m.i=function(r,c){typeof r=="string"&&(r=[[null,r,""]]);for(var l={},e=0;e<this.length;e++){var n=this[e][0];typeof n=="number"&&(l[n]=!0)}for(e=0;e<r.length;e++){var a=r[e];(typeof a[0]!="number"||!l[a[0]])&&(c&&!a[2]?a[2]=c:c&&(a[2]="("+a[2]+") and ("+c+")"),m.push(a))}},m};function K(G,m){var r=G[1]||"",c=G[3];if(!c)return r;if(m&&typeof btoa=="function"){var l=F(c),e=c.sources.map(function(n){return"/*# downloadUrl="+c.sourceRoot+n+" */"});return[r].concat(e).concat([l]).join(`
`)}return[r].join(`
`)}function F(G){var m=btoa(unescape(encodeURIComponent(JSON.stringify(G)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,"+m;return"/*# "+r+" */"}},function(X,I,K){var F={},G=function(D){var b;return function(){return typeof b=="undefined"&&(b=D.apply(this,arguments)),b}},m=G(function(){return window&&document&&document.all&&!window.atob}),r=function(D){return document.querySelector(D)},c=function(D){var b={};return function(S){if(typeof S=="function")return S();if(typeof b[S]=="undefined"){var C=r.call(this,S);if(window.HTMLIFrameElement&&C instanceof window.HTMLIFrameElement)try{C=C.contentDocument.head}catch{C=null}b[S]=C}return b[S]}}(),l=null,e=0,n=[],a=K(36);X.exports=function(D,b){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");b=b||{},b.attrs=typeof b.attrs=="object"?b.attrs:{},!b.singleton&&typeof b.singleton!="boolean"&&(b.singleton=m()),b.insertInto||(b.insertInto="head"),b.insertAt||(b.insertAt="bottom");var S=u(D,b);return s(S,b),function(P){for(var R=[],L=0;L<S.length;L++){var O=S[L],_=F[O.id];_.refs--,R.push(_)}if(P){var x=u(P,b);s(x,b)}for(var L=0;L<R.length;L++){var _=R[L];if(_.refs===0){for(var A=0;A<_.parts.length;A++)_.parts[A]();delete F[_.id]}}}};function s(D,b){for(var S=0;S<D.length;S++){var C=D[S],P=F[C.id];if(P){P.refs++;for(var R=0;R<P.parts.length;R++)P.parts[R](C.parts[R]);for(;R<C.parts.length;R++)P.parts.push(p(C.parts[R],b))}else{for(var L=[],R=0;R<C.parts.length;R++)L.push(p(C.parts[R],b));F[C.id]={id:C.id,refs:1,parts:L}}}}function u(D,b){for(var S=[],C={},P=0;P<D.length;P++){var R=D[P],L=b.base?R[0]+b.base:R[0],O=R[1],_=R[2],x=R[3],A={css:O,media:_,sourceMap:x};C[L]?C[L].parts.push(A):S.push(C[L]={id:L,parts:[A]})}return S}function t(D,b){var S=c(D.insertInto);if(!S)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var C=n[n.length-1];if(D.insertAt==="top")C?C.nextSibling?S.insertBefore(b,C.nextSibling):S.appendChild(b):S.insertBefore(b,S.firstChild),n.push(b);else if(D.insertAt==="bottom")S.appendChild(b);else if(typeof D.insertAt=="object"&&D.insertAt.before){var P=c(D.insertInto+" "+D.insertAt.before);S.insertBefore(b,P)}else throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`)}function f(D){if(D.parentNode===null)return!1;D.parentNode.removeChild(D);var b=n.indexOf(D);b>=0&&n.splice(b,1)}function h(D){var b=document.createElement("style");return D.attrs.type="text/css",y(b,D.attrs),t(D,b),b}function v(D){var b=document.createElement("link");return D.attrs.type="text/css",D.attrs.rel="stylesheet",y(b,D.attrs),t(D,b),b}function y(D,b){Object.keys(b).forEach(function(S){D.setAttribute(S,b[S])})}function p(D,b){var S,C,P,R;if(b.transform&&D.css)if(R=b.transform(D.css),R)D.css=R;else return function(){};if(b.singleton){var L=e++;S=l||(l=h(b)),C=d.bind(null,S,L,!1),P=d.bind(null,S,L,!0)}else D.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(S=v(b),C=w.bind(null,S,b),P=function(){f(S),S.href&&URL.revokeObjectURL(S.href)}):(S=h(b),C=E.bind(null,S),P=function(){f(S)});return C(D),function(_){if(_){if(_.css===D.css&&_.media===D.media&&_.sourceMap===D.sourceMap)return;C(D=_)}else P()}}var g=function(){var D=[];return function(b,S){return D[b]=S,D.filter(Boolean).join(`
`)}}();function d(D,b,S,C){var P=S?"":C.css;if(D.styleSheet)D.styleSheet.cssText=g(b,P);else{var R=document.createTextNode(P),L=D.childNodes;L[b]&&D.removeChild(L[b]),L.length?D.insertBefore(R,L[b]):D.appendChild(R)}}function E(D,b){var S=b.css,C=b.media;if(C&&D.setAttribute("media",C),D.styleSheet)D.styleSheet.cssText=S;else{for(;D.firstChild;)D.removeChild(D.firstChild);D.appendChild(document.createTextNode(S))}}function w(D,b,S){var C=S.css,P=S.sourceMap,R=b.convertToAbsoluteUrls===void 0&&P;(b.convertToAbsoluteUrls||R)&&(C=a(C)),P&&(C+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(P))))+" */");var L=new Blob([C],{type:"text/css"}),O=D.href;D.href=URL.createObjectURL(L),O&&URL.revokeObjectURL(O)}},function(X,I,K){var F=K(24)();X.exports=function(G){return G!==F&&G!==null}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(8);function G(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")}var m={network:{code:1,msg:"\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF",remark:"\u53EA\u8981\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF\u5C31\u4F7F\u7528\u6B64\u7C7B\u578B\uFF0C\u65E0\u8BBA\u662Fvideo\u672C\u8EAB\u7684\u8D85\u65F6\u8FD8\u662Fxhr\u7684\u5206\u6BB5\u8BF7\u6C42\u8D85\u65F6\u6216\u8005\u8D44\u6E90\u4E0D\u5B58\u5728"},mse:{code:2,msg:"\u6D41\u8FFD\u52A0\u9519\u8BEF",remark:"\u8FFD\u52A0\u6D41\u7684\u65F6\u5019\u5982\u679C\u7C7B\u578B\u4E0D\u5BF9\u3001\u65E0\u6CD5\u88AB\u6B63\u786E\u89E3\u7801\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},parse:{code:3,msg:"\u89E3\u6790\u9519\u8BEF",remark:"mp4\u3001hls\u3001flv\u6211\u4EEC\u90FD\u662F\u4F7F\u7528js\u8FDB\u884C\u683C\u5F0F\u89E3\u6790\uFF0C\u5982\u679C\u89E3\u6790\u5931\u8D25\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},format:{code:4,msg:"\u683C\u5F0F\u9519\u8BEF",remark:"\u5982\u679C\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u7684\u683C\u5F0F\u5BFC\u81F4\u64AD\u653E\u9519\u8BEF"},decoder:{code:5,msg:"\u89E3\u7801\u9519\u8BEF",remark:"\u6D4F\u89C8\u5668\u89E3\u7801\u5F02\u5E38\u4F1A\u629B\u51FA\u6B64\u7C7B\u578B\u9519\u8BEF"},runtime:{code:6,msg:"\u8BED\u6CD5\u9519\u8BEF",remark:"\u64AD\u653E\u5668\u8BED\u6CD5\u9519\u8BEF"},timeout:{code:7,msg:"\u64AD\u653E\u8D85\u65F6",remark:"\u64AD\u653E\u8FC7\u7A0B\u4E2D\u65E0\u6CD5\u6B63\u5E38\u8BF7\u6C42\u4E0B\u4E00\u4E2A\u5206\u6BB5\u5BFC\u81F4\u64AD\u653E\u4E2D\u65AD"},other:{code:8,msg:"\u5176\u4ED6\u9519\u8BEF",remark:"\u4E0D\u53EF\u77E5\u7684\u9519\u8BEF\u6216\u88AB\u5FFD\u7565\u7684\u9519\u8BEF\u7C7B\u578B"}},r=function c(l,e,n,a,s,u,t,f){var h=arguments.length>8&&arguments[8]!==void 0?arguments[8]:{line:"",handle:"",msg:"",version:""},v=arguments[9],y=arguments[10];G(this,c);var p={};if(arguments.length>1)p.playerVersion=F.version,p.errorType=l,p.domain=document.domain,p.duration=n,p.currentTime=e,p.networkState=a,p.readyState=s,p.currentSrc=t,p.src=u,p.ended=f,p.errd=h,p.ex=(m[l]||{}).msg,p.errorCode=v,p.mediaError=y;else{var g=arguments[0];Object.keys(g).map(function(d){p[d]=g[d]}),p.ex=(g.type&&m[g.type]||{}).msg}return p};I.default=r,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F={};Object.defineProperty(F,"device",{get:function(){var m=F.os;return m.isPc?"pc":"mobile"}}),Object.defineProperty(F,"browser",{get:function(){var m=navigator.userAgent.toLowerCase(),r={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(r).filter(function(c){return r[c].test(m)}))[0]||""}}),Object.defineProperty(F,"os",{get:function(){var m=navigator.userAgent,r=/(?:Windows Phone)/.test(m),c=/(?:SymbianOS)/.test(m)||r,l=/(?:Android)/.test(m),e=/(?:Firefox)/.test(m),n=/(?:iPad|PlayBook)/.test(m)||l&&!/(?:Mobile)/.test(m)||e&&/(?:Tablet)/.test(m),a=/(?:iPhone)/.test(m)&&!n,s=!a&&!l&&!c&&!n;return{isTablet:n,isPhone:a,isAndroid:l,isPc:s,isSymbian:c,isWindowsPhone:r,isFireFox:e}}}),I.default=F,X.exports=I.default},function(X,I,K){var F=void 0;X.exports=function(G){return G!==F&&G!==null}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function r(c,l){for(var e=0;e<l.length;e++){var n=l[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(c,n.key,n)}}return function(c,l,e){return l&&r(c.prototype,l),e&&r(c,e),c}}();function G(r,c){if(!(r instanceof c))throw new TypeError("Cannot call a class as a function")}var m=function(){function r(c){G(this,r),this.bufferedList=c}return F(r,[{key:"start",value:function(l){return this.bufferedList[l].start}},{key:"end",value:function(l){return this.bufferedList[l].end}},{key:"length",get:function(){return this.bufferedList.length}}]),r}();I.default=m,X.exports=I.default},function(X){X.exports=JSON.parse('{"version":"2.31.6"}')},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function D(b,S){for(var C=0;C<S.length;C++){var P=S[C];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(b,P.key,P)}}return function(b,S,C){return S&&D(b.prototype,S),C&&D(b,C),b}}(),G=function D(b,S,C){b===null&&(b=Function.prototype);var P=Object.getOwnPropertyDescriptor(b,S);if(P===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:D(R,S,C)}else{if("value"in P)return P.value;var L=P.get;return L===void 0?void 0:L.call(C)}},m=K(11),r=p(m),c=K(0),l=K(5),e=p(l),n=K(7),a=p(n),s=K(4),u=p(s),t=K(31),f=p(t),h=K(10),v=p(h);K(34);var y=K(8);function p(D){return D&&D.__esModule?D:{default:D}}function g(D,b){if(!(D instanceof b))throw new TypeError("Cannot call a class as a function")}function d(D,b){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:D}function E(D,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);D.prototype=Object.create(b&&b.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(D,b):D.__proto__=b)}var w=function(D){E(b,D);function b(S){g(this,b);var C=d(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,S));if(C.config=(0,c.deepCopy)({width:600,height:337.5,ignores:[],whitelist:[],lang:(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),inactive:3e3,volume:.6,controls:!0,controlsList:["nodownload"]},S),C.version=y.version,C.userTimer=null,C.waitTimer=null,C.history=[],C.isProgressMoving=!1,C.root=(0,c.findDom)(document,"#"+C.config.id),C.controls=(0,c.createDom)("xg-controls","",{unselectable:"on",onselectstart:"return false"},"xgplayer-controls"),C.config.isShowControl&&(C.controls.style.display="none"),!C.root){var P=C.config.el;if(P&&P.nodeType===1)C.root=P;else{var R;return C.emit("error",new u.default({type:"use",errd:{line:45,handle:"Constructor",msg:"container id can't be empty"},vid:C.config.vid})),console.error("container id can't be empty"),R=!1,d(C,R)}}if((0,c.addClass)(C.root,"xgplayer xgplayer-"+e.default.device+" xgplayer-nostart xgplayer-pause "+(C.config.controls?"":"xgplayer-no-controls")),C.root.appendChild(C.controls),C.config.fluid?(C.root.style["max-width"]="100%",C.root.style.width="100%",C.root.style.height="0",C.root.style["padding-top"]=C.config.height*100/C.config.width+"%",C.video.style.position="absolute",C.video.style.top="0",C.video.style.left="0"):(C.config.width&&(typeof C.config.width!="number"?C.root.style.width=C.config.width:C.root.style.width=C.config.width+"px"),C.config.height&&(typeof C.config.height!="number"?C.root.style.height=C.config.height:C.root.style.height=C.config.height+"px")),C.config.execBeforePluginsCall&&C.config.execBeforePluginsCall.forEach(function(x){x.call(C,C)}),C.config.closeI18n||b.install(v.default.name,v.default.method),C.config.controlStyle&&(0,c.typeOf)(C.config.controlStyle)==="String"){var L=C;fetch(L.config.controlStyle,{method:"GET",headers:{Accept:"application/json"}}).then(function(x){x.ok&&x.json().then(function(A){for(var k in A)A.hasOwnProperty(k)&&(L.config[k]=A[k]);L.pluginsCall()})}).catch(function(x){console.log("Fetch\u9519\u8BEF:"+x)})}else C.pluginsCall();C.config.controlPlugins&&b.controlsRun(C.config.controlPlugins,C),C.ev.forEach(function(x){var A=Object.keys(x)[0],k=C[x[A]];k&&C.on(A,k)}),["focus","blur"].forEach(function(x){C.on(x,C["on"+x.charAt(0).toUpperCase()+x.slice(1)])});var O=C;C.mousemoveFunc=function(){O.emit("focus"),O.config.closeFocusVideoFocus||O.video.focus()},C.root.addEventListener("mousemove",C.mousemoveFunc),C.playFunc=function(){O.emit("focus"),O.config.closePlayVideoFocus||O.video.focus()},O.once("play",C.playFunc),C.getVideoSize=function(){if(this.video.videoWidth&&this.video.videoHeight){var x=O.root.getBoundingClientRect();O.config.fitVideoSize==="auto"?x.width/x.height>this.video.videoWidth/this.video.videoHeight?O.root.style.height=this.video.videoHeight/this.video.videoWidth*x.width+"px":O.root.style.width=this.video.videoWidth/this.video.videoHeight*x.height+"px":O.config.fitVideoSize==="fixWidth"?O.root.style.height=this.video.videoHeight/this.video.videoWidth*x.width+"px":O.config.fitVideoSize==="fixHeight"&&(O.root.style.width=this.video.videoWidth/this.video.videoHeight*x.height+"px")}},O.once("loadeddata",C.getVideoSize),setTimeout(function(){C.emit("ready"),C.isReady=!0},0),C.config.videoInit&&(0,c.hasClass)(C.root,"xgplayer-nostart")&&C.start(),O.config.rotate&&(O.on("requestFullscreen",C.updateRotateDeg),O.on("exitFullscreen",C.updateRotateDeg));function _(){O.root.removeEventListener("mousemove",O.mousemoveFunc),O.off("destroy",_)}return O.once("destroy",_),C}return F(b,[{key:"attachVideo",value:function(){var C=this;this.video&&this.video.nodeType===1&&this.root.insertBefore(this.video,this.root.firstChild),setTimeout(function(){C.emit("complete"),C.danmu&&typeof C.danmu.resize=="function"&&C.danmu.resize()},1)}},{key:"start",value:function(){var C=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;if(!!this.video){var R=this;if(!P||P===""){this.emit("urlNull");return}this.canPlayFunc=function(){R.off("canplay",R.canPlayFunc);var L=R.video.play();L!==void 0&&L&&L.then(function(){R.emit("autoplay started")}).catch(function(){R.emit("autoplay was prevented"),(0,c.addClass)(R.root,"xgplayer-is-autoplay")})},(0,c.typeOf)(P)!=="Array"?(0,c.typeOf)(P)==="String"&&P.indexOf("blob:")>-1&&P===this.video.src||(this.video.src=P):P.forEach(function(L){C.video.appendChild((0,c.createDom)("source","",{src:""+L.src,type:""+(L.type||"")}))}),this.config.autoplay&&(e.default.os.isPhone?this.canPlayFunc():this.on("canplay",this.canPlayFunc)),this.config.disableStartLoad||this.video.load(),this.attachVideo()}}},{key:"reload",value:function(){this.video.load(),this.reloadFunc=function(){var C=this.play();C!==void 0&&C&&C.catch(function(P){})},this.once("loadeddata",this.reloadFunc)}},{key:"destroy",value:function(){var C=this,P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=this;clearInterval(this.bulletResizeTimer);for(var L in this._interval)clearInterval(this._interval[L]),this._interval[L]=null;this.checkTimer&&clearInterval(this.checkTimer),this.waitTimer&&clearTimeout(this.waitTimer),this.ev.forEach(function(_){var x=Object.keys(_)[0],A=C[_[x]];A&&C.off(x,A)}),this.loadeddataFunc&&this.off("loadeddata",this.loadeddataFunc),this.reloadFunc&&this.off("loadeddata",this.reloadFunc),this.replayFunc&&this.off("play",this.replayFunc),this.playFunc&&this.off("play",this.playFunc),this.getVideoSize&&this.off("loadeddata",this.getVideoSize),["focus","blur"].forEach(function(_){C.off(_,C["on"+_.charAt(0).toUpperCase()+_.slice(1)])}),(!this.config.keyShortcut||this.config.keyShortcut==="on")&&["video","controls"].forEach(function(_){C[_]&&C[_].removeEventListener("keydown",function(x){R.onKeydown(x,R)})});function O(){if(this.emit("destroy"),this.video.removeAttribute("src"),this.video.load(),P){this.root.innerHTML="";var _=this.root.className.split(" ");_.length>0?this.root.className=_.filter(function(A){return A.indexOf("xgplayer")<0}).join(" "):this.root.className=""}for(var x in this)delete this[x];(0,f.default)(this)}this.paused?O.call(this):(this.pause(),this.once("pause",O)),G(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"destroy",this).call(this)}},{key:"replay",value:function(){var C=this._replay;if((0,c.removeClass)(this.root,"xgplayer-ended"),e.default.browser.indexOf("ie")>-1&&(this.emit("play"),this.emit("playing")),C&&C instanceof Function)C();else{this.currentTime=0;var P=this.play();P!==void 0&&P&&P.catch(function(R){})}}},{key:"userGestureTrigEvent",value:function(C,P){var R=this,L=function(_,x){R.emit(_,x)};this.config.userGestureEventMiddleware&&typeof this.config.userGestureEventMiddleware[C]=="function"?this.config.userGestureEventMiddleware[C].call(this,this,C,P,L):L.call(this,C,P)}},{key:"pluginsCall",value:function(){var C=this;b.plugins.s_i18n&&b.plugins.s_i18n.call(this,this);var P=this;if(b.plugins){var R=this.config.ignores;Object.keys(b.plugins).forEach(function(L){var O=b.plugins[L];!O||typeof O!="function"?console.warn("plugin name",L,"is invalid"):!R.some(function(_){return L===_||L==="s_"+_})&&L!=="s_i18n"&&(["pc","tablet","mobile"].some(function(_){return _===L})?L===e.default.device&&setTimeout(function(){!P.video||O.call(P,P)},0):O.call(C,C))})}}},{key:"onFocus",value:function(){var C=this;(0,c.hasClass)(this.root,"xgplayer-inactive")&&C.emit("controlShow"),(0,c.removeClass)(this.root,"xgplayer-inactive"),C.userTimer&&clearTimeout(C.userTimer),C.userTimer=setTimeout(function(){C.emit("blur")},C.config.inactive)}},{key:"onBlur",value:function(){(this.config.enablePausedInactive||!this.paused)&&!this.ended&&!this.config.closeInactive&&((0,c.hasClass)(this.root,"xgplayer-inactive")||this.emit("controlHide"),(0,c.addClass)(this.root,"xgplayer-inactive"))}},{key:"onPlay",value:function(){(0,c.addClass)(this.root,"xgplayer-isloading"),(0,c.addClass)(this.root,"xgplayer-playing"),(0,c.removeClass)(this.root,"xgplayer-pause")}},{key:"onPause",value:function(){(0,c.addClass)(this.root,"xgplayer-pause"),this.userTimer&&clearTimeout(this.userTimer),this.emit("focus")}},{key:"onEnded",value:function(){(0,c.addClass)(this.root,"xgplayer-ended"),(0,c.removeClass)(this.root,"xgplayer-playing")}},{key:"onSeeking",value:function(){this.isSeeking=!0,this.onWaiting()}},{key:"onSeeked",value:function(){var C=this;this.once("timeupdate",function(){C.isSeeking=!1}),this.waitTimer&&clearTimeout(this.waitTimer),(0,c.removeClass)(this.root,"xgplayer-isloading")}},{key:"onWaiting",value:function(){var C=this;C.waitTimer&&clearTimeout(C.waitTimer),C.checkTimer&&(clearInterval(C.checkTimer),C.checkTimer=null);var P=C.currentTime;C.waitTimer=setTimeout(function(){(0,c.addClass)(C.root,"xgplayer-isloading"),C.checkTimer=setInterval(function(){C.currentTime!==P&&((0,c.removeClass)(C.root,"xgplayer-isloading"),clearInterval(C.checkTimer),C.checkTimer=null)},1e3)},500)}},{key:"onPlaying",value:function(){this.paused||(this.isSeeking=!1,this.waitTimer&&clearTimeout(this.waitTimer),(0,c.removeClass)(this.root,"xgplayer-isloading xgplayer-nostart xgplayer-pause xgplayer-ended xgplayer-is-error xgplayer-replay"),(0,c.addClass)(this.root,"xgplayer-playing"))}}],[{key:"install",value:function(C,P){!(0,c.checkIsBrowser)()||(b.plugins||(b.plugins={}),b.plugins[C]||(b.plugins[C]=P))}},{key:"installAll",value:function(C){for(var P=0;P<C.length;P++)b.install(C[P].name,C[P].method)}},{key:"use",value:function(C,P){b.plugins||(b.plugins={}),b.plugins[C]=P}},{key:"useAll",value:function(C){for(var P in C)b.use(C[P].name,C[P].method)}},{key:"controlsRun",value:function(C,P){C.forEach(function(R){R.method.call(P)})}}]),b}(r.default);w.util=c.util,w.sniffer=e.default,w.Errors=u.default,w.XgplayerTimeRange=a.default,I.default=w,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c={};c.en={HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"Pip",MINIPLAYER:"Miniplayer",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",MINIPLAYER_DRAG:"Click and hold to drag",AIRPLAY_TIPS:"Airplay"},c["zh-cn"]={HAVE_NOTHING:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u9891/\u89C6\u9891\u7684\u5143\u6570\u636E\u5DF2\u5C31\u7EEA",HAVE_CURRENT_DATA:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC",NETWORK_LOADING:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_DECODE:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u9891/\u89C6\u9891\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7F51\u7EDC\u8FDE\u63A5\u4F3C\u4E4E\u51FA\u73B0\u4E86\u95EE\u9898",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u6682\u505C",PLAYNEXT_TIPS:"\u4E0B\u4E00\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F7D",ROTATE_TIPS:"\u65CB\u8F6C",RELOAD_TIPS:"\u91CD\u65B0\u8F7D\u5165",FULLSCREEN_TIPS:"\u8FDB\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u8FDB\u5165\u6837\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6837\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u753B\u4E2D\u753B",MINIPLAYER:"\u8FF7\u4F60\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u56FE",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u5173\u95ED",MINIPLAYER_DRAG:"\u70B9\u51FB\u6309\u4F4F\u53EF\u62D6\u52A8\u89C6\u9891",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},c["zh-hk"]={HAVE_NOTHING:"\u6C92\u6709\u95DC\u65BC\u97F3\u983B/\u8996\u983B\u662F\u5426\u5C31\u7DD2\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u983B/\u8996\u983B\u7684\u5143\u6578\u64DA\u5DF2\u5C31\u7DD2",HAVE_CURRENT_DATA:"\u95DC\u65BC\u7576\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6C92\u6709\u8DB3\u5920\u7684\u6578\u64DA\u4F86\u64AD\u653E\u4E0B\u58F9\u5E40/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u7576\u524D\u53CA\u81F3\u5C11\u4E0B\u58F9\u5E40\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6578\u64DA\u8DB3\u4EE5\u958B\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u983B/\u8996\u983B\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u983B/\u8996\u983B\u662F\u6D3B\u52D5\u7684\u4E14\u5DF2\u9078\u53D6\u8CC7\u6E90\uFF0C\u4F46\u4E26\u672A\u4F7F\u7528\u7DB2\u7D61",NETWORK_LOADING:"\u700F\u89BD\u5668\u6B63\u5728\u4E0B\u8F09\u6578\u64DA",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u983B/\u8996\u983B\u4F86\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u904E\u7A0B\u88AB\u7528\u6236\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u7576\u4E0B\u8F09\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_DECODE:"\u7576\u89E3\u78BC\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u983B/\u8996\u983B\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7DB2\u7D61\u9023\u63A5\u4F3C\u4E4E\u51FA\u73FE\u4E86\u554F\u984C",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u66AB\u505C",PLAYNEXT_TIPS:"\u4E0B\u58F9\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F09",ROTATE_TIPS:"\u65CB\u8F49",RELOAD_TIPS:"\u91CD\u65B0\u8F09\u5165",FULLSCREEN_TIPS:"\u9032\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u9032\u5165\u6A23\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6A23\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u756B\u4E2D\u756B",MINIPLAYER:"\u8FF7\u59B3\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u5716",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u95DC\u9589",MINIPLAYER_DRAG:"\u9EDE\u64CA\u6309\u4F4F\u53EF\u62D6\u52D5\u8996\u983B",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},c.jp={HAVE_NOTHING:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u6E96\u5099\u3067\u304D\u3066\u3044\u308B\u304B\u60C5\u5831\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_METADATA:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306E\u30E1\u30BF\u30C7\u30FC\u30BF\u306F\u6E96\u5099\u3067\u304D\u3066\u3044\u307E\u3059",HAVE_CURRENT_DATA:"\u73FE\u5728\u306E\u518D\u751F\u4F4D\u7F6E\u306B\u95A2\u3059\u308B\u30C7\u30FC\u30BF\u306F\u5229\u7528\u53EF\u80FD\u3067\u3059\u304C\u3001\u6B21\u306E\u30D5\u30EC\u30FC\u30E0/\u30DF\u30EA\u79D2\u3092\u518D\u751F\u3059\u308B\u306E\u306B\u5341\u5206\u306A\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_FUTURE_DATA:"\u73FE\u5728\u3001\u5C11\u306A\u304F\u3068\u3082\u6B21\u306E\u30D5\u30EC\u30FC\u30E0\u306E\u30C7\u30FC\u30BF\u304C\u5229\u7528\u53EF\u80FD\u3067\u3059",HAVE_ENOUGH_DATA:"\u5229\u7528\u53EF\u80FD\u306A\u30C7\u30FC\u30BF\u306F\u518D\u751F\u3092\u958B\u59CB\u3059\u308B\u306E\u306B\u5341\u5206\u3067\u3059",NETWORK_EMPTY:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u521D\u671F\u5316\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_IDLE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306F\u30A2\u30AF\u30C6\u30A3\u30D6\u3067\u30EA\u30BD\u30FC\u30B9\u304C\u9078\u629E\u3055\u308C\u3066\u3044\u307E\u3059\u304C\u3001\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u304C\u4F7F\u7528\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_LOADING:"\u30D6\u30E9\u30A6\u30B6\u30FC\u306F\u30C7\u30FC\u30BF\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u3057\u3066\u3044\u307E\u3059",NETWORK_NO_SOURCE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u30BD\u30FC\u30B9\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093",MEDIA_ERR_ABORTED:"\u30E6\u30FC\u30B6\u30FC\u306B\u3088\u3063\u3066\u30D5\u30A7\u30C3\u30C1\u30D7\u30ED\u30BB\u30B9\u304C\u4E2D\u6B62\u3055\u308C\u307E\u3057\u305F",MEDIA_ERR_NETWORK:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_DECODE:"\u30C7\u30B3\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u5F62\u5F0F\u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093",REPLAY:"\u30EA\u30D7\u30EC\u30A4",ERROR:"\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u306E\u63A5\u7D9A\u306B\u554F\u984C\u304C\u767A\u751F\u3057\u307E\u3057\u305F",PLAY_TIPS:"\u30D7\u30EC\u30A4",PAUSE_TIPS:"\u4E00\u6642\u505C\u6B62",PLAYNEXT_TIPS:"\u6B21\u3092\u30D7\u30EC\u30A4",DOWNLOAD_TIPS:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",ROTATE_TIPS:"\u56DE\u8EE2",RELOAD_TIPS:"\u518D\u8AAD\u307F\u8FBC\u307F",FULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3",EXITFULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3\u3092\u7D42\u4E86",CSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9",EXITCSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9\u3092\u7D42\u4E86",TEXTTRACK:"\u5B57\u5E55",PIP:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",MINIPLAYER:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",SCREENSHOT:"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8",LIVE:"\u751F\u653E\u9001",OFF:"\u30AA\u30D5",MINIPLAYER_DRAG:"\u30DC\u30BF\u30F3\u3092\u62BC\u3057\u3066\u50CD\u753B\u3092\u30C9\u30E9\u30C3\u30B0\u3059\u308B",AIRPLAY_TIPS:"\u9694\u7A7A\u653E\u9001"},Object.defineProperty(r,"lang",{get:function(){return r.config&&c[r.config.lang]||c.en},set:function(e){(0,F.typeOf)(e)==="Object"&&Object.keys(e).forEach(function(n){c[n]=e[n]})}})};I.default={name:"s_i18n",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function u(t,f){for(var h=0;h<f.length;h++){var v=f[h];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(t,v.key,v)}}return function(t,f,h){return f&&u(t.prototype,f),h&&u(t,h),t}}(),G=K(12),m=e(G),r=K(0),c=K(4),l=e(c);function e(u){return u&&u.__esModule?u:{default:u}}function n(u,t,f){return t in u?Object.defineProperty(u,t,{value:f,enumerable:!0,configurable:!0,writable:!0}):u[t]=f,u}function a(u,t){if(!(u instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function u(t){var f=this;a(this,u),this._hasStart=!1,this.videoConfig={controls:!!t.isShowControl,autoplay:t.autoplay,playsinline:t.playsinline,"webkit-playsinline":t.playsinline,"x5-playsinline":t.playsinline,"x5-video-player-type":t["x5-video-player-type"]||t.x5VideoPlayerType,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:2,mediaType:t.mediaType||"video"},t.muted&&(this.videoConfig.muted="muted"),t.loop&&(this.videoConfig.loop="loop");var h="";if(this.textTrackShowDefault=!0,t.nativeTextTrack&&Array.isArray(t.nativeTextTrack)&&(t.nativeTextTrack.length>0&&!t.nativeTextTrack.some(function(P){return P.default})&&(t.nativeTextTrack[0].default=!0,this.textTrackShowDefault=!1),t.nativeTextTrack.some(function(P){if(P.src&&P.label&&P.default)return h+='<track src="'+P.src+'" ',P.kind&&(h+='kind="'+P.kind+'" '),h+='label="'+P.label+'" ',P.srclang&&(h+='srclang="'+P.srclang+'" '),h+=(P.default?"default":"")+">",!0}),this.videoConfig.crossorigin="anonymous"),t.textTrackStyle){var v=document.createElement("style");this.textTrackStyle=v,document.head.appendChild(v);var y="";for(var p in t.textTrackStyle)y+=p+": "+t.textTrackStyle[p]+";";var g=t.id?"#"+t.id:t.el.id?"#"+t.el.id:"."+t.el.className;v.sheet.insertRule?v.sheet.insertRule(g+" video::cue { "+y+" }",0):v.sheet.addRule&&v.sheet.addRule(g+" video::cue",y)}var d=t.el?t.el:(0,r.findDom)(document,"#"+t.id),E=this.constructor.XgVideoProxy;if(E&&this.videoConfig.mediaType===E.mediaType?this.video=new E(d,t):this.video=(0,r.createDom)(this.videoConfig.mediaType,h,this.videoConfig,""),t.videoStyle&&Object.keys(t.videoStyle).forEach(function(P){(0,r.setStyle)(f.video,P,t.videoStyle[P])}),!this.textTrackShowDefault&&h){var w=this.video.getElementsByTagName("Track");w[0].track.mode="hidden"}t.autoplay&&(this.video.autoplay=!0,t.autoplayMuted&&(this.video.muted=!0)),this.ev=["play","playing","pause","ended","error","seeking","seeked","progress","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","ratechange","loadedmetadata","loadeddata","loadstart"].map(function(P){return n({},P,"on"+P.charAt(0).toUpperCase()+P.slice(1))}),(0,m.default)(this),this._interval={};var D="0,0",b=this,S=function(R){!f||(R==="play"?f.hasStart=!0:R==="canplay"?(0,r.removeClass)(f.root,"xgplayer-is-enter"):R==="waiting"?f.inWaitingStart=new Date().getTime():R==="playing"&&((0,r.removeClass)(f.root,"xgplayer-is-enter"),f.inWaitingStart&&(f.inWaitingStart=void 0)),R==="error"?f._onError(R):f.emit(R,f),f.hasOwnProperty("_interval")&&(["ended","error","timeupdate"].indexOf(R)<0?((0,r._clearInterval)(f,"bufferedChange"),(0,r._setInterval)(f,"bufferedChange",function(){if(this.video&&this.video.buffered){for(var L=[],O=0,_=this.video.buffered.length;O<_;O++)L.push([this.video.buffered.start(O),this.video.buffered.end(O)]);L.toString()!==D&&(D=L.toString(),this.emit("bufferedChange",L))}},200)):R!=="timeupdate"&&(0,r._clearInterval)(f,"bufferedChange")))},C=function(R){t.videoEventMiddleware&&typeof t.videoEventMiddleware[R]=="function"?t.videoEventMiddleware[R].call(f,f,R,S):S.call(f,R)};this.ev.forEach(function(P){b.evItem=Object.keys(P)[0];var R=Object.keys(P)[0];b.video.addEventListener(Object.keys(P)[0],C.bind(b,R))})}return F(u,[{key:"_onError",value:function(f){this.video&&this.video.error&&this.emit(f,new l.default("other",this.currentTime,this.duration,this.networkState,this.readyState,this.currentSrc,this.src,this.ended,{line:162,msg:this.error,handle:"Constructor"},this.video.error.code,this.video.error))}},{key:"destroy",value:function(){this.textTrackStyle&&this.textTrackStyle.parentNode.removeChild(this.textTrackStyle)}},{key:"play",value:function(){return this.video.play()}},{key:"pause",value:function(){this.video.pause()}},{key:"canPlayType",value:function(f){return this.video.canPlayType(f)}},{key:"getBufferedRange",value:function(f){var h=[0,0],v=this.video;f||(f=v.buffered);var y=v.currentTime;if(f)for(var p=0,g=f.length;p<g&&(h[0]=f.start(p),h[1]=f.end(p),!(h[0]<=y&&y<=h[1]));p++);return h[0]-y<=0&&y-h[1]<=0?h:[0,0]}},{key:"proxyOn",value:function(f,h){(0,r.on)(this,f,h,"destroy")}},{key:"proxyOnce",value:function(f,h){(0,r.once)(this,f,h,"destroy")}},{key:"hasStart",get:function(){return this._hasStart},set:function(f){typeof f=="boolean"&&f===!0&&!this._hasStart&&(this._hasStart=!0,this.emit("hasstart"))}},{key:"autoplay",set:function(f){this.video&&(this.video.autoplay=f)},get:function(){return this.video?this.video.autoplay:!1}},{key:"buffered",get:function(){if(this.video)return this.video.buffered}},{key:"buffered2",get:function(){return(0,r.getBuffered2)(this.video.buffered)}},{key:"crossOrigin",get:function(){return this.video?this.video.crossOrigin:!1},set:function(f){this.video&&(this.video.crossOrigin=f)}},{key:"currentSrc",get:function(){if(this.video)return this.video.currentSrc}},{key:"currentTime",get:function(){return this.video&&this.video.currentTime||0},set:function(f){var h=this;typeof isFinite=="function"&&!isFinite(f)||((0,r.hasClass)(this.root,"xgplayer-ended")?(this.once("playing",function(){h.video.currentTime=f}),this.replay()):this.video.currentTime=f,this.emit("currentTimeChange",f))}},{key:"defaultMuted",get:function(){return this.video?this.video.defaultMuted:!1},set:function(f){this.video&&(this.video.defaultMuted=f)}},{key:"duration",get:function(){return this.config.duration?this.video?Math.min(this.config.duration,this.video.duration):this.config.duration:this.video?this.video.duration:null}},{key:"ended",get:function(){return this.video?this.video.ended||!1:!0}},{key:"error",get:function(){var f=this.video.error;if(!f)return null;var h=[{en:"MEDIA_ERR_ABORTED",cn:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62"},{en:"MEDIA_ERR_NETWORK",cn:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_DECODE",cn:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_SRC_NOT_SUPPORTED",cn:"\u4E0D\u652F\u6301\u97F3\u9891/\u89C6\u9891"}];return this.lang?this.lang[h[f.code-1].en]:h[f.code-1].en}},{key:"loop",get:function(){return this.video?this.video.loop:!1},set:function(f){this.video&&(this.video.loop=f)}},{key:"muted",get:function(){return this.video?this.video.muted:!1},set:function(f){this.video&&(this.video.muted=f)}},{key:"networkState",get:function(){var f=[{en:"NETWORK_EMPTY",cn:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316"},{en:"NETWORK_IDLE",cn:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC"},{en:"NETWORK_LOADING",cn:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E"},{en:"NETWORK_NO_SOURCE",cn:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90"}];return this.lang?this.lang[f[this.video.networkState].en]:f[this.video.networkState].en}},{key:"paused",get:function(){return(0,r.hasClass)(this.root,"xgplayer-pause")}},{key:"playbackRate",get:function(){return this.video?this.video.playbackRate:1},set:function(f){this.video&&(this.video.playbackRate=f)}},{key:"played",get:function(){if(this.video)return this.video.played}},{key:"preload",get:function(){return this.video?this.video.preload:!1},set:function(f){this.video&&(this.video.preload=f)}},{key:"readyState",get:function(){var f=[{en:"HAVE_NOTHING",cn:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F"},{en:"HAVE_METADATA",cn:"\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u5C31\u7EEA\u7684\u5143\u6570\u636E"},{en:"HAVE_CURRENT_DATA",cn:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2"},{en:"HAVE_FUTURE_DATA",cn:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684"},{en:"HAVE_ENOUGH_DATA",cn:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E"}];return this.lang?this.lang[f[this.video.readyState].en]:f[this.video.readyState]}},{key:"seekable",get:function(){return this.video?this.video.seekable:!1}},{key:"seeking",get:function(){return this.video?this.video.seeking:!1}},{key:"src",get:function(){if(this.video)return this.video.src},set:function(f){(0,r.hasClass)(this.root,"xgplayer-ended")||this.emit("urlchange",this.video.src),(0,r.removeClass)(this.root,"xgplayer-ended xgplayer-is-replay xgplayer-is-error"),this.video.pause(),this.emit("pause"),this.video.src=f,this.emit("srcChange")}},{key:"poster",set:function(f){var h=(0,r.findDom)(this.root,".xgplayer-poster");h&&(h.style.backgroundImage="url("+f+")")}},{key:"volume",get:function(){return this.video?this.video.volume:1},set:function(f){this.video&&(this.video.volume=f)}},{key:"fullscreen",get:function(){return(0,r.hasClass)(this.root,"xgplayer-is-fullscreen")||(0,r.hasClass)(this.root,"xgplayer-fullscreen-active")}},{key:"bullet",get:function(){return(0,r.findDom)(this.root,"xg-danmu")?(0,r.hasClass)((0,r.findDom)(this.root,"xg-danmu"),"xgplayer-has-danmu"):!1}},{key:"textTrack",get:function(){return(0,r.hasClass)(this.root,"xgplayer-is-textTrack")}},{key:"pip",get:function(){return(0,r.hasClass)(this.root,"xgplayer-pip-active")}},{key:"isMiniPlayer",get:function(){return(0,r.hasClass)(this.root,"xgplayer-miniplayer-active")}}]),u}();I.default=s,X.exports=I.default},function(X,I,K){var F=K(13),G=K(30),m=Function.prototype.apply,r=Function.prototype.call,c=Object.create,l=Object.defineProperty,e=Object.defineProperties,n=Object.prototype.hasOwnProperty,a={configurable:!0,enumerable:!1,writable:!0},s,u,t,f,h,v,y;s=function(p,g){var d;return G(g),n.call(this,"__ee__")?d=this.__ee__:(d=a.value=c(null),l(this,"__ee__",a),a.value=null),d[p]?typeof d[p]=="object"?d[p].push(g):d[p]=[d[p],g]:d[p]=g,this},u=function(p,g){var d,E;return G(g),E=this,s.call(this,p,d=function(){t.call(E,p,d),m.call(g,this,arguments)}),d.__eeOnceListener__=g,this},t=function(p,g){var d,E,w,D;if(G(g),!n.call(this,"__ee__"))return this;if(d=this.__ee__,!d[p])return this;if(E=d[p],typeof E=="object")for(D=0;w=E[D];++D)(w===g||w.__eeOnceListener__===g)&&(E.length===2?d[p]=E[D?0:1]:E.splice(D,1));else(E===g||E.__eeOnceListener__===g)&&delete d[p];return this},f=function(p){var g,d,E,w,D;if(!!n.call(this,"__ee__")&&(w=this.__ee__[p],!!w))if(typeof w=="object"){for(d=arguments.length,D=new Array(d-1),g=1;g<d;++g)D[g-1]=arguments[g];for(w=w.slice(),g=0;E=w[g];++g)m.call(E,this,D)}else switch(arguments.length){case 1:r.call(w,this);break;case 2:r.call(w,this,arguments[1]);break;case 3:r.call(w,this,arguments[1],arguments[2]);break;default:for(d=arguments.length,D=new Array(d-1),g=1;g<d;++g)D[g-1]=arguments[g];m.call(w,this,D)}},h={on:s,once:u,off:t,emit:f},v={on:F(s),once:F(u),off:F(t),emit:F(f)},y=e({},v),X.exports=I=function(p){return p==null?c(y):e(Object(p),v)},I.methods=h},function(X,I,K){var F=K(6),G=K(14),m=K(18),r=K(26),c=K(27),l=X.exports=function(e,n){var a,s,u,t,f;return arguments.length<2||typeof e!="string"?(t=n,n=e,e=null):t=arguments[2],F(e)?(a=c.call(e,"c"),s=c.call(e,"e"),u=c.call(e,"w")):(a=u=!0,s=!1),f={value:n,configurable:a,enumerable:s,writable:u},t?m(r(t),f):f};l.gs=function(e,n,a){var s,u,t,f;return typeof e!="string"?(t=a,a=n,n=e,e=null):t=arguments[3],F(n)?G(n)?F(a)?G(a)||(t=a,a=void 0):a=void 0:(t=n,n=a=void 0):n=void 0,F(e)?(s=c.call(e,"c"),u=c.call(e,"e")):(s=!0,u=!1),f={get:n,set:a,configurable:s,enumerable:u},t?m(r(t),f):f}},function(X,I,K){var F=K(15),G=/^\s*class[\s{/}]/,m=Function.prototype.toString;X.exports=function(r){return!(!F(r)||G.test(m.call(r)))}},function(X,I,K){var F=K(16);X.exports=function(G){if(typeof G!="function"||!hasOwnProperty.call(G,"length"))return!1;try{if(typeof G.length!="number"||typeof G.call!="function"||typeof G.apply!="function")return!1}catch{return!1}return!F(G)}},function(X,I,K){var F=K(17);X.exports=function(G){if(!F(G))return!1;try{return G.constructor?G.constructor.prototype===G:!1}catch{return!1}}},function(X,I,K){var F=K(6),G={object:!0,function:!0,undefined:!0};X.exports=function(m){return F(m)?hasOwnProperty.call(G,typeof m):!1}},function(X,I,K){X.exports=K(19)()?Object.assign:K(20)},function(X,I,K){X.exports=function(){var F=Object.assign,G;return typeof F!="function"?!1:(G={foo:"raz"},F(G,{bar:"dwa"},{trzy:"trzy"}),G.foo+G.bar+G.trzy==="razdwatrzy")}},function(X,I,K){var F=K(21),G=K(25),m=Math.max;X.exports=function(r,c){var l,e,n=m(arguments.length,2),a;for(r=Object(G(r)),a=function(s){try{r[s]=c[s]}catch(u){l||(l=u)}},e=1;e<n;++e)c=arguments[e],F(c).forEach(a);if(l!==void 0)throw l;return r}},function(X,I,K){X.exports=K(22)()?Object.keys:K(23)},function(X,I,K){X.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},function(X,I,K){var F=K(3),G=Object.keys;X.exports=function(m){return G(F(m)?Object(m):m)}},function(X,I,K){X.exports=function(){}},function(X,I,K){var F=K(3);X.exports=function(G){if(!F(G))throw new TypeError("Cannot use null or undefined");return G}},function(X,I,K){var F=K(3),G=Array.prototype.forEach,m=Object.create,r=function(c,l){var e;for(e in c)l[e]=c[e]};X.exports=function(c){var l=m(null);return G.call(arguments,function(e){!F(e)||r(Object(e),l)}),l}},function(X,I,K){X.exports=K(28)()?String.prototype.contains:K(29)},function(X,I,K){var F="razdwatrzy";X.exports=function(){return typeof F.contains!="function"?!1:F.contains("dwa")===!0&&F.contains("foo")===!1}},function(X,I,K){var F=String.prototype.indexOf;X.exports=function(G){return F.call(this,G,arguments[1])>-1}},function(X,I,K){X.exports=function(F){if(typeof F!="function")throw new TypeError(F+" is not a function");return F}},function(X,I,K){var F=K(32),G=Object.prototype.hasOwnProperty;X.exports=function(m){var r=arguments[1],c;if(F(m),r!==void 0){if(c=G.call(m,"__ee__")&&m.__ee__,!c)return;c[r]&&delete c[r];return}G.call(m,"__ee__")&&delete m.__ee__}},function(X,I,K){var F=K(33);X.exports=function(G){if(!F(G))throw new TypeError(G+" is not an Object");return G}},function(X,I,K){var F=K(3),G={function:!0,object:!0};X.exports=function(m){return F(m)&&G[typeof m]||!1}},function(X,I,K){var F=K(35);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default{background:#000;width:100%;height:100%;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.xgplayer-skin-default *{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}.xgplayer-skin-default.xgplayer-rotate-fullscreen{position:absolute;top:0;left:100%;bottom:0;right:0;height:100vw!important;width:100vh!important;-webkit-transform-origin:top left;-ms-transform-origin:top left;transform-origin:top left;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.xgplayer-skin-default.xgplayer-is-fullscreen{width:100%!important;height:100%!important;padding-top:0!important;z-index:9999}.xgplayer-skin-default.xgplayer-is-fullscreen.xgplayer-inactive{cursor:none}.xgplayer-skin-default video{width:100%;height:100%;outline:none}.xgplayer-skin-default .xgplayer-none{display:none}@-webkit-keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}@keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}.xgplayer-skin-default .xgplayer-controls{display:-webkit-flex;display:-moz-box;display:flex;position:absolute;bottom:0;left:0;right:0;height:40px;background-image:linear-gradient(180deg,transparent,rgba(0,0,0,.37),rgba(0,0,0,.75),rgba(0,0,0,.75));z-index:10}.xgplayer-skin-default.xgplayer-inactive .xgplayer-controls,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-progress,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-time,.xgplayer-skin-default.xgplayer-no-controls .xgplayer-controls,.xgplayer-skin-default.xgplayer-nostart .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-live{display:block}.xgplayer-skin-default .xgplayer-live{display:block;font-size:12px;color:#fff;line-height:40px;-webkit-order:1;-moz-box-ordinal-group:2;order:1}.xgplayer-skin-default .xgplayer-icon{display:block;width:40px;height:40px;overflow:hidden;fill:#fff}.xgplayer-skin-default .xgplayer-icon svg{position:absolute}.xgplayer-skin-default .xgplayer-tips{background:rgba(0,0,0,.54);border-radius:1px;display:none;position:absolute;font-family:PingFangSC-Regular;font-size:11px;color:#fff;padding:2px 4px;text-align:center;top:-30px;left:50%;margin-left:-16px;width:auto;white-space:nowrap}.xgplayer-skin-default.xgplayer-mobile .xgplayer-tips{display:none!important}.xgplayer-skin-default .xgplayer-screen-container{display:block;width:100%}",""])},function(X,I){X.exports=function(K){var F=typeof window!="undefined"&&window.location;if(!F)throw new Error("fixUrls requires window.location");if(!K||typeof K!="string")return K;var G=F.protocol+"//"+F.host,m=G+F.pathname.replace(/\/[^\/]*$/,"/"),r=K.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(c,l){var e=l.trim().replace(/^"(.*)"$/,function(a,s){return s}).replace(/^'(.*)'$/,function(a,s){return s});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e))return c;var n;return e.indexOf("//")===0?n=e:e.indexOf("/")===0?n=G+e:n=m+e.replace(/^\.\//,""),"url("+JSON.stringify(n)+")"});return r}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root,l=0,e=void 0,n={first:"",second:""};r.onElementTouchend=function(u,t){this.config.closeVideoPreventDefault||u.preventDefault(),this.config.closeVideoStopPropagation||u.stopPropagation();var f=this;if((0,F.hasClass)(c,"xgplayer-inactive")?f.emit("focus"):f.emit("blur"),!f.config.closeVideoTouch&&!f.isTouchMove){var h=function(){e=setTimeout(function(){if((0,F.hasClass)(f.root,"xgplayer-nostart"))return!1;if(!f.ended)if(f.paused){var y=f.play();y!==void 0&&y&&y.catch(function(p){})}else f.pause();l=0},200)};f.config.closeVideoClick||(l++,e&&clearTimeout(e),l===1?f.config.enableVideoDbltouch?n.first=new Date:h():l===2&&f.config.enableVideoDbltouch?(n.second=new Date,Math.abs(n.first-n.second)<400?h():(n.first=new Date,l=1)):l=0)}};function a(u){r.video.addEventListener("touchend",function(t){r.onElementTouchend(t,r.video)}),r.video.addEventListener("touchstart",function(){r.isTouchMove=!1}),r.video.addEventListener("touchmove",function(){r.isTouchMove=!0}),r.config.autoplay&&r.start()}r.once("ready",a);function s(){r.off("ready",a),r.off("destroy",s)}r.once("destroy",s)};I.default={name:"mobile",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this;if(!r.controls||!r.video)return;var c=r.controls,l=r.root,e=0,n=void 0;r.onElementClick=function(y,p){this.config.closeVideoPreventDefault||y.preventDefault(),this.config.closeVideoStopPropagation||y.stopPropagation();var g=this;g.config.closeVideoClick||(e++,n&&clearTimeout(n),e===1?n=setTimeout(function(){if((0,F.hasClass)(g.root,"xgplayer-nostart"))return!1;if(!g.ended)if(g.paused){var d=g.play();d!==void 0&&d&&d.catch(function(E){})}else g.pause();e=0},200):e=0)},r.video.addEventListener("click",function(y){r.onElementClick(y,r.video)},!1),r.onElementDblclick=function(y,p){this.config.closeVideoPreventDefault||y.preventDefault(),this.config.closeVideoStopPropagation||y.stopPropagation();var g=this;if(!g.config.closeVideoDblclick){var d=c.querySelector(".xgplayer-fullscreen");if(d){var E=void 0;document.createEvent?(E=document.createEvent("Event"),E.initEvent("click",!0,!0)):E=new Event("click"),d.dispatchEvent(E)}}},r.video.addEventListener("dblclick",function(y){r.onElementDblclick(y,r.video)},!1);function a(){clearTimeout(r.leavePlayerTimer),r.emit("focus",r)}l.addEventListener("mouseenter",a);function s(){r.config.closePlayerBlur||(r.leavePlayerTimer=setTimeout(function(){r.emit("blur",r)},r.config.leavePlayerTime||0))}l.addEventListener("mouseleave",s);function u(y){r.userTimer&&clearTimeout(r.userTimer)}c.addEventListener("mouseenter",u);function t(y){r.config.closeControlsBlur||r.emit("focus",r)}c.addEventListener("mouseleave",t);function f(y){y.preventDefault(),y.stopPropagation()}c.addEventListener("click",f);function h(y){r.config.autoplay&&r.start()}r.once("ready",h);function v(){l.removeEventListener("mouseenter",a),l.removeEventListener("mouseleave",s),r.off("ready",h),r.off("destroy",v)}r.once("destroy",v)};I.default={name:"pc",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root;function l(){r.off("canplay",l);var a=r.play();a!==void 0&&a&&a.catch(function(s){})}function e(){(0,F.hasClass)(c,"xgplayer-nostart")?((0,F.removeClass)(c,"xgplayer-nostart"),(0,F.addClass)(c,"xgplayer-is-enter"),typeof c.contains=="function"?r.video&&r.video.nodeType===1&&!c.contains(r.video)||r.video&&r.video.nodeType!==1&&r.video.mediaSource===void 0?(r.once("canplay",l),r.start()):l():r.video&&r.video.nodeType===1&&!c.querySelector(this.videoConfig.mediaType)||r.video&&r.video.nodeType!==1&&r.video.mediaSource===void 0?(r.once("canplay",l),r.start()):l()):r.paused&&((0,F.removeClass)(c,"xgplayer-nostart xgplayer-isloading"),setTimeout(function(){var a=r.play();a!==void 0&&a&&a.catch(function(s){})},10))}r.on("startBtnClick",e);function n(){r.off("startBtnClick",e),r.off("canplay",l),r.off("destroy",n)}r.once("destroy",n)};I.default={name:"start",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(41),m=l(G),r=K(42),c=l(r);K(43);function l(n){return n&&n.__esModule?n:{default:n}}var e=function(){var a=this,s=a.root,u=(0,F.createDom)("xg-start",'<div class="xgplayer-icon-play">'+m.default+`</div>
                                      <div class="xgplayer-icon-pause">`+c.default+"</div>",{},"xgplayer-start");function t(f){(0,F.addClass)(f.root,"xgplayer-skin-default"),f.config&&(f.config.autoplay&&!(0,F.isWeiXin)()&&!(0,F.isUc)()&&(0,F.addClass)(f.root,"xgplayer-is-enter"),f.config.lang&&f.config.lang==="en"?(0,F.addClass)(f.root,"xgplayer-lang-is-en"):f.config.lang==="jp"&&(0,F.addClass)(f.root,"xgplayer-lang-is-jp"),f.config.enableContextmenu||f.video.addEventListener("contextmenu",function(h){h.preventDefault(),h.stopPropagation()}))}a.config&&a.config.hideStartBtn&&(0,F.addClass)(s,"xgplayer-start-hide"),a.isReady?(s.appendChild(u),t(a)):a.once("ready",function(){s.appendChild(u),t(a)}),a.once("autoplay was prevented",function(){(0,F.removeClass)(a.root,"xgplayer-is-enter"),(0,F.addClass)(a.root,"xgplayer-nostart")}),a.once("canplay",function(){(0,F.removeClass)(a.root,"xgplayer-is-enter")}),u.onclick=function(f){f.preventDefault(),f.stopPropagation(),a.userGestureTrigEvent("startBtnClick")}};I.default={name:"s_start",method:e},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04,0.04)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04 0.04)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(X,I,K){var F=K(44);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-start{border-radius:50%;display:inline-block;width:70px;height:70px;background:rgba(0,0,0,.38);overflow:hidden;text-align:center;line-height:70px;vertical-align:middle;position:absolute;left:50%;top:50%;z-index:115;margin:-35px auto auto -35px;cursor:pointer}.xgplayer-skin-default .xgplayer-start div{position:absolute}.xgplayer-skin-default .xgplayer-start div svg{fill:hsla(0,0%,100%,.7)}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-start:hover{opacity:.85}.xgplayer-skin-default.xgplayer-pause.xgplayer-start-hide .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-start-hide .xgplayer-start{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start{display:inline-block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start,.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-pause{display:none}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root;function l(){r.config.rotateFullscreen?(0,F.hasClass)(c,"xgplayer-rotate-fullscreen")?r.exitRotateFullscreen():r.getRotateFullscreen():(0,F.hasClass)(c,"xgplayer-is-fullscreen")?r.exitFullscreen(c):r.getFullscreen(c)}r.on("fullscreenBtnClick",l);function e(){var s=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;s&&s===c?((0,F.addClass)(c,"xgplayer-is-fullscreen"),r.emit("requestFullscreen")):(0,F.hasClass)(c,"xgplayer-is-fullscreen")&&((0,F.removeClass)(c,"xgplayer-is-fullscreen"),r.emit("exitFullscreen")),r.danmu&&typeof r.danmu.resize=="function"&&r.danmu.resize()}["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(s){document.addEventListener(s,e)}),r.video.addEventListener("webkitbeginfullscreen",function(){(0,F.addClass)(c,"xgplayer-is-fullscreen"),r.emit("requestFullscreen")}),r.video.addEventListener("webkitendfullscreen",function(){(0,F.removeClass)(c,"xgplayer-is-fullscreen"),r.emit("exitFullscreen")});function n(s){var u=r.video.webkitPresentationMode;u!==F.PresentationMode.FULLSCREEN&&((0,F.removeClass)(c,"xgplayer-is-fullscreen"),r.emit("exitFullscreen"))}(0,F.checkWebkitSetPresentationMode)(r.video)&&r.video.addEventListener("webkitpresentationmodechanged",n);function a(){r.off("fullscreenBtnClick",l),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(s){document.removeEventListener(s,e)}),(0,F.checkWebkitSetPresentationMode)(r.video)&&r.video.removeEventListener("webkitpresentationmodechanged",n),r.off("destroy",a)}r.once("destroy",a),r.getFullscreen=function(s){var u=this;if(s.requestFullscreen){var t=s.requestFullscreen();t&&t.catch(function(){u.emit("fullscreen error")})}else s.mozRequestFullScreen?s.mozRequestFullScreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):u.video.webkitSupportsFullscreen?u.video.webkitEnterFullscreen():s.msRequestFullscreen?s.msRequestFullscreen():(0,F.addClass)(s,"xgplayer-is-cssfullscreen")},r.exitFullscreen=function(s){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),(0,F.removeClass)(s,"xgplayer-is-cssfullscreen")},r.getRotateFullscreen=function(){var s=this;document.documentElement.style.width="100%",document.documentElement.style.height="100%",s.config.fluid&&(s.root.style["padding-top"]="",s.root.style["max-width"]="unset"),s.root&&!(0,F.hasClass)(s.root,"xgplayer-rotate-fullscreen")&&(0,F.addClass)(s.root,"xgplayer-rotate-fullscreen"),s.emit("getRotateFullscreen")},r.exitRotateFullscreen=function(){var s=this;document.documentElement.style.width="unset",document.documentElement.style.height="unset",s.config.fluid&&(s.root.style.width="100%",s.root.style.height="0",s.root.style["padding-top"]=s.config.height*100/s.config.width+"%",s.root.style["max-width"]="100%"),s.root&&(0,F.hasClass)(s.root,"xgplayer-rotate-fullscreen")&&(0,F.removeClass)(s.root,"xgplayer-rotate-fullscreen"),s.emit("exitRotateFullscreen")}};I.default={name:"fullscreen",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this;function c(){if(!(!r.config.allowPlayAfterEnded&&r.ended))if((0,F.hasClass)(r.root,"xgplayer-nostart")&&r.start(),r.paused){var e=r.play();e!==void 0&&e&&e.catch(function(n){})}else r.pause()}r.on("playBtnClick",c);function l(){r.off("playBtnClick",c),r.off("destroy",l)}r.once("destroy",l)};I.default={name:"play",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root;function l(){(0,F.removeClass)(c,"xgplayer-is-replay"),r.replay()}r.on("replayBtnClick",l);function e(){r.config.loop||(0,F.addClass)(c,"xgplayer-is-replay")}r.on("ended",e);function n(){r.off("replayBtnClick",l),r.off("destroy",n)}r.once("destroy",n)};I.default={name:"replay",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(49),m=l(G),r=K(50),c=l(r);K(51);function l(n){return n&&n.__esModule?n:{default:n}}var e=function(){var a=this,s=a.config.playBtn?a.config.playBtn:{},u=void 0;s.type==="img"?u=(0,F.createImgBtn)("play",s.url.play,s.width,s.height):u=(0,F.createDom)("xg-play",`<xg-icon class="xgplayer-icon">
                                      <div class="xgplayer-icon-play">`+m.default+`</div>
                                      <div class="xgplayer-icon-pause">`+c.default+`</div>
                                     </xg-icon>`,{},"xgplayer-play");var t={};t.play=a.lang.PLAY_TIPS,t.pause=a.lang.PAUSE_TIPS;var f=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-play">'+t.play+`</span>
                                        <span class="xgplayer-tip-pause">`+t.pause+"</span>",{},"xgplayer-tips");u.appendChild(f),a.once("ready",function(){a.controls&&a.controls.appendChild(u)}),["click","touchend"].forEach(function(h){u.addEventListener(h,function(v){v.preventDefault(),v.stopPropagation(),a.userGestureTrigEvent("playBtnClick")})})};I.default={name:"s_play",method:e},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(X,I,K){var F=K(52);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-play,.xgplayer-skin-default .xgplayer-play-img{width:40px;position:relative;-webkit-order:0;-moz-box-ordinal-group:1;order:0;display:block;cursor:pointer;margin-left:3px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-play .xgplayer-icon{margin-top:3px;width:32px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-play .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}.xgplayer-skin-default .xgplayer-play-img:hover,.xgplayer-skin-default .xgplayer-play:hover{opacity:.85}.xgplayer-skin-default .xgplayer-play-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-play:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(54);var G=function(){var r=this,c=r.root;if(!!r.config.poster){var l=(0,F.createDom)("xg-poster","",{},"xgplayer-poster");l.style.backgroundImage="url("+r.config.poster+")",c.appendChild(l)}};I.default={name:"s_poster",method:G},X.exports=I.default},function(X,I,K){var F=K(55);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-poster{display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:100;background-size:cover;background-position:50%}.xgplayer-skin-default.xgplayer-nostart .xgplayer-poster{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(57);var G=function(){var r=this,c=(0,F.createDom)("xg-placeholder","",{},"xgplayer-placeholder");r.controls.appendChild(c)};I.default={name:"s_flex",method:G},X.exports=I.default},function(X,I,K){var F=K(58);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-placeholder{-webkit-flex:1;-moz-box-flex:1;flex:1;-webkit-order:3;-moz-box-ordinal-group:4;order:3;display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(60),m=l(G),r=K(61),c=l(r);K(62);function l(n){return n&&n.__esModule?n:{default:n}}var e=function(){var a=this,s=a.config.fullscreenBtn?a.config.fullscreenBtn:{},u=void 0;s.type==="img"?u=(0,F.createImgBtn)("fullscreen",s.url.request,s.width,s.height):u=(0,F.createDom)("xg-fullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+m.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+c.default+`</div>
                                           </xg-icon>`,{},"xgplayer-fullscreen");var t={};t.requestfull=a.lang.FULLSCREEN_TIPS,t.exitfull=a.lang.EXITFULLSCREEN_TIPS;var f=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+t.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+t.exitfull+"</span>",{},"xgplayer-tips");u.appendChild(f),a.once("ready",function(){a.controls&&a.controls.appendChild(u)}),["click","touchend"].forEach(function(h){u.addEventListener(h,function(v){v.preventDefault(),v.stopPropagation(),a.userGestureTrigEvent("fullscreenBtnClick")})})};I.default={name:"s_fullscreen",method:e},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`},function(X,I,K){var F=K(63);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-fullscreen,.xgplayer-skin-default .xgplayer-fullscreen-img{position:relative;-webkit-order:13;-moz-box-ordinal-group:14;order:13;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img:hover,.xgplayer-skin-default .xgplayer-fullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-fullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(65),m=r(G);K(66);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.root,a=(0,F.createDom)("xg-loading",""+m.default,{},"xgplayer-loading");e.once("ready",function(){n.appendChild(a)})};I.default={name:"s_loading",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100">
  <path d="M100,50A50,50,0,1,1,50,0"></path>
</svg>
`},function(X,I,K){var F=K(67);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-loading{display:none;width:100px;height:100px;overflow:hidden;-webkit-transform:scale(.7);-ms-transform:scale(.7);transform:scale(.7);position:absolute;left:50%;top:50%;margin:-50px auto auto -50px}.xgplayer-skin-default .xgplayer-loading svg{border-radius:50%;-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-animation:loadingRotate 1s linear infinite;animation:loadingRotate 1s linear infinite}.xgplayer-skin-default .xgplayer-loading svg path{stroke:#ddd;stroke-dasharray:236;-webkit-animation:loadingDashOffset 2s linear infinite;animation:loadingDashOffset 2s linear infinite;animation-direction:alternate-reverse;fill:none;stroke-width:12px}.xgplayer-skin-default.xgplayer-nostart .xgplayer-loading{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-loading{display:none!important}.xgplayer-skin-default.xgplayer-isloading .xgplayer-loading{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(5),m=r(G);K(69);function r(e){return e&&e.__esModule?e:{default:e}}var c=function(n){return(0,F.hasClass)(n.root,"xgplayer-rotate-fullscreen")},l=function(){var n=this,a=(0,F.createDom)("xg-progress",`<xg-outer class="xgplayer-progress-outer">
                                                   <xg-cache class="xgplayer-progress-cache"></xg-cache>
                                                   <xg-played class="xgplayer-progress-played">
                                                     <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
                                                     <xg-point class="xgplayer-progress-point xgplayer-tips"></xg-point>
                                                     <xg-thumbnail class="xgplayer-progress-thumbnail xgplayer-tips"></xg-thumbnail>
                                                   </xg-played>
                                                 </xg-outer>`,{tabindex:1},"xgplayer-progress"),s=void 0;n.controls.appendChild(a);var u=a.querySelector(".xgplayer-progress-played"),t=a.querySelector(".xgplayer-progress-outer"),f=a.querySelector(".xgplayer-progress-cache"),h=a.querySelector(".xgplayer-progress-point"),v=a.querySelector(".xgplayer-progress-thumbnail");n.dotArr={};function y(N,U){N.addEventListener("mouseenter",function(j){U&&((0,F.addClass)(N,"xgplayer-progress-dot-show"),(0,F.addClass)(a,"xgplayer-progress-dot-active"))}),N.addEventListener("mouseleave",function(j){U&&((0,F.removeClass)(N,"xgplayer-progress-dot-show"),(0,F.removeClass)(a,"xgplayer-progress-dot-active"))}),N.addEventListener("touchend",function(j){j.stopPropagation(),U&&((0,F.hasClass)(N,"xgplayer-progress-dot-show")||Object.keys(n.dotArr).forEach(function(z){n.dotArr[z]&&(0,F.removeClass)(n.dotArr[z],"xgplayer-progress-dot-show")}),(0,F.toggleClass)(N,"xgplayer-progress-dot-show"),(0,F.toggleClass)(a,"xgplayer-progress-dot-active"))})}function p(){n.config.progressDot&&(0,F.typeOf)(n.config.progressDot)==="Array"&&n.config.progressDot.forEach(function(N){if(N.time>=0&&N.time<=n.duration){var U=(0,F.createDom)("xg-progress-dot",N.text?'<span class="xgplayer-progress-tip">'+N.text+"</span>":"",{},"xgplayer-progress-dot");if(U.style.left=N.time/n.duration*100+"%",N.duration>=0&&(U.style.width=Math.min(N.duration,n.duration-N.time)/n.duration*100+"%"),N.style)for(var j in N.style)U.style[j]=N.style[j];t.appendChild(U),n.dotArr[N.time]=U,y(U,N.text)}})}n.once("canplay",p),n.addProgressDot=function(N,U,j,z){if(!n.dotArr[N]&&N>=0&&N<=n.duration){var J=(0,F.createDom)("xg-progress-dot",U?'<span class="xgplayer-progress-tip">'+U+"</span>":"",{},"xgplayer-progress-dot");if(J.style.left=N/n.duration*100+"%",j>=0&&(J.style.width=Math.min(j,n.duration-N)/n.duration*100+"%"),z)for(var te in z)J.style[te]=z[te];t.appendChild(J),n.dotArr[N]=J,y(J,U)}},n.removeProgressDot=function(N){if(N>=0&&N<=n.duration&&n.dotArr[N]){var U=n.dotArr[N];U.parentNode.removeChild(U),U=null,n.dotArr[N]=null}},n.removeAllProgressDot=function(){Object.keys(n.dotArr).forEach(function(N){if(n.dotArr[N]){var U=n.dotArr[N];U.parentNode.removeChild(U),U=null,n.dotArr[N]=null}})};var g=0,d=0,E=0,w=0,D=0,b=0,S=[],C=void 0,P=void 0,R=function(){n.config.thumbnail&&(n.config.thumbnail.isShowCoverPreview&&!C&&(u.removeChild(v),C=(0,F.createDom)("xg-coverpreview",`<xg-outer class="xgplayer-coverpreview-outer">
            <xg-thumbnail class="xgplayer-coverpreview-thumbnail"></xg-thumbnail>
            <xg-point class="xgplayer-coverpreview-point"></xg-point>
          </xg-outer>`,{tabindex:1},"xgplayer-coverpreview"),C.querySelector(".xgplayer-coverpreview-outer"),P=C.querySelector(".xgplayer-coverpreview-point"),v=C.querySelector(".xgplayer-coverpreview-thumbnail"),n.root.appendChild(C)),g=n.config.thumbnail.pic_num,d=n.config.thumbnail.width,E=n.config.thumbnail.height,w=n.config.thumbnail.col,D=n.config.thumbnail.row,S=n.config.thumbnail.urls,v.style.width=d+"px",v.style.height=E+"px")};n.on("loadedmetadata",R),typeof n.config.disableSwipeHandler=="function"&&typeof n.config.enableSwipeHandler=="function"&&(n.root.addEventListener("touchmove",function(N){N.preventDefault(),n.disableSwipe||(n.disableSwipe=!0,n.config.disableSwipeHandler.call(n))}),n.root.addEventListener("touchstart",function(N){n.disableSwipe=!0,n.config.disableSwipeHandler.call(n)}),n.root.addEventListener("touchend",function(N){n.disableSwipe=!1,n.config.enableSwipeHandler.call(n)}));var L=["touchstart","mousedown"];m.default.device==="mobile"&&L.pop(),L.forEach(function(N){a.addEventListener(N,function(U){if(!n.config.disableProgress){if(U.stopPropagation(),(0,F.event)(U),U._target===h||!n.config.allowSeekAfterEnded&&n.ended)return!0;a.focus();var j=u.getBoundingClientRect(),z=j.left,J=c(n);J?(z=u.getBoundingClientRect().top,s=a.getBoundingClientRect().height):(s=a.getBoundingClientRect().width,z=u.getBoundingClientRect().left);var te=function(se){se.stopPropagation(),(0,F.event)(se),n.isProgressMoving=!0;var me=(J?se.clientY:se.clientX)-z;me>s&&(me=s);var fe=me/s*n.duration;if(fe<0&&(fe=0),!(n.config.allowSeekPlayed&&Number(fe).toFixed(1)>n.maxPlayedTime))if(u.style.width=me*100/s+"%",n.videoConfig.mediaType==="video"&&!n.dash&&!n.config.closeMoveSeek)console.log("trigger touchmove"),n.currentTime=Number(fe).toFixed(1);else{var ue=(0,F.findDom)(n.controls,".xgplayer-time");ue&&(ue.innerHTML='<span class="xgplayer-time-current">'+(0,F.format)(fe||0)+"</span><span>"+(0,F.format)(n.duration)+"</span>")}if(n.config.thumbnail&&n.config.thumbnail.isShowCoverPreview){P.innerHTML="<span>"+(0,F.format)(fe)+"</span> / "+(0,F.format)(n.duration||0),b=n.duration/g;var ye=Math.floor(fe/b);v.style.backgroundImage="url("+S[Math.ceil((ye+1)/(w*D))-1]+")";var pe=ye+1-w*D*(Math.ceil((ye+1)/(w*D))-1),de=Math.ceil(pe/D)-1,ve=pe-de*D-1;v.style["background-position"]="-"+ve*d+"px -"+de*E+"px",C.style.display="block"}n.emit("focus")},re=function oe(se){if(console.log("up event",se),se.stopPropagation(),(0,F.event)(se),window.removeEventListener("mousemove",te),window.removeEventListener("touchmove",te,{passive:!1}),window.removeEventListener("mouseup",oe),window.removeEventListener("touchend",oe),m.default.browser.indexOf("ie")<0&&a.blur(),!n.isProgressMoving||n.videoConfig&&n.videoConfig.mediaType==="audio"||n.dash||n.config.closeMoveSeek){var me=(J?se.clientY:se.clientX)-z;me>s&&(me=s);var fe=me/s*n.duration;fe<0&&(fe=0),n.config.allowSeekPlayed&&Number(fe).toFixed(1)>n.maxPlayedTime||(u.style.width=me*100/s+"%",console.warn("trigger touchup"),n.currentTime=Number(fe).toFixed(1))}n.config.thumbnail&&n.config.thumbnail.isShowCoverPreview&&(C.style.display="none"),n.emit("focus"),n.isProgressMoving=!1};return window.addEventListener("touchmove",te,{passive:!1}),window.addEventListener("touchend",re),window.addEventListener("mousemove",te),window.addEventListener("mouseup",re),!0}})}),a.addEventListener("mouseenter",function(N){if(!n.config.allowSeekAfterEnded&&n.ended)return!0;var U=c(n),j=U?a.getBoundingClientRect().top:a.getBoundingClientRect().left,z=U?a.getBoundingClientRect().height:a.getBoundingClientRect().width,J=function(se){var me=((U?se.clientY:se.clientX)-j)/z*n.duration;me=me<0?0:me,h.textContent=(0,F.format)(me);var fe=h.getBoundingClientRect().width;if(n.config.thumbnail&&!n.config.thumbnail.isShowCoverPreview){b=n.duration/g;var ue=Math.floor(me/b);v.style.backgroundImage="url("+S[Math.ceil((ue+1)/(w*D))-1]+")";var ye=ue+1-w*D*(Math.ceil((ue+1)/(w*D))-1),pe=Math.ceil(ye/D)-1,de=ye-pe*D-1;v.style["background-position"]="-"+de*d+"px -"+pe*E+"px";var ve=(U?se.clientY:se.clientX)-j-d/2;ve=ve>0?ve:0,ve=ve<z-d?ve:z-d,v.style.left=ve+"px",v.style.top=-10-E+"px",v.style.display="block",h.style.left=ve+d/2-fe/2+"px"}else{var ne=se.clientX-j-fe/2;ne=ne>0?ne:0,ne=ne>z-fe?z-fe:ne,h.style.left=ne+"px"}(0,F.hasClass)(a,"xgplayer-progress-dot-active")?h.style.display="none":h.style.display="block"},te=function(se){J(se)},re=function oe(se){a.removeEventListener("mousemove",te,!1),a.removeEventListener("mouseleave",oe,!1),J(se),h.style.display="none",n.config.thumbnail&&!n.config.thumbnail.isShowCoverPreview&&(v.style.display="none")};a.addEventListener("mousemove",te,!1),a.addEventListener("mouseleave",re,!1),J(N)},!1);var O=function(){if(n.maxPlayedTime===void 0&&(n.maxPlayedTime=0),n.maxPlayedTime<n.currentTime&&(n.maxPlayedTime=n.currentTime),!s&&a&&(s=a.getBoundingClientRect().width),!n.isProgressMoving&&!n.isSeeking&&!n.seeking){var U=n.currentTime/n.duration,j=Number(u.style.width.replace("%","")||"0")/Number(a.style.width||"100");Math.abs(U-j)<=1&&(u.style.width=n.currentTime*100/n.duration+"%")}};n.on("timeupdate",O);var _=function(U){u.style.width=U*100/n.duration+"%"};n.on("currentTimeChange",_);var x=function(){u.style.width="0%"};n.on("srcChange",x);var A=function(){var U=n.buffered;if(U&&U.length>0){for(var j=U.end(U.length-1),z=0,J=U.length;z<J;z++)if(n.currentTime>=U.start(z)&&n.currentTime<=U.end(z)){j=U.end(z);for(var te=z+1;te<U.length;te++)if(U.start(te)-U.end(te-1)>=2){j=U.end(te-1);break}break}f.style.width=j/n.duration*100+"%"}},k=["bufferedChange","cacheupdate","ended","timeupdate"];k.forEach(function(N){n.on(N,A)});function M(){n.removeAllProgressDot(),n.off("canplay",p),n.off("timeupdate",O),n.off("currentTimeChange",_),n.off("srcChange",x),n.off("loadedmetadata",R),k.forEach(function(N){n.off(N,A)}),n.off("destroy",M)}n.once("destroy",M)};I.default={name:"s_progress",method:l},X.exports=I.default},function(X,I,K){var F=K(70);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-progress{display:block;position:absolute;height:20px;line-height:20px;left:12px;right:12px;outline:none;top:-15px;z-index:35}.xgplayer-skin-default .xgplayer-progress-outer{background:hsla(0,0%,100%,.3);display:block;height:3px;line-height:3px;margin-top:8.5px;width:100%;position:relative;cursor:pointer}.xgplayer-skin-default .xgplayer-progress-cache,.xgplayer-skin-default .xgplayer-progress-played{display:block;height:100%;line-height:1;position:absolute;left:0;top:0}.xgplayer-skin-default .xgplayer-progress-cache{width:0;background:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-progress-played{display:block;width:0;background-image:linear-gradient(-90deg,#fa1f41,#e31106);border-radius:0 1.5px 1.5px 0}.xgplayer-skin-default .xgplayer-progress-btn{display:none;position:absolute;left:0;top:-5px;width:13px;height:13px;border-radius:30px;background:#fff;box-shadow:0 0 2px 0 rgba(0,0,0,.26);left:100%;-webkit-transform:translate(-50%);-ms-transform:translate(-50%);transform:translate(-50%);z-index:36}.xgplayer-skin-default .xgplayer-progress-point{position:absolute}.xgplayer-skin-default .xgplayer-progress-point.xgplayer-tips{margin-left:0;top:-25px;display:none;z-index:100}.xgplayer-skin-default .xgplayer-progress-dot{display:inline-block;position:absolute;height:3px;width:5px;top:0;background:#fff;border-radius:6px;z-index:16}.xgplayer-skin-default .xgplayer-progress-dot .xgplayer-progress-tip{position:absolute;bottom:200%;right:50%;-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);height:auto;line-height:30px;width:auto;background:rgba(0,0,0,.3);border-radius:6px;border:1px solid rgba(0,0,0,.8);cursor:default;white-space:nowrap;display:none}.xgplayer-skin-default .xgplayer-progress-dot-show .xgplayer-progress-tip{display:block}.xgplayer-skin-default .xgplayer-progress-thumbnail{position:absolute;-moz-box-sizing:border-box;box-sizing:border-box}.xgplayer-skin-default .xgplayer-progress-thumbnail.xgplayer-tips{margin-left:0;display:none;z-index:99}.xgplayer-skin-default .xgplayer-coverpreview{position:absolute;width:100%;height:100%;top:0;left:0;display:none}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer{position:absolute;display:block;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-thumbnail{display:block}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point{display:block;text-align:center;font-family:PingFangSC-Regular;font-size:11px;color:#ccc;padding:2px 4px}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point span{color:#fff}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-outer{height:6px;margin-top:7px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-dot,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-dot{height:6px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-btn{display:block;top:-3px}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-volume-active .xgplayer-progress{z-index:15}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress-btn{display:block!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-outer{height:3px!important;margin-top:8.5px!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-btn{display:block!important;top:-5px!important}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(72);var G=function(){var r=this,c=(0,F.createDom)("xg-time",'<span class="xgplayer-time-current">'+(r.currentTime||(0,F.format)(0))+`</span>
                                           <span>`+(r.duration||(0,F.format)(0))+"</span>",{},"xgplayer-time");r.once("ready",function(){r.controls&&r.controls.appendChild(c)});var l=function(){(r.videoConfig.mediaType!=="audio"||!r.isProgressMoving||!r.dash)&&(c.innerHTML='<span class="xgplayer-time-current">'+(0,F.format)(r.currentTime||0)+"</span>"+("<span>"+(0,F.format)(r.duration)+"</span>"))};r.on("durationchange",l),r.on("timeupdate",l);function e(){r.off("durationchange",l),r.off("timeupdate",l),r.off("destroy",e)}r.once("destroy",e)};I.default={name:"s_time",method:G},X.exports=I.default},function(X,I,K){var F=K(73);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,'.xgplayer-skin-default .xgplayer-time{-webkit-order:2;-moz-box-ordinal-group:3;order:2;font-family:ArialMT;font-size:13px;color:#fff;line-height:40px;height:40px;text-align:center;display:inline-block;margin:auto 8px}.xgplayer-skin-default .xgplayer-time span{color:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current{color:#fff}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current:after{content:"/";display:inline-block;padding:0 3px}',""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(75),m=r(G);K(76);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.root,a=e.lang.REPLAY,s=(0,F.createDom)("xg-replay",m.default+`
                                         <xg-replay-txt class="xgplayer-replay-txt">`+a+`</xg-replay-txt>
                                        `,{},"xgplayer-replay");e.once("ready",function(){n.appendChild(s)});function u(){var v=s.querySelector("path");if(v){var y=window.getComputedStyle(v).getPropertyValue("transform");if(typeof y=="string"&&y.indexOf("none")>-1)return;v.setAttribute("transform",y)}}e.on("ended",u);function t(v){v.preventDefault(),v.stopPropagation()}s.addEventListener("click",t);var f=s.querySelector("svg");["click","touchend"].forEach(function(v){f.addEventListener(v,function(y){y.preventDefault(),y.stopPropagation(),e.userGestureTrigEvent("replayBtnClick")})});function h(){e.off("ended",u),e.off("destroy",h)}e.once("destroy",h)};I.default={name:"s_replay",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" width="78" height="78" viewbox="0 0 78 78">
  <path d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`},function(X,I,K){var F=K(77);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-replay{position:absolute;left:0;top:0;width:100%;height:100%;z-index:105;display:none;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center;background:rgba(0,0,0,.54);-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;flex-direction:column}.xgplayer-skin-default .xgplayer-replay svg{background:rgba(0,0,0,.58);border-radius:100%;cursor:pointer}.xgplayer-skin-default .xgplayer-replay svg path{-webkit-transform:translate(20px,21px);-ms-transform:translate(20px,21px);transform:translate(20px,21px);fill:#ddd}.xgplayer-skin-default .xgplayer-replay svg:hover{background:rgba(0,0,0,.38)}.xgplayer-skin-default .xgplayer-replay svg:hover path{fill:#fff}.xgplayer-skin-default .xgplayer-replay .xgplayer-replay-txt{display:inline-block;font-family:PingFangSC-Regular;font-size:14px;color:#fff;line-height:34px}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-replay{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(X,I,K){var F=K(161);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){X.exports=K(80)},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(9),G=ne(F),m=K(81),r=ne(m),c=K(82),l=ne(c),e=K(83),n=ne(e),a=K(84),s=ne(a),u=K(85),t=ne(u),f=K(88),h=ne(f),v=K(45),y=ne(v),p=K(89),g=ne(p),d=K(90),E=ne(d),w=K(91),D=ne(w),b=K(92),S=ne(b),C=K(37),P=ne(C),R=K(38),L=ne(R),O=K(98),_=ne(O),x=K(46),A=ne(x),k=K(99),M=ne(k),N=K(100),U=ne(N),j=K(47),z=ne(j),J=K(101),te=ne(J),re=K(102),oe=ne(re),se=K(103),me=ne(se),fe=K(39),ue=ne(fe),ye=K(104),pe=ne(ye),de=K(105),ve=ne(de);K(107);function ne(we){return we&&we.__esModule?we:{default:we}}G.default.installAll([r.default,l.default,n.default,s.default,t.default,h.default,y.default,g.default,E.default,D.default,S.default,P.default,L.default,_.default,A.default,M.default,U.default,z.default,te.default,oe.default,me.default,ue.default,pe.default,ve.default]),I.default=G.default,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this;if(!m.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)return;function r(){m.video.webkitShowPlaybackTargetPicker()}m.on("airplayBtnClick",r);function c(){m.off("airplayBtnClick",r),m.off("destroy",c)}m.once("destroy",c)};I.default={name:"airplay",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root;function l(){(0,F.hasClass)(c,"xgplayer-is-cssfullscreen")?r.exitCssFullscreen():r.getCssFullscreen()}r.on("cssFullscreenBtnClick",l),r.on("exitFullscreen",function(){(0,F.removeClass)(c,"xgplayer-is-cssfullscreen")});function e(){r.off("cssFullscreenBtnClick",l),r.off("destroy",e)}r.once("destroy",e),r.getCssFullscreen=function(){var n=this;n.config.fluid&&(n.root.style["padding-top"]=""),(0,F.addClass)(n.root,"xgplayer-is-cssfullscreen"),n.emit("requestCssFullscreen")},r.exitCssFullscreen=function(){var n=this;n.config.fluid&&(n.root.style.width="100%",n.root.style.height="0",n.root.style["padding-top"]=n.config.height*100/n.config.width+"%"),(0,F.removeClass)(n.root,"xgplayer-is-cssfullscreen"),n.emit("exitCssFullscreen")}};I.default={name:"cssFullscreen",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this;function c(l){var e=r.root.querySelector("xg-danmu");if((0,F.addClass)(e,"xgplayer-has-danmu"),!r.config.danmu.closeDefaultBtn){var n=function(){l.start()},a=function(){(0,F.hasClass)(r.danmuBtn,"danmu-switch-active")&&l.pause()},s=function(){(0,F.hasClass)(r.danmuBtn,"danmu-switch-active")&&l.play()},u=function(){(0,F.hasClass)(r.danmuBtn,"danmu-switch-active")&&(l.stop(),l.start())},t=function f(){r.off("timeupdate",n),r.off("pause",a),r.off("play",s),r.off("seeked",u),r.off("destroy",f)};r.danmuBtn=(0,F.copyDom)(l.bulletBtn.createSwitch(!0)),r.controls.appendChild(r.danmuBtn),["click","touchend"].forEach(function(f){r.danmuBtn.addEventListener(f,function(h){h.preventDefault(),h.stopPropagation(),(0,F.toggleClass)(r.danmuBtn,"danmu-switch-active"),(0,F.hasClass)(r.danmuBtn,"danmu-switch-active")?(r.emit("danmuBtnOn"),(0,F.addClass)(e,"xgplayer-has-danmu"),r.once("timeupdate",n)):(r.emit("danmuBtnOff"),(0,F.removeClass)(e,"xgplayer-has-danmu"),l.stop())})}),r.onElementClick&&e.addEventListener("click",function(f){r.onElementClick(f,e)},!1),r.onElementDblclick&&e.addEventListener("dblclick",function(f){r.onElementDblclick(f,e)},!1),r.on("pause",a),r.on("play",s),r.on("seeked",u),r.once("destroy",t)}}r.on("initDefaultDanmu",c)};I.default={name:"danmu",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this;function r(){m.off("destroy",r)}m.once("destroy",r)};I.default={name:"definition",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(86),G=r(F),m=K(87);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this;function n(){e.download()}e.on("downloadBtnClick",n);function a(){e.off("downloadBtnClick",n),e.off("destroy",a)}e.once("destroy",a),e.download=function(){var s=(0,m.getAbsoluteURL)(this.config.url);(0,G.default)(s)}};I.default={name:"download",method:c},X.exports=I.default},function(X,I,K){var F,G,m;(function(r,c){G=[],F=c,m=typeof F=="function"?F.apply(I,G):F,m!==void 0&&(X.exports=m)})(this,function(){return function r(c,l,e){var n=window,a="application/octet-stream",s=e||a,u=c,t=!l&&!e&&u,f=document.createElement("a"),h=function(C){return String(C)},v=n.Blob||n.MozBlob||n.WebKitBlob||h,y=l||"download",p,g;if(v=v.call?v.bind(n):Blob,String(this)==="true"&&(u=[u,s],s=u[0],u=u[1]),t&&t.length<2048&&(y=t.split("/").pop().split("?")[0],f.href=t,f.href.indexOf(t)!==-1)){var d=new XMLHttpRequest;return d.open("GET",t,!0),d.responseType="blob",d.onload=function(C){r(C.target.response,y,a)},setTimeout(function(){d.send()},0),d}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u))if(u.length>1024*1024*1.999&&v!==h)u=b(u),s=u.type||a;else return navigator.msSaveBlob?navigator.msSaveBlob(b(u),y):S(u);else if(/([\x80-\xff])/.test(u)){var E=0,w=new Uint8Array(u.length),D=w.length;for(E;E<D;++E)w[E]=u.charCodeAt(E);u=new v([w],{type:s})}p=u instanceof v?u:new v([u],{type:s});function b(C){var P=C.split(/[:;,]/),R=P[1],L=P[2]=="base64"?atob:decodeURIComponent,O=L(P.pop()),_=O.length,x=0,A=new Uint8Array(_);for(x;x<_;++x)A[x]=O.charCodeAt(x);return new v([A],{type:R})}function S(C,P){if("download"in f)return f.href=C,f.setAttribute("download",y),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),P===!0&&setTimeout(function(){n.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(C)&&(C="data:"+C.replace(/^data:([\w\/\-\+]+)/,a)),window.open(C)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=C),!0;var R=document.createElement("iframe");document.body.appendChild(R),!P&&/^data:/.test(C)&&(C="data:"+C.replace(/^data:([\w\/\-\+]+)/,a)),R.src=C,setTimeout(function(){document.body.removeChild(R)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(p,y);if(n.URL)S(n.URL.createObjectURL(p),!0);else{if(typeof p=="string"||p.constructor===h)try{return S("data:"+s+";base64,"+n.btoa(p))}catch{return S("data:"+s+","+encodeURIComponent(p))}g=new FileReader,g.onload=function(C){S(this.result)},g.readAsDataURL(p)}return!0}})},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0}),I.getAbsoluteURL=function(G){if(!G.match(/^https?:\/\//)){var m=document.createElement("div");m.innerHTML='<a href="'+G+'">x</a>',G=m.firstChild.href}return G}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(4),G=m(F);function m(l){return l&&l.__esModule?l:{default:l}}var r={maxCount:3,backupUrl:"",isFetch:!0,fetchTimeout:100};function c(){var l=this,e=this;if(!e.config.errorConfig||e.src.indexOf("blob:")>-1)return;var n={},a=e.config.errorConfig;for(var s in r)a[s]===void 0?n[s]=r[s]:n[s]=a[s];e.retryData={count:0,errfTimer:null,isFetchReturn:!1,currentTime:0};function u(h,v,y){var p=function(d,E){h.retryData.isFetchReturn||(h.retryData.isFetchReturn=!0,d(E))};return new Promise(function(g,d){try{var E=new window.XMLHttpRequest;E.open("get",v),E.onload=function(){p(g,{status:E.status,statusText:E.statusText,xhr:E})},E.onerror=function(){p(g,{status:E.status,statusText:E.statusText||"The network environment is disconnected or the address is invalid",xhr:E})},E.onabort=function(){},h.retryData.errfTimer=window.setTimeout(function(){var w=h.retryData.errfTimer;window.clearTimeout(w),h.retryData.errfTimer=null,p(g,{status:-1,statusText:"request timeout"})},y),E.send()}catch{h.retryData.isFetchReturn=!0,p(g,{status:-2,statusText:"request error"})}})}function t(){this.currentTime=this.retryData.currentTime,this.play(),this.retryData.retryCode=0,this.retryData.isFetchReturn=!1,this.retryData.currentTime=0}var f=e._onError;e._onError=function(h){var v=l.retryData.count;if(v>n.maxCount){n.isFetch?u(l,l.currentSrc,n.fetchTimeout).then(function(p){l.emit("error",new G.default({type:"network",currentTime:l.currentTime,duration:l.duration||0,networkState:l.networkState,readyState:l.readyState,currentSrc:l.currentSrc,src:l.src,ended:l.ended,httpCode:p.status,httpMsg:p.statusText,errd:{line:101,msg:l.error,handle:"plugin errorRetry"},errorCode:l.video&&l.video.error.code,mediaError:l.video&&l.video.error})),f.call(l,p)}):f.call(l,h);return}v===0&&(l.retryData.currentTime=l.currentTime,l.once("canplay",t.bind(l)));var y="";n.count<2?y=n.backupUrl?n.backupUrl:e.currentSrc:y=n.backupUrl&&v>1?n.backupUrl:e.currentSrc,l.retryData.count++,l.src=y}}I.default={name:"errorretry",method:c},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function l(e,n){for(var a=0;a<n.length;a++){var s=n[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,a){return n&&l(e.prototype,n),a&&l(e,a),e}}(),G=K(0);function m(l,e){if(!(l instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function l(e){m(this,l),this.player=e,this.state={playbackRate:0,isRepeat:!1,keyCode:0,repeat:0,isBody:!1},this.timer=null,this.initEvents()}return F(l,[{key:"initEvents",value:function(){var n=this,a=this.player,s=a.root,u=a.config;if(this.player.onBodyKeydown=this.onBodyKeydown.bind(this),this.player.onKeydown=this.onKeydown.bind(this),this.player.onKeyup=this.onKeyup.bind(this),!u.keyShortcut||u.keyShortcut==="on"){document.addEventListener("keydown",this.player.onBodyKeydown),s.addEventListener("keydown",this.player.onKeydown);var t=function(){document.removeEventListener("keydown",n.player.onBodyKeydown),s.removeEventListener("keydown",n.player.onKeydown),clearTimeout(n.timer),n.timer=null};(0,G.on)(this.player,"destroy",t)}}},{key:"checkTarget",value:function(n){var a=this.player;return n.target===a.root||n.target===a.video||n.target===a.controls}},{key:"onBodyKeydown",value:function(n){var a=n||window.event,s=a.keyCode;if(a.target===document.body&&(s===37||s===39||s===32))return a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,a.repeat||document.addEventListener("keyup",this.player.onKeyup),this.handler(a),!1}},{key:"onKeydown",value:function(n){var a=n||window.event,s=a.keyCode;if(this.checkTarget(a)&&(s===37||s===38||s===39||s===40||s===32||s===27))return a.preventDefault(),a.cancelBubble=!0,a.returnValue=!1,this.player.emit("focus"),a.repeat||this.player.root.addEventListener("keyup",this.player.onKeyup),this.handler(a),!1}},{key:"onKeyup",value:function(){var n=this.state,a=this.player;document.removeEventListener("keyup",this.player.onKeyup),a.root.removeEventListener("keyup",this.player.onKeyup),!!n.keyCode&&(n.playbackRate!==0&&(a.playbackRate=n.playbackRate),n.isRepeat||this.handlerKeyCode(n.keyCode,!1),n.playbackRate=0,n.isRepeat=!1,n.keyCode=0,n.repeat=0,this.changeVolumeSlide())}},{key:"handler",value:function(n){var a=this.state,s=this.player;a.keyCode=n.keyCode,a.isRepeat=n.repeat,n.repeat&&(s.config.disableLongPress?this.handlerKeyCode(a.keyCode,!1):a.repeat%2==0&&this.handlerKeyCode(a.keyCode,!0),a.repeat++)}},{key:"handlerKeyCode",value:function(n,a){var s=this.player,u=this.state;switch(n){case 39:a?u.repeat===0&&this.changeRate():this.seek(!1,a);break;case 37:this.seek(!0,a);break;case 38:this.changeVolume(!0);break;case 40:this.changeVolume(!1);break;case 32:a||(s.paused?s.play():s.pause());break;case 27:(0,G.hasClass)(s.root,"xgplayer-is-cssfullscreen")&&s.exitCssFullscreen();break}}},{key:"seek",value:function(n,a){var s=this.player,u=s.config.keyShortcutStep||{},t=u.currentTime||10;s.isLoading||s.isSeeking||a&&this.state.repeat%8>0||(n?s.currentTime-t>=0?s.currentTime-=t:s.currentTime=0:s.maxPlayedTime&&s.config.allowSeekPlayed&&s.currentTime+t>s.maxPlayedTime?s.currentTime=s.maxPlayedTime:s.currentTime+t<=s.duration?s.currentTime+=t:s.currentTime=s.duration+1)}},{key:"changeRate",value:function(){this.state.playbackRate=this.player.playbackRate,this.player.playbackRate=this.player.config.keyboardRate||5}},{key:"changeVolumeSlide",value:function(n){var a=this.player;!a.controls||(n?(a.emit("focus"),(0,G.hasClass)(a.root,"xgplayer-volume-active")||(0,G.addClass)(a.root,"xgplayer-volume-active")):(clearTimeout(this.timer),this.timer=setTimeout(function(){(0,G.removeClass)(a.root,"xgplayer-volume-active")},1e3)))}},{key:"changeVolume",value:function(n){var a=this.player,s=a.config.keyShortcutStep||{},u=s.volume||.1;this.changeVolumeSlide(!0);var t=a.volume;n&&t+u<=1?a.volume=t+u:!n&&t-u>=0&&(a.volume=t-u)}}]),l}(),c=function(){var e=this;e.keyboard=new r(e)};I.default={name:"keyboard",method:c},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.root;function l(n){r.uploadFile=n.files[0];var a=URL.createObjectURL(r.uploadFile);if((0,F.hasClass)(c,"xgplayer-nostart"))r.config.url=a,r.start();else{r.src=a;var s=r.play();s!==void 0&&s&&s.catch(function(u){})}}r.on("upload",l);function e(){r.off("upload",l),r.off("destroy",e)}r.once("destroy",e)};I.default={name:"localPreview",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this;m.on("memoryPlayStart",function(r){setTimeout(function(){console.log("memoryPlayStart",r,m.readyState,11),m.currentTime=r})})};I.default={name:"memoryPlay",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(93),m=r(G);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.root;function a(){(0,F.hasClass)(n,"xgplayer-miniplayer-active")?e.exitMiniplayer():e.getMiniplayer()}e.on("miniplayerBtnClick",a);function s(){e.off("miniplayerBtnClick",a),e.off("destroy",s)}e.once("destroy",s),e.getMiniplayer=function(){(0,F.hasClass)(n,"xgplayer-is-fullscreen")&&this.exitFullscreen(n),(0,F.hasClass)(n,"xgplayer-is-cssfullscreen")&&this.exitCssFullscreen(),(0,F.hasClass)(n,"xgplayer-rotate-fullscreen")&&this.exitRotateFullscreen();var u=(0,F.createDom)("xg-miniplayer-lay","<div></div>",{},"xgplayer-miniplayer-lay");this.root.appendChild(u);var t=(0,F.createDom)("xg-miniplayer-drag",'<div class="drag-handle"><span>'+this.lang.MINIPLAYER_DRAG+"</span></div>",{tabindex:9},"xgplayer-miniplayer-drag");this.root.appendChild(t),new m.default(".xgplayer",{handle:".drag-handle"}),(0,F.addClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right=0,this.root.style.bottom="200px",this.root.style.top="",this.root.style.left="",this.root.style.width="320px",this.root.style.height="180px",this.config.miniplayerConfig&&(this.config.miniplayerConfig.top!==void 0&&(this.root.style.top=this.config.miniplayerConfig.top+"px",this.root.style.bottom=""),this.config.miniplayerConfig.bottom!==void 0&&(this.root.style.bottom=this.config.miniplayerConfig.bottom+"px"),this.config.miniplayerConfig.left!==void 0&&(this.root.style.left=this.config.miniplayerConfig.left+"px",this.root.style.right=""),this.config.miniplayerConfig.right!==void 0&&(this.root.style.right=this.config.miniplayerConfig.right+"px"),this.config.miniplayerConfig.width!==void 0&&(this.root.style.width=this.config.miniplayerConfig.width+"px"),this.config.miniplayerConfig.height!==void 0&&(this.root.style.height=this.config.miniplayerConfig.height+"px")),this.config.fluid&&(this.root.style["padding-top"]="");var f=this;["click","touchend"].forEach(function(h){u.addEventListener(h,function(v){v.preventDefault(),v.stopPropagation(),f.exitMiniplayer()})})},e.exitMiniplayer=function(){(0,F.removeClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right="",this.root.style.bottom="",this.root.style.top="",this.root.style.left="",this.config.fluid?(this.root.style.width="100%",this.root.style.height="0",this.root.style["padding-top"]=this.config.height*100/this.config.width+"%"):(this.config.width&&(typeof this.config.width!="number"?this.root.style.width=this.config.width:this.root.style.width=this.config.width+"px"),this.config.height&&(typeof this.config.height!="number"?this.root.style.height=this.config.height:this.root.style.height=this.config.height+"px"));var u=(0,F.findDom)(this.root,".xgplayer-miniplayer-lay");u&&u.parentNode&&u.parentNode.removeChild(u);var t=(0,F.findDom)(this.root,".xgplayer-miniplayer-drag");t&&t.parentNode&&t.parentNode.removeChild(t)}};I.default={name:"miniplayer",method:c},X.exports=I.default},function(X,I,K){var F,G;/*!
* Draggabilly v2.3.0
* Make that shiz draggable
* https://draggabilly.desandro.com
* MIT license
*/(function(m,r){F=[K(94),K(95)],G=function(c,l){return r(m,c,l)}.apply(I,F),G!==void 0&&(X.exports=G)})(window,function(r,c,l){function e(h,v){for(var y in v)h[y]=v[y];return h}function n(){}var a=r.jQuery;function s(h,v){this.element=typeof h=="string"?document.querySelector(h):h,a&&(this.$element=a(this.element)),this.options=e({},this.constructor.defaults),this.option(v),this._create()}var u=s.prototype=Object.create(l.prototype);s.defaults={},u.option=function(h){e(this.options,h)};var t={relative:!0,absolute:!0,fixed:!0};u._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=e({},this.position);var h=getComputedStyle(this.element);t[h.position]||(this.element.style.position="relative"),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},u.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},u.dispatchEvent=function(h,v,y){var p=[v].concat(y);this.emitEvent(h,p),this.dispatchJQueryEvent(h,v,y)},u.dispatchJQueryEvent=function(h,v,y){var p=r.jQuery;if(!(!p||!this.$element)){var g=p.Event(v);g.type=h,this.$element.trigger(g,y)}},u._getPosition=function(){var h=getComputedStyle(this.element),v=this._getPositionCoord(h.left,"width"),y=this._getPositionCoord(h.top,"height");this.position.x=isNaN(v)?0:v,this.position.y=isNaN(y)?0:y,this._addTransformPosition(h)},u._getPositionCoord=function(h,v){if(h.indexOf("%")!=-1){var y=c(this.element.parentNode);return y?parseFloat(h)/100*y[v]:0}return parseInt(h,10)},u._addTransformPosition=function(h){var v=h.transform;if(v.indexOf("matrix")===0){var y=v.split(","),p=v.indexOf("matrix3d")===0?12:4,g=parseInt(y[p],10),d=parseInt(y[p+1],10);this.position.x+=g,this.position.y+=d}},u.onPointerDown=function(h,v){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",h,[v])},u.pointerDown=function(h,v){var y=this.okayPointerDown(h);if(!y||!this.isEnabled){this._pointerReset();return}this.pointerDownPointer={pageX:v.pageX,pageY:v.pageY},h.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(h),this.element.classList.add("is-pointer-down"),this.dispatchEvent("pointerDown",h,[v])},u.dragStart=function(h,v){!this.isEnabled||(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",h,[v]),this.animate())},u.measureContainment=function(){var h=this.getContainer();if(!!h){var v=c(this.element),y=c(h),p=this.element.getBoundingClientRect(),g=h.getBoundingClientRect(),d=y.borderLeftWidth+y.borderRightWidth,E=y.borderTopWidth+y.borderBottomWidth,w=this.relativeStartPosition={x:p.left-(g.left+y.borderLeftWidth),y:p.top-(g.top+y.borderTopWidth)};this.containSize={width:y.width-d-w.x-v.width,height:y.height-E-w.y-v.height}}},u.getContainer=function(){var h=this.options.containment;if(!!h){var v=h instanceof HTMLElement;return v?h:typeof h=="string"?document.querySelector(h):this.element.parentNode}},u.onPointerMove=function(h,v,y){this.dispatchJQueryEvent("pointerMove",h,[v,y])},u.dragMove=function(h,v,y){if(!!this.isEnabled){var p=y.x,g=y.y,d=this.options.grid,E=d&&d[0],w=d&&d[1];p=f(p,E),g=f(g,w),p=this.containDrag("x",p,E),g=this.containDrag("y",g,w),p=this.options.axis=="y"?0:p,g=this.options.axis=="x"?0:g,this.position.x=this.startPosition.x+p,this.position.y=this.startPosition.y+g,this.dragPoint.x=p,this.dragPoint.y=g,this.dispatchEvent("dragMove",h,[v,y])}};function f(h,v,y){return y=y||"round",v?Math[y](h/v)*v:h}return u.containDrag=function(h,v,y){if(!this.options.containment)return v;var p=h=="x"?"width":"height",g=this.relativeStartPosition[h],d=f(-g,y,"ceil"),E=this.containSize[p];return E=f(E,y,"floor"),Math.max(d,Math.min(E,v))},u.onPointerUp=function(h,v){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",h,[v])},u.dragEnd=function(h,v){!this.isEnabled||(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",h,[v]))},u.animate=function(){if(!!this.isDragging){this.positionDrag();var h=this;requestAnimationFrame(function(){h.animate()})}},u.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},u.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},u.staticClick=function(h,v){this.dispatchEvent("staticClick",h,[v])},u.setPosition=function(h,v){this.position.x=h,this.position.y=v,this.setLeftTop()},u.enable=function(){this.isEnabled=!0},u.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},u.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},u._init=n,a&&a.bridget&&a.bridget("draggabilly",s),s})},function(X,I,K){var F,G;/*!
* getSize v2.0.3
* measure size of elements
* MIT license
*/(function(m,r){F=r,G=typeof F=="function"?F.call(I,K,I,X):F,G!==void 0&&(X.exports=G)})(window,function(){function r(v){var y=parseFloat(v),p=v.indexOf("%")==-1&&!isNaN(y);return p&&y}function c(){}var l=typeof console=="undefined"?c:function(v){console.error(v)},e=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],n=e.length;function a(){for(var v={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},y=0;y<n;y++){var p=e[y];v[p]=0}return v}function s(v){var y=getComputedStyle(v);return y||l("Style returned "+y+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),y}var u=!1,t;function f(){if(!u){u=!0;var v=document.createElement("div");v.style.width="200px",v.style.padding="1px 2px 3px 4px",v.style.borderStyle="solid",v.style.borderWidth="1px 2px 3px 4px",v.style.boxSizing="border-box";var y=document.body||document.documentElement;y.appendChild(v);var p=s(v);t=Math.round(r(p.width))==200,h.isBoxSizeOuter=t,y.removeChild(v)}}function h(v){if(f(),typeof v=="string"&&(v=document.querySelector(v)),!(!v||typeof v!="object"||!v.nodeType)){var y=s(v);if(y.display=="none")return a();var p={};p.width=v.offsetWidth,p.height=v.offsetHeight;for(var g=p.isBorderBox=y.boxSizing=="border-box",d=0;d<n;d++){var E=e[d],w=y[E],D=parseFloat(w);p[E]=isNaN(D)?0:D}var b=p.paddingLeft+p.paddingRight,S=p.paddingTop+p.paddingBottom,C=p.marginLeft+p.marginRight,P=p.marginTop+p.marginBottom,R=p.borderLeftWidth+p.borderRightWidth,L=p.borderTopWidth+p.borderBottomWidth,O=g&&t,_=r(y.width);_!==!1&&(p.width=_+(O?0:b+R));var x=r(y.height);return x!==!1&&(p.height=x+(O?0:S+L)),p.innerWidth=p.width-(b+R),p.innerHeight=p.height-(S+L),p.outerWidth=p.width+C,p.outerHeight=p.height+P,p}}return h})},function(X,I,K){var F,G;/*!
* Unidragger v2.3.1
* Draggable base class
* MIT license
*/(function(m,r){F=[K(96)],G=function(c){return r(m,c)}.apply(I,F),G!==void 0&&(X.exports=G)})(window,function(r,c){function l(){}var e=l.prototype=Object.create(c.prototype);e.bindHandles=function(){this._bindHandles(!0)},e.unbindHandles=function(){this._bindHandles(!1)},e._bindHandles=function(s){s=s===void 0?!0:s;for(var u=s?"addEventListener":"removeEventListener",t=s?this._touchActionValue:"",f=0;f<this.handles.length;f++){var h=this.handles[f];this._bindStartEvent(h,s),h[u]("click",this),r.PointerEvent&&(h.style.touchAction=t)}},e._touchActionValue="none",e.pointerDown=function(s,u){var t=this.okayPointerDown(s);!t||(this.pointerDownPointer={pageX:u.pageX,pageY:u.pageY},s.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(s),this.emitEvent("pointerDown",[s,u]))};var n={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},a={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return e.okayPointerDown=function(s){var u=n[s.target.nodeName],t=a[s.target.type],f=!u||t;return f||this._pointerReset(),f},e.pointerDownBlur=function(){var s=document.activeElement,u=s&&s.blur&&s!=document.body;u&&s.blur()},e.pointerMove=function(s,u){var t=this._dragPointerMove(s,u);this.emitEvent("pointerMove",[s,u,t]),this._dragMove(s,u,t)},e._dragPointerMove=function(s,u){var t={x:u.pageX-this.pointerDownPointer.pageX,y:u.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(t)&&this._dragStart(s,u),t},e.hasDragStarted=function(s){return Math.abs(s.x)>3||Math.abs(s.y)>3},e.pointerUp=function(s,u){this.emitEvent("pointerUp",[s,u]),this._dragPointerUp(s,u)},e._dragPointerUp=function(s,u){this.isDragging?this._dragEnd(s,u):this._staticClick(s,u)},e._dragStart=function(s,u){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(s,u)},e.dragStart=function(s,u){this.emitEvent("dragStart",[s,u])},e._dragMove=function(s,u,t){!this.isDragging||this.dragMove(s,u,t)},e.dragMove=function(s,u,t){s.preventDefault(),this.emitEvent("dragMove",[s,u,t])},e._dragEnd=function(s,u){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(s,u)},e.dragEnd=function(s,u){this.emitEvent("dragEnd",[s,u])},e.onclick=function(s){this.isPreventingClicks&&s.preventDefault()},e._staticClick=function(s,u){this.isIgnoringMouseUp&&s.type=="mouseup"||(this.staticClick(s,u),s.type!="mouseup"&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},e.staticClick=function(s,u){this.emitEvent("staticClick",[s,u])},l.getPointerPoint=c.getPointerPoint,l})},function(X,I,K){var F,G;/*!
* Unipointer v2.3.0
* base class for doing one thing with pointer event
* MIT license
*/(function(m,r){F=[K(97)],G=function(c){return r(m,c)}.apply(I,F),G!==void 0&&(X.exports=G)})(window,function(r,c){function l(){}function e(){}var n=e.prototype=Object.create(c.prototype);n.bindStartEvent=function(s){this._bindStartEvent(s,!0)},n.unbindStartEvent=function(s){this._bindStartEvent(s,!1)},n._bindStartEvent=function(s,u){u=u===void 0?!0:u;var t=u?"addEventListener":"removeEventListener",f="mousedown";r.PointerEvent?f="pointerdown":"ontouchstart"in r&&(f="touchstart"),s[t](f,this)},n.handleEvent=function(s){var u="on"+s.type;this[u]&&this[u](s)},n.getTouch=function(s){for(var u=0;u<s.length;u++){var t=s[u];if(t.identifier==this.pointerIdentifier)return t}},n.onmousedown=function(s){var u=s.button;u&&u!==0&&u!==1||this._pointerDown(s,s)},n.ontouchstart=function(s){this._pointerDown(s,s.changedTouches[0])},n.onpointerdown=function(s){this._pointerDown(s,s)},n._pointerDown=function(s,u){s.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=u.pointerId!==void 0?u.pointerId:u.identifier,this.pointerDown(s,u))},n.pointerDown=function(s,u){this._bindPostStartEvents(s),this.emitEvent("pointerDown",[s,u])};var a={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return n._bindPostStartEvents=function(s){if(!!s){var u=a[s.type];u.forEach(function(t){r.addEventListener(t,this)},this),this._boundPointerEvents=u}},n._unbindPostStartEvents=function(){!this._boundPointerEvents||(this._boundPointerEvents.forEach(function(s){r.removeEventListener(s,this)},this),delete this._boundPointerEvents)},n.onmousemove=function(s){this._pointerMove(s,s)},n.onpointermove=function(s){s.pointerId==this.pointerIdentifier&&this._pointerMove(s,s)},n.ontouchmove=function(s){var u=this.getTouch(s.changedTouches);u&&this._pointerMove(s,u)},n._pointerMove=function(s,u){this.pointerMove(s,u)},n.pointerMove=function(s,u){this.emitEvent("pointerMove",[s,u])},n.onmouseup=function(s){this._pointerUp(s,s)},n.onpointerup=function(s){s.pointerId==this.pointerIdentifier&&this._pointerUp(s,s)},n.ontouchend=function(s){var u=this.getTouch(s.changedTouches);u&&this._pointerUp(s,u)},n._pointerUp=function(s,u){this._pointerDone(),this.pointerUp(s,u)},n.pointerUp=function(s,u){this.emitEvent("pointerUp",[s,u])},n._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},n._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},n.pointerDone=l,n.onpointercancel=function(s){s.pointerId==this.pointerIdentifier&&this._pointerCancel(s,s)},n.ontouchcancel=function(s){var u=this.getTouch(s.changedTouches);u&&this._pointerCancel(s,u)},n._pointerCancel=function(s,u){this._pointerDone(),this.pointerCancel(s,u)},n.pointerCancel=function(s,u){this.emitEvent("pointerCancel",[s,u])},e.getPointerPoint=function(s){return{x:s.pageX,y:s.pageY}},e})},function(X,I,K){var F,G;(function(m,r){F=r,G=typeof F=="function"?F.call(I,K,I,X):F,G!==void 0&&(X.exports=G)})(typeof window!="undefined"?window:this,function(){function m(){}var r=m.prototype;return r.on=function(c,l){if(!(!c||!l)){var e=this._events=this._events||{},n=e[c]=e[c]||[];return n.indexOf(l)==-1&&n.push(l),this}},r.once=function(c,l){if(!(!c||!l)){this.on(c,l);var e=this._onceEvents=this._onceEvents||{},n=e[c]=e[c]||{};return n[l]=!0,this}},r.off=function(c,l){var e=this._events&&this._events[c];if(!(!e||!e.length)){var n=e.indexOf(l);return n!=-1&&e.splice(n,1),this}},r.emitEvent=function(c,l){var e=this._events&&this._events[c];if(!(!e||!e.length)){e=e.slice(0),l=l||[];for(var n=this._onceEvents&&this._onceEvents[c],a=0;a<e.length;a++){var s=e[a],u=n&&n[s];u&&(this.off(c,s),delete n[s]),s.apply(this,l)}return this}},r.allOff=function(){delete this._events,delete this._onceEvents},m})},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=this;function l(){c.video!==document.pictureInPictureElement?c.video.requestPictureInPicture():document.exitPictureInPicture()}c.on("pipBtnClick",l);var e=function(s){var u=c.video.webkitPresentationMode;r.pMode=u,u===F.PresentationMode.PIP?c.emit("requestPictureInPicture",s.pictureInPictureWindow):u===F.PresentationMode.INLINE&&c.emit("exitPictureInPicture")};c.video.addEventListener("enterpictureinpicture",function(a){(0,F.addClass)(c.root,"xgplayer-pip-active"),c.emit("requestPictureInPicture",a)}),c.video.addEventListener("leavepictureinpicture",function(){(0,F.removeClass)(c.root,"xgplayer-pip-active"),c.emit("exitPictureInPicture")}),(0,F.checkWebkitSetPresentationMode)(c.video)&&c.video.addEventListener("webkitpresentationmodechanged",e);function n(){c.off("pipBtnClick",l),c.off("destroy",n),(0,F.checkWebkitSetPresentationMode)(c.video)&&c.video.removeEventListener("webkitpresentationmodechanged",e)}c.once("destroy",n)};I.default={name:"pip",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this,r=m.config.playNext;m.currentVideoIndex=-1;function c(){m.currentVideoIndex+1<r.urlList.length&&(m.currentVideoIndex++,m.video.autoplay=!0,m.src=r.urlList[m.currentVideoIndex],m.emit("playerNext",m.currentVideoIndex+1),m.currentVideoIndex+1===r.urlList.length&&m.emit("urlListEnd"))}m.on("playNextBtnClick",c);function l(){m.off("playNextBtnClick",c),m.off("destroy",l)}m.once("destroy",l)};I.default={name:"playNext",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this,c=r.config.reload;if(!c)return;function l(){(0,F.removeClass)(r.root,"xgplayer-is-error"),r.src=r.config.url}r.on("reloadBtnClick",l);function e(){r.off("reloadBtnClick",l),r.off("destroy",e)}r.once("destroy",e)};I.default={name:"reload",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this,r=m.config.rotate;if(!r)return;function c(){m.rotate(r.clockwise,r.innerRotate)}m.on("rotateBtnClick",c);function l(){m.off("rotateBtnClick",c),m.off("destroy",l)}m.once("destroy",l),m.updateRotateDeg=function(){var e=this;e.rotateDeg||(e.rotateDeg=0);var n=e.root.offsetWidth,a=e.root.offsetHeight,s=e.video.videoWidth,u=e.video.videoHeight;!e.config.rotate.innerRotate&&e.config.rotate.controlsFix&&(e.root.style.width=a+"px",e.root.style.height=n+"px");var t=void 0;if(e.rotateDeg===.25||e.rotateDeg===.75){if(e.config.rotate.innerRotate)if(s/u>a/n){var f=0;u/s>a/n?f=a*s/u:f=n,t=a/f}else{var h=0;u/s>a/n?h=a:h=n*u/s,t=n/h}else n>=a?t=n/a:t=a/n;t=Number(t.toFixed(5))}else t=1;e.config.rotate.innerRotate||e.config.rotate.controlsFix?(e.video.style.transformOrigin="center center",e.video.style.transform="rotate("+e.rotateDeg+"turn) scale("+t+")",e.video.style.webKitTransform="rotate("+e.rotateDeg+"turn) scale("+t+")"):(e.root.style.transformOrigin="center center",e.root.style.transform="rotate("+e.rotateDeg+"turn) scale("+1+")",e.root.style.webKitTransform="rotate("+e.rotateDeg+"turn) scale("+1+")")},m.rotate=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=this;a.rotateDeg||(a.rotateDeg=0);var s=e?1:-1;a.rotateDeg=(a.rotateDeg+1+s*.25*n)%1,this.updateRotateDeg(),a.emit("rotate",a.rotateDeg*360)}};I.default={name:"rotate",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){var m=this,r=m.config.screenShot;if(!r)return;m.video.setAttribute("crossOrigin","anonymous");var c=.92;(r.quality||r.quality===0)&&(c=r.quality);var l=r.type===void 0?"image/png":r.type,e=r.format===void 0?".png":r.format,n=document.createElement("canvas"),a=n.getContext("2d"),s=new Image;n.width=this.config.width||600,n.height=this.config.height||337.5;var u=function(h,v){var y=document.createElement("a");y.href=h,y.download=v;var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),y.dispatchEvent(p)};m.screenShot=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;f=r.saveImg===void 0?f:r.saveImg,n.width=m.video.videoWidth||600,n.height=m.video.videoHeight||337.5,s.onload=function(){a.drawImage(m.video,0,0,n.width,n.height),s.src=n.toDataURL(l,c).replace(l,"image/octet-stream");var h=s.src.replace(/^data:image\/[^;]+/,"data:application/octet-stream");m.emit("screenShot",h),f&&u(h,"\u622A\u56FE"+e)}()},m.on("screenShotBtnClick",m.screenShot);function t(){m.off("screenShotBtnClick",m.screenShot),m.off("destroy",t)}m.once("destroy",t)};I.default={name:"screenShot",method:F},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(4),G=m(F);function m(c){return c&&c.__esModule?c:{default:c}}function r(){var c=this;if(!!c.config.enableStallCheck){var l=0,e=void 0,n=void 0;c.once("complete",function(){setInterval(function(){c.currentTime-(l||0)>.1||c.paused?(e===1||e===2)&&(e=0,clearTimeout(n),n=null):e||(e=1,n=setTimeout(function(){e===1&&(e=2,c.emit("error",new G.default("STALL"))),n=null},2e4)),l=c.currentTime},1e3)})}}I.default={name:"stallCheck",method:r},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(5),m=r(G);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.root,a=void 0,s=void 0,u=void 0,t=void 0;function f(){!e.controls||(e.volume=e.config.volume,a=e.controls.querySelector(".xgplayer-volume"),!!a&&(s=a.querySelector(".xgplayer-slider"),u=a.querySelector(".xgplayer-bar"),t=a.querySelector(".xgplayer-drag"),m.default.device==="mobile"&&(e.volume===0&&(e.video.muted=!0),d())))}e.once("canplay",f);function h(w){if(!!s){e.video.muted=!1,s.focus(),(0,F.event)(w);var D=u.getBoundingClientRect(),b={x:w.clientX,y:w.clientY},S=t.getBoundingClientRect().height,C=!1,P=function(O){O.preventDefault(),O.stopPropagation(),(0,F.event)(O),C=!0;var _=S-O.clientY+b.y,x=_/D.height;t.style.height=_+"px",e.volume=Math.max(Math.min(x,1),0)},R=function L(O){if(O.preventDefault(),O.stopPropagation(),(0,F.event)(O),window.removeEventListener("mousemove",P),window.removeEventListener("touchmove",P),window.removeEventListener("mouseup",L),window.removeEventListener("touchend",L),!C){var _=D.height-(O.clientY-D.top),x=_/D.height;t.style.height=_+"px",x<=0&&(e.volume>0?t.volume=e.video.volume:x=t.volume),e.volume=Math.max(Math.min(x,1),0)}s.volume=e.volume,C=!1};return window.addEventListener("mousemove",P),window.addEventListener("touchmove",P),window.addEventListener("mouseup",R),window.addEventListener("touchend",R),!1}}e.on("volumeBarClick",h);function v(){if(m.default.device==="mobile")e.video.muted?(e.video.muted=!1,e.emit("unmute"),e.volume=1):(e.video.muted=!0,e.emit("mute"),e.volume=0);else{if(!s)return;e.video.muted=!1,e.volume<.1?(s.volume<.1?e.volume=.6:e.volume=s.volume,e.emit("unmute")):(e.volume=0,e.emit("mute"))}}e.on("volumeIconClick",v);function y(){(0,F.addClass)(n,"xgplayer-volume-active"),a&&a.focus()}e.on("volumeIconEnter",y);function p(){(0,F.removeClass)(n,"xgplayer-volume-active")}e.on("volumeIconLeave",p);var g=null;function d(){g&&clearTimeout(g),g=setTimeout(function(){if(m.default.device==="mobile")(0,F.removeClass)(n,"xgplayer-volume-muted"),(0,F.removeClass)(n,"xgplayer-volume-large"),e.video.muted||e.video.defaultMuted?(e.video.muted||(e.video.muted=!0),e.video.defaultMuted=!1,(0,F.addClass)(n,"xgplayer-volume-muted")):(0,F.addClass)(n,"xgplayer-volume-large");else{if((0,F.removeClass)(n,"xgplayer-volume-muted"),(0,F.removeClass)(n,"xgplayer-volume-small"),(0,F.removeClass)(n,"xgplayer-volume-large"),e.volume===0||e.muted?(0,F.addClass)(n,"xgplayer-volume-muted"):e.volume<.5?(0,F.addClass)(n,"xgplayer-volume-small"):(0,F.addClass)(n,"xgplayer-volume-large"),!u)return;var w=u.getBoundingClientRect().height||76;t.style.height=e.volume*w+"px"}},50)}e.on("volumechange",d);function E(){e.off("canplay",f),e.off("volumeBarClick",h),e.off("volumeIconClick",v),e.off("volumeIconEnter",y),e.off("volumeIconLeave",p),e.off("volumechange",d),e.off("destroy",E),g&&(clearTimeout(g),g=null)}e.once("destroy",E)};I.default={name:"volume",method:c},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function a(s,u){for(var t=0;t<u.length;t++){var f=u[t];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(s,f.key,f)}}return function(s,u,t){return u&&a(s.prototype,u),t&&a(s,t),s}}(),G=K(106),m=r(G);function r(a){return a&&a.__esModule?a:{default:a}}function c(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var l={follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},e=function(){function a(s,u,t){var f=this;c(this,a);var h=this.create(u,t,s.textTrackShowDefault);h.attachPlayer(s),this.subtitle=h,this.player=s,this.positionData={vBottom:0,marginBottom:0},this.isActive=!1,this.followBottom=t.followBottom,["onSubtitleResize","onFocus","onBlur"].map(function(v){f[v]=f[v].bind(f)}),s.controls&&t.follow&&(this.subtitle.on("resize",this.onSubtitleResize),s.on("focus",this.onFocus),s.on("blur",this.onBlur))}return F(a,[{key:"create",value:function(u){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h={subTitles:u,defaultOpen:f};return Object.keys(t).map(function(v){h[v]=t[v]}),new m.default(h)}},{key:"switch",value:function(u){return this.subtitle.switch(u)}},{key:"switchOff",value:function(){return this.subtitle.switchOff()}},{key:"setSubTitles",value:function(u,t,f){return this.subtitle.setSubTitles(u,t,f)}},{key:"onFocus",value:function(){var u=this.positionData,t=u.marginBottom,f=u.vBottom;if(!(this.isActive||!t)){this.isActive=!0;var h=t+f;this.followBottom>h&&(h=this.followBottom),this.subtitle&&(this.subtitle.root.style.bottom=h+"px")}}},{key:"onBlur",value:function(){this.isActive=!1;var u=this.positionData.vBottom+this.positionData.marginBottom;this.subtitle&&(this.subtitle.root.style.bottom=u+"px")}},{key:"onSubtitleResize",value:function(u){this.positionData.vBottom=u.vBottom,this.positionData.marginBottom=u.marginBottom}},{key:"destroy",value:function(){this.subtitle.off("resize",this.onSubtitleResize),this.player.off("focus",this.onFocus),this.player.off("blur",this.onBlur),this.subtitle.destroy(),this.subtitle=null}}]),a}(),n=function(){var s=this,u=this,t=u.config.textTrack;if(!t)return;var f=u.config.textTrackStyle||{};Object.keys(l).map(function(v){f[v]===void 0&&(f[v]=l[v])}),u.textTrackShowDefault=!1,u.config.textTrack.map(function(v,y){!v.id&&!v.language&&(v.id=y),!v.url&&(v.url=v.src),!v.language&&(v.language=v.srclang),v.isDefault===void 0&&(v.isDefault=v.default),!u.textTrackShowDefault&&(u.textTrackShowDefault=v.isDefault||v.default)}),this.subTitles=new e(u,u.config.textTrack,f),u.setSubTitles=function(v){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=!1;v.map(function(g,d){!g.id&&!g.language&&(g.id=d),!g.url&&(g.url=g.src),!g.language&&(g.language=g.srclang),g.isDefault===void 0&&(g.isDefault=g.default),g.isDefault&&(p=!0)}),u.textTrackShowDefault=p,s.subTitles.setSubTitles(v,p,y),u.emit("subtitle_change",{off:!1,isListUpdate:!0,list:v})},u.switchSubTitle=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};s.subTitles.switch(v).then(function(y){y.code===0&&(v.off=!1,v.isListUpdate=!1,v.list=[],u.emit("subtitle_change",v))})},u.switchOffSubtile=function(){s.subTitles.switchOff(),u.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]})};function h(){this.subTitles.destroy(),this.subTitles=null}u.once("destroy",h)};I.default={name:"textTrack",method:n},X.exports=I.default},function(X,I,K){(function(F,G){X.exports=G()})(this,function(){function F(V){return V&&V.__esModule&&Object.prototype.hasOwnProperty.call(V,"default")?V.default:V}function G(V,Z){return Z={exports:{}},V(Z,Z.exports),Z.exports}function m(V){var Z,q;this.promise=new V(function(ee,ae){if(Z!==void 0||q!==void 0)throw TypeError("Bad Promise constructor");Z=ee,q=ae}),this.resolve=z(Z),this.reject=z(q)}function r(V){var Z=V.length;return Z===3?(60*(60*Number(V[0])+Number(V[1]))*1e3+1e3*Number(V[2]))/1e3:Z===2?(60*Number(V[0])*1e3+1e3*Number(V[1]))/1e3:Number(V[0])}function c(V){return/^(\-|\+)?\d+(\.\d+)?$/.test(V)}function l(V){return V}function e(V,Z){return V>=0&&V<Z.length?Z[V]:""}function n(V,Z){if(!V)return!1;if(V.classList)return Array.prototype.some.call(V.classList,function(ee){return ee===Z});var q=V.className&&er(V.className)==="object"?V.getAttribute("class"):V.className;return q&&!!q.match(new RegExp("(\\s|^)"+Z+"(\\s|$)"))}function a(V,Z){V&&(V.classList?Z.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(q){q&&V.classList.add(q)}):n(V,Z)||(V.className&&er(V.className)==="object"?V.setAttribute("class",V.getAttribute("class")+" "+Z):V.className+=" "+Z))}function s(V,Z){V&&(V.classList?Z.split(/\s+/g).forEach(function(q){V.classList.remove(q)}):n(V,Z)&&Z.split(/\s+/g).forEach(function(q){var ee=new RegExp("(\\s|^)"+q+"(\\s|$)");V.className&&er(V.className)==="object"?V.setAttribute("class",V.getAttribute("class").replace(ee," ")):V.className=V.className.replace(ee," ")}))}function u(V,Z,q){var ee=Z.length;if(ee<1)return-1;if(q=q<0?0:q>=ee?ee-1:q,Z[q].start<=V&&V<Z[q].end)return q;for(var ae=Z[q].end<=V?q+1:0;ae<ee;ae++){if(Z[ae].start<=V&&V<Z[ae].end)return ae;if(V>Z[ae].end&&ae+1<ee&&V<Z[ae+1].start||V>Z[ae].end&&ae+1>=ee)return-1}return-1}function t(V,Z,q){var ee=Z.length;if(ee<1)return[];var ae=[];if((q=q<0?0:q>=ee?ee-1:q)<ee)for(var he=Z[q].end<=V?q:0;he<ee&&(Z[he].start<=V&&V<Z[he].end&&ae.push(he),!(V<Z[he].start));he++);return ae}function f(V){return Object.prototype.toString.call(V).match(/([^\s.*]+)(?=]$)/g)[0]}function h(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ee=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",ae=document.createElement(V);return ae.className=ee,ae.innerHTML=Z,wt(q).forEach(function(he){var Ee=he,Te=q[he];V==="video"||V==="audio"||V==="live-video"?Te&&ae.setAttribute(Ee,Te):ae.setAttribute(Ee,Te)}),ae}function v(){var V=navigator.userAgent,Z=/(?:Windows Phone)/.test(V),q=/(?:SymbianOS)/.test(V)||Z,ee=/(?:Android)/.test(V),ae=/(?:Firefox)/.test(V),he=/(?:iPad|PlayBook)/.test(V)||ee&&!/(?:Mobile)/.test(V)||ae&&/(?:Tablet)/.test(V);return/(?:iPhone)/.test(V)&&!he||ee||q||he}function y(V){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",q="";V.map(function(Te){q+=" "+Z+" "+Te.key+" {"+Te.style+"}"});var ee=document.createElement("style"),ae=document.head||document.getElementsByTagName("head")[0];if(ee.type="text/css",ee.id="ssss",ee.styleSheet){var he=function(){try{ee.styleSheet.cssText=q}catch{}};ee.styleSheet.disabled?setTimeout(he,10):he()}else{var Ee=document.createTextNode(q);ee.appendChild(Ee)}ae.appendChild(ee)}function p(V,Z){At||(At=new pn),At.addObserver(V,Z)}function g(V,Z){At&&At.unObserver(V,Z)}function d(V){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q={code:xi[V].code,msg:xi[V].msg};return wt(Z).map(function(ee){q[ee]=Z[ee]}),q}function E(V,Z,q,ee,ae){ae?q(d(2,ae),{format:ee.format}):ee.format?(V.list=ee.list,V.format=ee.format,V.styles=ee.styles,Z(V)):q(d(3))}function w(V){return new gr(function(Z,q){if(V.list)return void Z(V);if(V.json){var ee=vr.parseJson(V.json);return V.list=ee,V.format="json",void Z(V)}if(V.stringContent&&!V.url)vr.parse(V.stringContent,function(he,Ee){E(V,Z,q,he,Ee)});else if(V.url)new cn({url:V.url,type:"text"}).then(function(he){vr.parse(he.res.response,function(Ee,Te){E(V,Z,q,Ee,Te)})}).catch(function(he){var Ee=d(1,{statusText:he.statusText,status:he.status,type:he.type,message:"http load error",url:V.url});q(Ee)});else{var ae=d(8);q(ae)}})}function D(V,Z){return!!(V.id&&V.id===Z.id||V.language&&V.language===Z.language)}var b=function(V){if(V==null)throw TypeError("Can't call method on  "+V);return V},S=function(V){return Object(b(V))},C={}.hasOwnProperty,P=function(V,Z){return C.call(V,Z)},R=G(function(V){var Z=V.exports={version:"2.6.12"};typeof __e=="number"&&(__e=Z)}),L=(R.version,G(function(V){var Z=V.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=Z)})),O=G(function(V){var Z=L["__core-js_shared__"]||(L["__core-js_shared__"]={});(V.exports=function(q,ee){return Z[q]||(Z[q]=ee!==void 0?ee:{})})("versions",[]).push({version:R.version,mode:"pure",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})}),_=0,x=Math.random(),A=function(V){return"Symbol(".concat(V===void 0?"":V,")_",(++_+x).toString(36))},k=O("keys"),M=function(V){return k[V]||(k[V]=A(V))},N=M("IE_PROTO"),U=Object.prototype,j=Object.getPrototypeOf||function(V){return V=S(V),P(V,N)?V[N]:typeof V.constructor=="function"&&V instanceof V.constructor?V.constructor.prototype:V instanceof Object?U:null},z=function(V){if(typeof V!="function")throw TypeError(V+" is not a function!");return V},J=function(V,Z,q){if(z(V),Z===void 0)return V;switch(q){case 1:return function(ee){return V.call(Z,ee)};case 2:return function(ee,ae){return V.call(Z,ee,ae)};case 3:return function(ee,ae,he){return V.call(Z,ee,ae,he)}}return function(){return V.apply(Z,arguments)}},te=function(V){return typeof V=="object"?V!==null:typeof V=="function"},re=function(V){if(!te(V))throw TypeError(V+" is not an object!");return V},oe=function(V){try{return!!V()}catch{return!0}},se=!oe(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),me=L.document,fe=te(me)&&te(me.createElement),ue=function(V){return fe?me.createElement(V):{}},ye=!se&&!oe(function(){return Object.defineProperty(ue("div"),"a",{get:function(){return 7}}).a!=7}),pe=function(V,Z){if(!te(V))return V;var q,ee;if(Z&&typeof(q=V.toString)=="function"&&!te(ee=q.call(V))||typeof(q=V.valueOf)=="function"&&!te(ee=q.call(V))||!Z&&typeof(q=V.toString)=="function"&&!te(ee=q.call(V)))return ee;throw TypeError("Can't convert object to primitive value")},de=Object.defineProperty,ve={f:se?Object.defineProperty:function(V,Z,q){if(re(V),Z=pe(Z,!0),re(q),ye)try{return de(V,Z,q)}catch{}if("get"in q||"set"in q)throw TypeError("Accessors not supported!");return"value"in q&&(V[Z]=q.value),V}},ne=function(V,Z){return{enumerable:!(1&V),configurable:!(2&V),writable:!(4&V),value:Z}},we=se?function(V,Z,q){return ve.f(V,Z,ne(1,q))}:function(V,Z,q){return V[Z]=q,V},Ce=function(V,Z,q){var ee,ae,he,Ee=V&Ce.F,Te=V&Ce.G,Se=V&Ce.S,Ae=V&Ce.P,De=V&Ce.B,Re=V&Ce.W,Me=Te?R:R[Z]||(R[Z]={}),Ie=Me.prototype,Le=Te?L:Se?L[Z]:(L[Z]||{}).prototype;Te&&(q=Z);for(ee in q)(ae=!Ee&&Le&&Le[ee]!==void 0)&&P(Me,ee)||(he=ae?Le[ee]:q[ee],Me[ee]=Te&&typeof Le[ee]!="function"?q[ee]:De&&ae?J(he,L):Re&&Le[ee]==he?function(Fe){var Be=function(He,Xe,Je){if(this instanceof Fe){switch(arguments.length){case 0:return new Fe;case 1:return new Fe(He);case 2:return new Fe(He,Xe)}return new Fe(He,Xe,Je)}return Fe.apply(this,arguments)};return Be.prototype=Fe.prototype,Be}(he):Ae&&typeof he=="function"?J(Function.call,he):he,Ae&&((Me.virtual||(Me.virtual={}))[ee]=he,V&Ce.R&&Ie&&!Ie[ee]&&we(Ie,ee,he)))};Ce.F=1,Ce.G=2,Ce.S=4,Ce.P=8,Ce.B=16,Ce.W=32,Ce.U=64,Ce.R=128;var ge=Ce,_e=function(V,Z){var q=(R.Object||{})[V]||Object[V],ee={};ee[V]=Z(q),ge(ge.S+ge.F*oe(function(){q(1)}),"Object",ee)};_e("getPrototypeOf",function(){return function(V){return j(S(V))}});var Pe=R.Object.getPrototypeOf,Q=F(G(function(V){V.exports={default:Pe,__esModule:!0}})),B=F(G(function(V,Z){Z.__esModule=!0,Z.default=function(q,ee){if(!(q instanceof ee))throw new TypeError("Cannot call a class as a function")}})),W=Math.ceil,Y=Math.floor,$=function(V){return isNaN(V=+V)?0:(V>0?Y:W)(V)},ie=we,le={},ce={}.toString,xe=function(V){return ce.call(V).slice(8,-1)},Oe=Object("z").propertyIsEnumerable(0)?Object:function(V){return xe(V)=="String"?V.split(""):Object(V)},ke=function(V){return Oe(b(V))},Ue=Math.min,Ne=function(V){return V>0?Ue($(V),9007199254740991):0},We=Math.max,Ke=Math.min,Qe=function(V,Z){return V=$(V),V<0?We(V+Z,0):Ke(V,Z)},Ge=function(V){return function(Z,q,ee){var ae,he=ke(Z),Ee=Ne(he.length),Te=Qe(ee,Ee);if(V&&q!=q){for(;Ee>Te;)if((ae=he[Te++])!=ae)return!0}else for(;Ee>Te;Te++)if((V||Te in he)&&he[Te]===q)return V||Te||0;return!V&&-1}}(!1),qe=M("IE_PROTO"),Ye=function(V,Z){var q,ee=ke(V),ae=0,he=[];for(q in ee)q!=qe&&P(ee,q)&&he.push(q);for(;Z.length>ae;)P(ee,q=Z[ae++])&&(~Ge(he,q)||he.push(q));return he},ze="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),$e=Object.keys||function(V){return Ye(V,ze)},je=se?Object.defineProperties:function(V,Z){re(V);for(var q,ee=$e(Z),ae=ee.length,he=0;ae>he;)ve.f(V,q=ee[he++],Z[q]);return V},et=L.document,tt=et&&et.documentElement,at=M("IE_PROTO"),st=function(){},Ze=function(){var V,Z=ue("iframe"),q=ze.length;for(Z.style.display="none",tt.appendChild(Z),Z.src="javascript:",(V=Z.contentWindow.document).open(),V.write("<script>document.F=Object<\/script>"),V.close(),Ze=V.F;q--;)delete Ze.prototype[ze[q]];return Ze()},nt=Object.create||function(V,Z){var q;return V!==null?(st.prototype=re(V),q=new st,st.prototype=null,q[at]=V):q=Ze(),Z===void 0?q:je(q,Z)},Ve=G(function(V){var Z=O("wks"),q=L.Symbol,ee=typeof q=="function";(V.exports=function(ae){return Z[ae]||(Z[ae]=ee&&q[ae]||(ee?q:A)("Symbol."+ae))}).store=Z}),Nt=ve.f,Dt=Ve("toStringTag"),lt=function(V,Z,q){V&&!P(V=q?V:V.prototype,Dt)&&Nt(V,Dt,{configurable:!0,value:Z})},yt={};we(yt,Ve("iterator"),function(){return this});var jt=function(V,Z,q){V.prototype=nt(yt,{next:ne(1,q)}),lt(V,Z+" Iterator")},xt=Ve("iterator"),Ht=!([].keys&&"next"in[].keys()),Ti=function(){return this},yr=function(V,Z,q,ee,ae,he,Ee){jt(q,Z,ee);var Te,Se,Ae,De=function(Je){if(!Ht&&Je in Le)return Le[Je];switch(Je){case"keys":case"values":return function(){return new q(this,Je)}}return function(){return new q(this,Je)}},Re=Z+" Iterator",Me=ae=="values",Ie=!1,Le=V.prototype,Fe=Le[xt]||Le["@@iterator"]||ae&&Le[ae],Be=Fe||De(ae),He=ae?Me?De("entries"):Be:void 0,Xe=Z=="Array"&&Le.entries||Fe;if(Xe&&(Ae=j(Xe.call(new V)))!==Object.prototype&&Ae.next&&lt(Ae,Re,!0),Me&&Fe&&Fe.name!=="values"&&(Ie=!0,Be=function(){return Fe.call(this)}),Ee&&(Ht||Ie||!Le[xt])&&we(Le,xt,Be),le[Z]=Be,le[Re]=Ti,ae)if(Te={values:Me?Be:De("values"),keys:he?Be:De("keys"),entries:He},Ee)for(Se in Te)Se in Le||ie(Le,Se,Te[Se]);else ge(ge.P+ge.F*(Ht||Ie),Z,Te);return Te},Si=function(V){return function(Z,q){var ee,ae,he=String(b(Z)),Ee=$(q),Te=he.length;return Ee<0||Ee>=Te?V?"":void 0:(ee=he.charCodeAt(Ee),ee<55296||ee>56319||Ee+1===Te||(ae=he.charCodeAt(Ee+1))<56320||ae>57343?V?he.charAt(Ee):ee:V?he.slice(Ee,Ee+2):ae-56320+(ee-55296<<10)+65536)}}(!0);yr(String,"String",function(V){this._t=String(V),this._i=0},function(){var V,Z=this._t,q=this._i;return q>=Z.length?{value:void 0,done:!0}:(V=Si(Z,q),this._i+=V.length,{value:V,done:!1})});var Lt=function(V,Z){return{value:Z,done:!!V}};yr(Array,"Array",function(V,Z){this._t=ke(V),this._i=0,this._k=Z},function(){var V=this._t,Z=this._k,q=this._i++;return!V||q>=V.length?(this._t=void 0,Lt(1)):Z=="keys"?Lt(0,q):Z=="values"?Lt(0,V[q]):Lt(0,[q,V[q]])},"values"),le.Arguments=le.Array;for(var xr=Ve("toStringTag"),Er="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Wt=0;Wt<Er.length;Wt++){var Kt=Er[Wt],br=L[Kt],Gt=br&&br.prototype;Gt&&!Gt[xr]&&we(Gt,xr,Kt),le[Kt]=le.Array}var Vt={f:Ve},Ci=Vt.f("iterator"),Tr=G(function(V){V.exports={default:Ci,__esModule:!0}});F(Tr);var dt=G(function(V){var Z=A("meta"),q=ve.f,ee=0,ae=Object.isExtensible||function(){return!0},he=!oe(function(){return ae(Object.preventExtensions({}))}),Ee=function(Re){q(Re,Z,{value:{i:"O"+ ++ee,w:{}}})},Te=function(Re,Me){if(!te(Re))return typeof Re=="symbol"?Re:(typeof Re=="string"?"S":"P")+Re;if(!P(Re,Z)){if(!ae(Re))return"F";if(!Me)return"E";Ee(Re)}return Re[Z].i},Se=function(Re,Me){if(!P(Re,Z)){if(!ae(Re))return!0;if(!Me)return!1;Ee(Re)}return Re[Z].w},Ae=function(Re){return he&&De.NEED&&ae(Re)&&!P(Re,Z)&&Ee(Re),Re},De=V.exports={KEY:Z,NEED:!1,fastKey:Te,getWeak:Se,onFreeze:Ae}}),_i=(dt.KEY,dt.NEED,dt.fastKey,dt.getWeak,dt.onFreeze,ve.f),zt=function(V){var Z=R.Symbol||(R.Symbol={});V.charAt(0)=="_"||V in Z||_i(Z,V,{value:Vt.f(V)})},Et={f:Object.getOwnPropertySymbols},Yt={f:{}.propertyIsEnumerable},Oi=function(V){var Z=$e(V),q=Et.f;if(q)for(var ee,ae=q(V),he=Yt.f,Ee=0;ae.length>Ee;)he.call(V,ee=ae[Ee++])&&Z.push(ee);return Z},wi=Array.isArray||function(V){return xe(V)=="Array"},Ai=ze.concat("length","prototype"),Sr={f:Object.getOwnPropertyNames||function(V){return Ye(V,Ai)}},Cr=Sr.f,Di={}.toString,_r=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Li=function(V){try{return Cr(V)}catch{return _r.slice()}},Or={f:function(V){return _r&&Di.call(V)=="[object Window]"?Li(V):Cr(ke(V))}},wr=Object.getOwnPropertyDescriptor,Xt={f:se?wr:function(V,Z){if(V=ke(V),Z=pe(Z,!0),ye)try{return wr(V,Z)}catch{}if(P(V,Z))return ne(!Yt.f.call(V,Z),V[Z])}},Pi=dt.KEY,Ar=Xt.f,ht=ve.f,Dr=Or.f,it=L.Symbol,Pt=L.JSON,kt=Pt&&Pt.stringify,rt=Ve("_hidden"),Lr=Ve("toPrimitive"),ki={}.propertyIsEnumerable,bt=O("symbol-registry"),ft=O("symbols"),Tt=O("op-symbols"),ot=Object.prototype,gt=typeof it=="function"&&!!Et.f,Qt=L.QObject,$t=!Qt||!Qt.prototype||!Qt.prototype.findChild,Jt=se&&oe(function(){return nt(ht({},"a",{get:function(){return ht(this,"a",{value:7}).a}})).a!=7})?function(V,Z,q){var ee=Ar(ot,Z);ee&&delete ot[Z],ht(V,Z,q),ee&&V!==ot&&ht(ot,Z,ee)}:ht,Pr=function(V){var Z=ft[V]=nt(it.prototype);return Z._k=V,Z},Zt=gt&&typeof it.iterator=="symbol"?function(V){return typeof V=="symbol"}:function(V){return V instanceof it},Rt=function(V,Z,q){return V===ot&&Rt(Tt,Z,q),re(V),Z=pe(Z,!0),re(q),P(ft,Z)?(q.enumerable?(P(V,rt)&&V[rt][Z]&&(V[rt][Z]=!1),q=nt(q,{enumerable:ne(0,!1)})):(P(V,rt)||ht(V,rt,ne(1,{})),V[rt][Z]=!0),Jt(V,Z,q)):ht(V,Z,q)},kr=function(V,Z){re(V);for(var q,ee=Oi(Z=ke(Z)),ae=0,he=ee.length;he>ae;)Rt(V,q=ee[ae++],Z[q]);return V},Ri=function(V,Z){return Z===void 0?nt(V):kr(nt(V),Z)},Mi=function(V){var Z=ki.call(this,V=pe(V,!0));return!(this===ot&&P(ft,V)&&!P(Tt,V))&&(!(Z||!P(this,V)||!P(ft,V)||P(this,rt)&&this[rt][V])||Z)},Rr=function(V,Z){if(V=ke(V),Z=pe(Z,!0),V!==ot||!P(ft,Z)||P(Tt,Z)){var q=Ar(V,Z);return!q||!P(ft,Z)||P(V,rt)&&V[rt][Z]||(q.enumerable=!0),q}},Mr=function(V){for(var Z,q=Dr(ke(V)),ee=[],ae=0;q.length>ae;)P(ft,Z=q[ae++])||Z==rt||Z==Pi||ee.push(Z);return ee},Ir=function(V){for(var Z,q=V===ot,ee=Dr(q?Tt:ke(V)),ae=[],he=0;ee.length>he;)!P(ft,Z=ee[he++])||q&&!P(ot,Z)||ae.push(ft[Z]);return ae};gt||(ie((it=function(){if(this instanceof it)throw TypeError("Symbol is not a constructor!");var V=A(arguments.length>0?arguments[0]:void 0),Z=function(q){this===ot&&Z.call(Tt,q),P(this,rt)&&P(this[rt],V)&&(this[rt][V]=!1),Jt(this,V,ne(1,q))};return se&&$t&&Jt(ot,V,{configurable:!0,set:Z}),Pr(V)}).prototype,"toString",function(){return this._k}),Xt.f=Rr,ve.f=Rt,Sr.f=Or.f=Mr,Yt.f=Mi,Et.f=Ir,Vt.f=function(V){return Pr(Ve(V))}),ge(ge.G+ge.W+ge.F*!gt,{Symbol:it});for(var Fr="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Br=0;Fr.length>Br;)Ve(Fr[Br++]);for(var Ur=$e(Ve.store),Nr=0;Ur.length>Nr;)zt(Ur[Nr++]);ge(ge.S+ge.F*!gt,"Symbol",{for:function(V){return P(bt,V+="")?bt[V]:bt[V]=it(V)},keyFor:function(V){if(!Zt(V))throw TypeError(V+" is not a symbol!");for(var Z in bt)if(bt[Z]===V)return Z},useSetter:function(){$t=!0},useSimple:function(){$t=!1}}),ge(ge.S+ge.F*!gt,"Object",{create:Ri,defineProperty:Rt,defineProperties:kr,getOwnPropertyDescriptor:Rr,getOwnPropertyNames:Mr,getOwnPropertySymbols:Ir});var Ii=oe(function(){Et.f(1)});ge(ge.S+ge.F*Ii,"Object",{getOwnPropertySymbols:function(V){return Et.f(S(V))}}),Pt&&ge(ge.S+ge.F*(!gt||oe(function(){var V=it();return kt([V])!="[null]"||kt({a:V})!="{}"||kt(Object(V))!="{}"})),"JSON",{stringify:function(V){for(var Z,q,ee=[V],ae=1;arguments.length>ae;)ee.push(arguments[ae++]);if(q=Z=ee[1],(te(Z)||V!==void 0)&&!Zt(V))return wi(Z)||(Z=function(he,Ee){if(typeof q=="function"&&(Ee=q.call(this,he,Ee)),!Zt(Ee))return Ee}),ee[1]=Z,kt.apply(Pt,ee)}}),it.prototype[Lr]||we(it.prototype,Lr,it.prototype.valueOf),lt(it,"Symbol"),lt(Math,"Math",!0),lt(L.JSON,"JSON",!0),zt("asyncIterator"),zt("observable");var Fi=R.Symbol,jr=G(function(V){V.exports={default:Fi,__esModule:!0}});F(jr);var qt=G(function(V,Z){function q(Ee){return Ee&&Ee.__esModule?Ee:{default:Ee}}Z.__esModule=!0;var ee=q(Tr),ae=q(jr),he=typeof ae.default=="function"&&typeof ee.default=="symbol"?function(Ee){return typeof Ee}:function(Ee){return Ee&&typeof ae.default=="function"&&Ee.constructor===ae.default&&Ee!==ae.default.prototype?"symbol":typeof Ee};Z.default=typeof ae.default=="function"&&he(ee.default)==="symbol"?function(Ee){return Ee===void 0?"undefined":he(Ee)}:function(Ee){return Ee&&typeof ae.default=="function"&&Ee.constructor===ae.default&&Ee!==ae.default.prototype?"symbol":Ee===void 0?"undefined":he(Ee)}}),er=F(qt),Hr=F(G(function(V,Z){Z.__esModule=!0;var q=function(ee){return ee&&ee.__esModule?ee:{default:ee}}(qt);Z.default=function(ee,ae){if(!ee)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!ae||(ae===void 0?"undefined":(0,q.default)(ae))!=="object"&&typeof ae!="function"?ee:ae}}));ge(ge.S+ge.F*!se,"Object",{defineProperty:ve.f});var Bi=R.Object,Ui=function(V,Z,q){return Bi.defineProperty(V,Z,q)},Wr=G(function(V){V.exports={default:Ui,__esModule:!0}});F(Wr);var Mt=F(G(function(V,Z){Z.__esModule=!0;var q=function(ee){return ee&&ee.__esModule?ee:{default:ee}}(Wr);Z.default=function(){function ee(ae,he){for(var Ee=0;Ee<he.length;Ee++){var Te=he[Ee];Te.enumerable=Te.enumerable||!1,Te.configurable=!0,"value"in Te&&(Te.writable=!0),(0,q.default)(ae,Te.key,Te)}}return function(ae,he,Ee){return he&&ee(ae.prototype,he),Ee&&ee(ae,Ee),ae}}()})),Kr=function(V,Z){if(re(V),!te(Z)&&Z!==null)throw TypeError(Z+": can't set as prototype!")},Ni={set:Object.setPrototypeOf||("__proto__"in{}?function(V,Z,q){try{(q=J(Function.call,Xt.f(Object.prototype,"__proto__").set,2))(V,[]),Z=!(V instanceof Array)}catch{Z=!0}return function(ee,ae){return Kr(ee,ae),Z?ee.__proto__=ae:q(ee,ae),ee}}({},!1):void 0),check:Kr};ge(ge.S,"Object",{setPrototypeOf:Ni.set});var ji=R.Object.setPrototypeOf,Gr=G(function(V){V.exports={default:ji,__esModule:!0}});F(Gr),ge(ge.S,"Object",{create:nt});var Hi=R.Object,Wi=function(V,Z){return Hi.create(V,Z)},Vr=G(function(V){V.exports={default:Wi,__esModule:!0}});F(Vr);var pt,zr,tr,Ki=F(G(function(V,Z){function q(Ee){return Ee&&Ee.__esModule?Ee:{default:Ee}}Z.__esModule=!0;var ee=q(Gr),ae=q(Vr),he=q(qt);Z.default=function(Ee,Te){if(typeof Te!="function"&&Te!==null)throw new TypeError("Super expression must either be null or a function, not "+(Te===void 0?"undefined":(0,he.default)(Te)));Ee.prototype=(0,ae.default)(Te&&Te.prototype,{constructor:{value:Ee,enumerable:!1,writable:!0,configurable:!0}}),Te&&(ee.default?(0,ee.default)(Ee,Te):Ee.__proto__=Te)}})),Gi=Ve("toStringTag"),Vi=xe(function(){return arguments}())=="Arguments",zi=function(V,Z){try{return V[Z]}catch{}},Yr=function(V){var Z,q,ee;return V===void 0?"Undefined":V===null?"Null":typeof(q=zi(Z=Object(V),Gi))=="string"?q:Vi?xe(Z):(ee=xe(Z))=="Object"&&typeof Z.callee=="function"?"Arguments":ee},Yi=function(V,Z,q,ee){if(!(V instanceof Z)||ee!==void 0&&ee in V)throw TypeError(q+": incorrect invocation!");return V},Xi=function(V,Z,q,ee){try{return ee?Z(re(q)[0],q[1]):Z(q)}catch(he){var ae=V.return;throw ae!==void 0&&re(ae.call(V)),he}},Qi=Ve("iterator"),$i=Array.prototype,Ji=function(V){return V!==void 0&&(le.Array===V||$i[Qi]===V)},Zi=Ve("iterator"),qi=R.getIteratorMethod=function(V){if(V!=null)return V[Zi]||V["@@iterator"]||le[Yr(V)]},Xr=G(function(V){var Z={},q={},ee=V.exports=function(ae,he,Ee,Te,Se){var Ae,De,Re,Me,Ie=Se?function(){return ae}:qi(ae),Le=J(Ee,Te,he?2:1),Fe=0;if(typeof Ie!="function")throw TypeError(ae+" is not iterable!");if(Ji(Ie)){for(Ae=Ne(ae.length);Ae>Fe;Fe++)if((Me=he?Le(re(De=ae[Fe])[0],De[1]):Le(ae[Fe]))===Z||Me===q)return Me}else for(Re=Ie.call(ae);!(De=Re.next()).done;)if((Me=Xi(Re,Le,De.value,he))===Z||Me===q)return Me};ee.BREAK=Z,ee.RETURN=q}),en=Ve("species"),Qr=function(V,Z){var q,ee=re(V).constructor;return ee===void 0||(q=re(ee)[en])==null?Z:z(q)},tn=function(V,Z,q){var ee=q===void 0;switch(Z.length){case 0:return ee?V():V.call(q);case 1:return ee?V(Z[0]):V.call(q,Z[0]);case 2:return ee?V(Z[0],Z[1]):V.call(q,Z[0],Z[1]);case 3:return ee?V(Z[0],Z[1],Z[2]):V.call(q,Z[0],Z[1],Z[2]);case 4:return ee?V(Z[0],Z[1],Z[2],Z[3]):V.call(q,Z[0],Z[1],Z[2],Z[3])}return V.apply(q,Z)},$r=L.process,rr=L.setImmediate,ir=L.clearImmediate,Jr=L.MessageChannel,nr=L.Dispatch,ar=0,St={},Ct=function(){var V=+this;if(St.hasOwnProperty(V)){var Z=St[V];delete St[V],Z()}},Zr=function(V){Ct.call(V.data)};rr&&ir||(rr=function(V){for(var Z=[],q=1;arguments.length>q;)Z.push(arguments[q++]);return St[++ar]=function(){tn(typeof V=="function"?V:Function(V),Z)},pt(ar),ar},ir=function(V){delete St[V]},xe($r)=="process"?pt=function(V){$r.nextTick(J(Ct,V,1))}:nr&&nr.now?pt=function(V){nr.now(J(Ct,V,1))}:Jr?(tr=(zr=new Jr).port2,zr.port1.onmessage=Zr,pt=J(tr.postMessage,tr,1)):L.addEventListener&&typeof postMessage=="function"&&!L.importScripts?(pt=function(V){L.postMessage(V+"","*")},L.addEventListener("message",Zr,!1)):pt="onreadystatechange"in ue("script")?function(V){tt.appendChild(ue("script")).onreadystatechange=function(){tt.removeChild(this),Ct.call(V)}}:function(V){setTimeout(J(Ct,V,1),0)});var qr={set:rr,clear:ir},rn=qr.set,ei=L.MutationObserver||L.WebKitMutationObserver,sr=L.process,or=L.Promise,ti=xe(sr)=="process",It={f:function(V){return new m(V)}},Ft=function(V){try{return{e:!1,v:V()}}catch(Z){return{e:!0,v:Z}}},ri=L.navigator,nn=ri&&ri.userAgent||"",lr=function(V,Z){if(re(V),te(Z)&&Z.constructor===V)return Z;var q=It.f(V);return(0,q.resolve)(Z),q.promise},ii=Ve("species"),ur=Ve("iterator"),ni=!1;try{var ai=[7][ur]();ai.return=function(){ni=!0},Array.from(ai,function(){throw 2})}catch{}var fr,si,oi,cr,li=qr.set,ui=function(){var V,Z,q,ee=function(){var Te,Se;for(ti&&(Te=sr.domain)&&Te.exit();V;){Se=V.fn,V=V.next;try{Se()}catch(Ae){throw V?q():Z=void 0,Ae}}Z=void 0,Te&&Te.enter()};if(ti)q=function(){sr.nextTick(ee)};else if(!ei||L.navigator&&L.navigator.standalone)if(or&&or.resolve){var ae=or.resolve(void 0);q=function(){ae.then(ee)}}else q=function(){rn.call(L,ee)};else{var he=!0,Ee=document.createTextNode("");new ei(ee).observe(Ee,{characterData:!0}),q=function(){Ee.data=he=!he}}return function(Te){var Se={fn:Te,next:void 0};Z&&(Z.next=Se),V||(V=Se,q()),Z=Se}}(),fi=L.TypeError,vt=L.process,ci=vt&&vt.versions,an=ci&&ci.v8||"",ut=L.Promise,_t=Yr(vt)=="process",Bt=function(){},Ot=si=It.f,Ut=!!function(){try{var V=ut.resolve(1),Z=(V.constructor={})[Ve("species")]=function(q){q(Bt,Bt)};return(_t||typeof PromiseRejectionEvent=="function")&&V.then(Bt)instanceof Z&&an.indexOf("6.6")!==0&&nn.indexOf("Chrome/66")===-1}catch{}}(),hi=function(V){var Z;return!(!te(V)||typeof(Z=V.then)!="function")&&Z},hr=function(V,Z){if(!V._n){V._n=!0;var q=V._c;ui(function(){for(var ee=V._v,ae=V._s==1,he=0;q.length>he;)(function(Ee){var Te,Se,Ae,De=ae?Ee.ok:Ee.fail,Re=Ee.resolve,Me=Ee.reject,Ie=Ee.domain;try{De?(ae||(V._h==2&&on(V),V._h=1),De===!0?Te=ee:(Ie&&Ie.enter(),Te=De(ee),Ie&&(Ie.exit(),Ae=!0)),Te===Ee.promise?Me(fi("Promise-chain cycle")):(Se=hi(Te))?Se.call(Te,Re,Me):Re(Te)):Me(ee)}catch(Le){Ie&&!Ae&&Ie.exit(),Me(Le)}})(q[he++]);V._c=[],V._n=!1,Z&&!V._h&&sn(V)})}},sn=function(V){li.call(L,function(){var Z,q,ee,ae=V._v,he=di(V);if(he&&(Z=Ft(function(){_t?vt.emit("unhandledRejection",ae,V):(q=L.onunhandledrejection)?q({promise:V,reason:ae}):(ee=L.console)&&ee.error&&ee.error("Unhandled promise rejection",ae)}),V._h=_t||di(V)?2:1),V._a=void 0,he&&Z.e)throw Z.v})},di=function(V){return V._h!==1&&(V._a||V._c).length===0},on=function(V){li.call(L,function(){var Z;_t?vt.emit("rejectionHandled",V):(Z=L.onrejectionhandled)&&Z({promise:V,reason:V._v})})},mt=function(V){var Z=this;Z._d||(Z._d=!0,(Z=Z._w||Z)._v=V,Z._s=2,Z._a||(Z._a=Z._c.slice()),hr(Z,!0))},dr=function(V){var Z,q=this;if(!q._d){q._d=!0,q=q._w||q;try{if(q===V)throw fi("Promise can't be resolved itself");(Z=hi(V))?ui(function(){var ee={_w:q,_d:!1};try{Z.call(V,J(dr,ee,1),J(mt,ee,1))}catch(ae){mt.call(ee,ae)}}):(q._v=V,q._s=1,hr(q,!1))}catch(ee){mt.call({_w:q,_d:!1},ee)}}};Ut||(ut=function(V){Yi(this,ut,"Promise","_h"),z(V),fr.call(this);try{V(J(dr,this,1),J(mt,this,1))}catch(Z){mt.call(this,Z)}},(fr=function(V){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(V,Z,q){for(var ee in Z)q&&V[ee]?V[ee]=Z[ee]:we(V,ee,Z[ee]);return V}(ut.prototype,{then:function(V,Z){var q=Ot(Qr(this,ut));return q.ok=typeof V!="function"||V,q.fail=typeof Z=="function"&&Z,q.domain=_t?vt.domain:void 0,this._c.push(q),this._a&&this._a.push(q),this._s&&hr(this,!1),q.promise},catch:function(V){return this.then(void 0,V)}}),oi=function(){var V=new fr;this.promise=V,this.resolve=J(dr,V,1),this.reject=J(mt,V,1)},It.f=Ot=function(V){return V===ut||V===cr?new oi(V):si(V)}),ge(ge.G+ge.W+ge.F*!Ut,{Promise:ut}),lt(ut,"Promise"),function(V){var Z=typeof R[V]=="function"?R[V]:L[V];se&&Z&&!Z[ii]&&ve.f(Z,ii,{configurable:!0,get:function(){return this}})}("Promise"),cr=R.Promise,ge(ge.S+ge.F*!Ut,"Promise",{reject:function(V){var Z=Ot(this);return(0,Z.reject)(V),Z.promise}}),ge(ge.S+!0*ge.F,"Promise",{resolve:function(V){return lr(this===cr?ut:this,V)}}),ge(ge.S+ge.F*!(Ut&&function(V,Z){if(!Z&&!ni)return!1;var q=!1;try{var ee=[7],ae=ee[ur]();ae.next=function(){return{done:q=!0}},ee[ur]=function(){return ae},V(ee)}catch{}return q}(function(V){ut.all(V).catch(Bt)})),"Promise",{all:function(V){var Z=this,q=Ot(Z),ee=q.resolve,ae=q.reject,he=Ft(function(){var Ee=[],Te=0,Se=1;Xr(V,!1,function(Ae){var De=Te++,Re=!1;Ee.push(void 0),Se++,Z.resolve(Ae).then(function(Me){Re||(Re=!0,Ee[De]=Me,--Se||ee(Ee))},ae)}),--Se||ee(Ee)});return he.e&&ae(he.v),q.promise},race:function(V){var Z=this,q=Ot(Z),ee=q.reject,ae=Ft(function(){Xr(V,!1,function(he){Z.resolve(he).then(q.resolve,ee)})});return ae.e&&ee(ae.v),q.promise}}),ge(ge.P+ge.R,"Promise",{finally:function(V){var Z=Qr(this,R.Promise||L.Promise),q=typeof V=="function";return this.then(q?function(ee){return lr(Z,V()).then(function(){return ee})}:V,q?function(ee){return lr(Z,V()).then(function(){throw ee})}:V)}}),ge(ge.S,"Promise",{try:function(V){var Z=It.f(this),q=Ft(V);return(q.e?Z.reject:Z.resolve)(q.v),Z.promise}});var ln=R.Promise,gr=F(G(function(V){V.exports={default:ln,__esModule:!0}}));_e("keys",function(){return function(V){return $e(S(V))}});var un=R.Object.keys,wt=F(G(function(V){V.exports={default:un,__esModule:!0}})),fn=G(function(V){function Z(){}function q(Se,Ae,De){this.fn=Se,this.context=Ae,this.once=De||!1}function ee(Se,Ae,De,Re,Me){if(typeof De!="function")throw new TypeError("The listener must be a function");var Ie=new q(De,Re||Se,Me),Le=Te?Te+Ae:Ae;return Se._events[Le]?Se._events[Le].fn?Se._events[Le]=[Se._events[Le],Ie]:Se._events[Le].push(Ie):(Se._events[Le]=Ie,Se._eventsCount++),Se}function ae(Se,Ae){--Se._eventsCount==0?Se._events=new Z:delete Se._events[Ae]}function he(){this._events=new Z,this._eventsCount=0}var Ee=Object.prototype.hasOwnProperty,Te="~";Object.create&&(Z.prototype=Object.create(null),new Z().__proto__||(Te=!1)),he.prototype.eventNames=function(){var Se,Ae,De=[];if(this._eventsCount===0)return De;for(Ae in Se=this._events)Ee.call(Se,Ae)&&De.push(Te?Ae.slice(1):Ae);return Object.getOwnPropertySymbols?De.concat(Object.getOwnPropertySymbols(Se)):De},he.prototype.listeners=function(Se){var Ae=Te?Te+Se:Se,De=this._events[Ae];if(!De)return[];if(De.fn)return[De.fn];for(var Re=0,Me=De.length,Ie=new Array(Me);Re<Me;Re++)Ie[Re]=De[Re].fn;return Ie},he.prototype.listenerCount=function(Se){var Ae=Te?Te+Se:Se,De=this._events[Ae];return De?De.fn?1:De.length:0},he.prototype.emit=function(Se,Ae,De,Re,Me,Ie){var Le=Te?Te+Se:Se;if(!this._events[Le])return!1;var Fe,Be,He=this._events[Le],Xe=arguments.length;if(He.fn){switch(He.once&&this.removeListener(Se,He.fn,void 0,!0),Xe){case 1:return He.fn.call(He.context),!0;case 2:return He.fn.call(He.context,Ae),!0;case 3:return He.fn.call(He.context,Ae,De),!0;case 4:return He.fn.call(He.context,Ae,De,Re),!0;case 5:return He.fn.call(He.context,Ae,De,Re,Me),!0;case 6:return He.fn.call(He.context,Ae,De,Re,Me,Ie),!0}for(Be=1,Fe=new Array(Xe-1);Be<Xe;Be++)Fe[Be-1]=arguments[Be];He.fn.apply(He.context,Fe)}else{var Je,ct=He.length;for(Be=0;Be<ct;Be++)switch(He[Be].once&&this.removeListener(Se,He[Be].fn,void 0,!0),Xe){case 1:He[Be].fn.call(He[Be].context);break;case 2:He[Be].fn.call(He[Be].context,Ae);break;case 3:He[Be].fn.call(He[Be].context,Ae,De);break;case 4:He[Be].fn.call(He[Be].context,Ae,De,Re);break;default:if(!Fe)for(Je=1,Fe=new Array(Xe-1);Je<Xe;Je++)Fe[Je-1]=arguments[Je];He[Be].fn.apply(He[Be].context,Fe)}}return!0},he.prototype.on=function(Se,Ae,De){return ee(this,Se,Ae,De,!1)},he.prototype.once=function(Se,Ae,De){return ee(this,Se,Ae,De,!0)},he.prototype.removeListener=function(Se,Ae,De,Re){var Me=Te?Te+Se:Se;if(!this._events[Me])return this;if(!Ae)return ae(this,Me),this;var Ie=this._events[Me];if(Ie.fn)Ie.fn!==Ae||Re&&!Ie.once||De&&Ie.context!==De||ae(this,Me);else{for(var Le=0,Fe=[],Be=Ie.length;Le<Be;Le++)(Ie[Le].fn!==Ae||Re&&!Ie[Le].once||De&&Ie[Le].context!==De)&&Fe.push(Ie[Le]);Fe.length?this._events[Me]=Fe.length===1?Fe[0]:Fe:ae(this,Me)}return this},he.prototype.removeAllListeners=function(Se){var Ae;return Se?(Ae=Te?Te+Se:Se,this._events[Ae]&&ae(this,Ae)):(this._events=new Z,this._eventsCount=0),this},he.prototype.off=he.prototype.removeListener,he.prototype.addListener=he.prototype.on,he.prefixed=Te,he.EventEmitter=he,V.exports=he}),cn=function V(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=Z.url,ee=Z.method,ae=ee===void 0?"GET":ee,he=Z.type,Ee=he===void 0?"arraybuffer":he,Te=Z.timeout,Se=Te===void 0?1e4:Te,Ae=Z.data,De=Ae===void 0?{}:Ae,Re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return B(this,V),new gr(function(Me,Ie){var Le=new window.XMLHttpRequest,Fe=ae.toUpperCase(),Be=[];Ee&&(Le.responseType=Ee),Se&&(Le.timeout=Se);for(var He in De)Be.push("k="+De[He]);if(Le.onload=function(){Le.status===200||Le.status===206?Me({context:Re,res:Le}):Ie(new Error({context:Re,res:Le,type:"error"}))},Le.onerror=function(Xe){Ie(new Error({context:Re,res:Le,type:"error"}))},Le.ontimeout=function(Xe){Ie(new Error({context:Re,res:Le,type:"error"}))},Le.onabort=function(){Ie(new Error({context:Re,res:Le,type:"error"}))},Fe==="GET")Le.open(Fe,""+q),Le.send();else{if(Fe!=="post")throw new Error("xhr "+Fe+" is not supported");Le.open(Fe,q),Le.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Le.send(Be.join("&"))}})},pr=/^WEBVTT/,hn=/^STYLE+$/,dn=/^\:\:cue/,gn=/^}+$/,gi=/^\[Script Info\].*/,pi=[/[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{3}-->[0-9]{2}:[0-9]{2}:[0-9]{2}\.[0-9]{3}/,/[0-9]{2}:[0-9]{2}\.[0-9]{3}-->[0-9]{2}:[0-9]{2}\.[0-9]{3}/,/[0-9]{2}\.[0-9]{3}-->[0-9]{2}\.[0-9]{3}/],vi=/^Format:\s/,mi=/^Style:\s/,yi=/^Dialogue:\s/,vr=function(){function V(){B(this,V)}return Mt(V,null,[{key:"parseJson",value:function(Z){for(var q=[],ee=0,ae=0;ae<Z.length;ae++){if(ee>=50&&(ee=0),ee===0){var he={start:Z[ae].start,list:[Z[ae]],end:Z[ae].end};q.push(he)}else q[q.length-1].list.push(Z[ae]),q[q.length-1].end=Z[ae].end;ee++}return q}},{key:"parse",value:function(Z,q){var ee=V.checkFormat(Z);ee||q({format:ee});try{var ae=[];ee==="ass"?ae=V.parseASS(Z):ee==="vtt"&&(ae=V.parseVTT(Z)),q({format:ee,list:ae.list,styles:ae.styles})}catch(he){console.error(he),q({format:ee},he)}}},{key:"parseASSItem",value:function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ee=Z.split(","),ae={},he="";try{var Ee=ee.length-q.length;return he=Ee>0?ee.splice(q.length-1,Ee+1).join(",")+"":ee[ee.length-1]+"",he=he.replace(/\\n+/g,""),he=l(he),ee[q.length-1]=he,q.map(function(Te,Se){Te==="end"||Te==="start"?ae[Te]=r(ee[Se].split(":")):Te==="text"?ae[Te]=[ee[Se]]:Te==="layer"?(ae[Te]=[ee[Se]],ae.textTag=[ee[Se]]):ae[Te]=Te==="style"?[ee[Se]]:Number(ee[Se])?Number(ee[Se]):ee[Se]}),ae}catch(Te){return console.error(Te),{}}}},{key:"parseASS",value:function(Z){for(var q=Z.split(`
`),ee=[],ae=0,he=0,Ee=[],Te=[],Se=null;ae<q.length;){if(vi.test(q[ae]))Te=(Te=q[ae].replace(vi,"").replace(/\s+/g,"").split(",")).map(function(Fe){return Fe.toLocaleLowerCase()});else if(mi.test(q[ae]))Ee.push(q[ae].replace(mi,"").replace(/\s+/g,""));else if(yi.test(q[ae])){var Ae=V.parseASSItem(q[ae].replace(yi,""),Te);if(Se&&Ae.start===Se.start&&Ae.end===Se.end)try{var De=Se,Re=De.text,Me=De.textTag,Ie=De.style;Re.push(Ae.text[0]),Me.push(Ae.textTag[0]),Ie.push(Ae.style[0])}catch(Fe){console.error(Fe)}else{Se=Ae;var Le=null;he%50==0?((Le={start:Se.start,end:Se.end,list:[]}).list.push(Se),ee.push(Le)):((Le=ee[ee.length-1]).end=Se.end,Le.list.push(Se)),he++}}ae++}return{list:ee,style:{}}}},{key:"parseVTTStyle",value:function(Z,q){var ee=Z.split(":");if(ee.length>1){var ae=ee[0].trim().split("-"),he="";ae.length>1?ae.map(function(Ee,Te){he+=Te===0?Ee:Ee.charAt(0).toUpperCase()+Ee.slice(1)}):he=ae[0],q[he]=ee[1].trim().replace(/;$/,"")}return q}},{key:"parseVTT",value:function(Z){for(var q=(Z=Z.replace(pr,"")).split(`
`),ee=[],ae=0,he=0,Ee=null,Te=!1,Se=!1,Ae=null,De=null,Re=[];ae<q.length;){var Me=e(ae,q).trim();if(!Me||Te&&c(Me))Te=!Me;else if(dn.test(Me)&&hn.test(e(ae-1,q).trim())){Se=!0;var Ie=/\((.+?)\)/g.exec(Me);De=Ie?Ie[1]:"",Ae=""}else if(Se)gn.test(Me)?(Re.push({key:De,style:Ae}),Ae=null,De=null,Se=!1):Ae+=Me;else if(Me){Te=!1;var Le=this.checkIsTime(q[ae]);if(Le){var Fe=this.parseVttTime(Le);if(!Ee||Fe.start!==Ee.start||Fe.end!==Ee.end){(Ee=Fe).text=[],Ee.textTag=[];var Be=null;he%50==0?((Be={start:Ee.start,end:Ee.end,list:[]}).list.push(Ee),ee.push(Be)):((Be=ee[ee.length-1]).end=Ee.end,Be.list.push(Ee)),he++}}else if(Ee){var He=Ee,Xe=He.text,Je=He.textTag,ct=this.parseVttText(q[ae]);Xe.push(ct.text),Je.push(ct.tag)}Te=!1}ae++}return{list:ee,styles:Re}}},{key:"checkIsTime",value:function(Z){Z=Z.replace(/\s+/g,"");for(var q=0,ee=null;q<pi.length&&!(ee=pi[q].exec(Z));)q++;return ee?ee[0]:null}},{key:"parseVttText",value:function(Z){var q=/^(<?.+?>)/g.exec(Z),ee="",ae="default";if(q){ae=q[0].replace(/\<|\>|\&/g,"");var he=RegExp("^<"+ae+">(([\\s\\S])*?)</"+ae+">$").exec(Z);he?ee=he[1]:(ee=Z,ae="")}else ee=Z;for(var Ee=/<(\w+).(\w+)>/g,Te=Ee.exec(ee);Te&&Te.length>2;)ee=ee.replace(Te[0],"<"+Te[1]+' class="'+Te[2]+'">'),Te=Ee.exec(ee);return{tag:ae,text:l(ee.replace(/\\n+/g,"<br/>"))}}},{key:"parseVttTime",value:function(Z){var q=Z.split("-->"),ee=void 0,ae=0;if(q.length===2){var he=q[0].split(":"),Ee=q[1].split(":");ee=r(he),ae=r(Ee)}return{start:ee,end:ae,time:Z}}},{key:"isVTT",value:function(Z){return pr.test(Z)}},{key:"isASS",value:function(Z){return gi.test(Z)}},{key:"checkFormat",value:function(Z){return Z?pr.test(Z)?"vtt":gi.test(Z)?"ass":null:null}}]),V}(),pn=function(){function V(){var Z=this;B(this,V),this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver(function(q){Z.__trigger(q)}))}return Mt(V,[{key:"addObserver",value:function(Z,q){if(this.observer){this.observer&&this.observer.observe(Z);for(var ee=this.__handlers,ae=-1,he=0;he<ee.length;he++)ee[he]&&Z===ee[he].target&&(ae=he);ae>-1?this.__handlers[ae].handler.push(q):this.__handlers.push({target:Z,handler:[q]})}}},{key:"unObserver",value:function(Z){var q=-1;this.__handlers.map(function(ee,ae){Z===ee.target&&(q=ae)}),this.observer&&this.observer.unobserve(Z),q>-1&&this.__handlers.splice(q,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(Z,q){for(var ee=this.__handlers,ae=0;ae<ee.length;ae++)if(ee[ae]&&Z===ee[ae].target){ee[ae].handler&&ee[ae].handler.map(function(he){try{he(Z,q)}catch(Ee){console.error(Ee)}});break}}},{key:"__trigger",value:function(Z){var q=this;Z.map(function(ee){var ae=ee.contentRect;q.__runHandler(ee.target,ae)})}}]),V}(),At=null;(function(V,Z){Z===void 0&&(Z={});var q=Z.insertAt;if(V&&typeof document!="undefined"){var ee=document.head||document.getElementsByTagName("head")[0],ae=document.createElement("style");ae.type="text/css",q==="top"&&ee.firstChild?ee.insertBefore(ae,ee.firstChild):ee.appendChild(ae),ae.styleSheet?ae.styleSheet.cssText=V:ae.appendChild(document.createTextNode(V))}})(`xg-text-track.xg-text-track {
  font-family: "PingFang SC","SF Pro SC","SF Pro Text","SF Pro Icons","Helvetica Neue","Helvetica","Arial",sans-serif;
  -webkit-font-smoothing: antialiased;
  position: absolute;
  bottom: 0;
  color: #fff;
  left: 0;
  right: 0;
  pointer-events: none;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center; }
  xg-text-track.xg-text-track.text-track-no-fitvideo {
    margin-bottom: 2%; }
  xg-text-track.xg-text-track.text-track-hide {
    opacity: 0;
    visibility: hidden; }
  xg-text-track.xg-text-track.text-track-show {
    opacity: 1;
    visibility: visible; }
  xg-text-track.xg-text-track xg-text-track-inner {
    display: block;
    max-width: 92%; }
  xg-text-track.xg-text-track xg-text-track-span {
    display: -webkit-box;
    text-align: center;
    text-overflow: ellipsis;
    -webkit-box-orient: vertical;
    overflow: hidden;
    padding: 1px 4px;
    -webkit-line-clamp: 1;
    line-height: 120%;
    word-break: break-word; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-deputy {
      font-size: 75%; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-single {
      -webkit-line-clamp: 1; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-double {
      -webkit-line-clamp: 2; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-three {
      -webkit-line-clamp: 3; }
  xg-text-track.xg-text-track.text-track-bg xg-text-track-inner {
    background-color: rgba(0, 0, 0, .54);
    border-radius: 2px; }
  xg-text-track.xg-text-track.text-track-stroke xg-text-track-inner {
    background-color: none;
    border-radius: 0;
    text-shadow: -1px 1px 0 rgba(0, 0, 0, .7), 1px 1px 0 rgba(0, 0, 0, .7), 1px -1px 0 rgba(0, 0, 0, .7), -1px -1px 0 rgba(0, 0, 0, .7); }
`);var xi=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR"},{code:6,msg:"ABORT"},{code:7,msg:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null"}],vn={RESIZE:"resize"},Ei=!1;return function(V){function Z(q){B(this,Z);var ee=Hr(this,(Z.__proto__||Q(Z)).call(this));return Ei=v(),ee.currentText=null,ee.textTrack=[],ee._cid=-1,ee._gid=-1,ee._cids=[],ee._iId=null,ee._iC=0,ee.player=null,ee.root=null,ee.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff"},ee._ctime=0,ee._loadingTrack={},wt(ee.config).map(function(ae){q[ae]!==void 0&&q[ae]!==null&&(ee.config[ae]=q[ae])}),ee._isOpen=!1,ee._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},q.subTitles&&f(q.subTitles)==="Array"?(q.player&&ee.attachPlayer(q.player),ee.setSubTitles(q.subTitles,ee.config.defaultOpen),ee):Hr(ee)}return Ki(Z,V),Mt(Z,[{key:"version",get:function(){return"1.0.12"}}]),Mt(Z,[{key:"setSubTitles",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ee=this,ae=arguments.length>1&&arguments[1]!==void 0&&arguments[1],he=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],Ee=this._isOpen||ae;he&&this.innerRoot&&this.switchOff(),this.currentText=null,this.textTrack=[],q.map(function(Te){var Se={};wt(Te).map(function(Ae){Se[Ae]=Te[Ae]}),Se.isDefault&&(ee.currentText=Se),ee.textTrack.push(Se)}),this.currentText&&w(this.currentText).then(function(Te){ee.addStyles(Te),Ee&&ee.switch()})}},{key:"addStyles",value:function(q){var ee=q.styles,ae=q.format;ee&&ae==="vtt"&&(ee.map(function(he){he.key||(he.key="xg-text-track-span")}),y(ee,"xg-text-track"))}},{key:"attachPlayer",value:function(q){var ee=this;if(q){this.player&&this.detachPlayer();var ae=this.config,he=ae.fontColor,Ee=ae.mode,Te=ae.fitVideo;this.player=q,this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&a(this.root,"text-track-hide"),!Te&&a(this.root,"text-track-no-fitvideo"),Ee&&a(this.root,"text-track-"+Ee),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),he&&(this.root.style.color=he),this.currentText&&["language","id","label"].map(function(Se){ee.root.setAttribute("data-"+Se,ee.currentText[Se]||"")}),this.player.root.appendChild(this.root),["destroy","__onTimeupdate","_onResize"].map(function(Se){ee[Se]=ee[Se].bind(ee)}),this.player.on("destroy",this.destroy),this.player.on("timeupdate",this.__onTimeupdate),this._isOpen&&this.switch(),p(q.root,this._onResize)}}},{key:"detachPlayer",value:function(){var q=this.player;q&&(q.off("destroy",this.destroy),q.off("timeupdate",this.__onTimeupdate),q.root&&(g(q.root,this._onResize),q.root.removeChild(this.root)),this.innerRoot=null,this.root=null,this.player=null)}},{key:"switch",value:function(){var q=this,ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};return this._loadingTrack=ee,new gr(function(ae,he){if(!ee.id&&!ee.language){if(q.currentText){q._loadingTrack={},q._updateCurrent(q.currentText),q._isOpen=!0,q.show();var Ee=d(0,{message:"switch default subtitle success"});return void ae(Ee)}var Te=d(5,{message:"no default subtitle"});return void he(Te)}if(q.currentText&&D(ee,q.currentText))q._loadingTrack={},q._updateCurrent(q.currentText),q._isOpen=!0,q.show(),ae(d(0));else{for(var Se=null,Ae=0;Ae<q.textTrack.length;Ae++)if(D(ee,q.textTrack[Ae])){Se=q.textTrack[Ae];break}if(Se)Se.list?(q._loadingTrack={},q._updateCurrent(Se),q._isOpen=!0,q.show(),ae(d(0))):w(Se).then(function(Re){if(q.addStyles(Re),q._loadingTrack.id===Se.id||q._loadingTrack.language===Re.language)q._loadingTrack={},q._updateCurrent(Re),q._isOpen=!0,q.show(),ae(d(0));else{var Me=d(6,{message:"check _loadingTrack fail id: "+q._loadingTrack.id+"  nextSubtitle:"+Re.id});console.trace(Me),he(Me)}}).catch(function(Re){he(Re)});else{var De=d(4,new Error("The is no subtitle with id:[{"+ee.id+"}] or language:["+ee.language+"]"));console.trace(De),he(De)}}})}},{key:"switchOff",value:function(){this._isOpen=!1,this.hide()}},{key:"_updateCurrent",value:function(q){var ee=this;if(this.root){this.currentText=q,["language","id","label"].map(function(he){ee.root.setAttribute("data-"+he,ee.currentText[he]||"")}),this.__remove(this._cids);var ae=this.player.currentTime;this._cids=[],this._gid=-1,this._cid=-1,this._update(ae)}}},{key:"__loadAll",value:function(){this.textTrack.map(function(q){w(q)})}},{key:"getDelCid",value:function(q,ee){for(var ae=[],he=0;he<q.length;he++)ee.includes(q[he])||ae.push(q[he]);return ae}},{key:"getNewCid",value:function(q,ee){for(var ae=[],he=0;he<ee.length;he++)q.includes(ee[he])||ae.push(ee[he]);return ae}},{key:"_update",value:function(q){var ee=this,ae=u(q,this.currentText.list,this._gid),he=[];if(ae>-1&&(he=t(q,this.currentText.list[ae].list,this._cid)),he.length<1)return this._cids.length>0&&this.__remove(this._cids),void(this._cids=[]);if(this._cids!==he||ae!==this._gid){this._gid=ae,this._cid=he[0];var Ee=this.getDelCid(this._cids,he),Te=this.getNewCid(this._cids,he);this._cids=he,this.__remove(Ee);var Se=[];Te.map(function(Ae){var De=ee.currentText.list[ae].list[Ae];De.index=Ae,Se.push(De)}),this.__render(Se,q)}}},{key:"__onTimeupdate",value:function(){if(this._isOpen){var q=this.player.video,ee=q.videoWidth,ae=q.videoHeight;!this._videoMeta.scale&&ee&&ae&&this._onResize(this.player.root);var he=this.player.currentTime;Math.round(Math.abs(1e3*he-this._ctime))<200||(this._ctime=1e3*he,this.currentText&&this.currentText.list&&this._update(he))}}},{key:"_onResize",value:function(q){var ee=this._videoMeta;if(q&&q instanceof window.Element||(q=this.player.root),this._iId&&(clearTimeout(this._iId),this._iId=null),!ee.scale){if(!this.player.video)return;var ae=this.player.video,he=ae.videoWidth,Ee=ae.videoHeight;if(!he||!Ee)return;ee.videoWidth=he,ee.videoHeight=Ee,ee.scale=parseInt(Ee/he*100,10)}this.__startResize(q)}},{key:"resize",value:function(q,ee){var ae=this,he=this.config,Ee=he.baseSizeX,Te=he.baseSizeY,Se=he.minMobileSize,Ae=he.minSize,De=he.fitVideo,Re=he.offsetBottom,Me=this._videoMeta.scale;this._videoMeta.lwidth=q,this._videoMeta.lheight=ee;var Ie=void 0,Le=0;ee/q*100>=Me?(Le=parseInt(Me*q,10)/100,Ie=q):(Le=ee,Ie=parseInt(ee/Me*100,10)),this._videoMeta.vWidth=Ie,this._videoMeta.vHeight=Le;var Fe=0,Be=0;Me>120?(Fe=Te,Be=parseInt(Fe*Le/1080,10)):(Fe=Ee,Be=parseInt(Fe*Ie/1920,10));var He=Ei?Se:Ae,Xe={fontSize:Be=Be<He?He:Be>Fe?Fe:Be},Je=parseInt((ee-Le)/2,10),ct=parseInt((q-Ie)/2,10),mr=parseInt(Le*Re,10)/100;this._videoMeta.vBottom=Je,this._videoMeta.vLeft=ct,this._videoMeta.marginBottom=mr,De&&(Xe.bottom=Je+mr,Xe.left=Xe.right=ct),wt(Xe).map(function(bi){ae.root.style[bi]=Xe[bi]+"px"}),this.emit(vn.RESIZE,{vLeft:ct,vBottom:Je,marginBottom:mr,vWidth:Ie,vHeight:Le,fontSize:Be,scale:Me})}},{key:"__startResize",value:function(q){var ee=this,ae=q.getBoundingClientRect(),he=this._videoMeta,Ee=ae.width,Te=ae.height;if(this._iId&&(clearTimeout(this._iId),this._iId=null),Ee>0&&Te>0&&(Ee!==he.lwidth||Te!==he.lheight))this._iC=0,this.resize(Ee,Te);else{if(this._iC>=5)return void(this._iC=0);this._iC++,this._iId=setTimeout(function(){ee.__startResize(q)},50)}}},{key:"__remove",value:function(q){var ee=this;if(q&&!(q.length<1)){for(var ae=this.innerRoot.children,he=[],Ee=0;Ee<ae.length;Ee++){var Te=Number(ae[Ee].getAttribute("data-index"));q.includes(Te)&&he.push(ae[Ee])}he.map(function(Se){ee.innerRoot.removeChild(Se)})}}},{key:"__render",value:function(){var q=this,ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ee.length>0&&ee.map(function(ae){var he="text-track-"+q.config.line;ae.text.map(function(Ee,Te){Te>0&&(he+=" text-track-deputy");var Se={"data-start":ae.start,"data-end":ae.end,"data-index":ae.index};q.innerRoot.appendChild(h("xg-text-track-span",Ee,Se,he))})})}},{key:"show",value:function(){s(this.root,"text-track-hide")}},{key:"hide",value:function(){a(this.root,"text-track-hide"),this.innerRoot.innerHTML=""}},{key:"destroy",value:function(){this.detachPlayer(),this.removeAllListeners(),this.player=null,this.textTrack=null}},{key:"marginBottom",get:function(){var q=this._videoMeta,ee=q.bottom,ae=q.marginBottom;return this.config.fitVideo?ee+ae:ae}}]),Z}(fn)})},function(X,I,K){var F=K(9),G=$(F),m=K(10),r=$(m),c=K(108),l=$(c),e=K(48),n=$(e),a=K(40),s=$(a),u=K(53),t=$(u),f=K(56),h=$(f),v=K(59),y=$(v),p=K(111),g=$(p),d=K(116),E=$(d),w=K(122),D=$(w),b=K(64),S=$(b),C=K(68),P=$(C),R=K(71),L=$(R),O=K(74),_=$(O),x=K(125),A=$(x),k=K(128),M=$(k),N=K(129),U=$(N),j=K(133),z=$(j),J=K(139),te=$(J),re=K(142),oe=$(re),se=K(145),me=$(se),fe=K(149),ue=$(fe),ye=K(153),pe=$(ye),de=K(157),ve=$(de),ne=K(160),we=$(ne),Ce=K(162),ge=$(Ce),_e=K(163),Pe=$(_e),Q=K(166),B=$(Q),W=K(169),Y=$(W);function $(ie){return ie&&ie.__esModule?ie:{default:ie}}G.default.installAll([r.default,l.default,n.default,s.default,t.default,h.default,y.default,g.default,E.default,D.default,S.default,P.default,L.default,_.default,A.default,M.default,U.default,z.default,te.default,oe.default,me.default,ue.default,pe.default,ve.default,we.default,ge.default,Pe.default,B.default,Y.default])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(109);var G=function(){for(var r=this,c=r.root,l="",e=1;e<=12;e++)l+='<div class="xgplayer-enter-bar'+e+'"></div>';var n=(0,F.createDom)("xg-enter",`<div class="xgplayer-enter-spinner">
                                                  `+l+`
                                                </div>`,{},"xgplayer-enter");c.appendChild(n)};I.default={name:"s_enter",method:G},X.exports=I.default},function(X,I,K){var F=K(110);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-enter{display:none;position:absolute;left:0;top:0;width:100%;height:100%;background:#000;z-index:120}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner{display:block;position:absolute;left:50%;top:50%;height:100px;width:100px;position:relative;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div{width:12%;height:26%;background-color:hsla(0,0%,100%,.7);position:absolute;left:44%;top:37%;opacity:0;border-radius:30px;-webkit-animation:fade 1s linear infinite;animation:fade 1s linear infinite}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar1{-webkit-transform:rotate(0deg) translateY(-142%);-ms-transform:rotate(0deg) translateY(-142%);transform:rotate(0deg) translateY(-142%);-webkit-animation-delay:0s;animation-delay:0s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar2{-webkit-transform:rotate(30deg) translateY(-142%);-ms-transform:rotate(30deg) translateY(-142%);transform:rotate(30deg) translateY(-142%);-webkit-animation-delay:-.9163s;animation-delay:-.9163s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar3{-webkit-transform:rotate(60deg) translateY(-142%);-ms-transform:rotate(60deg) translateY(-142%);transform:rotate(60deg) translateY(-142%);-webkit-animation-delay:-.833s;animation-delay:-.833s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar4{-webkit-transform:rotate(90deg) translateY(-142%);-ms-transform:rotate(90deg) translateY(-142%);transform:rotate(90deg) translateY(-142%);-webkit-animation-delay:-.7497s;animation-delay:-.7497s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar5{-webkit-transform:rotate(120deg) translateY(-142%);-ms-transform:rotate(120deg) translateY(-142%);transform:rotate(120deg) translateY(-142%);-webkit-animation-delay:-.6664s;animation-delay:-.6664s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar6{-webkit-transform:rotate(150deg) translateY(-142%);-ms-transform:rotate(150deg) translateY(-142%);transform:rotate(150deg) translateY(-142%);-webkit-animation-delay:-.5831s;animation-delay:-.5831s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar7{-webkit-transform:rotate(180deg) translateY(-142%);-ms-transform:rotate(180deg) translateY(-142%);transform:rotate(180deg) translateY(-142%);-webkit-animation-delay:-.4998s;animation-delay:-.4998s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar8{-webkit-transform:rotate(210deg) translateY(-142%);-ms-transform:rotate(210deg) translateY(-142%);transform:rotate(210deg) translateY(-142%);-webkit-animation-delay:-.4165s;animation-delay:-.4165s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar9{-webkit-transform:rotate(240deg) translateY(-142%);-ms-transform:rotate(240deg) translateY(-142%);transform:rotate(240deg) translateY(-142%);-webkit-animation-delay:-.3332s;animation-delay:-.3332s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar10{-webkit-transform:rotate(270deg) translateY(-142%);-ms-transform:rotate(270deg) translateY(-142%);transform:rotate(270deg) translateY(-142%);-webkit-animation-delay:-.2499s;animation-delay:-.2499s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar11{-webkit-transform:rotate(300deg) translateY(-142%);-ms-transform:rotate(300deg) translateY(-142%);transform:rotate(300deg) translateY(-142%);-webkit-animation-delay:-.1666s;animation-delay:-.1666s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar12{-webkit-transform:rotate(330deg) translateY(-142%);-ms-transform:rotate(330deg) translateY(-142%);transform:rotate(330deg) translateY(-142%);-webkit-animation-delay:-.0833s;animation-delay:-.0833s}@-webkit-keyframes fade{0%{opacity:1}to{opacity:.25}}@keyframes fade{0%{opacity:1}to{opacity:.25}}.xgplayer-skin-default.xgplayer-is-enter .xgplayer-enter{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(112),m=l(G),r=K(113),c=l(r);K(114);function l(n){return n&&n.__esModule?n:{default:n}}var e=function(){var a=this;if(!!a.config.cssFullscreen){var s=(0,F.createDom)("xg-cssfullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+m.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+c.default+`</div>
                                           </xg-icon>`,{},"xgplayer-cssfullscreen"),u={};u.requestfull=a.lang.CSSFULLSCREEN_TIPS,u.exitfull=a.lang.EXITCSSFULLSCREEN_TIPS;var t=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+u.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+u.exitfull+"</span>",{},"xgplayer-tips");s.appendChild(t),a.once("ready",function(){a.controls.appendChild(s)}),["click","touchend"].forEach(function(f){s.addEventListener(f,function(h){h.preventDefault(),h.stopPropagation(),a.userGestureTrigEvent("cssFullscreenBtnClick")})})}};I.default={name:"s_cssFullscreen",method:e},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M843.617212 67.898413 175.411567 67.898413c-61.502749 0-111.367437 49.856501-111.367437 111.367437l0 668.205645c0 61.510936 49.864688 111.367437 111.367437 111.367437L843.617212 958.838931c61.510936 0 111.367437-49.856501 111.367437-111.367437L954.984648 179.26585C954.984648 117.754914 905.12917 67.898413 843.617212 67.898413zM398.146441 736.104057c15.380292 0 27.842115 12.461823 27.842115 27.842115 0 15.379269-12.461823 27.841092-27.842115 27.841092L259.725858 791.787264c-7.785314 0-14.781658-3.217275-19.838837-8.365528-5.383614-4.577249-8.791224-11.228739-8.791224-19.475564L231.095797 624.736621c0-15.371082 12.471033-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115l-0.61603 71.426773 133.036969-133.037992 39.378869 39.378869L324.962651 736.113267 398.146441 736.104057zM419.199942 463.611943 286.162974 330.565764l0.61603 71.435982c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.371082 0-27.842115-12.461823-27.842115-27.842115L231.094774 262.791172c0-8.256034 3.40761-14.908548 8.791224-19.476587 5.057179-5.148253 12.053524-8.374738 19.838837-8.374738l138.420583 0.00921c15.380292 0 27.842115 12.461823 27.842115 27.842115s-12.461823 27.842115-27.842115 27.842115l-73.175603-0.00921 133.607974 133.607974L419.199942 463.611943zM787.932981 763.946172c0 8.247848-3.40761 14.899338-8.791224 19.475564-5.057179 5.148253-12.053524 8.365528-19.839861 8.365528L620.881314 791.787264c-15.379269 0-27.841092-12.461823-27.841092-27.841092 0-15.380292 12.461823-27.842115 27.841092-27.842115l73.185836 0.00921L560.449967 602.50427l39.378869-39.378869L732.875015 696.163393l-0.62524-71.426773c0-15.371082 12.462846-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115L787.934005 763.946172zM787.932981 402.000724c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.379269 0-27.842115-12.461823-27.842115-27.842115l0.62524-71.435982L599.828836 463.611943l-39.378869-39.378869 133.617184-133.607974-73.185836 0.00921c-15.379269 0-27.841092-12.461823-27.841092-27.842115s12.461823-27.842115 27.841092-27.842115l138.421606-0.00921c7.785314 0 14.781658 3.226484 19.839861 8.374738 5.383614 4.568039 8.791224 11.219529 8.791224 19.476587L787.934005 402.000724z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M834.56 81.92H189.44c-59.392 0-107.52 48.128-107.52 107.52v645.12c0 59.392 48.128 107.52 107.52 107.52h645.12c59.392 0 107.52-48.128 107.52-107.52V189.44c0-59.392-48.128-107.52-107.52-107.52zM458.24 727.04c0 14.848-12.288 26.624-26.624 26.624S404.48 741.888 404.48 727.04v-69.632L289.28 773.12c-10.752 10.24-27.648 10.24-37.888 0-10.24-10.752-10.24-27.648 0-37.888L366.592 619.52H296.96c-14.848 0-26.624-12.288-26.624-26.624s12.288-26.624 26.624-26.624h134.144c14.848 0 26.624 12.288 26.624 26.624V727.04z m0-295.936c0 14.848-12.288 26.624-26.624 26.624H296.96c-14.848 0-26.624-12.288-26.624-26.624S282.112 404.48 296.96 404.48h69.632L251.392 289.28c-10.24-10.752-10.24-27.648 0-37.888 5.12-5.12 12.288-7.68 18.944-7.68 6.656 0 13.824 2.56 18.944 7.68L404.48 366.592V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v134.144zM773.12 773.12c-10.752 10.24-27.648 10.24-37.888 0L619.52 657.408V727.04c0 14.848-12.288 26.624-26.624 26.624s-26.624-11.776-26.624-26.624v-134.144c0-14.848 12.288-26.624 26.624-26.624H727.04c14.848 0 26.624 12.288 26.624 26.624s-12.288 26.624-26.624 26.624h-69.632l115.2 115.2c10.752 10.752 10.752 27.648 0.512 38.4z m0-483.84L657.408 404.48H727.04c14.848 0 26.624 12.288 26.624 26.624 0 14.848-12.288 26.624-26.624 26.624h-134.144c-14.848 0-26.624-12.288-26.624-26.624V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v69.632L734.72 250.88c5.12-5.12 12.288-7.68 18.944-7.68s13.824 2.56 18.944 7.68c10.752 10.752 10.752 27.648 0.512 38.4z"></path>
</svg>
`},function(X,I,K){var F=K(115);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-cssfullscreen,.xgplayer-skin-default .xgplayer-cssfullscreen-img{position:relative;-webkit-order:12;-moz-box-ordinal-group:13;order:12;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon{width:32px;margin-top:5px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-40px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover,.xgplayer-skin-default .xgplayer-cssfullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-47px}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen-img{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen{position:fixed!important;left:0!important;top:0!important;width:100%!important;height:100%!important;z-index:99999!important}.xgplayer-lang-is-en .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en .xgplayer-cssfullscreen .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-46px}.lang-is-jp .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-120px}.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-60px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(117),m=n(G),r=K(118),c=n(r),l=K(119),e=n(l);K(120);function n(s){return s&&s.__esModule?s:{default:s}}var a=function(){var u=this,t=(0,F.createDom)("xg-volume",`<xg-icon class="xgplayer-icon">
                                         <div class="xgplayer-icon-large">`+e.default+`</div>
                                         <div class="xgplayer-icon-small">`+c.default+`</div>
                                         <div class="xgplayer-icon-muted">`+m.default+`</div>
                                       </xg-icon>
                                       <xg-slider class="xgplayer-slider" tabindex="2">
                                         <xg-bar class="xgplayer-bar">
                                           <xg-drag class="xgplayer-drag"></xg-drag>
                                         </xg-bar>
                                       </xg-slider>`,{},"xgplayer-volume");u.once("ready",function(){u.controls&&u.controls.appendChild(t)});var f=t.querySelector(".xgplayer-slider"),h=t.querySelector(".xgplayer-bar"),v=t.querySelector(".xgplayer-drag"),y=t.querySelector(".xgplayer-icon");v.style.height=u.config.volume*100+"%",f.volume=u.config.volume,h.addEventListener("mousedown",function(p){p.preventDefault(),p.stopPropagation(),u.userGestureTrigEvent("volumeBarClick",p)}),["click","touchend"].forEach(function(p){y.addEventListener(p,function(g){g.preventDefault(),g.stopPropagation(),u.userGestureTrigEvent("volumeIconClick")})}),y.addEventListener("mouseenter",function(p){p.preventDefault(),p.stopPropagation(),u.userGestureTrigEvent("volumeIconEnter")}),["blur","mouseleave"].forEach(function(p){t.addEventListener(p,function(g){g.preventDefault(),g.stopPropagation(),u.userGestureTrigEvent("volumeIconLeave")})})};I.default={name:"s_volume",method:a},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(X,I,K){var F=K(121);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,'.xgplayer-skin-default .xgplayer-volume{outline:none;-webkit-order:4;-moz-box-ordinal-group:5;order:4;width:40px;height:40px;display:block;position:relative;z-index:18}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon{margin-top:8px;cursor:pointer;position:absolute;bottom:-9px}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:none}.xgplayer-skin-default .xgplayer-slider{display:none;position:absolute;width:28px;height:92px;background:rgba(0,0,0,.54);border-radius:1px;bottom:42px;outline:none}.xgplayer-skin-default .xgplayer-slider:after{content:" ";display:block;height:15px;width:28px;position:absolute;bottom:-15px;left:0;z-index:20}.xgplayer-skin-default .xgplayer-bar,.xgplayer-skin-default .xgplayer-drag{display:block;position:absolute;bottom:6px;left:12px;background:hsla(0,0%,100%,.3);border-radius:100px;width:4px;height:76px;outline:none;cursor:pointer}.xgplayer-skin-default .xgplayer-drag{bottom:0;left:0;background:#fa1f41;max-height:76px}.xgplayer-skin-default .xgplayer-drag:after{content:" ";display:inline-block;width:8px;height:8px;background:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.26);position:absolute;border-radius:50%;left:-2px;top:-6px}.xgplayer-skin-default.xgplayer-volume-active .xgplayer-slider,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:none}.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:block}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-large,.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:none}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:block}.xgplayer-skin-default.xgplayer-mobile .xgplayer-volume .xgplayer-slider{display:none}',""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(5),m=r(G);K(123);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.root,a=void 0,s=(0,F.createDom)("xg-definition","",{tabindex:3},"xgplayer-definition");m.default.device==="mobile"&&(e.config.definitionActive="click");function u(){var p=e.definitionList,g=["<ul>"],d=e.config.url,E=document.createElement("a");e.switchURL?["mp4","hls","__flv__","dash"].every(function(C){return e[C]?(e[C].url&&(E.href=e[C].url),C==="__flv__"&&(e[C]._options?E.href=e[C]._options.url:E.href=e[C]._mediaDataSource.url),C==="hls"&&(E.href=e[C].originUrl||e[C].url,d=E.href),d=E.href,!1):!0}):d=e.currentSrc||e.src,p.forEach(function(C){E.href=C.url,e.dash?g.push("<li url='"+C.url+"' cname='"+C.name+"' class='"+(C.selected?"selected":"")+"'>"+C.name+"</li>"):g.push("<li url='"+C.url+"' cname='"+C.name+"' class='"+(E.href===d?"selected":"")+"'>"+C.name+"</li>")});var w=p.filter(function(C){return E.href=C.url,e.dash?C.selected===!0:E.href===d});g.push("</ul><p class='name'>"+(w[0]||{name:""}).name+"</p>");var D=n.querySelector(".xgplayer-definition");if(D){D.innerHTML=g.join("");var b=D.querySelector(".name");(!e.config.definitionActive||e.config.definitionActive==="hover")&&b.addEventListener("mouseenter",function(C){C.preventDefault(),C.stopPropagation(),(0,F.addClass)(e.root,"xgplayer-definition-active"),D.focus()})}else{s.innerHTML=g.join("");var S=s.querySelector(".name");(!e.config.definitionActive||e.config.definitionActive==="hover")&&S.addEventListener("mouseenter",function(C){C.preventDefault(),C.stopPropagation(),(0,F.addClass)(e.root,"xgplayer-definition-active"),s.focus()}),e.controls.appendChild(s)}}function t(p){e.definitionList=p,p&&p instanceof Array&&p.length>0&&((0,F.addClass)(n,"xgplayer-is-definition"),e.once("canplay",u))}e.on("resourceReady",t);function f(){if(e.currentTime=e.curTime,a)e.pause();else{var p=e.play();p!==void 0&&p&&p.catch(function(g){})}}function h(){e.once("timeupdate",f)}["touchend","click"].forEach(function(p){s.addEventListener(p,function(g){g.preventDefault(),g.stopPropagation();var d=e.definitionList,E=g.target||g.srcElement,w=document.createElement("a");if(E&&E.tagName.toLocaleLowerCase()==="li"){var D=void 0,b=void 0;if(Array.prototype.forEach.call(E.parentNode.childNodes,function(C){(0,F.hasClass)(C,"selected")&&(D=C.getAttribute("cname"),(0,F.removeClass)(C,"selected"),e.emit("beforeDefinitionChange",C.getAttribute("url")))}),e.dash&&d.forEach(function(C){C.selected=!1,C.name===E.innerHTML&&(C.selected=!0)}),(0,F.addClass)(E,"selected"),b=E.getAttribute("cname"),E.parentNode.nextSibling.innerHTML=""+E.getAttribute("cname"),w.href=E.getAttribute("url"),a=e.paused,e.switchURL){var S=document.createElement("a");["mp4","hls","__flv__","dash"].every(function(C){return e[C]?(e[C].url&&(S.href=e[C].url),C==="__flv__"&&(e[C]._options?S.href=e[C]._options.url:S.href=e[C]._mediaDataSource.url),C==="hls"&&(S.href=e[C].originUrl||e[C].url),!1):!0}),S.href!==w.href&&!e.ended&&e.switchURL(w.href)}else e.hls&&(document.createElement("a"),e.hls.url),w.href!==e.currentSrc&&(e.curTime=e.currentTime,e.ended||(e.src=w.href));navigator.userAgent.toLowerCase().indexOf("android")>-1?e.once("timeupdate",h):e.once("loadedmetadata",f),e.emit("definitionChange",{from:D,to:b}),m.default.device==="mobile"&&(0,F.removeClass)(e.root,"xgplayer-definition-active")}else e.config.definitionActive==="click"&&E&&(E.tagName.toLocaleLowerCase()==="p"||E.tagName.toLocaleLowerCase()==="em")&&(m.default.device==="mobile"?(0,F.toggleClass)(e.root,"xgplayer-definition-active"):(0,F.addClass)(e.root,"xgplayer-definition-active"),s.focus());e.emit("focus")},!1)}),s.addEventListener("mouseleave",function(p){p.preventDefault(),p.stopPropagation(),(0,F.removeClass)(n,"xgplayer-definition-active")});function v(){(0,F.removeClass)(n,"xgplayer-definition-active")}e.on("blur",v);function y(){e.off("resourceReady",t),e.off("canplay",u),navigator.userAgent.toLowerCase().indexOf("android")>-1?(e.off("timeupdate",h),e.off("timeupdate",f)):e.off("loadedmetadata",f),e.off("blur",v),e.off("destroy",y)}e.once("destroy",y),e.getCurrentDefinition=function(){for(var p=e.controls.querySelectorAll(".xgplayer-definition ul li"),g=0;g<p.length;g++)if(p[g].className&&p[g].className.indexOf("selected")>-1)return{name:p[g].getAttribute("cname"),url:p[g].getAttribute("url")};return{name:p[0].getAttribute("cname"),url:p[0].getAttribute("url")}},e.switchDefinition=function(){for(var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=e.controls.querySelectorAll(".xgplayer-definition ul li"),d=0;d<g.length;d++)(g[d].getAttribute("cname")===p.name||g[d].getAttribute("url")===p.url||d===p.index)&&g[d].click()}};I.default={name:"s_definition",method:c},X.exports=I.default},function(X,I,K){var F=K(124);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-definition{-webkit-order:5;-moz-box-ordinal-group:6;order:5;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-left:10px;margin-top:-119px}.xgplayer-skin-default .xgplayer-definition ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:0;text-align:center;white-space:nowrap;margin-left:-10px;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-definition ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);padding:6px 13px}.xgplayer-skin-default .xgplayer-definition ul li.selected,.xgplayer-skin-default .xgplayer-definition ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-definition .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-definition ul,.xgplayer-skin-default.xgplayer-is-definition .xgplayer-definition{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(5),m=r(G);K(126);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=[];if(e.config.playbackRate)n=[].concat(e.config.playbackRate),n.sort(function(d,E){return E-d});else return!1;var a=e.config.playbackRateUnit!==void 0?e.config.playbackRateUnit:"x",s=(0,F.createDom)("xg-playbackrate"," ",{},"xgplayer-playbackrate");m.default.device==="mobile"&&(e.config.playbackRateActive="click");var u=[];n.forEach(function(d){u.push({name:""+d,rate:""+d+a,selected:!1})});var t=1,f=["<ul>"];u.forEach(function(d){e.config.defaultPlaybackRate&&e.config.defaultPlaybackRate.toString()===d.name?(d.selected=!0,t=e.config.defaultPlaybackRate,e.once("playing",function(){e.video.playbackRate=e.config.defaultPlaybackRate})):(d.name==="1.0"||d.name==="1")&&(!e.config.defaultPlaybackRate||e.config.defaultPlaybackRate===1)&&(d.selected=!0),f.push("<li cname='"+d.name+"' class='"+(d.selected?"selected":"")+"'>"+d.rate+"</li>")}),f.push("</ul><p class='name'>"+t+a+"</p>");var h=e.root.querySelector(".xgplayer-playbackrate");if(h){h.innerHTML=f.join("");var v=h.querySelector(".name");(!e.config.playbackRateActive||e.config.playbackRateActive==="hover")&&v.addEventListener("mouseenter",function(d){d.preventDefault(),d.stopPropagation(),(0,F.addClass)(e.root,"xgplayer-playbackrate-active"),h.focus()})}else{s.innerHTML=f.join("");var y=s.querySelector(".name");(!e.config.playbackRateActive||e.config.playbackRateActive==="hover")&&y.addEventListener("mouseenter",function(d){d.preventDefault(),d.stopPropagation(),(0,F.addClass)(e.root,"xgplayer-playbackrate-active"),s.focus()}),e.once("ready",function(){e.controls.appendChild(s)})}var p=["touchend","click"];p.forEach(function(d){s.addEventListener(d,function(E){E.stopPropagation(),E.preventDefault();var w=E.target;if(w&&w.tagName.toLocaleLowerCase()==="li"){var D=void 0,b=void 0;u.forEach(function(S){S.selected=!1,w.textContent.replace(/\s+/g,"")===S.rate&&(Array.prototype.forEach.call(w.parentNode.childNodes,function(C){(0,F.hasClass)(C,"selected")&&(D=Number(C.getAttribute("cname")),(0,F.removeClass)(C,"selected"))}),S.selected=!0,e.video.playbackRate=S.name*1,t=S.name*1)}),(0,F.addClass)(w,"selected"),b=Number(w.getAttribute("cname")),w.parentNode.nextSibling.innerHTML=""+w.getAttribute("cname")+a,e.emit("playbackrateChange",{from:D,to:b}),m.default.device==="mobile"&&(0,F.removeClass)(e.root,"xgplayer-playbackrate-active")}else e.config.playbackRateActive==="click"&&w&&(w.tagName.toLocaleLowerCase()==="p"||w.tagName.toLocaleLowerCase()==="span")&&(m.default.device==="mobile"?(0,F.toggleClass)(e.root,"xgplayer-playbackrate-active"):(0,F.addClass)(e.root,"xgplayer-playbackrate-active"),s.focus());e.emit("focus")},!1)}),s.addEventListener("mouseleave",function(d){d.preventDefault(),d.stopPropagation(),(0,F.removeClass)(e.root,"xgplayer-playbackrate-active")});function g(){(0,F.removeClass)(e.root,"xgplayer-playbackrate-active")}e.on("blur",g),e.on("play",function(){e.video.playbackRate.toFixed(1)!==t.toFixed(1)&&(e.video.playbackRate=t)}),e.switchPlaybackRate=function(){for(var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=e.controls.querySelectorAll(".xgplayer-playbackrate ul li"),w=0;w<E.length;w++)!(0,F.hasClass)(E[w],"selected")&&(E[w].getAttribute("cname")===""+d.playbackRate||w===d.index)&&E[w].click()},e.on("ratechange",function(){e.switchPlaybackRate({playbackRate:e.playbackRate})})};I.default={name:"s_playbackRate",method:c},X.exports=I.default},function(X,I,K){var F=K(127);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-playbackrate{-webkit-order:8;-moz-box-ordinal-group:9;order:8;width:60px;height:150px;z-index:18;position:relative;display:inline-block;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-playbackrate ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);text-align:left;white-space:nowrap;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-playbackrate ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);position:relative;padding:4px 0;text-align:center}.xgplayer-skin-default .xgplayer-playbackrate ul li.selected,.xgplayer-skin-default .xgplayer-playbackrate ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-playbackrate ul li:first-child{position:relative;margin-top:12px}.xgplayer-skin-default .xgplayer-playbackrate ul li:last-child{position:relative;margin-bottom:12px}.xgplayer-skin-default .xgplayer-playbackrate .name{width:60px;height:20px;position:absolute;bottom:0;text-align:center;font-family:PingFangSC-Regular;font-size:13px;background:rgba(0,0,0,.38);color:hsla(0,0%,100%,.8);border-radius:10px;line-height:20px}.xgplayer-skin-default .xgplayer-playbackrate span{position:relative;top:19px;font-weight:700;text-shadow:0 0 4px rgba(0,0,0,.6)}.xgplayer-skin-default .xgplayer-playbackrate:hover{opacity:1}.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-playbackrate ul{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=function(){var r=this;if(r.config.preview&&r.config.preview.uploadEl){var c=(0,F.createDom)("xg-preview",'<input type="file">',{},"xgplayer-preview"),l=c.querySelector("input");r.config.preview.uploadEl.appendChild(c),l.onchange=function(){r.emit("upload",l)}}};I.default={name:"s_localPreview",method:G},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(130),m=r(G);K(131);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this;if(!!e.config.download){var n=(0,F.createDom)("xg-download",'<xg-icon class="xgplayer-icon">'+m.default+"</xg-icon>",{},"xgplayer-download"),a=e.lang.DOWNLOAD_TIPS,s=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-download">'+a+"</span>",{},"xgplayer-tips");n.appendChild(s),e.once("ready",function(){e.controls.appendChild(n)}),["click","touchend"].forEach(function(u){n.addEventListener(u,function(t){t.preventDefault(),t.stopPropagation(),e.userGestureTrigEvent("downloadBtnClick")})})}};I.default={name:"s_download",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`},function(X,I,K){var F=K(132);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-download{position:relative;-webkit-order:9;-moz-box-ordinal-group:10;order:9;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-download .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-download .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-download .xgplayer-icon svg{position:relative;top:5px;left:5px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips{margin-left:-20px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips .xgplayer-tip-download{display:block}.xgplayer-skin-default .xgplayer-download:hover{opacity:.85}.xgplayer-skin-default .xgplayer-download:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-download .xgplayer-tips{margin-left:-32px}.xgplayer-lang-is-jp .xgplayer-download .xgplayer-tips{margin-left:-40px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(134),m=l(G),r=K(136),c=l(r);K(137);function l(n){return n&&n.__esModule?n:{default:n}}var e=function(){var a=this,s=a.root;if(!!a.config.danmu){var u=(0,F.createDom)("xg-danmu","",{},"xgplayer-danmu");a.once("ready",function(){s.appendChild(u)});var t=(0,F.deepCopy)({container:u,player:a.video,comments:[],area:{start:0,end:1}},a.config.danmu),f=void 0;a.config.danmu.panel&&(f=(0,F.createDom)("xg-panel",`<xg-panel-icon class="xgplayer-panel-icon">
                                                `+c.default+`
                                              </xg-panel-icon>
                                              <xg-panel-slider class="xgplayer-panel-slider">
                                                <xg-hidemode class="xgplayer-hidemode">
                                                  <p class="xgplayer-hidemode-font">\u5C4F\u853D\u7C7B\u578B</p>
                                                  <ul class="xgplayer-hidemode-radio">
                                                    <li class="xgplayer-hidemode-scroll" id="false">\u6EDA\u52A8</li><li class="xgplayer-hidemode-top" id="false">\u9876\u90E8</li><li class="xgplayer-hidemode-bottom" id="false">\u5E95\u90E8</li><li class="xgplayer-hidemode-color" id="false">\u8272\u5F69</li>
                                                  </ul>
                                                </xg-hidemode>
                                                <xg-transparency class="xgplayer-transparency">
                                                  <span>\u4E0D\u900F\u660E\u5EA6</span>
                                                  <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>
                                                </xg-transparency>
                                                <xg-showarea class="xgplayer-showarea">
                                                  <div class="xgplayer-showarea-name">\u663E\u793A\u533A\u57DF</div>
                                                  <div class="xgplayer-showarea-control">
                                                    <div class="xgplayer-showarea-control-up">
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>
                                                    </div>
                                                    <div class="xgplayer-showarea-control-down">
                                                      <div class="xgplayer-showarea-control-down-dots">
                                                        <span class="xgplayer-showarea-onequarters-dot"></span>
                                                        <span class="xgplayer-showarea-twoquarters-dot"></span>
                                                        <span class="xgplayer-showarea-threequarters-dot"></span>
                                                        <span class="xgplayer-showarea-full-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">
                                                    </div>
                                                  </div>
                                                </xg-showarea>
                                                <xg-danmuspeed class="xgplayer-danmuspeed">
                                                  <div class="xgplayer-danmuspeed-name">\u5F39\u5E55\u901F\u5EA6</div>
                                                  <div class="xgplayer-danmuspeed-control">
                                                    <div class="xgplayer-danmuspeed-control-up">
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small">\u6162</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color">\u4E2D</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large">\u5FEB</span>
                                                    </div>
                                                    <div class="xgplayer-danmuspeed-control-down">
                                                      <div class="xgplayer-danmuspeed-control-down-dots">
                                                        <span class="xgplayer-danmuspeed-small-dot"></span>
                                                        <span class="xgplayer-danmuspeed-middle-dot"></span>
                                                        <span class="xgplayer-danmuspeed-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">
                                                    </div>
                                                  </div>
                                                </xg-danmuspeed>
                                                <xg-danmufont class="xgplayer-danmufont">
                                                  <div class="xgplayer-danmufont-name">\u5B57\u4F53\u5927\u5C0F</div>
                                                  <div class="xgplayer-danmufont-control">
                                                    <div class="xgplayer-danmufont-control-up">
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small">\u5C0F</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle">\u4E2D</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color">\u5927</span>
                                                    </div>
                                                    <div class="xgplayer-danmufont-control-down">
                                                      <div class="xgplayer-danmufont-control-down-dots">
                                                        <span class="xgplayer-danmufont-small-dot"></span>
                                                        <span class="xgplayer-danmufont-middle-dot"></span>
                                                        <span class="xgplayer-danmufont-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">
                                                    </div>
                                                  </div>
                                                </xg-danmufont>
                                              </xg-panel-slider>`,{tabindex:7},"xgplayer-panel"),a.once("ready",function(){a.controls.appendChild(f)})),a.once("complete",function(){var h=new m.default(t);if(a.emit("initDefaultDanmu",h),a.danmu=h,!!a.config.danmu.panel){var v=f.querySelector(".xgplayer-panel-slider"),y=void 0,p=["mouseenter","touchend","click"];p.forEach(function(k){f.addEventListener(k,function(M){M.preventDefault(),M.stopPropagation(),(0,F.addClass)(v,"xgplayer-panel-active"),f.focus(),y=!0})}),f.addEventListener("mouseleave",function(k){k.preventDefault(),k.stopPropagation(),(0,F.removeClass)(v,"xgplayer-panel-active"),y=!1}),v.addEventListener("mouseleave",function(k){k.preventDefault(),k.stopPropagation(),y===!1&&(0,F.removeClass)(v,"xgplayer-panel-active")});var g=a.config.danmu,d=f.querySelector(".xgplayer-hidemode-scroll"),E=f.querySelector(".xgplayer-hidemode-top"),w=f.querySelector(".xgplayer-hidemode-bottom"),D=f.querySelector(".xgplayer-hidemode-color"),b={scroll:d,top:E,bottom:w,color:D},S=function(M){var N=M,U=["touchend","click"];U.forEach(function(j){b[N].addEventListener(j,function(z){b[N].getAttribute("id")!=="true"?(b[N].style.color="#f85959",b[N].setAttribute("id","true"),a.danmu.hide(N)):(b[N].style.color="#aaa",b[N].setAttribute("id","false"),a.danmu.show(N))})})};for(var C in b)S(C);var P=f.querySelector(".xgplayer-transparency-line"),R=f.querySelector(".xgplayer-transparency-gradient"),L=50;R.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+L+"%, #aaa "+L+"%, #aaa)",P.addEventListener("input",function(k){k.preventDefault(),k.stopPropagation(),L=k.target.value,R.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+L+"%, #aaa "+L+"%, #aaa)",g.comments.forEach(function(M){M.style.opacity=L/100})});var O=f.querySelector(".xgplayer-showarea-line");O.addEventListener("input",function(k){k.preventDefault(),k.stopPropagation();var M=k.target.value;a.danmu.config.area.end=M/100,a.config.danmu.area.end=M/100,a.danmu.bulletBtn.main.channel.resize()});var _=f.querySelector(".xgplayer-danmuspeed-line");_.addEventListener("input",function(k){k.preventDefault(),k.stopPropagation();var M=k.target.value;g.comments.forEach(function(N){N.duration=(200-M)*100})});var x=f.querySelector(".xgplayer-danmufont-line");if(x.addEventListener("input",function(k){k.preventDefault(),k.stopPropagation();var M=k.target.value;g.comments.forEach(function(N){N.style.fontSize=M+"px"})}),navigator.userAgent.indexOf("Firefox")>-1)for(var A=0;A<v.querySelectorAll("input").length;A++)v.querySelectorAll("input")[A].style.marginTop="10px"}})}};I.default={name:"s_danmu",method:e},X.exports=I.default},function(X,I,K){(function(F){var G,m,r,c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l};(function(l,e){c(I)=="object"&&c(F)=="object"?F.exports=e():(m=[],G=e,r=typeof G=="function"?G.apply(I,m):G,r!==void 0&&(F.exports=r))})(window,function(){return function(l){var e={};function n(a){if(e[a])return e[a].exports;var s=e[a]={i:a,l:!1,exports:{}};return l[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=l,n.c=e,n.d=function(a,s,u){n.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:u})},n.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.t=function(a,s){if(1&s&&(a=n(a)),8&s||4&s&&(typeof a=="undefined"?"undefined":c(a))=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(n.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var t in a)n.d(u,t,function(f){return a[f]}.bind(null,t));return u},n.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return n.d(s,"a",s),s},n.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},n.p="",n(n.s=4)}([function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a={createDom:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",v=document.createElement(u);return v.className=h,v.innerHTML=t,Object.keys(f).forEach(function(y){var p=y,g=f[y];u==="video"||u==="audio"?g&&v.setAttribute(p,g):v.setAttribute(p,g)}),v},hasClass:function(u,t){return u.classList?Array.prototype.some.call(u.classList,function(f){return f===t}):!!u.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},addClass:function(u,t){u.classList?t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(f){f&&u.classList.add(f)}):a.hasClass(u,t)||(u.className+=" "+t)},removeClass:function(u,t){u.classList?t.split(/\s+/g).forEach(function(f){u.classList.remove(f)}):a.hasClass(u,t)&&t.split(/\s+/g).forEach(function(f){var h=new RegExp("(\\s|^)"+f+"(\\s|$)");u.className=u.className.replace(h," ")})},toggleClass:function(u,t){t.split(/\s+/g).forEach(function(f){a.hasClass(u,f)?a.removeClass(u,f):a.addClass(u,f)})},findDom:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,t=arguments[1],f=void 0;try{f=u.querySelector(t)}catch{t.startsWith("#")&&(f=u.getElementById(t.slice(1)))}return f},deepCopy:function(u,t){if(a.typeOf(t)==="Object"&&a.typeOf(u)==="Object")return Object.keys(t).forEach(function(f){a.typeOf(t[f])!=="Object"||t[f]instanceof Node?a.typeOf(t[f])==="Array"?u[f]=a.typeOf(u[f])==="Array"?u[f].concat(t[f]):t[f]:u[f]=t[f]:u[f]?a.deepCopy(u[f],t[f]):u[f]=t[f]}),u},typeOf:function(u){return Object.prototype.toString.call(u).match(/([^\s.*]+)(?=]$)/g)[0]},copyDom:function(u){if(u&&u.nodeType===1){var t=document.createElement(u.tagName);return Array.prototype.forEach.call(u.attributes,function(f){t.setAttribute(f.name,f.value)}),u.innerHTML&&(t.innerHTML=u.innerHTML),t}return""},formatTime:function(u){var t=Math.floor(u);return 1e3*t+(u-t)},offInDestroy:function(u,t,f,h){u.once(h,function v(){u.off(t,f),u.off(h,v)})},on:function(u,t,f,h){h?(u.on(t,f),a.offInDestroy(u,t,f,h)):u.on(t,function v(y){f(y),u.off(t,v)})},style:function(u,t,f){var h=u.style;try{h[t]=f}catch{h.setProperty(t,f)}}};e.default=a,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a,s=function(){function h(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}return function(v,y,p){return y&&h(v.prototype,y),p&&h(v,p),v}}(),u=n(26),t=(a=u)&&a.__esModule?a:{default:a},f=function(){function h(){(function(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")})(this,h)}return s(h,[{key:"setLogger",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.logger=new t.default(y+".js")}}]),h}();e.default=f,l.exports=e.default},function(l,e,n){var a=n(19)();l.exports=function(s){return s!==a&&s!==null}},function(l,e,n){l.exports=function(a){return a!=null}},function(l,e,n){l.exports=n(5)},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a,s=n(6),u=(a=s)&&a.__esModule?a:{default:a};n(34),e.default=u.default,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function E(w,D){for(var b=0;b<D.length;b++){var S=D[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,D,b){return D&&E(w.prototype,D),b&&E(w,b),w}}(),s=p(n(7)),u=p(n(1)),t=p(n(27)),f=p(n(31)),h=p(n(0)),v=n(32),y=n(33);function p(E){return E&&E.__esModule?E:{default:E}}function g(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!w||(typeof w=="undefined"?"undefined":c(w))!="object"&&typeof w!="function"?E:w}var d=function(E){function w(D){(function(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")})(this,w);var b=g(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));b.setLogger("danmu"),b.logger&&b.logger.info("danmu.js version: "+v.version);var S=b;if(S.config=h.default.deepCopy({overlap:!1,area:{start:0,end:1},live:!1,comments:[],direction:"r2l",needResizeObserver:!1},D),S.hideArr=[],S.domObj=new f.default,(0,s.default)(S),S.config.comments.forEach(function(P){P.duration=P.duration?P.duration:5e3,P.mode||(P.mode="scroll")}),!S.config.container||S.config.container.nodeType!==1)return S.emit("error","container id can't be empty"),g(b,!1);if(S.container=S.config.container,S.config.containerStyle){var C=S.config.containerStyle;Object.keys(C).forEach(function(P){S.container.style[P]=C[P]})}return S.live=S.config.live,S.player=S.config.player,S.direction=S.config.direction,h.default.addClass(S.container,"danmu"),S.bulletBtn=new t.default(S),S.isReady=!0,S.emit("ready"),b.logger&&b.logger.info("ready"),b.addResizeObserver(),b}return function(D,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof b=="undefined"?"undefined":c(b)));D.prototype=Object.create(b&&b.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(D,b):D.__proto__=b)}(w,E),a(w,[{key:"addResizeObserver",value:function(){var b=this;this.config.needResizeObserver&&(0,y.addObserver)(this.container,function(){b.logger&&b.logger.info("needResizeObserver"),b.resize()})}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.bulletBtn.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.bulletBtn.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.bulletBtn.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.bulletBtn.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.bulletBtn.main.clear()}},{key:"destroy",value:function(){for(var b in(0,y.unObserver)(this.container),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn.destroy(),this.domObj.destroy(),this)delete this[b];this.emit("destroy")}},{key:"sendComment",value:function(b){this.logger&&this.logger.info("sendComment: "+(b.txt||"[DOM Element]")),b.duration||(b.duration=15e3),b&&b.id&&b.duration&&(b.el||b.txt)&&(b.duration=b.duration?b.duration:5e3,b.style||(b.style={opacity:void 0,fontSize:void 0}),b.style&&(this.opacity&&this.opacity!==b.style.opacity&&(b.style.opacity=this.opacity),this.fontSize&&this.fontSize!==b.style.fontSize&&(b.style.fontSize=this.fontSize),this.like&&(b.like=b.like?b.like:this.like)),b.prior||b.realTime?(this.bulletBtn.main.data.unshift(b),b.realTime&&(this.bulletBtn.main.readData(),this.bulletBtn.main.dataHandle())):this.bulletBtn.main.data.push(b))}},{key:"setCommentID",value:function(b,S){var C=this;this.logger&&this.logger.info("setCommentID: oldID "+b+" newID "+S);var P=this.container.getBoundingClientRect();b&&S&&(this.bulletBtn.main.data.some(function(R){return R.id===b&&(R.id=S,!0)}),this.bulletBtn.main.queue.some(function(R){return R.id===b&&(R.id=S,R.pauseMove(P),C.bulletBtn.main.status!=="paused"&&R.startMove(P),!0)}))}},{key:"setCommentDuration",value:function(b,S){var C=this;this.logger&&this.logger.info("setCommentDuration: id "+b+" duration "+S);var P=this.container.getBoundingClientRect();b&&S&&(S=S||5e3,this.bulletBtn.main.data.some(function(R){return R.id===b&&(R.duration=S,!0)}),this.bulletBtn.main.queue.some(function(R){return R.id===b&&(R.duration=S,R.pauseMove(P),C.bulletBtn.main.status!=="paused"&&R.startMove(P),!0)}))}},{key:"setCommentLike",value:function(b,S){this.logger&&this.logger.info("setCommentLike: id "+b+" like "+S);var C=this.container.getBoundingClientRect();this.like=S,b&&S&&(this.bulletBtn.main.data.some(function(P){return P.id===b&&(P.like=S,!0)}),this.bulletBtn.main.queue.some(function(P){return P.id===b&&(P.pauseMove(C),P.setLikeDom(S.el,S.style),P.danmu.bulletBtn.main.status!=="paused"&&P.startMove(C),!0)}))}},{key:"restartComment",value:function(b){this.logger&&this.logger.info("restartComment: id "+b),this.mouseControl=!1;var S=this.container.getBoundingClientRect();b&&this.bulletBtn.main.queue.some(function(C){return C.id===b&&(C.danmu.bulletBtn.main.status!=="paused"?C.startMove(S,!0):C.status="paused",!0)})}},{key:"freezeComment",value:function(b){this.logger&&this.logger.info("freezeComment: id "+b),this.mouseControl=!0;var S=this.container.getBoundingClientRect();b&&this.bulletBtn.main.queue.some(function(C){return C.id===b&&(C.status="forcedPause",C.pauseMove(S),C.el&&C.el.style&&h.default.style(C.el,"zIndex",10),!0)})}},{key:"removeComment",value:function(b){this.logger&&this.logger.info("removeComment: id "+b),b&&(this.bulletBtn.main.queue.some(function(S){return S.id===b&&(S.remove(),!0)}),this.bulletBtn.main.data=this.bulletBtn.main.data.filter(function(S){return S.id!==b}))}},{key:"updateComments",value:function(b){var S=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];S&&(this.bulletBtn.main.data=[]),this.bulletBtn.main.data=this.bulletBtn.main.data.concat(b)}},{key:"setAllDuration",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",S=arguments[1],C=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];this.logger&&this.logger.info("setAllDuration: mode "+b+" duration "+S+" force "+C);var P=this.container.getBoundingClientRect();S&&(S=S||5e3,C&&(this.bulletBtn.main.forceDuration=S),this.bulletBtn.main.data.forEach(function(R){b===R.mode&&(R.duration=S)}),this.bulletBtn.main.queue.forEach(function(R){b===R.mode&&(R.duration=S,R.pauseMove(P),R.danmu.bulletBtn.main.status!=="paused"&&R.startMove(P))}))}},{key:"setOpacity",value:function(b){this.logger&&this.logger.info("setOpacity: opacity "+b),this.container.style.opacity=b}},{key:"setFontSize",value:function(b,S){var C=this;this.logger&&this.logger.info("setFontSize: size "+b+" channelSize "+S),this.fontSize=b+"px",b&&(this.bulletBtn.main.data.forEach(function(P){P.style&&(P.style.fontSize=C.fontSize)}),this.bulletBtn.main.queue.forEach(function(P){P.options.style||(P.options.style={}),P.options.style.fontSize=C.fontSize,P.setFontSize(C.fontSize),S&&(P.top=P.channel_id[0]*S,P.topInit())})),S&&(this.config.channelSize=S,this.bulletBtn.main.channel.resize(!0))}},{key:"setArea",value:function(b){this.logger&&this.logger.info("setArea: area "+b),this.config.area=b,this.bulletBtn.main.channel.resize(!0)}},{key:"hide",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode "+b),this.hideArr.indexOf(b)<0&&this.hideArr.push(b);var S=this.bulletBtn.main.queue.filter(function(C){return b===C.mode||b==="color"&&C.color});S.forEach(function(C){return C.remove()})}},{key:"show",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode "+b);var S=this.hideArr.indexOf(b);S>-1&&this.hideArr.splice(S,1)}},{key:"setDirection",value:function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction "+b),this.emit("changeDirection",b)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}}]),w}(u.default);e.default=d,l.exports=e.default},function(l,e,n){var a,s,u,t,f,h,v,y=n(8),p=n(25),g=Function.prototype.apply,d=Function.prototype.call,E=Object.create,w=Object.defineProperty,D=Object.defineProperties,b=Object.prototype.hasOwnProperty,S={configurable:!0,enumerable:!1,writable:!0};s=function(P,R){var L,O;return p(R),O=this,a.call(this,P,L=function(){u.call(O,P,L),g.call(R,this,arguments)}),L.__eeOnceListener__=R,this},f={on:a=function(P,R){var L;return p(R),b.call(this,"__ee__")?L=this.__ee__:(L=S.value=E(null),w(this,"__ee__",S),S.value=null),L[P]?c(L[P])=="object"?L[P].push(R):L[P]=[L[P],R]:L[P]=R,this},once:s,off:u=function(P,R){var L,O,_,x;if(p(R),!b.call(this,"__ee__"))return this;if(!(L=this.__ee__)[P])return this;if(c(O=L[P])=="object")for(x=0;_=O[x];++x)_!==R&&_.__eeOnceListener__!==R||(O.length===2?L[P]=O[x?0:1]:O.splice(x,1));else O!==R&&O.__eeOnceListener__!==R||delete L[P];return this},emit:t=function(P){var R,L,O,_,x;if(b.call(this,"__ee__")&&(_=this.__ee__[P]))if((typeof _=="undefined"?"undefined":c(_))=="object"){for(L=arguments.length,x=new Array(L-1),R=1;R<L;++R)x[R-1]=arguments[R];for(_=_.slice(),R=0;O=_[R];++R)g.call(O,this,x)}else switch(arguments.length){case 1:d.call(_,this);break;case 2:d.call(_,this,arguments[1]);break;case 3:d.call(_,this,arguments[1],arguments[2]);break;default:for(L=arguments.length,x=new Array(L-1),R=1;R<L;++R)x[R-1]=arguments[R];g.call(_,this,x)}}},h={on:y(a),once:y(s),off:y(u),emit:y(t)},v=D({},h),l.exports=e=function(P){return P==null?E(v):D(Object(P),h)},e.methods=f},function(l,e,n){var a=n(3),s=n(9),u=n(13),t=n(21),f=n(22);(l.exports=function(h,v){var y,p,g,d,E;return arguments.length<2||typeof h!="string"?(d=v,v=h,h=null):d=arguments[2],a(h)?(y=f.call(h,"c"),p=f.call(h,"e"),g=f.call(h,"w")):(y=g=!0,p=!1),E={value:v,configurable:y,enumerable:p,writable:g},d?u(t(d),E):E}).gs=function(h,v,y){var p,g,d,E;return typeof h!="string"?(d=y,y=v,v=h,h=null):d=arguments[3],a(v)?s(v)?a(y)?s(y)||(d=y,y=void 0):y=void 0:(d=v,v=y=void 0):v=void 0,a(h)?(p=f.call(h,"c"),g=f.call(h,"e")):(p=!0,g=!1),E={get:v,set:y,configurable:p,enumerable:g},d?u(t(d),E):E}},function(l,e,n){var a=n(10),s=/^\s*class[\s{/}]/,u=Function.prototype.toString;l.exports=function(t){return!!a(t)&&!s.test(u.call(t))}},function(l,e,n){var a=n(11);l.exports=function(s){if(typeof s!="function"||!hasOwnProperty.call(s,"length"))return!1;try{if(typeof s.length!="number"||typeof s.call!="function"||typeof s.apply!="function")return!1}catch{return!1}return!a(s)}},function(l,e,n){var a=n(12);l.exports=function(s){if(!a(s))return!1;try{return!!s.constructor&&s.constructor.prototype===s}catch{return!1}}},function(l,e,n){var a=n(3),s={object:!0,function:!0,undefined:!0};l.exports=function(u){return!!a(u)&&hasOwnProperty.call(s,typeof u=="undefined"?"undefined":c(u))}},function(l,e,n){l.exports=n(14)()?Object.assign:n(15)},function(l,e,n){l.exports=function(){var a,s=Object.assign;return typeof s=="function"&&(s(a={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),a.foo+a.bar+a.trzy==="razdwatrzy")}},function(l,e,n){var a=n(16),s=n(20),u=Math.max;l.exports=function(t,f){var h,v,y,p=u(arguments.length,2);for(t=Object(s(t)),y=function(d){try{t[d]=f[d]}catch(E){h||(h=E)}},v=1;v<p;++v)a(f=arguments[v]).forEach(y);if(h!==void 0)throw h;return t}},function(l,e,n){l.exports=n(17)()?Object.keys:n(18)},function(l,e,n){l.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},function(l,e,n){var a=n(2),s=Object.keys;l.exports=function(u){return s(a(u)?Object(u):u)}},function(l,e,n){l.exports=function(){}},function(l,e,n){var a=n(2);l.exports=function(s){if(!a(s))throw new TypeError("Cannot use null or undefined");return s}},function(l,e,n){var a=n(2),s=Array.prototype.forEach,u=Object.create,t=function(h,v){var y;for(y in h)v[y]=h[y]};l.exports=function(f){var h=u(null);return s.call(arguments,function(v){a(v)&&t(Object(v),h)}),h}},function(l,e,n){l.exports=n(23)()?String.prototype.contains:n(24)},function(l,e,n){var a="razdwatrzy";l.exports=function(){return typeof a.contains=="function"&&a.contains("dwa")===!0&&a.contains("foo")===!1}},function(l,e,n){var a=String.prototype.indexOf;l.exports=function(s){return a.call(this,s,arguments[1])>-1}},function(l,e,n){l.exports=function(a){if(typeof a!="function")throw new TypeError(a+" is not a function");return a}},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(f,h){for(var v=0;v<h.length;v++){var y=h[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(f,y.key,y)}}return function(f,h,v){return h&&t(f.prototype,h),v&&t(f,v),f}}(),s=typeof window!="undefined"&&window.location.href.indexOf("danmu-debug")>-1,u=function(){function t(f){(function(h,v){if(!(h instanceof v))throw new TypeError("Cannot call a class as a function")})(this,t),this.constructorName=f||""}return a(t,[{key:"info",value:function(h){for(var v,y=arguments.length,p=Array(y>1?y-1:0),g=1;g<y;g++)p[g-1]=arguments[g];s&&(v=console).log.apply(v,["[Danmu Log]["+this.constructorName+"]",h].concat(p))}}]),t}();e.default=u,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function v(y,p){for(var g=0;g<p.length;g++){var d=p[g];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}return function(y,p,g){return p&&v(y.prototype,p),g&&v(y,g),y}}(),s=f(n(1)),u=f(n(0)),t=f(n(28));function f(v){return v&&v.__esModule?v:{default:v}}var h=function(v){function y(p){(function(d,E){if(!(d instanceof E))throw new TypeError("Cannot call a class as a function")})(this,y);var g=function(d,E){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!E||(typeof E=="undefined"?"undefined":c(E))!="object"&&typeof E!="function"?d:E}(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return g.setLogger("control"),g.danmu=p,g.main=new t.default(p),p.config.defaultOff||g.main.start(),g}return function(p,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof g=="undefined"?"undefined":c(g)));p.prototype=Object.create(g&&g.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(p,g):p.__proto__=g)}(y,v),a(y,[{key:"createSwitch",value:function(){var g=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=u.default.createDom("dk-switch",'<span class="txt">\u5F39</span>',{},"danmu-switch "+(g?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var g in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)delete this[g]}}]),y}(s.default);e.default=h,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function y(p,g){for(var d=0;d<g.length;d++){var E=g[d];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(p,E.key,E)}}return function(p,g,d){return g&&y(p.prototype,g),d&&y(p,d),p}}(),s=h(n(1)),u=h(n(29)),t=h(n(30)),f=h(n(0));function h(y){return y&&y.__esModule?y:{default:y}}var v=function(y){function p(g){(function(w,D){if(!(w instanceof D))throw new TypeError("Cannot call a class as a function")})(this,p);var d=function(w,D){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!D||(typeof D=="undefined"?"undefined":c(D))!="object"&&typeof D!="function"?w:D}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));d.setLogger("main"),d.danmu=g,d.container=g.container,d.channel=new u.default(g),d.data=[].concat(g.config.comments),d.playedData=[],d.queue=[],d.timer=null,d.retryTimer=null,d.retryStatus="normal",d.interval=g.config.interval||2e3,d.status="idle",f.default.on(g,"bullet_remove",d.updateQueue.bind(d),"destroy");var E=d;return f.default.on(d.danmu,"changeDirection",function(w){E.danmu.direction=w},"destroy"),d.nums=0,d}return function(g,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof d=="undefined"?"undefined":c(d)));g.prototype=Object.create(d&&d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(g,d):g.__proto__=d)}(p,y),a(p,[{key:"destroy",value:function(){for(var d in this.logger&&this.logger.info("destroy"),clearTimeout(this.dataHandleTimer),this.channel.destroy(),this.data=[],this)delete this[d]}},{key:"updateQueue",value:function(d){this.logger&&this.logger.info("updateQueue");var E=this;E.queue.some(function(w,D){return w.id===d.bullet.id&&(E.queue.splice(D,1),!0)}),E.data.some(function(w,D){return w.id===d.bullet.id&&(w.hasAttached=!1,!0)})}},{key:"init",value:function(d,E){E.logger&&E.logger.info("init"),E||(E=this),E.retryStatus="normal",E.data.sort(function(w,D){return w.start-D.start}),E.retryTimer||function w(){E.status==="closed"&&E.retryStatus==="stop"||(E.status==="playing"&&(E.readData(),E.dataHandle()),E.retryStatus==="stop"&&E.status!=="paused"||(E.dataHandleTimer=setTimeout(function(){w()},E.interval-1e3)))}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.status="playing",this.queue=[],this.container.innerHTML="",this.channel.resetWithCb(this.init,this)}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.status="closed",this.retryTimer=null,this.retryStatus="stop",this.channel.reset(),this.queue=[],this.container.innerHTML=""}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel.reset(),this.data=[],this.queue=[],this.container.innerHTML=""}},{key:"play",value:function(){var d=this;this.logger&&this.logger.info("play"),this.status="playing";var E=this.channel.channels,w=this.danmu.container.getBoundingClientRect();E&&E.length>0&&["scroll","top","bottom"].forEach(function(D){d.queue.forEach(function(S){S.startMove(w),S.resized=!0});for(var b=0;b<E.length;b++)E[b].queue[D].forEach(function(S){S.resized=!1})})}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.status="paused";var d=this.channel.channels,E=this.danmu.container.getBoundingClientRect();d&&d.length>0&&this.queue.forEach(function(w){w.pauseMove(E)})}},{key:"dataHandle",value:function(){var d=this;this.status!=="paused"&&this.status!=="closed"&&d.queue.length&&d.queue.forEach(function(E){E.status==="waiting"&&E.startMove(d.channel.containerPos)})}},{key:"readData",value:function(){var d=this,E=this.danmu;if(E.isReady){var w=0;E.player&&E.player.currentTime&&(w=f.default.formatTime(E.player.currentTime));var D=void 0,b=d.interval,S=d.channel,C=void 0;E.player?(C=d.data.filter(function(P){return!P.start&&d.danmu.hideArr.indexOf(P.mode)<0&&(!P.color||d.danmu.hideArr.indexOf("color")<0)&&(P.start=w),d.danmu.hideArr.indexOf(P.mode)<0&&(!P.color||d.danmu.hideArr.indexOf("color")<0)&&P.start-b<=w&&w<=P.start+b}),E.live&&(d.data=[])):(C=d.data.splice(0,1)).length===0&&(C=d.playedData.splice(0,1)),C.length>0&&C.forEach(function(P){if(d.forceDuration&&d.forceDuration!=P.duration&&(P.duration=d.forceDuration),D=new t.default(E,P),P.hasAttached){for(var R in D.detach(),D)delete D[R];D=null,P.hasAttached=!1,P.noDiscard&&(P.prior?d.data.unshift(P):d.data.push(P))}else if(D.attach(),P.hasAttached=!0,S.addBullet(D).result)d.queue.push(D),d.nums++,D.topInit();else{for(var L in D.detach(),D)delete D[L];D=null,P.hasAttached=!1,P.noDiscard&&(P.prior?d.data.unshift(P):d.data.push(P))}})}}}]),p}(s.default);e.default=v,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function h(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}return function(v,y,p){return y&&h(v.prototype,y),p&&h(v,p),v}}(),s=t(n(1)),u=t(n(0));function t(h){return h&&h.__esModule?h:{default:h}}var f=function(h){function v(y){(function(d,E){if(!(d instanceof E))throw new TypeError("Cannot call a class as a function")})(this,v);var p=function(d,E){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!E||(typeof E=="undefined"?"undefined":c(E))!="object"&&typeof E!="function"?d:E}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));p.setLogger("channel"),p.danmu=y,p.reset(!0);var g=p;return u.default.on(p.danmu,"bullet_remove",function(d){g.removeBullet(d.bullet)},"destroy"),p.direction=y.direction,u.default.on(p.danmu,"changeDirection",function(d){g.direction=d},"destroy"),p.containerPos=p.danmu.container.getBoundingClientRect(),p.containerWidth=p.containerPos.width,p.containerHeight=p.containerPos.height,p.containerLeft=p.containerPos.left,p.containerRight=p.containerPos.right,u.default.on(p.danmu,"channel_resize",function(){g.containerPos=g.danmu.container.getBoundingClientRect(),g.resizing||(g.containerWidth=g.containerPos.width,g.containerHeight=g.containerPos.height,g.containerLeft=g.containerPos.left,g.containerRight=g.containerPos.right,g.resize(!0))},"destroy"),p}return function(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof p=="undefined"?"undefined":c(p)));y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}(v,h),a(v,[{key:"destroy",value:function(){for(var p in this.logger&&this.logger.info("destroy"),clearTimeout(this.resizeTimer),this.channels=[],this)delete this[p]}},{key:"resize",value:function(){var p=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("resize");var g=this.danmu.container,d=this;d.resizing||(d.resizing=!0,this.resizeTimer=setTimeout(function(){d.danmu.bulletBtn.main.data&&d.danmu.bulletBtn.main.data.forEach(function(k){k.bookChannelId&&(delete k.bookChannelId,d.logger&&d.logger.info("resize\u5BFC\u81F4"+k.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u53D6\u6D88"))}),d.logger&&d.logger.info("resize\u5BFC\u81F4\u6240\u6709\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528");var E=g.getBoundingClientRect();d.width=E.width,d.height=E.height,d.danmu.config.area&&d.danmu.config.area.start>=0&&d.danmu.config.area.end>=d.danmu.config.area.start&&(d.direction==="b2t"?d.width=d.width*(d.danmu.config.area.end-d.danmu.config.area.start):d.height=d.height*(d.danmu.config.area.end-d.danmu.config.area.start)),d.container=g;var w=d.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),D=void 0;D=d.direction==="b2t"?Math.floor(d.width/w):Math.floor(d.height/w);for(var b=[],S=0;S<D;S++)b[S]={id:S,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(d.channels&&d.channels.length<=b.length){for(var C=function(M){b[M]={id:M,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach(function(N){d.channels[M].queue[N].forEach(function(U){U.el&&(b[M].queue[N].push(U),U.resized||(U.pauseMove(d.containerPos,p),U.danmu.bulletBtn.main.status!=="paused"&&U.startMove(d.containerPos),U.resized=!0))})}),d.channels[M].queue.bottom.forEach(function(N){if(N.el){if(b[M+b.length-d.channels.length].queue.bottom.push(N),N.channel_id[0]+N.channel_id[1]-1===M){var U=[].concat(N.channel_id);N.channel_id=[U[0]-d.channels.length+b.length,U[1]],N.top=N.channel_id[0]*w,d.danmu.config.area&&d.danmu.config.area.start&&(N.top+=d.containerHeight*d.danmu.config.area.start),N.topInit()}N.resized||(N.pauseMove(d.containerPos,p),N.danmu.bulletBtn.main.status!=="paused"&&N.startMove(d.containerPos),N.resized=!0)}})},P=0;P<d.channels.length;P++)C(P);for(var R=function(M){["scroll","top","bottom"].forEach(function(N){b[M].queue[N].forEach(function(U){U.resized=!1})})},L=0;L<b.length;L++)R(L);d.channels=b,d.direction==="b2t"?d.channelWidth=w:d.channelHeight=w}else if(d.channels&&d.channels.length>b.length){for(var O=function(M){b[M]={id:M,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach(function(N){if(!(N==="top"&&M>Math.floor(b.length/2))){if(!(N==="bottom"&&M<=Math.floor(b.length/2))){var U=N==="bottom"?M-b.length+d.channels.length:M;d.channels[U].queue[N].forEach(function(j,z){if(j.el){if(b[M].queue[N].push(j),N==="bottom"&&j.channel_id[0]+j.channel_id[1]-1===U){var J=[].concat(j.channel_id);j.channel_id=[J[0]-d.channels.length+b.length,J[1]],j.top=j.channel_id[0]*w,d.danmu.config.area&&d.danmu.config.area.start&&(j.top+=d.containerHeight*d.danmu.config.area.start),j.topInit()}j.pauseMove(d.containerPos,p),j.danmu.bulletBtn.main.status!=="paused"&&j.startMove(d.containerPos),j.resized||(j.resized=!0)}d.channels[U].queue[N].splice(z,1)})}}})},_=0;_<b.length;_++)O(_);for(var x=function(M){["scroll","top","bottom"].forEach(function(N){b[M].queue[N].forEach(function(U){U.resized=!1})})},A=0;A<b.length;A++)x(A);d.channels=b,d.direction==="b2t"?d.channelWidth=w:d.channelHeight=w}d.resizing=!1},10))}},{key:"addBullet",value:function(p){var g=this,d=this.danmu,E=this.channels,w=void 0,D=void 0,b=void 0;if(g.direction==="b2t"?(D=this.channelWidth,b=Math.ceil(p.width/D)):(w=this.channelHeight,b=Math.ceil(p.height/w)),b>E.length)return{result:!1,message:"exceed channels.length, occupy="+b+",channelsSize="+E.length};for(var S=!0,C=void 0,P=-1,R=0,L=E.length;R<L;R++)if(E[R].queue[p.mode].some(function(_e){return _e.id===p.id}))return{result:!1,message:"exsited, channelOrder="+R+",danmu_id="+p.id};if(p.mode==="scroll")for(var O=0,_=E.length-b;O<=_;O++){S=!0;for(var x=O;x<O+b;x++){if((C=E[x]).operating.scroll){S=!1;break}if(C.bookId.scroll&&C.bookId.scroll!==p.id){S=!1;break}C.operating.scroll=!0;var A=C.queue.scroll[0];if(A){var k=A.el.getBoundingClientRect();if(g.direction==="b2t"){if(k.bottom>g.containerPos.bottom){S=!1,C.operating.scroll=!1;break}}else if(k.right>g.containerPos.right){S=!1,C.operating.scroll=!1;break}var M,N=void 0,U=void 0,j=void 0,z=void 0;if(g.direction==="b2t"?(U=(k.top-g.containerPos.top+k.height)/(N=(g.containerPos.height+k.height)/A.duration),j=g.containerPos.height,z=(g.containerPos.height+p.height)/p.duration):(U=(k.left-g.containerPos.left+k.width)/(N=(g.containerPos.width+k.width)/A.duration),j=g.containerPos.width,z=(g.containerPos.width+p.width)/p.duration),M=j/z,d.config.bOffset||(d.config.bOffset=0),N<z&&U+d.config.bOffset>M){S=!1,C.operating.scroll=!1;break}}C.operating.scroll=!1}if(S){P=O;break}}else if(p.mode==="top")for(var J=0,te=E.length-b;J<=te;J++){S=!0;for(var re=J;re<J+b;re++){if(re>Math.floor(E.length/2)){S=!1;break}if((C=E[re]).operating[p.mode]){S=!1;break}if((C.bookId[p.mode]||p.prior)&&C.bookId[p.mode]!==p.id){S=!1;break}if(C.operating[p.mode]=!0,C.queue[p.mode].length>0){S=!1,C.operating[p.mode]=!1;break}C.operating[p.mode]=!1}if(S){P=J;break}}else if(p.mode==="bottom")for(var oe=E.length-b;oe>=0;oe--){S=!0;for(var se=oe;se<oe+b;se++){if(se<=Math.floor(E.length/2)){S=!1;break}if((C=E[se]).operating[p.mode]){S=!1;break}if((C.bookId[p.mode]||p.prior)&&C.bookId[p.mode]!==p.id){S=!1;break}if(C.operating[p.mode]=!0,C.queue[p.mode].length>0){S=!1,C.operating[p.mode]=!1;break}C.operating[p.mode]=!1}if(S){P=oe;break}}if(P!==-1){for(var me=P,fe=P+b;me<fe;me++)(C=E[me]).operating[p.mode]=!0,C.queue[p.mode].unshift(p),p.prior&&(delete C.bookId[p.mode],g.logger&&g.logger.info(me+"\u53F7\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528")),C.operating[p.mode]=!1;return p.prior&&(g.logger&&g.logger.info(p.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u8FD0\u884C\u5B8C\u6BD5"),delete p.bookChannelId,d.player&&d.bulletBtn.main.data.some(function(_e){return _e.id===p.id&&(delete _e.bookChannelId,!0)})),p.channel_id=[P,b],g.direction==="b2t"?(p.top=P*D,g.danmu.config.area&&g.danmu.config.area.start&&(p.top+=g.containerWidth*g.danmu.config.area.start)):(p.top=P*w,g.danmu.config.area&&g.danmu.config.area.start&&(p.top+=g.containerHeight*g.danmu.config.area.start)),{result:p,message:"success"}}if(p.options.realTime){var ue=0,ye=-1,pe=null;if(g.danmu.bulletBtn.main.queue.forEach(function(_e,Pe){!_e.prior&&!_e.options.realTime&&_e.el&&_e.el.getBoundingClientRect().left>g.containerPos.right&&_e.start>=ue&&(ue=_e.start,ye=Pe,pe=_e)}),pe){pe.remove(),g.removeBullet(pe),g.danmu.bulletBtn.main.queue.splice(ye,1),p.channel_id=pe.channel_id;for(var de=pe.channel_id[0],ve=pe.channel_id[0]+pe.channel_id[1];de<ve;de++)(C=E[de]).operating[p.mode]=!0,C.queue[p.mode].unshift(p),p.prior&&delete C.bookId[p.mode],C.operating[p.mode]=!1;return p.top=pe.top,g.danmu.config.area&&g.danmu.config.area.start&&(p.top+=g.containerHeight*g.danmu.config.area.start),{result:p,message:"success"}}}if(p.prior)if(p.bookChannelId||g.danmu.live)d.player&&d.bulletBtn.main.data.some(function(_e){return _e.id===p.id&&(g.logger&&g.logger.info(p.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),_e.start+=2e3,!0)});else{P=-1;for(var ne=0,we=E.length-b;ne<=we;ne++){S=!0;for(var Ce=ne;Ce<ne+b;Ce++)if(E[Ce].bookId[p.mode]){S=!1;break}if(S){P=ne;break}}if(P!==-1){for(var ge=P;ge<P+b;ge++)E[ge].bookId[p.mode]=p.id,g.logger&&g.logger.info(ge+"\u53F7\u8F68\u9053\u88AB"+p.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A");d.player&&d.bulletBtn.main.data.some(function(_e){return _e.id===p.id&&(g.logger&&g.logger.info(p.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),_e.start+=2e3,_e.bookChannelId=[P,b],g.logger&&g.logger.info(p.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u4E86"+P+"~"+(P+b-1)+"\u53F7\u8F68\u9053"),!0)})}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(p){this.logger&&this.logger.info("removeBullet "+(p.options.txt||"[DOM Element]"));for(var g=this.channels,d=p.channel_id,E=void 0,w=d[0],D=d[0]+d[1];w<D;w++)if(E=g[w]){E.operating[p.mode]=!0;var b=-1;E.queue[p.mode].some(function(S,C){return S.id===p.id&&(b=C,!0)}),b>-1&&E.queue[p.mode].splice(b,1),E.operating[p.mode]=!1}p.options.loop&&this.danmu.bulletBtn.main.playedData.push(p.options)}},{key:"resetArea",value:function(){this.logger&&this.logger.info("resetArea");var p=this.danmu.container,g=this,d=p.getBoundingClientRect();g.width=d.width,g.height=d.height,g.danmu.config.area&&g.danmu.config.area.start>=0&&g.danmu.config.area.end>=g.danmu.config.area.start&&(g.direction==="b2t"?g.width=g.width*(g.danmu.config.area.end-g.danmu.config.area.start):g.height=g.height*(g.danmu.config.area.end-g.danmu.config.area.start)),g.container=p;var E=g.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),w=void 0;w=g.direction==="b2t"?Math.floor(g.width/E):Math.floor(g.height/E);for(var D=[],b=0;b<w;b++)D[b]={id:b,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(g.channels&&g.channels.length<=D.length){for(var S=function(k){D[k]={id:k,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach(function(M){g.channels[k].queue[M].forEach(function(N){N.el&&(D[k].queue[M].push(N),N.resized||(N.pauseMove(g.containerPos,!1),N.startMove(g.containerPos),N.resized=!0))})}),g.channels[k].queue.bottom.forEach(function(M){if(M.el){if(D[k+D.length-g.channels.length].queue.bottom.push(M),M.channel_id[0]+M.channel_id[1]-1===k){var N=[].concat(M.channel_id);M.channel_id=[N[0]-g.channels.length+D.length,N[1]],M.top=M.channel_id[0]*E,g.danmu.config.area&&g.danmu.config.area.start&&(M.top+=g.containerHeight*g.danmu.config.area.start),M.topInit()}M.resized||(M.pauseMove(g.containerPos,!1),M.startMove(g.containerPos),M.resized=!0)}})},C=0;C<g.channels.length;C++)S(C);for(var P=function(k){["scroll","top","bottom"].forEach(function(M){D[k].queue[M].forEach(function(N){N.resized=!1})})},R=0;R<D.length;R++)P(R);g.channels=D,g.direction==="b2t"?g.channelWidth=E:g.channelHeight=E}else if(g.channels&&g.channels.length>D.length){for(var L=function(k){D[k]={id:k,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach(function(M){if(!(M==="top"&&k>Math.floor(D.length/2))){if(!(M==="bottom"&&k<=Math.floor(D.length/2))){var N=M==="bottom"?k-D.length+g.channels.length:k;g.channels[N].queue[M].forEach(function(U,j){if(U.el){if(D[k].queue[M].push(U),M==="bottom"&&U.channel_id[0]+U.channel_id[1]-1===N){var z=[].concat(U.channel_id);U.channel_id=[z[0]-g.channels.length+D.length,z[1]],U.top=U.channel_id[0]*E,g.danmu.config.area&&g.danmu.config.area.start&&(U.top+=g.containerHeight*g.danmu.config.area.start),U.topInit()}U.resized||(U.pauseMove(g.containerPos,!1),U.startMove(g.containerPos),U.resized=!0)}g.channels[N].queue[M].splice(j,1)})}}})},O=0;O<D.length;O++)L(O);for(var _=function(k){["scroll","top","bottom"].forEach(function(M){D[k].queue[M].forEach(function(N){N.resized=!1})})},x=0;x<D.length;x++)_(x);g.channels=D,g.direction==="b2t"?g.channelWidth=E:g.channelHeight=E}}},{key:"reset",value:function(){var p=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("reset");var g=this.danmu.container,d=this;function E(){var w=g.getBoundingClientRect();d.width=w.width,d.height=w.height,d.danmu.config.area&&d.danmu.config.area.start>=0&&d.danmu.config.area.end>=d.danmu.config.area.start&&(d.direction==="b2t"?d.width=d.width*(d.danmu.config.area.end-d.danmu.config.area.start):d.height=d.height*(d.danmu.config.area.end-d.danmu.config.area.start)),d.container=g;var D=d.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),b=void 0;b=d.direction==="b2t"?Math.floor(d.width/D):Math.floor(d.height/D);for(var S=[],C=0;C<b;C++)S[C]={id:C,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};d.channels=S,d.direction==="b2t"?d.channelWidth=D:d.channelHeight=D}d.danmu.bulletBtn&&d.danmu.bulletBtn.main&&d.danmu.bulletBtn.main.queue.forEach(function(w){w.pauseMove(d.containerPos),w.remove()}),d.channels&&d.channels.length>0&&["scroll","top","bottom"].forEach(function(w){for(var D=0;D<d.channels.length;D++)d.channels[D].queue[w].forEach(function(b){b.pauseMove(d.containerPos),b.remove()})}),d.danmu.bulletBtn&&d.danmu.bulletBtn.main&&d.danmu.bulletBtn.main.data&&d.danmu.bulletBtn.main.data.forEach(function(w){w.hasAttached=!1}),p?this.resetTimer=setTimeout(E,200):E()}},{key:"resetWithCb",value:function(p,g){this.logger&&this.logger.info("resetWithCb");var d=this.danmu.container,E=this;E.channels&&E.channels.length>0&&["scroll","top","bottom"].forEach(function(P){for(var R=0;R<E.channels.length;R++)E.channels[R].queue[P].forEach(function(L){L.pauseMove(E.containerPos),L.remove()})});var w=d.getBoundingClientRect();E.width=w.width,E.height=w.height,E.danmu.config.area&&E.danmu.config.area.start>=0&&E.danmu.config.area.end>=E.danmu.config.area.start&&(E.direction==="b2t"?E.width=E.width*(E.danmu.config.area.end-E.danmu.config.area.start):E.height=E.height*(E.danmu.config.area.end-E.danmu.config.area.start)),E.container=d;var D=E.danmu.config.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12),b=void 0;b=E.direction==="b2t"?Math.floor(E.width/D):Math.floor(E.height/D);for(var S=[],C=0;C<b;C++)S[C]={id:C,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};E.channels=S,E.channelHeight=D,p&&p(!0,g)}}]),v}(s.default);e.default=f,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function h(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}return function(v,y,p){return y&&h(v.prototype,y),p&&h(v,p),v}}(),s=t(n(1)),u=t(n(0));function t(h){return h&&h.__esModule?h:{default:h}}var f=function(h){function v(y,p){(function(P,R){if(!(P instanceof R))throw new TypeError("Cannot call a class as a function")})(this,v);var g=function(P,R){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!R||(typeof R=="undefined"?"undefined":c(R))!="object"&&typeof R!="function"?P:R}(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));g.setLogger("bullet"),g.danmu=y,g.options=p,g.duration=p.duration,g.moveV=p.moveV,g.id=p.id,g.container=y.container,g.start=p.start,g.prior=p.prior,g.color=p.color,g.bookChannelId=p.bookChannelId,g.direction=y.direction;var d=g;g.onChangeDirection=function(P){d.direction=P},g.danmu.on("changeDirection",g.onChangeDirection);var E=void 0;if(g.domObj=y.domObj,p.el&&p.el.nodeType===1){E=g.domObj.use();var w=u.default.copyDom(p.el);p.eventListeners&&p.eventListeners.length>0&&p.eventListeners.forEach(function(P){w.addEventListener(P.event,P.listener,P.useCapture||!1)}),E.appendChild(w)}else(E=g.domObj.use()).textContent=p.txt;if(p.style){var D=p.style;Object.keys(D).forEach(function(P){u.default.style(E,P,D[P])})}p.mode==="top"||p.mode==="bottom"?g.mode=p.mode:g.mode="scroll",g.el=E,p.like&&p.like.el&&g.setLikeDom(p.like.el,p.like.style),g.status="waiting";var b=g.container.getBoundingClientRect(),S=Math.floor(Math.random()*(b.width/10>100?200:b.width/10));p.realTime&&(S=0);var C=b.width+S+"px";return u.default.style(g.el,"left",C),g.containerPos=b,g}return function(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof p=="undefined"?"undefined":c(p)));y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}(v,h),a(v,[{key:"attach",value:function(){if(this.container.appendChild(this.el),this.elPos=this.el.getBoundingClientRect(),this.direction==="b2t"?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV){var p=this.containerPos;this.duration=(p.width+this.width)/this.moveV*1e3}this.danmu.config&&this.danmu.config.mouseControl&&(this.mouseoverFunWrapper=this.mouseoverFun.bind(this),this.el.addEventListener("mouseover",this.mouseoverFunWrapper,!1)),this.danmu.config&&this.danmu.config.mouseEnterControl&&(this.mouseEnterFunWrapper=this.mouseoverFun.bind(this),this.el.addEventListener("mouseenter",this.mouseEnterFunWrapper,!1))}},{key:"mouseoverFun",value:function(p){this.danmu&&this.danmu.mouseControl&&this.danmu.config.mouseControlPause||this.status==="waiting"||this.status==="end"||this.danmu&&this.danmu.emit("bullet_hover",{bullet:this,event:p})}},{key:"detach",value:function(){this.el&&(this.danmu.config&&this.danmu.config.mouseControl&&this.el.removeEventListener("mouseover",this.mouseoverFunWrapper,!1),this.danmu.config&&this.danmu.config.mouseEnterControl&&this.el.removeEventListener("mouseenter",this.mouseEnterFunWrapper,!1),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.domObj.unuse(this.el),this.el=null),this.danmu.off("changeDirection",this.onChangeDirection)}},{key:"topInit",value:function(){if(this.logger&&this.logger.info("topInit #"+(this.options.txt||"[DOM Element]")+"#"),this.direction==="b2t"){var p=this.containerPos;u.default.style(this.el,"transformOrigin","left top"),u.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+p.height+"px) translateZ(0px) rotate(90deg)"),u.default.style(this.el,"transition","transform 0s linear 0s")}else u.default.style(this.el,"top",this.top+"px")}},{key:"pauseMove",value:function(p){var g=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.logger&&this.logger.info("pauseMove #"+(this.options.txt||"[DOM Element]")+"#");var d=this;if(this.status!=="paused"&&(d.status!=="forcedPause"&&(this.status="paused"),clearTimeout(d.removeTimer),this.el))if(u.default.style(this.el,"willChange","auto"),this.mode==="scroll"){if(g){var E=(new Date().getTime()-d.moveTime)/1e3,w=E*this.moveV,D=0;D=d.moveMoreS-w>=0?this.direction==="b2t"?(d.moveMoreS-w)/d.moveContainerHeight*p.height:(d.moveMoreS-w)/d.moveContainerWidth*p.width:d.moveMoreS-w,this.direction==="b2t"?u.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+D+"px) translateZ(0px) rotate(90deg)"):u.default.style(this.el,"left",D+"px")}else this.direction==="b2t"?u.default.style(this.el,"transform","translateX(-"+this.top+"px) translateY("+(this.el.getBoundingClientRect().top-p.top)+"px) translateZ(0px) rotate(90deg)"):u.default.style(this.el,"left",this.el.getBoundingClientRect().left-p.left+"px");this.direction==="b2t"||u.default.style(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),u.default.style(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+new Date().getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(p,g){this.logger&&this.logger.info("startMove #"+(this.options.txt||"[DOM Element]")+"#");var d=this;if(d.hasMove||(d.danmu.emit("bullet_start",d),d.hasMove=!0),(d.status!=="forcedPause"||g)&&this.el&&this.status!=="start")if(this.status="start",u.default.style(this.el,"willChange","transform"),this.mode==="scroll")if(this.direction==="b2t"){this.moveV=(p.height+this.height)/this.duration*1e3;var E=(d.el.getBoundingClientRect().bottom-p.top)/this.moveV;u.default.style(this.el,"transition","transform "+E+"s linear 0s"),this.startMoveTimer=setTimeout(function(){d.el&&(u.default.style(d.el,"transform","translateX(-"+d.top+"px) translateY(-"+d.height+"px) translateZ(0px) rotate(90deg)"),d.moveTime=new Date().getTime(),d.moveMoreS=d.el.getBoundingClientRect().top-p.top,d.moveContainerHeight=p.height,d.removeTimer=setTimeout(S,1e3*E))},20)}else{var w=this.el.getBoundingClientRect();this.moveV=(p.width+this.width)/this.duration*1e3;var D=(w.right-p.left)/this.moveV;u.default.style(this.el,"transition","transform "+D+"s linear 0s"),this.startMoveTimer=setTimeout(function(){if(d.el){var C=d.el.getBoundingClientRect(),P=(C.right-p.left)/D;C.right>p.left&&P>d.moveV-1&&P<d.moveV+1?(u.default.style(d.el,"transform","translateX(-"+(C.right-p.left)+"px) translateY(0px) translateZ(0px)"),d.moveTime=new Date().getTime(),d.moveMoreS=C.left-p.left,d.moveContainerWidth=p.width,d.removeTimer=setTimeout(S,1e3*D)):(d.status="end",d.remove())}},0)}else{u.default.style(this.el,"left","50%"),u.default.style(this.el,"margin","0 0 0 -"+this.width/2+"px"),this.pastDuration||(this.pastDuration=1);var b=this.duration>=this.pastDuration?this.duration-this.pastDuration:0;this.removeTimer=setTimeout(S,b),this.startTime=new Date().getTime()}function S(){if(d.el)if(d.mode==="scroll"){var C=d.containerPos,P=d.el.getBoundingClientRect();d.direction==="b2t"?P&&P.bottom<=C.top+100?(d.status="end",d.remove()):(d.pauseMove(C),d.danmu.bulletBtn.main.status!=="paused"&&d.startMove(C)):P&&P.right<=C.left+100?(d.status="end",d.remove()):(d.pauseMove(C),d.danmu.bulletBtn.main.status!=="paused"&&d.startMove(C))}else d.status="end",d.remove()}}},{key:"remove",value:function(){this.logger&&this.logger.info("remove #"+(this.options.txt||"[DOM Element]")+"#"),this.removeTimer&&clearTimeout(this.removeTimer),this.startMoveTimer&&clearTimeout(this.startMoveTimer),this.el&&this.el.parentNode&&(u.default.style(this.el,"willChange","auto"),this.detach(),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(p){this.el&&(this.el.style.fontSize=p)}},{key:"setLikeDom",value:function(p,g){if(p&&(Object.keys(g).forEach(function(E){p.style[E]=g[E]}),p.className="danmu-like",this.el)){var d=this.el.querySelector(".danmu-like");d&&this.el.removeChild(d),this.el.innerHTML=""+this.el.innerHTML+p.outerHTML}return p}}]),v}(s.default);e.default=f,l.exports=e.default},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a,s=function(){function h(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}return function(v,y,p){return y&&h(v.prototype,y),p&&h(v,p),v}}(),u=n(0),t=(a=u)&&a.__esModule?a:{default:a},f=function(){function h(v){(function(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")})(this,h),v={initDOM:function(){return document.createElement("div")},initSize:10},this.init(v)}return s(h,[{key:"init",value:function(y){this.idleList=[],this.usingList=[],this._id=0,this.options=y,this._expand(y.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var y=this.idleList.shift();return this.usingList.push(y),y}},{key:"unuse",value:function(y){var p=this.usingList.indexOf(y);p<0||(this.usingList.splice(p,1),y.innerHTML="",y.textcontent="",this.clearElementStyle(y),this.idleList.push(y))}},{key:"_expand",value:function(y){for(var p=0;p<y;p++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var y=0;y<this.idleList.length;y++)this.idleList[y].innerHTML="",this.idleList[y].textcontent="",this.clearElementStyle(this.idleList[y]);for(var p=0;p<this.usingList.length;p++)this.usingList[p].innerHTML="",this.usingList[p].textcontent="",this.clearElementStyle(this.usingList[p]);for(var g in this)delete this[g]}},{key:"clearElementStyle",value:function(y){var p=typeof window!="undefined"?window.navigator.userAgent:null;p&&(p.indexOf("MSIE ")>-1||p.indexOf("Trident/")>-1?t.default.style(y,"transform","none"):y.setAttribute("style",""))}}]),h}();e.default=f,l.exports=e.default},function(l){l.exports=JSON.parse('{"version":"0.5.10"}')},function(l,e,n){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function u(t,f){for(var h=0;h<f.length;h++){var v=f[h];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(t,v.key,v)}}return function(t,f,h){return f&&u(t.prototype,f),h&&u(t,h),t}}(),s=new(function(){function u(){var t=this;if(function(f,h){if(!(f instanceof h))throw new TypeError("Cannot call a class as a function")}(this,u),this.__handlers=[],window.ResizeObserver)try{this.observer=new window.ResizeObserver(function(f){var h=new Date().getTime();h-t.timeStampe<200||(t.timeStampe=h,t.__trigger(f))}),this.timeStampe=new Date().getTime()}catch{}}return a(u,[{key:"addObserver",value:function(f,h){if(this.observer){this.observer&&this.observer.observe(f);for(var v=this.__handlers,y=-1,p=0;p<v.length;p++)v[p]&&f===v[p].target&&(y=p);y>-1?this.__handlers[y].handler.push(h):this.__handlers.push({target:f,handler:[h]})}}},{key:"unObserver",value:function(f){var h=-1;this.__handlers.map(function(v,y){f===v.target&&(h=y)}),this.observer&&this.observer.unobserve(f),h>-1&&this.__handlers.splice(h,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(f){for(var h=this.__handlers,v=0;v<h.length;v++)if(h[v]&&f===h[v].target){h[v].handler&&h[v].handler.map(function(y){try{y()}catch(p){console.error(p)}});break}}},{key:"__trigger",value:function(f){var h=this;f.map(function(v){h.__runHandler(v.target)})}}]),u}());e.addObserver=function(u,t){s.addObserver(u,t)},e.unObserver=function(u,t){s.unObserver(u,t)},e.destroyObserver=function(u,t){s.destroyObserver(u,t)}},function(l,e,n){var a=n(35);typeof a=="string"&&(a=[[l.i,a,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,s),a.locals&&(l.exports=a.locals)},function(l,e,n){(l.exports=n(36)(!1)).push([l.i,`.danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#ffffff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}
`,""])},function(l,e){l.exports=function(n){var a=[];return a.toString=function(){return this.map(function(s){var u=function(t,f){var h=t[1]||"",v=t[3];if(!v)return h;if(f&&typeof btoa=="function"){var y=(g=v,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(g))))+" */"),p=v.sources.map(function(d){return"/*# downloadUrl="+v.sourceRoot+d+" */"});return[h].concat(p).concat([y]).join(`
`)}var g;return[h].join(`
`)}(s,n);return s[2]?"@media "+s[2]+"{"+u+"}":u}).join("")},a.i=function(s,u){typeof s=="string"&&(s=[[null,s,""]]);for(var t={},f=0;f<this.length;f++){var h=this[f][0];typeof h=="number"&&(t[h]=!0)}for(f=0;f<s.length;f++){var v=s[f];typeof v[0]=="number"&&t[v[0]]||(u&&!v[2]?v[2]=u:u&&(v[2]="("+v[2]+") and ("+u+")"),a.push(v))}},a}},function(l,e,n){var a,s,u={},t=(a=function(){return window&&document&&document.all&&!window.atob},function(){return s===void 0&&(s=a.apply(this,arguments)),s}),f=function(A){return document.querySelector(A)},h=function(x){var A={};return function(k){if(typeof k=="function")return k();if(A[k]===void 0){var M=f.call(this,k);if(window.HTMLIFrameElement&&M instanceof window.HTMLIFrameElement)try{M=M.contentDocument.head}catch{M=null}A[k]=M}return A[k]}}(),v=null,y=0,p=[],g=n(38);function d(x,A){for(var k=0;k<x.length;k++){var M=x[k],N=u[M.id];if(N){N.refs++;for(var U=0;U<N.parts.length;U++)N.parts[U](M.parts[U]);for(;U<M.parts.length;U++)N.parts.push(C(M.parts[U],A))}else{var j=[];for(U=0;U<M.parts.length;U++)j.push(C(M.parts[U],A));u[M.id]={id:M.id,refs:1,parts:j}}}}function E(x,A){for(var k=[],M={},N=0;N<x.length;N++){var U=x[N],j=A.base?U[0]+A.base:U[0],z={css:U[1],media:U[2],sourceMap:U[3]};M[j]?M[j].parts.push(z):k.push(M[j]={id:j,parts:[z]})}return k}function w(x,A){var k=h(x.insertInto);if(!k)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var M=p[p.length-1];if(x.insertAt==="top")M?M.nextSibling?k.insertBefore(A,M.nextSibling):k.appendChild(A):k.insertBefore(A,k.firstChild),p.push(A);else if(x.insertAt==="bottom")k.appendChild(A);else{if(c(x.insertAt)!="object"||!x.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var N=h(x.insertInto+" "+x.insertAt.before);k.insertBefore(A,N)}}function D(x){if(x.parentNode===null)return!1;x.parentNode.removeChild(x);var A=p.indexOf(x);A>=0&&p.splice(A,1)}function b(x){var A=document.createElement("style");return x.attrs.type===void 0&&(x.attrs.type="text/css"),S(A,x.attrs),w(x,A),A}function S(x,A){Object.keys(A).forEach(function(k){x.setAttribute(k,A[k])})}function C(x,A){var k,M,N,U;if(A.transform&&x.css){if(!(U=A.transform(x.css)))return function(){};x.css=U}if(A.singleton){var j=y++;k=v||(v=b(A)),M=L.bind(null,k,j,!1),N=L.bind(null,k,j,!0)}else x.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(k=function(z){var J=document.createElement("link");return z.attrs.type===void 0&&(z.attrs.type="text/css"),z.attrs.rel="stylesheet",S(J,z.attrs),w(z,J),J}(A),M=_.bind(null,k,A),N=function(){D(k),k.href&&URL.revokeObjectURL(k.href)}):(k=b(A),M=O.bind(null,k),N=function(){D(k)});return M(x),function(z){if(z){if(z.css===x.css&&z.media===x.media&&z.sourceMap===x.sourceMap)return;M(x=z)}else N()}}l.exports=function(x,A){if(typeof DEBUG!="undefined"&&DEBUG&&(typeof document=="undefined"?"undefined":c(document))!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(A=A||{}).attrs=c(A.attrs)=="object"?A.attrs:{},A.singleton||typeof A.singleton=="boolean"||(A.singleton=t()),A.insertInto||(A.insertInto="head"),A.insertAt||(A.insertAt="bottom");var k=E(x,A);return d(k,A),function(M){for(var N=[],U=0;U<k.length;U++){var j=k[U];(z=u[j.id]).refs--,N.push(z)}for(M&&d(E(M,A),A),U=0;U<N.length;U++){var z;if((z=N[U]).refs===0){for(var J=0;J<z.parts.length;J++)z.parts[J]();delete u[z.id]}}}};var P,R=(P=[],function(x,A){return P[x]=A,P.filter(Boolean).join(`
`)});function L(x,A,k,M){var N=k?"":M.css;if(x.styleSheet)x.styleSheet.cssText=R(A,N);else{var U=document.createTextNode(N),j=x.childNodes;j[A]&&x.removeChild(j[A]),j.length?x.insertBefore(U,j[A]):x.appendChild(U)}}function O(x,A){var k=A.css,M=A.media;if(M&&x.setAttribute("media",M),x.styleSheet)x.styleSheet.cssText=k;else{for(;x.firstChild;)x.removeChild(x.firstChild);x.appendChild(document.createTextNode(k))}}function _(x,A,k){var M=k.css,N=k.sourceMap,U=A.convertToAbsoluteUrls===void 0&&N;(A.convertToAbsoluteUrls||U)&&(M=g(M)),N&&(M+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(N))))+" */");var j=new Blob([M],{type:"text/css"}),z=x.href;x.href=URL.createObjectURL(j),z&&URL.revokeObjectURL(z)}},function(l,e){l.exports=function(n){var a=typeof window!="undefined"&&window.location;if(!a)throw new Error("fixUrls requires window.location");if(!n||typeof n!="string")return n;var s=a.protocol+"//"+a.host,u=s+a.pathname.replace(/\/[^\/]*$/,"/");return n.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,f){var h,v=f.trim().replace(/^"(.*)"$/,function(y,p){return p}).replace(/^'(.*)'$/,function(y,p){return p});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(v)?t:(h=v.indexOf("//")===0?v:v.indexOf("/")===0?s+v:u+v.replace(/^\.\//,""),"url("+JSON.stringify(h)+")")})}}])})}).call(this,K(135)(X))},function(X,I){X.exports=function(K){return K.webpackPolyfill||(K.deprecate=function(){},K.paths=[],K.children||(K.children=[]),Object.defineProperty(K,"loaded",{enumerable:!0,get:function(){return K.l}}),Object.defineProperty(K,"id",{enumerable:!0,get:function(){return K.i}}),K.webpackPolyfill=1),K}},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40">
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>
</svg>
`},function(X,I,K){var F=K(138);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .danmu-switch{-webkit-order:6;-moz-box-ordinal-group:7;order:6;z-index:26}.xgplayer-skin-default .xgplayer-danmu{display:none;position:absolute;top:0;left:0;right:0;height:100%;overflow:hidden;z-index:9;outline:none}.xgplayer-skin-default .xgplayer-danmu>*{position:absolute;white-space:nowrap;z-index:9}.xgplayer-skin-default .xgplayer-danmu.xgplayer-has-danmu{display:block}.xgplayer-skin-default .xgplayer-panel{outline:none;-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:40px;height:40px;display:inline-block;position:relative;font-family:PingFangSC-Regular;font-size:13px;color:hsla(0,0%,100%,.8);z-index:36}.xgplayer-skin-default .xgplayer-panel .xgplayer-panel-icon{cursor:pointer;position:absolute;margin-left:5px;top:10px}.xgplayer-skin-default .xgplayer-panel-active{display:block!important;bottom:30px}.xgplayer-skin-default .xgplayer-panel-slider{z-index:36;display:none;position:absolute;width:230px;height:230px;background:rgba(0,0,0,.54);border-radius:1px;padding:10px 20px;outline:none;left:-115px;bottom:40px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode{padding-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-radio li{display:inline;list-style:none;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode ul{display:-webkit-flex;display:-moz-box;display:flex;-webkit-justify-content:space-around;justify-content:space-around}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode li{margin:0 12px;font-size:11px;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-font{margin-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency{display:block;margin-top:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-progress{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:4px;border-radius:4px;background:linear-gradient(90deg,#f85959,#f85959 100%,#aaa)}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea{display:block;margin-top:8px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-threequarters,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-twoquarters{margin-left:-6px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-full{margin-right:3px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-full-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-onequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-threequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-twoquarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-zero-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(140);var G=function(){var r=this;if(!(!r.config.pip||typeof r.video.requestPictureInPicture!="function")){var c=r.lang.PIP,l=(0,F.createDom)("xg-pip",'<p class="name"><span>'+c+"</span></p>",{tabindex:9},"xgplayer-pip");r.once("ready",function(){r.controls.appendChild(l)}),["click","touchend"].forEach(function(e){l.addEventListener(e,function(n){n.preventDefault(),n.stopPropagation(),r.userGestureTrigEvent("pipBtnClick")})})}};I.default={name:"s_pip",method:G},X.exports=I.default},function(X,I,K){var F=K(141);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-pip{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-pip .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-pip .name span{width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.lang-is-jp .xgplayer-pip .name span{width:70px;height:20px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(143);var G=function(){var r=this;if(!!r.config.miniplayer){var c=r.lang.MINIPLAYER,l=(0,F.createDom)("xg-miniplayer",'<p class="name"><span>'+c+"</span></p>",{tabindex:9},"xgplayer-miniplayer");r.once("ready",function(){r.controls.appendChild(l)}),["click","touchend"].forEach(function(e){l.addEventListener(e,function(n){n.preventDefault(),n.stopPropagation(),r.userGestureTrigEvent("miniplayerBtnClick")})})}};I.default={name:"s_miniplayer",method:G},X.exports=I.default},function(X,I,K){var F=K(144);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-miniplayer{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-miniplayer .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-miniplayer .name span{width:80px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-miniplayer-lay{position:absolute;top:26px;left:0;width:100%;height:100%;z-index:130;cursor:pointer;background-color:transparent;display:none}.xgplayer-skin-default .xgplayer-miniplayer-lay div{width:100%;height:100%}.xgplayer-skin-default .xgplayer-miniplayer-drag{cursor:move;position:absolute;top:0;left:0;width:100%;height:26px;line-height:26px;background-image:linear-gradient(rgba(0,0,0,.3),transparent);z-index:130;display:none}.xgplayer-skin-default .xgplayer-miniplayer-drag .drag-handle{width:100%}.xgplayer-skin-default.xgplayer-miniplayer-active{position:fixed;right:0;bottom:200px;width:320px;height:180px;z-index:110}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-controls,.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-danmu{display:none}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-lay{display:block}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-drag{display:-webkit-flex;display:-moz-box;display:flex}.xgplayer-skin-default.xgplayer-inactive .xgplayer-miniplayer-drag{display:none}.lang-is-jp .xgplayer-miniplayer .name span{width:70px;height:20px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(146),m=r(G);K(147);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this,n=e.config.playNext;if(!n||!n.urlList)return;var a=(0,F.createDom)("xg-playnext",'<xg-icon class="xgplayer-icon">'+m.default+"</xg-icon>",{},"xgplayer-playnext"),s=e.lang.PLAYNEXT_TIPS,u=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-playnext">'+s+"</span>",{},"xgplayer-tips");a.appendChild(u),e.once("ready",function(){e.controls.appendChild(a)}),["click","touchend"].forEach(function(h){a.addEventListener(h,function(v){v.preventDefault(),v.stopPropagation(),(0,F.addClass)(e.root,"xgplayer-is-enter"),e.userGestureTrigEvent("playNextBtnClick")})});var t=function(){(0,F.addClass)(e.root,"xgplayer-playnext-inactive")};e.on("urlListEnd",t);function f(){e.off("urlListEnd",t),e.off("destroy",f)}e.once("destroy",f)};I.default={name:"s_playNext",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`},function(X,I,K){var F=K(148);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-playnext{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;cursor:pointer;top:-2px}.xgplayer-skin-default .xgplayer-playnext .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-playnext .xgplayer-tips .xgplayer-tip-playnext{display:block}.xgplayer-skin-default .xgplayer-playnext:hover{opacity:.85}.xgplayer-skin-default .xgplayer-playnext:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-playnext .xgplayer-tips{margin-left:-25px}.xgplayer-lang-is-jp .xgplayer-playnext .xgplayer-tips{margin-left:-38px}.xgplayer-skin-default.xgplayer-playnext-inactive .xgplayer-playnext{display:none}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(150),m=r(G);K(151);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this;if(!!e.config.rotate){var n=(0,F.createDom)("xg-rotate",'<xg-icon class="xgplayer-icon">'+m.default+"</xg-icon>",{},"xgplayer-rotate"),a=e.lang.ROTATE_TIPS,s=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-rotate">'+a+"</span>",{},"xgplayer-tips");n.appendChild(s),e.once("ready",function(){e.controls.appendChild(n)}),["click","touchend"].forEach(function(u){n.addEventListener(u,function(t){t.preventDefault(),t.stopPropagation(),e.userGestureTrigEvent("rotateBtnClick")})})}};I.default={name:"s_rotate",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`},function(X,I,K){var F=K(152);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-rotate{position:relative;-webkit-order:10;-moz-box-ordinal-group:11;order:10;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips .xgplayer-tip-rotate{display:block}.xgplayer-skin-default .xgplayer-rotate:hover{opacity:.85}.xgplayer-skin-default .xgplayer-rotate:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-rotate .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-rotate .xgplayer-tips{margin-left:-38px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(154),m=r(G);K(155);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this;if(!!e.config.reload){var n=(0,F.createDom)("xg-reload",'<xg-icon class="xgplayer-icon">'+m.default+"</xg-icon>",{},"xgplayer-reload"),a=e.lang.RELOAD_TIPS,s=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-reload">'+a+"</span>",{},"xgplayer-tips");n.appendChild(s),e.once("ready",function(){e.controls.appendChild(n)}),["click","touchend"].forEach(function(u){n.addEventListener(u,function(t){t.preventDefault(),t.stopPropagation(),e.userGestureTrigEvent("reloadBtnClick")})})}};I.default={name:"s_reload",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
    <path fill="#FFF" fill-opacity="1" fill-rule="nonzero" d="M18.17 19.988a7.182 7.182 0 0 1-4.256 1.318 7.806 7.806 0 0 1-.595-.03c-.08-.008-.16-.021-.242-.031a8.004 8.004 0 0 1-.458-.071c-.094-.018-.185-.042-.276-.063a7.743 7.743 0 0 1-.439-.113c-.068-.022-.136-.047-.205-.07a7.03 7.03 0 0 1-.492-.181c-.037-.015-.072-.032-.108-.049a7.295 7.295 0 0 1-.554-.269l-.025-.012a7.347 7.347 0 0 1-2.111-1.753c-.03-.036-.057-.074-.086-.11a7.305 7.305 0 0 1-1.594-4.557h1.686a.123.123 0 0 0 .108-.064.119.119 0 0 0-.006-.125L5.684 9.532a.123.123 0 0 0-.103-.056.123.123 0 0 0-.102.056l-2.834 4.276a.121.121 0 0 0-.005.125c.022.04.064.064.107.064h1.687c0 2.025.627 3.902 1.693 5.454.013.021.022.044.037.066.11.159.233.305.352.455.043.057.085.116.13.171.175.213.36.413.55.61.02.018.036.038.054.055a9.447 9.447 0 0 0 2.91 1.996c.058.026.115.054.175.079.202.084.41.158.619.228.098.034.196.069.296.1.183.054.37.1.558.145.125.029.249.06.376.085.052.01.102.027.155.035.177.032.355.05.533.071.064.007.128.018.19.026.32.03.639.052.956.052a9.46 9.46 0 0 0 5.47-1.746 1.16 1.16 0 0 0 .282-1.608 1.143 1.143 0 0 0-1.6-.283zm5.397-5.991a9.604 9.604 0 0 0-1.685-5.441c-.016-.027-.026-.054-.043-.078-.132-.19-.276-.366-.419-.543-.017-.022-.032-.044-.05-.065a9.467 9.467 0 0 0-3.571-2.7l-.114-.051a11.2 11.2 0 0 0-.673-.248c-.082-.027-.163-.057-.247-.082a9.188 9.188 0 0 0-.6-.156c-.113-.026-.224-.055-.337-.077-.057-.011-.109-.028-.164-.037-.151-.027-.304-.039-.455-.058-.104-.013-.208-.03-.313-.04a10.05 10.05 0 0 0-.759-.039c-.045 0-.09-.007-.136-.007l-.025.003a9.45 9.45 0 0 0-5.46 1.737 1.16 1.16 0 0 0-.284 1.608c.363.523 1.08.65 1.6.284a7.182 7.182 0 0 1 4.222-1.32c.217.002.429.013.639.033.065.007.129.017.193.025.173.021.344.046.513.08.075.014.149.033.221.05.166.037.331.077.494.127l.152.051c.185.061.366.127.545.201l.054.025a7.308 7.308 0 0 1 2.741 2.067l.013.018a7.302 7.302 0 0 1 1.652 4.633h-1.686a.123.123 0 0 0-.108.064.12.12 0 0 0 .006.124l2.834 4.277c.022.033.06.054.103.054.042 0 .08-.021.102-.054l2.833-4.277a.12.12 0 0 0 .005-.124.123.123 0 0 0-.108-.064h-1.685z"/>
</svg>
`},function(X,I,K){var F=K(156);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-reload{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;width:40px;height:40px;cursor:pointer}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips .xgplayer-tip-reload{display:block}.xgplayer-skin-default .xgplayer-reload:hover{opacity:.85}.xgplayer-skin-default .xgplayer-reload:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-reload .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-reload .xgplayer-tips{margin-left:-38px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(158);var G=function(){var r=this;if(!(!r.config.screenShot||r.config.screenShot.hideButton)){var c=r.lang.SCREENSHOT,l=(0,F.createDom)("xg-screenshot",'<p class="name"><span>'+(r.config.screenShot.iconText||c)+"</span></p>",{tabindex:11},"xgplayer-screenshot");r.once("ready",function(){r.controls.appendChild(l)}),["click","touchend"].forEach(function(e){l.addEventListener(e,function(n){n.preventDefault(),n.stopPropagation(),r.userGestureTrigEvent("screenShotBtnClick")})})}};I.default={name:"s_screenShot",method:G},X.exports=I.default},function(X,I,K){var F=K(159);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-screenshot{-webkit-order:11;-moz-box-ordinal-group:12;order:11;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-screenshot .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-screenshot .name span{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;padding:0 10px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-lang-is-en .xgplayer-screenshot .name span,.xgplayer-lang-is-jp .xgplayer-screenshot .name span{width:75px;height:20px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(9),G=m(F);K(78);function m(c){return c&&c.__esModule?c:{default:c}}var r=function(){if(!!this.config.nativeTextTrack){var l=this,e=l.root,n=G.default.util,a=n.createDom("xg-texttrack","",{tabindex:7},"xgplayer-texttrack"),s=l.config.nativeTextTrack;s&&Array.isArray(s)&&s.length>0&&(n.addClass(l.root,"xgplayer-is-texttrack"),l.once("canplay",function(){var u=this,t=["<ul>"];t.push("<li class='"+(this.textTrackShowDefault?"":"selected")+"'}'>"+l.lang.OFF+"</li>"),s.forEach(function(p){t.push("<li class='"+(p.default&&u.textTrackShowDefault?"selected":"")+"'>"+p.label+"</li>")});var f=l.lang.TEXTTRACK;t.push('</ul><p class="name">'+f+"</p>");var h=e.querySelector(".xgplayer-texttrack");if(h){h.innerHTML=t.join("");var v=h.querySelector(".name");(!l.config.textTrackActive||l.config.textTrackActive==="hover")&&v.addEventListener("mouseenter",function(p){p.preventDefault(),p.stopPropagation(),n.addClass(e,"xgplayer-texttrack-active"),h.focus()})}else{a.innerHTML=t.join("");var y=a.querySelector(".name");(!l.config.textTrackActive||l.config.textTrackActive==="hover")&&y.addEventListener("mouseenter",function(p){p.preventDefault(),p.stopPropagation(),n.addClass(l.root,"xgplayer-texttrack-active"),a.focus()}),l.controls.appendChild(a)}})),["touchend","click"].forEach(function(u){a.addEventListener(u,function(t){t.preventDefault(),t.stopPropagation();var f=t.target||t.srcElement;if(f&&f.tagName.toLocaleLowerCase()==="li"){Array.prototype.forEach.call(f.parentNode.childNodes,function(v){n.removeClass(v,"selected")}),n.addClass(f,"selected");var h=l.root.getElementsByTagName("Track");f.innerHTML===l.lang.OFF?(h[0].track.mode="hidden",h[0].src="",n.removeClass(l.root,"xgplayer-texttrack-active")):(h[0].style.display="block",n.addClass(l.root,"xgplayer-texttrack-active"),h[0].track.mode="showing",s.some(function(v){if(v.label===f.innerHTML)return h[0].src=v.src,v.kind&&(h[0].kind=v.kind),h[0].label=v.label,v.srclang&&(h[0].srclang=v.srclang),!0}),l.emit("textTrackChange",f.innerHTML))}else l.config.textTrackActive==="click"&&f&&(f.tagName.toLocaleLowerCase()==="p"||f.tagName.toLocaleLowerCase()==="em")&&(n.addClass(l.root,"xgplayer-texttrack-active"),a.focus())},!1)}),l.on("play",function(){var u=e.querySelector(".xgplayer-texttrack ul"),t=e.getElementsByTagName("Track");!l.hls||!u||!t||(t[0].src="",Array.prototype.forEach.call(u.childNodes,function(f){n.hasClass(f,"selected")&&(f.innerHTML===l.lang.OFF?(t[0].track.mode="hidden",t[0].src=""):(t[0].track.mode="hidden",s.some(function(h){if(h.label!==f.innerHTML)return t[0].src=h.src,h.kind&&(t[0].kind=h.kind),t[0].label=h.label,h.srclang&&(t[0].srclang=h.srclang),!0}),s.some(function(h){if(h.label===f.innerHTML)return setTimeout(function(){t[0].src=h.src,h.kind&&(t[0].kind=h.kind),t[0].label=h.label,h.srclang&&(t[0].srclang=h.srclang),t[0].track.mode="showing"}),!0})))}),n.removeClass(l.root,"xgplayer-texttrack-active"))}),a.addEventListener("mouseleave",function(u){u.preventDefault(),u.stopPropagation(),n.removeClass(l.root,"xgplayer-texttrack-active")})}};I.default={name:"s_nativeTextTrack",method:r},X.exports=I.default},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-texttrack{-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-texttrack ul{display:none;list-style:none;min-width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;text-align:center;white-space:nowrap;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-texttrack ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:auto;padding:6px 13px}.xgplayer-skin-default .xgplayer-texttrack ul li.selected,.xgplayer-skin-default .xgplayer-texttrack ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-texttrack .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-texttrack.xgplayer-texttrack-hide{display:none}xg-text-track{transition:bottom .3s ease}.xgplayer-skin-default.xgplayer-is-texttrack .xgplayer-texttrack,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-texttrack ul{display:block}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(78);function G(r,c,l,e){if(c.length===0){r.innerHTML="";return}var n=[];n.push('<li data-type="off" class="'+(e?"":"selected")+'">'+l+"</li>"),c.forEach(function(a){n.push("<li data-id="+a.id+" data-language="+a.language+' class="'+(a.isDefault&&e?"selected":"")+'">'+a.label+"</li>")}),r.innerHTML=n.join("")}var m=function(){var c=this;if(!this.config.textTrack)return;var l=this.config.textTrack,e=c.lang.TEXTTRACK,n=(0,F.createDom)("xg-texttrack",'<ul></ul><p class="name">'+e+"</p>",{tabindex:7},"xgplayer-texttrack");function a(){var u=c.root.querySelector(".xgplayer-texttrack");if(!u){c.controls.appendChild(n);var t=n.querySelector(".name");!c.config.textTrackActive||c.config.textTrackActive==="hover"?(t.addEventListener("mouseenter",function(h){h.preventDefault(),h.stopPropagation(),(0,F.addClass)(c.root,"xgplayer-texttrack-active"),n.focus()}),n.addEventListener("mouseleave",function(h){h.preventDefault(),h.stopPropagation(),(0,F.removeClass)(c.root,"xgplayer-texttrack-active")})):t.addEventListener("click",function(h){h.preventDefault(),h.stopPropagation(),(0,F.hasClass)(c.root,"xgplayer-texttrack-active")?(0,F.removeClass)(c.root,"xgplayer-texttrack-active"):(0,F.addClass)(c.root,"xgplayer-texttrack-active")})}["touchend","click"].forEach(function(h){n.addEventListener(h,function(v){v.preventDefault(),v.stopPropagation();var y=v.target||v.srcElement;if(y&&y.tagName.toLocaleLowerCase()==="li"){var p=y.getAttribute("data-id"),g=y.getAttribute("data-type"),d=y.getAttribute("data-language");Array.prototype.forEach.call(y.parentNode.childNodes,function(E){(0,F.removeClass)(E,"selected")}),(0,F.addClass)(y,"selected"),g==="off"?(c.switchOffSubtile(),(0,F.removeClass)(c.root,"xgplayer-texttrack-active")):(c.switchSubTitle({id:p,language:d}),(0,F.addClass)(c.root,"xgplayer-texttrack-active"))}})});var f=n.getElementsByTagName("ul")[0];G(f,l,c.lang.OFF,c.textTrackShowDefault),l.length===0?(0,F.addClass)(n,"xgplayer-texttrack-hide"):(0,F.removeClass)(n,"xgplayer-texttrack-hide")}var s=function(t){if(!!t.isListUpdate){var f=n.getElementsByTagName("ul")[0];l=t.list,G(f,t.list,c.lang.OFF,c.textTrackShowDefault),t.list.length>0?(0,F.addClass)(c.root,"xgplayer-is-texttrack"):(0,F.removeClass)(c.root,"xgplayer-is-texttrack"),t.list.length===0?(0,F.addClass)(n,"xgplayer-texttrack-hide"):(0,F.removeClass)(n,"xgplayer-texttrack-hide")}};l&&Array.isArray(l)&&(l.length>0&&(0,F.addClass)(c.root,"xgplayer-is-texttrack"),c.once("canplay",a),c.on("subtitle_change",s))};I.default={name:"s_textTrack",method:m},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(164);var G=function(){var r=this,c=r.root,l=(0,F.createDom)("xg-error",'<span class="xgplayer-error-text">\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5</span>',{},"xgplayer-error");r.once("ready",function(){c.appendChild(l)});var e=l.querySelector(".xgplayer-error-text");r.config.lang&&r.config.lang==="zh-cn"?e.innerHTML=r.config.errorTips||'\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5':e.innerHTML=r.config.errorTips||'please try to <span class="xgplayer-error-refresh">refresh</span>';var n=null;function a(){(0,F.addClass)(r.root,"xgplayer-is-error"),n=l.querySelector(".xgplayer-error-refresh"),n&&["touchend","click"].forEach(function(u){n.addEventListener(u,function(t){t.preventDefault(),t.stopPropagation(),r.autoplay=!0;var f=r.currentTime;r.once("playing",function(){r.currentTime=f,(0,F.removeClass)(r.root,"xgplayer-is-error")}),r.src=r.config.url})})}r.on("error",a);function s(){r.off("error",a),r.off("destroy",s)}r.once("destroy",s)};I.default={name:"s_error",method:G},X.exports=I.default},function(X,I,K){var F=K(165);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-error{background:#000;display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:125;font-family:PingFangSC-Regular;font-size:14px;color:#fff;text-align:center;line-height:100%;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center}.xgplayer-skin-default .xgplayer-error .xgplayer-error-refresh{color:#fa1f41;padding:0 3px;cursor:pointer}.xgplayer-skin-default .xgplayer-error .xgplayer-error-text{line-height:18px;margin:auto 6px}.xgplayer-skin-default.xgplayer-is-error .xgplayer-error{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0);K(167);var G=function(){var r=this,c=r.config.lastPlayTime||0,l=r.config.lastPlayTimeHideDelay||0,e=null;if(!(c<=0)){e=(0,F.createDom)("xg-memoryplay",'<div class="xgplayer-memoryplay-spot"><div class="xgplayer-progress-tip">\u60A8\u4E0A\u6B21\u89C2\u770B\u5230 <span class="xgplayer-lasttime">'+(0,F.format)(c)+'</span> \uFF0C\u4E3A\u60A8\u81EA\u52A8\u7EED\u64AD <span class="btn-close"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="close" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"></path></svg></span></div></div>',{},"xgplayer-memoryplay"),e.addEventListener("mouseover",function(s){s.stopPropagation()});var n=function(){e&&e.parentNode&&e.parentNode.removeChild(e),e=null};e.querySelector(".xgplayer-progress-tip .btn-close").addEventListener("click",n);var a=function(){l>0&&r.root.appendChild(e),r.emit("memoryPlayStart",c),l>0&&setTimeout(function(){n()},l*1e3)};r.once("playing",a),r.once("ended",n)}};I.default={name:"s_memoryPlay",method:G},X.exports=I.default},function(X,I,K){var F=K(168);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-memoryplay-spot{position:absolute;height:32px;left:10px;bottom:46px;background:rgba(0,0,0,.5);border-radius:32px;line-height:32px;color:#ddd;z-index:15;padding:0 32px 0 16px}.xgplayer-skin-default .xgplayer-memoryplay-spot .xgplayer-lasttime{color:red;font-weight:700}.xgplayer-skin-default .xgplayer-memoryplay-spot .btn-close{position:absolute;width:16px;height:16px;right:10px;top:2px;cursor:pointer;color:#fff;font-size:16px}",""])},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=K(170),m=r(G);K(171);function r(l){return l&&l.__esModule?l:{default:l}}var c=function(){var e=this;if(!(!e.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)){var n=(0,F.createDom)("xg-airplay",`<xg-icon class="xgplayer-icon">
    <div class="xgplayer-icon-airplay">`+m.default+`</div>
  </xg-icon>`,{},"xgplayer-airplay"),a=(0,F.createDom)("xg-tips",'<span class="xgplayer-tip-airplay">'+e.lang.AIRPLAY_TIPS+"</span>",{},"xgplayer-tips");n.appendChild(a),e.once("ready",function(){e.controls.appendChild(n),e.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(s){switch(s.availability){case"available":n.hidden=!1,n.disabled=!1;break;case"not-available":n.hidden=!0,n.disabled=!0;break}})}),["click","touchend"].forEach(function(s){n.addEventListener(s,function(u){u.preventDefault(),u.stopPropagation(),e.userGestureTrigEvent("airplayBtnClick")})})}};I.default={name:"s_airplay",method:c},X.exports=I.default},function(X,I,K){K.r(I),I.default='<svg t="1600422191774" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3100" width="28" height="28"><path d="M256 938.666667h512L512 597.333333 256 938.666667z m170.666667-85.333334l85.333333-113.781333L597.333333 853.333333H426.666667zM853.333333 85.333333H170.666667C99.946667 85.333333 42.666667 142.613333 42.666667 213.333333v426.666667c0 70.72 57.28 128 128 128h106.666666l64-85.333333H170.666667c-23.573333 0-42.666667-19.093333-42.666667-42.666667V213.333333c0-23.573333 19.093333-42.666667 42.666667-42.666666h682.666666c23.573333 0 42.666667 19.093333 42.666667 42.666666v426.666667c0 23.573333-19.093333 42.666667-42.666667 42.666667H682.666667l64 85.333333h106.666666c70.72 0 128-57.28 128-128V213.333333c0-70.72-57.28-128-128-128z" p-id="3101" fill="#ffffff"></path></svg>'},function(X,I,K){var F=K(172);typeof F=="string"&&(F=[[X.i,F,""]]);var G,m={hmr:!0};m.transform=G,m.insertInto=void 0,K(2)(F,m),F.locals&&(X.exports=F.locals)},function(X,I,K){I=X.exports=K(1)(!1),I.push([X.i,".xgplayer-skin-default .xgplayer-airplay{position:relative;-webkit-order:11;-moz-box-ordinal-group:12;order:11;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon{margin-top:6px;margin-left:6px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon .xgplayer-icon-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips .xgplayer-tip-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay:hover{opacity:.85}.xgplayer-skin-default .xgplayer-airplay:hover .xgplayer-tips{display:block}",""])}])})})(dist$2);var volume={exports:{}};(function(be,H){(function(X,I){be.exports=I()})(window,function(){return function(X){var I={};function K(F){if(I[F])return I[F].exports;var G=I[F]={i:F,l:!1,exports:{}};return X[F].call(G.exports,G,G.exports,K),G.l=!0,G.exports}return K.m=X,K.c=I,K.d=function(F,G,m){K.o(F,G)||Object.defineProperty(F,G,{enumerable:!0,get:m})},K.r=function(F){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})},K.t=function(F,G){if(1&G&&(F=K(F)),8&G||4&G&&typeof F=="object"&&F&&F.__esModule)return F;var m=Object.create(null);if(K.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:F}),2&G&&typeof F!="string")for(var r in F)K.d(m,r,function(c){return F[c]}.bind(null,r));return m},K.n=function(F){var G=F&&F.__esModule?function(){return F.default}:function(){return F};return K.d(G,"a",G),G},K.o=function(F,G){return Object.prototype.hasOwnProperty.call(F,G)},K.p="",K(K.s=1)}([function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0}),I.util=I.PresentationMode=void 0,I.createDom=r,I.hasClass=c,I.addClass=l,I.removeClass=e,I.toggleClass=n,I.findDom=a,I.padStart=s,I.format=u,I.event=t,I.typeOf=f,I.deepCopy=h,I.getBgImage=v,I.copyDom=y,I._setInterval=p,I._clearInterval=g,I.createImgBtn=d,I.isWeiXin=E,I.isUc=w,I.computeWatchDur=D,I.offInDestroy=b,I.on=S,I.once=C,I.getBuffered2=P,I.checkIsBrowser=R,I.setStyle=L,I.checkWebkitSetPresentationMode=function(O){return typeof O.webkitSetPresentationMode=="function"};var F,G=K(3),m=(F=G)&&F.__esModule?F:{default:F};function r(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",k=document.createElement(O);return k.className=A,k.innerHTML=_,Object.keys(x).forEach(function(M){var N=M,U=x[M];O==="video"||O==="audio"?U&&k.setAttribute(N,U):k.setAttribute(N,U)}),k}function c(O,_){return!!O&&(O.classList?Array.prototype.some.call(O.classList,function(x){return x===_}):!!O.className&&!!O.className.match(new RegExp("(\\s|^)"+_+"(\\s|$)")))}function l(O,_){O&&(O.classList?_.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(x){x&&O.classList.add(x)}):c(O,_)||(O.className+=" "+_))}function e(O,_){O&&(O.classList?_.split(/\s+/g).forEach(function(x){O.classList.remove(x)}):c(O,_)&&_.split(/\s+/g).forEach(function(x){var A=new RegExp("(\\s|^)"+x+"(\\s|$)");O.className=O.className.replace(A," ")}))}function n(O,_){O&&_.split(/\s+/g).forEach(function(x){c(O,x)?e(O,x):l(O,x)})}function a(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,_=arguments[1],x=void 0;try{x=O.querySelector(_)}catch{_.indexOf("#")===0&&(x=O.getElementById(_.slice(1)))}return x}function s(O,_,x){for(var A=String(x),k=_>>0,M=Math.ceil(k/A.length),N=[],U=String(O);M--;)N.push(A);return N.join("").substring(0,k-U.length)+U}function u(O){if(window.isNaN(O))return"";var _=s(Math.floor(O/3600),2,0),x=s(Math.floor((O-3600*_)/60),2,0),A=s(Math.floor(O-3600*_-60*x),2,0);return(_==="00"?[x,A]:[_,x,A]).join(":")}function t(O){if(O.touches){var _=O.touches[0]||O.changedTouches[0];O.clientX=_.clientX||0,O.clientY=_.clientY||0,O.offsetX=_.pageX-_.target.offsetLeft,O.offsetY=_.pageY-_.target.offsetTop}O._target=O.target||O.srcElement}function f(O){return Object.prototype.toString.call(O).match(/([^\s.*]+)(?=]$)/g)[0]}function h(O,_){if(f(_)==="Object"&&f(O)==="Object")return Object.keys(_).forEach(function(x){f(_[x])!=="Object"||_[x]instanceof Node?f(_[x])==="Array"?O[x]=f(O[x])==="Array"?O[x].concat(_[x]):_[x]:O[x]=_[x]:O[x]?h(O[x],_[x]):O[x]=_[x]}),O}function v(O){var _=(O.currentStyle||window.getComputedStyle(O,null)).backgroundImage;if(!_||_==="none")return"";var x=document.createElement("a");return x.href=_.replace(/url\("|"\)/g,""),x.href}function y(O){if(O&&O.nodeType===1){var _=document.createElement(O.tagName);return Array.prototype.forEach.call(O.attributes,function(x){_.setAttribute(x.name,x.value)}),O.innerHTML&&(_.innerHTML=O.innerHTML),_}return""}function p(O,_,x,A){O._interval[_]||(O._interval[_]=setInterval(x.bind(O),A))}function g(O,_){clearInterval(O._interval[_]),O._interval[_]=null}function d(O,_,x,A){var k=r("xg-"+O,"",{},"xgplayer-"+O+"-img");if(k.style.backgroundImage='url("'+_+'")',x&&A){var M=void 0,N=void 0,U=void 0;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(j){return!(x.indexOf(j)>-1&&A.indexOf(j)>-1)||(M=Number(x.slice(0,x.indexOf(j)).trim()),N=Number(A.slice(0,A.indexOf(j)).trim()),U=j,!1)}),k.style.width=""+M+U,k.style.height=""+N+U,k.style.backgroundSize=""+M+U+" "+N+U,k.style.margin=O==="start"?"-"+N/2+U+" auto auto -"+M/2+U:"auto 5px auto 5px"}return k}function E(){return window.navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1}function w(){return window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")>-1}function D(){for(var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_=[],x=0;x<O.length;x++)if(!(!O[x].end||O[x].begin<0||O[x].end<0||O[x].end<O[x].begin))if(_.length<1)_.push({begin:O[x].begin,end:O[x].end});else for(var A=0;A<_.length;A++){var k=O[x].begin,M=O[x].end;if(M<_[A].begin){_.splice(A,0,{begin:k,end:M});break}if(!(k>_[A].end)){var N=_[A].begin,U=_[A].end;_[A].begin=Math.min(k,N),_[A].end=Math.max(M,U);break}if(A>_.length-2){_.push({begin:k,end:M});break}}for(var j=0,z=0;z<_.length;z++)j+=_[z].end-_[z].begin;return j}function b(O,_,x,A){O.once(A,function k(){O.off(_,x),O.off(A,k)})}function S(O,_,x,A){A?(O.on(_,x),b(O,_,x,A)):O.on(_,function k(M){x(M),O.off(_,k)})}function C(O,_,x,A){A?(O.once(_,x),b(O,_,x,A)):O.once(_,function k(M){x(M),O.off(_,k)})}function P(O){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,x=[],A=0;A<O.length;A++)x.push({start:O.start(A)<.5?0:O.start(A),end:O.end(A)});x.sort(function(j,z){var J=j.start-z.start;return J||z.end-j.end});var k=[];if(_)for(var M=0;M<x.length;M++){var N=k.length;if(N){var U=k[N-1].end;x[M].start-U<_?x[M].end>U&&(k[N-1].end=x[M].end):k.push(x[M])}else k.push(x[M])}else k=x;return new m.default(k)}function R(){return!(typeof window=="undefined"||window.document===void 0||window.document.createElement===void 0)}function L(O,_,x){var A=O.style;try{A[_]=x}catch{A.setProperty(_,x)}}I.PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},I.util={createDom:r,hasClass:c,addClass:l,removeClass:e,toggleClass:n,findDom:a,padStart:s,format:u,event:t,typeOf:f,deepCopy:h,getBgImage:v,copyDom:y,setInterval:p,clearInterval:g,createImgBtn:d,isWeiXin:E,isUc:w,computeWatchDur:D,offInDestroy:b,on:S,once:C,getBuffered2:P,checkIsBrowser:R,setStyle:L}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=m(K(2)),G=m(K(5));function m(r){return r&&r.__esModule?r:{default:r}}I.default={name:"volume",method:function(){F.default.method.call(this),G.default.method.call(this)}},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F,G=K(0),m=K(4),r=(F=m)&&F.__esModule?F:{default:F};I.default={name:"volume",method:function(){var c=this,l=c.root,e=void 0,n=void 0,a=void 0,s=void 0;function u(){c.controls&&(c.volume=c.config.volume,(e=c.controls.querySelector(".xgplayer-volume"))&&(n=e.querySelector(".xgplayer-slider"),a=e.querySelector(".xgplayer-bar"),s=e.querySelector(".xgplayer-drag"),r.default.device==="mobile"&&(c.volume===0&&(c.video.muted=!0),p())))}function t(g){if(n){c.video.muted=!1,n.focus(),(0,G.event)(g);var d=a.getBoundingClientRect(),E=(g.clientX,g.clientY),w=s.getBoundingClientRect().height,D=!1,b=function(C){C.preventDefault(),C.stopPropagation(),(0,G.event)(C),D=!0;var P=w-C.clientY+E,R=P/d.height;s.style.height=P+"px",c.volume=Math.max(Math.min(R,1),0)},S=function C(P){if(P.preventDefault(),P.stopPropagation(),(0,G.event)(P),window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",b),window.removeEventListener("mouseup",C),window.removeEventListener("touchend",C),!D){var R=d.height-(P.clientY-d.top),L=R/d.height;s.style.height=R+"px",L<=0&&(c.volume>0?s.volume=c.video.volume:L=s.volume),c.volume=Math.max(Math.min(L,1),0)}n.volume=c.volume,D=!1};return window.addEventListener("mousemove",b),window.addEventListener("touchmove",b),window.addEventListener("mouseup",S),window.addEventListener("touchend",S),!1}}function f(){if(r.default.device==="mobile")c.video.muted?(c.video.muted=!1,c.emit("unmute"),c.volume=1):(c.video.muted=!0,c.emit("mute"),c.volume=0);else{if(!n)return;c.video.muted=!1,c.volume<.1?(n.volume<.1?c.volume=.6:c.volume=n.volume,c.emit("unmute")):(c.volume=0,c.emit("mute"))}}function h(){(0,G.addClass)(l,"xgplayer-volume-active"),e&&e.focus()}function v(){(0,G.removeClass)(l,"xgplayer-volume-active")}c.once("canplay",u),c.on("volumeBarClick",t),c.on("volumeIconClick",f),c.on("volumeIconEnter",h),c.on("volumeIconLeave",v);var y=null;function p(){y&&clearTimeout(y),y=setTimeout(function(){if(r.default.device==="mobile")(0,G.removeClass)(l,"xgplayer-volume-muted"),(0,G.removeClass)(l,"xgplayer-volume-large"),c.video.muted||c.video.defaultMuted?(c.video.muted||(c.video.muted=!0),c.video.defaultMuted=!1,(0,G.addClass)(l,"xgplayer-volume-muted")):(0,G.addClass)(l,"xgplayer-volume-large");else{if((0,G.removeClass)(l,"xgplayer-volume-muted"),(0,G.removeClass)(l,"xgplayer-volume-small"),(0,G.removeClass)(l,"xgplayer-volume-large"),c.volume===0||c.muted?(0,G.addClass)(l,"xgplayer-volume-muted"):c.volume<.5?(0,G.addClass)(l,"xgplayer-volume-small"):(0,G.addClass)(l,"xgplayer-volume-large"),!a)return;var g=a.getBoundingClientRect().height||76;s.style.height=c.volume*g+"px"}},50)}c.on("volumechange",p),c.once("destroy",function g(){c.off("canplay",u),c.off("volumeBarClick",t),c.off("volumeIconClick",f),c.off("volumeIconEnter",h),c.off("volumeIconLeave",v),c.off("volumechange",p),c.off("destroy",g),y&&(clearTimeout(y),y=null)})}},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function m(r,c){for(var l=0;l<c.length;l++){var e=c[l];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,c,l){return c&&m(r.prototype,c),l&&m(r,l),r}}(),G=function(){function m(r){(function(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")})(this,m),this.bufferedList=r}return F(m,[{key:"start",value:function(r){return this.bufferedList[r].start}},{key:"end",value:function(r){return this.bufferedList[r].end}},{key:"length",get:function(){return this.bufferedList.length}}]),m}();I.default=G,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F={};Object.defineProperty(F,"device",{get:function(){return F.os.isPc?"pc":"mobile"}}),Object.defineProperty(F,"browser",{get:function(){var G=navigator.userAgent.toLowerCase(),m={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(m).filter(function(r){return m[r].test(G)}))[0]||""}}),Object.defineProperty(F,"os",{get:function(){var G=navigator.userAgent,m=/(?:Windows Phone)/.test(G),r=/(?:SymbianOS)/.test(G)||m,c=/(?:Android)/.test(G),l=/(?:Firefox)/.test(G),e=/(?:iPad|PlayBook)/.test(G)||c&&!/(?:Mobile)/.test(G)||l&&/(?:Tablet)/.test(G),n=/(?:iPhone)/.test(G)&&!e;return{isTablet:e,isPhone:n,isAndroid:c,isPc:!(n||c||r||e),isSymbian:r,isWindowsPhone:m,isFireFox:l}}}),I.default=F,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=K(0),G=c(K(6)),m=c(K(7)),r=c(K(8));function c(l){return l&&l.__esModule?l:{default:l}}K(9),I.default={name:"s_volume",method:function(){var l=this,e=(0,F.createDom)("xg-volume",`<xg-icon class="xgplayer-icon">
                                         <div class="xgplayer-icon-large">`+r.default+`</div>
                                         <div class="xgplayer-icon-small">`+m.default+`</div>
                                         <div class="xgplayer-icon-muted">`+G.default+`</div>
                                       </xg-icon>
                                       <xg-slider class="xgplayer-slider" tabindex="2">
                                         <xg-bar class="xgplayer-bar">
                                           <xg-drag class="xgplayer-drag"></xg-drag>
                                         </xg-bar>
                                       </xg-slider>`,{},"xgplayer-volume");l.once("ready",function(){l.controls&&l.controls.appendChild(e)});var n=e.querySelector(".xgplayer-slider"),a=e.querySelector(".xgplayer-bar"),s=e.querySelector(".xgplayer-drag"),u=e.querySelector(".xgplayer-icon");s.style.height=100*l.config.volume+"%",n.volume=l.config.volume,a.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),l.userGestureTrigEvent("volumeBarClick",t)}),["click","touchend"].forEach(function(t){u.addEventListener(t,function(f){f.preventDefault(),f.stopPropagation(),l.userGestureTrigEvent("volumeIconClick")})}),u.addEventListener("mouseenter",function(t){t.preventDefault(),t.stopPropagation(),l.userGestureTrigEvent("volumeIconEnter")}),["blur","mouseleave"].forEach(function(t){e.addEventListener(t,function(f){f.preventDefault(),f.stopPropagation(),l.userGestureTrigEvent("volumeIconLeave")})})}},X.exports=I.default},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(X,I,K){K.r(I),I.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(X,I,K){var F=K(10);typeof F=="string"&&(F=[[X.i,F,""]]);var G={hmr:!0,transform:void 0,insertInto:void 0};K(12)(F,G),F.locals&&(X.exports=F.locals)},function(X,I,K){(X.exports=K(11)(!1)).push([X.i,'.xgplayer-skin-default .xgplayer-volume{outline:none;-webkit-order:4;-moz-box-ordinal-group:5;order:4;width:40px;height:40px;display:block;position:relative;z-index:18}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon{margin-top:8px;cursor:pointer;position:absolute;bottom:-9px}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:none}.xgplayer-skin-default .xgplayer-slider{display:none;position:absolute;width:28px;height:92px;background:rgba(0,0,0,.54);border-radius:1px;bottom:42px;outline:none}.xgplayer-skin-default .xgplayer-slider:after{content:" ";display:block;height:15px;width:28px;position:absolute;bottom:-15px;left:0;z-index:20}.xgplayer-skin-default .xgplayer-bar,.xgplayer-skin-default .xgplayer-drag{display:block;position:absolute;bottom:6px;left:12px;background:hsla(0,0%,100%,.3);border-radius:100px;width:4px;height:76px;outline:none;cursor:pointer}.xgplayer-skin-default .xgplayer-drag{bottom:0;left:0;background:#fa1f41;max-height:76px}.xgplayer-skin-default .xgplayer-drag:after{content:" ";display:inline-block;width:8px;height:8px;background:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.26);position:absolute;border-radius:50%;left:-2px;top:-6px}.xgplayer-skin-default.xgplayer-volume-active .xgplayer-slider,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:none}.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:block}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-large,.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:none}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:block}.xgplayer-skin-default.xgplayer-mobile .xgplayer-volume .xgplayer-slider{display:none}',""])},function(X,I){X.exports=function(K){var F=[];return F.toString=function(){return this.map(function(G){var m=function(r,c){var l=r[1]||"",e=r[3];if(!e)return l;if(c&&typeof btoa=="function"){var n=(s=e,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=e.sources.map(function(u){return"/*# downloadUrl="+e.sourceRoot+u+" */"});return[l].concat(a).concat([n]).join(`
`)}var s;return[l].join(`
`)}(G,K);return G[2]?"@media "+G[2]+"{"+m+"}":m}).join("")},F.i=function(G,m){typeof G=="string"&&(G=[[null,G,""]]);for(var r={},c=0;c<this.length;c++){var l=this[c][0];typeof l=="number"&&(r[l]=!0)}for(c=0;c<G.length;c++){var e=G[c];typeof e[0]=="number"&&r[e[0]]||(m&&!e[2]?e[2]=m:m&&(e[2]="("+e[2]+") and ("+m+")"),F.push(e))}},F}},function(X,I,K){var F,G,m={},r=(F=function(){return window&&document&&document.all&&!window.atob},function(){return G===void 0&&(G=F.apply(this,arguments)),G}),c=function(b){return document.querySelector(b)},l=function(b){var S={};return function(C){if(typeof C=="function")return C();if(S[C]===void 0){var P=c.call(this,C);if(window.HTMLIFrameElement&&P instanceof window.HTMLIFrameElement)try{P=P.contentDocument.head}catch{P=null}S[C]=P}return S[C]}}(),e=null,n=0,a=[],s=K(13);function u(b,S){for(var C=0;C<b.length;C++){var P=b[C],R=m[P.id];if(R){R.refs++;for(var L=0;L<R.parts.length;L++)R.parts[L](P.parts[L]);for(;L<P.parts.length;L++)R.parts.push(p(P.parts[L],S))}else{var O=[];for(L=0;L<P.parts.length;L++)O.push(p(P.parts[L],S));m[P.id]={id:P.id,refs:1,parts:O}}}}function t(b,S){for(var C=[],P={},R=0;R<b.length;R++){var L=b[R],O=S.base?L[0]+S.base:L[0],_={css:L[1],media:L[2],sourceMap:L[3]};P[O]?P[O].parts.push(_):C.push(P[O]={id:O,parts:[_]})}return C}function f(b,S){var C=l(b.insertInto);if(!C)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var P=a[a.length-1];if(b.insertAt==="top")P?P.nextSibling?C.insertBefore(S,P.nextSibling):C.appendChild(S):C.insertBefore(S,C.firstChild),a.push(S);else if(b.insertAt==="bottom")C.appendChild(S);else{if(typeof b.insertAt!="object"||!b.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var R=l(b.insertInto+" "+b.insertAt.before);C.insertBefore(S,R)}}function h(b){if(b.parentNode===null)return!1;b.parentNode.removeChild(b);var S=a.indexOf(b);S>=0&&a.splice(S,1)}function v(b){var S=document.createElement("style");return b.attrs.type="text/css",y(S,b.attrs),f(b,S),S}function y(b,S){Object.keys(S).forEach(function(C){b.setAttribute(C,S[C])})}function p(b,S){var C,P,R,L;if(S.transform&&b.css){if(!(L=S.transform(b.css)))return function(){};b.css=L}if(S.singleton){var O=n++;C=e||(e=v(S)),P=E.bind(null,C,O,!1),R=E.bind(null,C,O,!0)}else b.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(C=function(_){var x=document.createElement("link");return _.attrs.type="text/css",_.attrs.rel="stylesheet",y(x,_.attrs),f(_,x),x}(S),P=D.bind(null,C,S),R=function(){h(C),C.href&&URL.revokeObjectURL(C.href)}):(C=v(S),P=w.bind(null,C),R=function(){h(C)});return P(b),function(_){if(_){if(_.css===b.css&&_.media===b.media&&_.sourceMap===b.sourceMap)return;P(b=_)}else R()}}X.exports=function(b,S){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(S=S||{}).attrs=typeof S.attrs=="object"?S.attrs:{},S.singleton||typeof S.singleton=="boolean"||(S.singleton=r()),S.insertInto||(S.insertInto="head"),S.insertAt||(S.insertAt="bottom");var C=t(b,S);return u(C,S),function(P){for(var R=[],L=0;L<C.length;L++){var O=C[L];(_=m[O.id]).refs--,R.push(_)}for(P&&u(t(P,S),S),L=0;L<R.length;L++){var _;if((_=R[L]).refs===0){for(var x=0;x<_.parts.length;x++)_.parts[x]();delete m[_.id]}}}};var g,d=(g=[],function(b,S){return g[b]=S,g.filter(Boolean).join(`
`)});function E(b,S,C,P){var R=C?"":P.css;if(b.styleSheet)b.styleSheet.cssText=d(S,R);else{var L=document.createTextNode(R),O=b.childNodes;O[S]&&b.removeChild(O[S]),O.length?b.insertBefore(L,O[S]):b.appendChild(L)}}function w(b,S){var C=S.css,P=S.media;if(P&&b.setAttribute("media",P),b.styleSheet)b.styleSheet.cssText=C;else{for(;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(C))}}function D(b,S,C){var P=C.css,R=C.sourceMap,L=S.convertToAbsoluteUrls===void 0&&R;(S.convertToAbsoluteUrls||L)&&(P=s(P)),R&&(P+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(R))))+" */");var O=new Blob([P],{type:"text/css"}),_=b.href;b.href=URL.createObjectURL(O),_&&URL.revokeObjectURL(_)}},function(X,I){X.exports=function(K){var F=typeof window!="undefined"&&window.location;if(!F)throw new Error("fixUrls requires window.location");if(!K||typeof K!="string")return K;var G=F.protocol+"//"+F.host,m=G+F.pathname.replace(/\/[^\/]*$/,"/");return K.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(r,c){var l,e=c.trim().replace(/^"(.*)"$/,function(n,a){return a}).replace(/^'(.*)'$/,function(n,a){return a});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e)?r:(l=e.indexOf("//")===0?e:e.indexOf("/")===0?G+e:m+e.replace(/^\.\//,""),"url("+JSON.stringify(l)+")")})}}])})})(volume);var playbackRate={exports:{}};(function(be,H){(function(X,I){be.exports=I()})(window,function(){return function(X){var I={};function K(F){if(I[F])return I[F].exports;var G=I[F]={i:F,l:!1,exports:{}};return X[F].call(G.exports,G,G.exports,K),G.l=!0,G.exports}return K.m=X,K.c=I,K.d=function(F,G,m){K.o(F,G)||Object.defineProperty(F,G,{enumerable:!0,get:m})},K.r=function(F){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})},K.t=function(F,G){if(1&G&&(F=K(F)),8&G||4&G&&typeof F=="object"&&F&&F.__esModule)return F;var m=Object.create(null);if(K.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:F}),2&G&&typeof F!="string")for(var r in F)K.d(m,r,function(c){return F[c]}.bind(null,r));return m},K.n=function(F){var G=F&&F.__esModule?function(){return F.default}:function(){return F};return K.d(G,"a",G),G},K.o=function(F,G){return Object.prototype.hasOwnProperty.call(F,G)},K.p="",K(K.s=0)}([function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F,G=K(1),m=(F=G)&&F.__esModule?F:{default:F};I.default={name:"playbackRate",method:function(){m.default.method.call(this)}},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F,G=K(2),m=K(4),r=(F=m)&&F.__esModule?F:{default:F};K(5),I.default={name:"s_playbackRate",method:function(){var c=this,l=[];if(!c.config.playbackRate)return!1;(l=[].concat(c.config.playbackRate)).sort(function(v,y){return y-v});var e=c.config.playbackRateUnit!==void 0?c.config.playbackRateUnit:"x",n=(0,G.createDom)("xg-playbackrate"," ",{},"xgplayer-playbackrate");r.default.device==="mobile"&&(c.config.playbackRateActive="click");var a=[];l.forEach(function(v){a.push({name:""+v,rate:""+v+e,selected:!1})});var s=1,u=["<ul>"];a.forEach(function(v){c.config.defaultPlaybackRate&&c.config.defaultPlaybackRate.toString()===v.name?(v.selected=!0,s=c.config.defaultPlaybackRate,c.once("playing",function(){c.video.playbackRate=c.config.defaultPlaybackRate})):v.name!=="1.0"&&v.name!=="1"||c.config.defaultPlaybackRate&&c.config.defaultPlaybackRate!==1||(v.selected=!0),u.push("<li cname='"+v.name+"' class='"+(v.selected?"selected":"")+"'>"+v.rate+"</li>")}),u.push("</ul><p class='name'>"+s+e+"</p>");var t=c.root.querySelector(".xgplayer-playbackrate");if(t){t.innerHTML=u.join("");var f=t.querySelector(".name");c.config.playbackRateActive&&c.config.playbackRateActive!=="hover"||f.addEventListener("mouseenter",function(v){v.preventDefault(),v.stopPropagation(),(0,G.addClass)(c.root,"xgplayer-playbackrate-active"),t.focus()})}else{n.innerHTML=u.join("");var h=n.querySelector(".name");c.config.playbackRateActive&&c.config.playbackRateActive!=="hover"||h.addEventListener("mouseenter",function(v){v.preventDefault(),v.stopPropagation(),(0,G.addClass)(c.root,"xgplayer-playbackrate-active"),n.focus()}),c.once("ready",function(){c.controls.appendChild(n)})}["touchend","click"].forEach(function(v){n.addEventListener(v,function(y){y.stopPropagation(),y.preventDefault();var p=y.target;if(p&&p.tagName.toLocaleLowerCase()==="li"){var g,d=void 0;a.forEach(function(E){E.selected=!1,p.textContent.replace(/\s+/g,"")===E.rate&&(Array.prototype.forEach.call(p.parentNode.childNodes,function(w){(0,G.hasClass)(w,"selected")&&(d=Number(w.getAttribute("cname")),(0,G.removeClass)(w,"selected"))}),E.selected=!0,c.video.playbackRate=1*E.name,s=1*E.name)}),(0,G.addClass)(p,"selected"),g=Number(p.getAttribute("cname")),p.parentNode.nextSibling.innerHTML=""+p.getAttribute("cname")+e,c.emit("playbackrateChange",{from:d,to:g}),r.default.device==="mobile"&&(0,G.removeClass)(c.root,"xgplayer-playbackrate-active")}else c.config.playbackRateActive!=="click"||!p||p.tagName.toLocaleLowerCase()!=="p"&&p.tagName.toLocaleLowerCase()!=="span"||(r.default.device==="mobile"?(0,G.toggleClass)(c.root,"xgplayer-playbackrate-active"):(0,G.addClass)(c.root,"xgplayer-playbackrate-active"),n.focus());c.emit("focus")},!1)}),n.addEventListener("mouseleave",function(v){v.preventDefault(),v.stopPropagation(),(0,G.removeClass)(c.root,"xgplayer-playbackrate-active")}),c.on("blur",function(){(0,G.removeClass)(c.root,"xgplayer-playbackrate-active")}),c.on("play",function(){c.video.playbackRate.toFixed(1)!==s.toFixed(1)&&(c.video.playbackRate=s)}),c.switchPlaybackRate=function(){for(var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=c.controls.querySelectorAll(".xgplayer-playbackrate ul li"),p=0;p<y.length;p++)(0,G.hasClass)(y[p],"selected")||y[p].getAttribute("cname")!==""+v.playbackRate&&p!==v.index||y[p].click()},c.on("ratechange",function(){c.switchPlaybackRate({playbackRate:c.playbackRate})})}},X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0}),I.util=I.PresentationMode=void 0,I.createDom=r,I.hasClass=c,I.addClass=l,I.removeClass=e,I.toggleClass=n,I.findDom=a,I.padStart=s,I.format=u,I.event=t,I.typeOf=f,I.deepCopy=h,I.getBgImage=v,I.copyDom=y,I._setInterval=p,I._clearInterval=g,I.createImgBtn=d,I.isWeiXin=E,I.isUc=w,I.computeWatchDur=D,I.offInDestroy=b,I.on=S,I.once=C,I.getBuffered2=P,I.checkIsBrowser=R,I.setStyle=L,I.checkWebkitSetPresentationMode=function(O){return typeof O.webkitSetPresentationMode=="function"};var F,G=K(3),m=(F=G)&&F.__esModule?F:{default:F};function r(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",k=document.createElement(O);return k.className=A,k.innerHTML=_,Object.keys(x).forEach(function(M){var N=M,U=x[M];O==="video"||O==="audio"?U&&k.setAttribute(N,U):k.setAttribute(N,U)}),k}function c(O,_){return!!O&&(O.classList?Array.prototype.some.call(O.classList,function(x){return x===_}):!!O.className&&!!O.className.match(new RegExp("(\\s|^)"+_+"(\\s|$)")))}function l(O,_){O&&(O.classList?_.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(x){x&&O.classList.add(x)}):c(O,_)||(O.className+=" "+_))}function e(O,_){O&&(O.classList?_.split(/\s+/g).forEach(function(x){O.classList.remove(x)}):c(O,_)&&_.split(/\s+/g).forEach(function(x){var A=new RegExp("(\\s|^)"+x+"(\\s|$)");O.className=O.className.replace(A," ")}))}function n(O,_){O&&_.split(/\s+/g).forEach(function(x){c(O,x)?e(O,x):l(O,x)})}function a(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,_=arguments[1],x=void 0;try{x=O.querySelector(_)}catch{_.indexOf("#")===0&&(x=O.getElementById(_.slice(1)))}return x}function s(O,_,x){for(var A=String(x),k=_>>0,M=Math.ceil(k/A.length),N=[],U=String(O);M--;)N.push(A);return N.join("").substring(0,k-U.length)+U}function u(O){if(window.isNaN(O))return"";var _=s(Math.floor(O/3600),2,0),x=s(Math.floor((O-3600*_)/60),2,0),A=s(Math.floor(O-3600*_-60*x),2,0);return(_==="00"?[x,A]:[_,x,A]).join(":")}function t(O){if(O.touches){var _=O.touches[0]||O.changedTouches[0];O.clientX=_.clientX||0,O.clientY=_.clientY||0,O.offsetX=_.pageX-_.target.offsetLeft,O.offsetY=_.pageY-_.target.offsetTop}O._target=O.target||O.srcElement}function f(O){return Object.prototype.toString.call(O).match(/([^\s.*]+)(?=]$)/g)[0]}function h(O,_){if(f(_)==="Object"&&f(O)==="Object")return Object.keys(_).forEach(function(x){f(_[x])!=="Object"||_[x]instanceof Node?f(_[x])==="Array"?O[x]=f(O[x])==="Array"?O[x].concat(_[x]):_[x]:O[x]=_[x]:O[x]?h(O[x],_[x]):O[x]=_[x]}),O}function v(O){var _=(O.currentStyle||window.getComputedStyle(O,null)).backgroundImage;if(!_||_==="none")return"";var x=document.createElement("a");return x.href=_.replace(/url\("|"\)/g,""),x.href}function y(O){if(O&&O.nodeType===1){var _=document.createElement(O.tagName);return Array.prototype.forEach.call(O.attributes,function(x){_.setAttribute(x.name,x.value)}),O.innerHTML&&(_.innerHTML=O.innerHTML),_}return""}function p(O,_,x,A){O._interval[_]||(O._interval[_]=setInterval(x.bind(O),A))}function g(O,_){clearInterval(O._interval[_]),O._interval[_]=null}function d(O,_,x,A){var k=r("xg-"+O,"",{},"xgplayer-"+O+"-img");if(k.style.backgroundImage='url("'+_+'")',x&&A){var M=void 0,N=void 0,U=void 0;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(j){return!(x.indexOf(j)>-1&&A.indexOf(j)>-1)||(M=Number(x.slice(0,x.indexOf(j)).trim()),N=Number(A.slice(0,A.indexOf(j)).trim()),U=j,!1)}),k.style.width=""+M+U,k.style.height=""+N+U,k.style.backgroundSize=""+M+U+" "+N+U,k.style.margin=O==="start"?"-"+N/2+U+" auto auto -"+M/2+U:"auto 5px auto 5px"}return k}function E(){return window.navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1}function w(){return window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")>-1}function D(){for(var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_=[],x=0;x<O.length;x++)if(!(!O[x].end||O[x].begin<0||O[x].end<0||O[x].end<O[x].begin))if(_.length<1)_.push({begin:O[x].begin,end:O[x].end});else for(var A=0;A<_.length;A++){var k=O[x].begin,M=O[x].end;if(M<_[A].begin){_.splice(A,0,{begin:k,end:M});break}if(!(k>_[A].end)){var N=_[A].begin,U=_[A].end;_[A].begin=Math.min(k,N),_[A].end=Math.max(M,U);break}if(A>_.length-2){_.push({begin:k,end:M});break}}for(var j=0,z=0;z<_.length;z++)j+=_[z].end-_[z].begin;return j}function b(O,_,x,A){O.once(A,function k(){O.off(_,x),O.off(A,k)})}function S(O,_,x,A){A?(O.on(_,x),b(O,_,x,A)):O.on(_,function k(M){x(M),O.off(_,k)})}function C(O,_,x,A){A?(O.once(_,x),b(O,_,x,A)):O.once(_,function k(M){x(M),O.off(_,k)})}function P(O){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,x=[],A=0;A<O.length;A++)x.push({start:O.start(A)<.5?0:O.start(A),end:O.end(A)});x.sort(function(j,z){var J=j.start-z.start;return J||z.end-j.end});var k=[];if(_)for(var M=0;M<x.length;M++){var N=k.length;if(N){var U=k[N-1].end;x[M].start-U<_?x[M].end>U&&(k[N-1].end=x[M].end):k.push(x[M])}else k.push(x[M])}else k=x;return new m.default(k)}function R(){return!(typeof window=="undefined"||window.document===void 0||window.document.createElement===void 0)}function L(O,_,x){var A=O.style;try{A[_]=x}catch{A.setProperty(_,x)}}I.PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},I.util={createDom:r,hasClass:c,addClass:l,removeClass:e,toggleClass:n,findDom:a,padStart:s,format:u,event:t,typeOf:f,deepCopy:h,getBgImage:v,copyDom:y,setInterval:p,clearInterval:g,createImgBtn:d,isWeiXin:E,isUc:w,computeWatchDur:D,offInDestroy:b,on:S,once:C,getBuffered2:P,checkIsBrowser:R,setStyle:L}},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F=function(){function m(r,c){for(var l=0;l<c.length;l++){var e=c[l];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(r,c,l){return c&&m(r.prototype,c),l&&m(r,l),r}}(),G=function(){function m(r){(function(c,l){if(!(c instanceof l))throw new TypeError("Cannot call a class as a function")})(this,m),this.bufferedList=r}return F(m,[{key:"start",value:function(r){return this.bufferedList[r].start}},{key:"end",value:function(r){return this.bufferedList[r].end}},{key:"length",get:function(){return this.bufferedList.length}}]),m}();I.default=G,X.exports=I.default},function(X,I,K){Object.defineProperty(I,"__esModule",{value:!0});var F={};Object.defineProperty(F,"device",{get:function(){return F.os.isPc?"pc":"mobile"}}),Object.defineProperty(F,"browser",{get:function(){var G=navigator.userAgent.toLowerCase(),m={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(m).filter(function(r){return m[r].test(G)}))[0]||""}}),Object.defineProperty(F,"os",{get:function(){var G=navigator.userAgent,m=/(?:Windows Phone)/.test(G),r=/(?:SymbianOS)/.test(G)||m,c=/(?:Android)/.test(G),l=/(?:Firefox)/.test(G),e=/(?:iPad|PlayBook)/.test(G)||c&&!/(?:Mobile)/.test(G)||l&&/(?:Tablet)/.test(G),n=/(?:iPhone)/.test(G)&&!e;return{isTablet:e,isPhone:n,isAndroid:c,isPc:!(n||c||r||e),isSymbian:r,isWindowsPhone:m,isFireFox:l}}}),I.default=F,X.exports=I.default},function(X,I,K){var F=K(6);typeof F=="string"&&(F=[[X.i,F,""]]);var G={hmr:!0,transform:void 0,insertInto:void 0};K(8)(F,G),F.locals&&(X.exports=F.locals)},function(X,I,K){(X.exports=K(7)(!1)).push([X.i,".xgplayer-skin-default .xgplayer-playbackrate{-webkit-order:8;-moz-box-ordinal-group:9;order:8;width:60px;height:150px;z-index:18;position:relative;display:inline-block;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-playbackrate ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);text-align:left;white-space:nowrap;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-playbackrate ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);position:relative;padding:4px 0;text-align:center}.xgplayer-skin-default .xgplayer-playbackrate ul li.selected,.xgplayer-skin-default .xgplayer-playbackrate ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-playbackrate ul li:first-child{position:relative;margin-top:12px}.xgplayer-skin-default .xgplayer-playbackrate ul li:last-child{position:relative;margin-bottom:12px}.xgplayer-skin-default .xgplayer-playbackrate .name{width:60px;height:20px;position:absolute;bottom:0;text-align:center;font-family:PingFangSC-Regular;font-size:13px;background:rgba(0,0,0,.38);color:hsla(0,0%,100%,.8);border-radius:10px;line-height:20px}.xgplayer-skin-default .xgplayer-playbackrate span{position:relative;top:19px;font-weight:700;text-shadow:0 0 4px rgba(0,0,0,.6)}.xgplayer-skin-default .xgplayer-playbackrate:hover{opacity:1}.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-playbackrate ul{display:block}",""])},function(X,I){X.exports=function(K){var F=[];return F.toString=function(){return this.map(function(G){var m=function(r,c){var l=r[1]||"",e=r[3];if(!e)return l;if(c&&typeof btoa=="function"){var n=(s=e,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=e.sources.map(function(u){return"/*# downloadUrl="+e.sourceRoot+u+" */"});return[l].concat(a).concat([n]).join(`
`)}var s;return[l].join(`
`)}(G,K);return G[2]?"@media "+G[2]+"{"+m+"}":m}).join("")},F.i=function(G,m){typeof G=="string"&&(G=[[null,G,""]]);for(var r={},c=0;c<this.length;c++){var l=this[c][0];typeof l=="number"&&(r[l]=!0)}for(c=0;c<G.length;c++){var e=G[c];typeof e[0]=="number"&&r[e[0]]||(m&&!e[2]?e[2]=m:m&&(e[2]="("+e[2]+") and ("+m+")"),F.push(e))}},F}},function(X,I,K){var F,G,m={},r=(F=function(){return window&&document&&document.all&&!window.atob},function(){return G===void 0&&(G=F.apply(this,arguments)),G}),c=function(b){return document.querySelector(b)},l=function(b){var S={};return function(C){if(typeof C=="function")return C();if(S[C]===void 0){var P=c.call(this,C);if(window.HTMLIFrameElement&&P instanceof window.HTMLIFrameElement)try{P=P.contentDocument.head}catch{P=null}S[C]=P}return S[C]}}(),e=null,n=0,a=[],s=K(9);function u(b,S){for(var C=0;C<b.length;C++){var P=b[C],R=m[P.id];if(R){R.refs++;for(var L=0;L<R.parts.length;L++)R.parts[L](P.parts[L]);for(;L<P.parts.length;L++)R.parts.push(p(P.parts[L],S))}else{var O=[];for(L=0;L<P.parts.length;L++)O.push(p(P.parts[L],S));m[P.id]={id:P.id,refs:1,parts:O}}}}function t(b,S){for(var C=[],P={},R=0;R<b.length;R++){var L=b[R],O=S.base?L[0]+S.base:L[0],_={css:L[1],media:L[2],sourceMap:L[3]};P[O]?P[O].parts.push(_):C.push(P[O]={id:O,parts:[_]})}return C}function f(b,S){var C=l(b.insertInto);if(!C)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var P=a[a.length-1];if(b.insertAt==="top")P?P.nextSibling?C.insertBefore(S,P.nextSibling):C.appendChild(S):C.insertBefore(S,C.firstChild),a.push(S);else if(b.insertAt==="bottom")C.appendChild(S);else{if(typeof b.insertAt!="object"||!b.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var R=l(b.insertInto+" "+b.insertAt.before);C.insertBefore(S,R)}}function h(b){if(b.parentNode===null)return!1;b.parentNode.removeChild(b);var S=a.indexOf(b);S>=0&&a.splice(S,1)}function v(b){var S=document.createElement("style");return b.attrs.type="text/css",y(S,b.attrs),f(b,S),S}function y(b,S){Object.keys(S).forEach(function(C){b.setAttribute(C,S[C])})}function p(b,S){var C,P,R,L;if(S.transform&&b.css){if(!(L=S.transform(b.css)))return function(){};b.css=L}if(S.singleton){var O=n++;C=e||(e=v(S)),P=E.bind(null,C,O,!1),R=E.bind(null,C,O,!0)}else b.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(C=function(_){var x=document.createElement("link");return _.attrs.type="text/css",_.attrs.rel="stylesheet",y(x,_.attrs),f(_,x),x}(S),P=D.bind(null,C,S),R=function(){h(C),C.href&&URL.revokeObjectURL(C.href)}):(C=v(S),P=w.bind(null,C),R=function(){h(C)});return P(b),function(_){if(_){if(_.css===b.css&&_.media===b.media&&_.sourceMap===b.sourceMap)return;P(b=_)}else R()}}X.exports=function(b,S){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(S=S||{}).attrs=typeof S.attrs=="object"?S.attrs:{},S.singleton||typeof S.singleton=="boolean"||(S.singleton=r()),S.insertInto||(S.insertInto="head"),S.insertAt||(S.insertAt="bottom");var C=t(b,S);return u(C,S),function(P){for(var R=[],L=0;L<C.length;L++){var O=C[L];(_=m[O.id]).refs--,R.push(_)}for(P&&u(t(P,S),S),L=0;L<R.length;L++){var _;if((_=R[L]).refs===0){for(var x=0;x<_.parts.length;x++)_.parts[x]();delete m[_.id]}}}};var g,d=(g=[],function(b,S){return g[b]=S,g.filter(Boolean).join(`
`)});function E(b,S,C,P){var R=C?"":P.css;if(b.styleSheet)b.styleSheet.cssText=d(S,R);else{var L=document.createTextNode(R),O=b.childNodes;O[S]&&b.removeChild(O[S]),O.length?b.insertBefore(L,O[S]):b.appendChild(L)}}function w(b,S){var C=S.css,P=S.media;if(P&&b.setAttribute("media",P),b.styleSheet)b.styleSheet.cssText=C;else{for(;b.firstChild;)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(C))}}function D(b,S,C){var P=C.css,R=C.sourceMap,L=S.convertToAbsoluteUrls===void 0&&R;(S.convertToAbsoluteUrls||L)&&(P=s(P)),R&&(P+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(R))))+" */");var O=new Blob([P],{type:"text/css"}),_=b.href;b.href=URL.createObjectURL(O),_&&URL.revokeObjectURL(_)}},function(X,I){X.exports=function(K){var F=typeof window!="undefined"&&window.location;if(!F)throw new Error("fixUrls requires window.location");if(!K||typeof K!="string")return K;var G=F.protocol+"//"+F.host,m=G+F.pathname.replace(/\/[^\/]*$/,"/");return K.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(r,c){var l,e=c.trim().replace(/^"(.*)"$/,function(n,a){return a}).replace(/^'(.*)'$/,function(n,a){return a});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(e)?r:(l=e.indexOf("//")===0?e:e.indexOf("/")===0?G+e:m+e.replace(/^\.\//,""),"url("+JSON.stringify(l)+")")})}}])})})(playbackRate);var dist$1={exports:{}};(function(be,H){(function(I,K){be.exports=K(dist$2.exports)})(window,function(X){return function(I){var K={};function F(G){if(K[G])return K[G].exports;var m=K[G]={i:G,l:!1,exports:{}};return I[G].call(m.exports,m,m.exports,F),m.l=!0,m.exports}return F.m=I,F.c=K,F.d=function(G,m,r){F.o(G,m)||Object.defineProperty(G,m,{enumerable:!0,get:r})},F.r=function(G){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(G,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(G,"__esModule",{value:!0})},F.t=function(G,m){if(m&1&&(G=F(G)),m&8||m&4&&typeof G=="object"&&G&&G.__esModule)return G;var r=Object.create(null);if(F.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:G}),m&2&&typeof G!="string")for(var c in G)F.d(r,c,function(l){return G[l]}.bind(null,c));return r},F.n=function(G){var m=G&&G.__esModule?function(){return G.default}:function(){return G};return F.d(m,"a",m),m},F.o=function(G,m){return Object.prototype.hasOwnProperty.call(G,m)},F.p="",F(F.s=0)}([function(I,K,F){I.exports=F(1)},function(I,K,F){Object.defineProperty(K,"__esModule",{value:!0});var G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},m=function(){function y(p,g){for(var d=0;d<g.length;d++){var E=g[d];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(p,E.key,E)}}return function(p,g,d){return g&&y(p.prototype,g),d&&y(p,d),p}}(),r=function y(p,g,d){p===null&&(p=Function.prototype);var E=Object.getOwnPropertyDescriptor(p,g);if(E===void 0){var w=Object.getPrototypeOf(p);return w===null?void 0:y(w,g,d)}else{if("value"in E)return E.value;var D=E.get;return D===void 0?void 0:D.call(d)}},c=F(2),l=u(c),e=F(3),n=u(e),a=F(4),s=u(a);function u(y){return y&&y.__esModule?y:{default:y}}function t(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")}function f(y,p){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:y}function h(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(y,p):y.__proto__=p)}var v=function(y){h(p,y);function p(g){t(this,p);var d=f(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,g));d.hlsOpts=g.hlsOpts||{},d.hlsOpts.mediaType=d.config.mediaType;var E=l.default.util,w=d;if(w.once("complete",function(){if(w.config.isLive&&(E.addClass(w.root,"xgplayer-is-live"),!E.findDom(w.controls,".xgplayer-live"))){var b=E.createDom("xg-live",w.lang.LIVE||"\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");w.controls.appendChild(b)}}),d.browser=s.default.getBrowserVersion(),w.config.useHls===void 0){if(l.default.sniffer.device==="mobile"&&navigator.platform!=="MacIntel"&&navigator.platform!=="Win32"||d.browser.indexOf("Safari")>-1)return f(d)}else if(!w.config.useHls)return f(d);d._start=d.start,d.start=function(){window.XgVideoProxy||d.root.insertBefore(d.video,d.root.firstChild),setTimeout(function(){d.emit("complete"),d.danmu&&typeof d.danmu.resize=="function"&&d.danmu.resize()},1)},Number.isFinite=Number.isFinite||function(b){return typeof b=="number"&&isFinite(b)};var D=void 0;return D=new n.default(d.hlsOpts),d.hls=D,Object.defineProperty(w,"src",{get:function(){return w.currentSrc},set:function(S){E.removeClass(w.root,"xgplayer-is-live");var C=document.querySelector(".xgplayer-live");C&&C.parentNode.removeChild(C),w.autoplay=!0;var P=w.paused;P||w.pause(),w.hls.stopLoad(),w.hls.detachMedia(),w.hls.destroy(),w.hls=new n.default(w.hlsOpts),w.register(S),w.once("canplay",function(){w.play().catch(function(R){})}),w.hls.loadSource(S),w.hls.attachMedia(w.video)},configurable:!0}),d.register(d.config.url),d.once("complete",function(){D.attachMedia(w.video),w.config.videoInit||w.once("canplay",function(){w.play().catch(function(b){})})}),d.once("destroy",function(){D.stopLoad()}),d}return m(p,[{key:"switchURL",value:function(d){var E=this;E.url=d,E.config.url=d;var w=E.currentTime;l.default.util.addClass(E.root,"xgplayer-is-enter"),E.once("playing",function(){l.default.util.removeClass(E.root,"xgplayer-is-enter")}),E.once("canplay",function(){E.currentTime=w,E.play()}),G(E.hls)==="object"&&(E.hls.originUrl=d),E.src=d}},{key:"register",value:function(d){var E=this.hls,w=l.default.util,D=this;E.on(n.default.Events.MEDIA_ATTACHED,function(){E.loadSource(d)}),E.on(n.default.Events.LEVEL_LOADED,function(b,S){if(!E.inited&&(E.inited=!0,S&&S.details&&S.details.live&&(w.addClass(D.root,"xgplayer-is-live"),!w.findDom(D.root,".xgplayer-live")))){var C=w.createDom("xg-live",D.lang.LIVE||"\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");D.controls.appendChild(C)}}),E.on(n.default.Events.ERROR,function(b,S){if(D.emit("HLS_ERROR",{errorType:S.type,errorDetails:S.details,errorFatal:S.fatal}),S.fatal)switch(S.type){case n.default.ErrorTypes.NETWORK_ERROR:E.startLoad();break;case n.default.ErrorTypes.MEDIA_ERROR:E.recoverMediaError();break;default:D.emit("error",S)}}),this._statistics()}},{key:"_statistics",value:function(){var d={speed:0,playerType:"HlsPlayer"},E={videoDataRate:0,audioDataRate:0},w=this.hls,D=this;w.on(n.default.Events.FRAG_LOAD_PROGRESS,function(b,S){d.speed=S.stats.loaded/1e3}),w.on(n.default.Events.FRAG_PARSING_DATA,function(b,S){S.type==="video"&&(E.fps=parseInt(S.nb/(S.endPTS-S.startPTS)))}),w.on(n.default.Events.FRAG_PARSING_INIT_SEGMENT,function(b,S){if(E.hasAudio=!!(S&&S.tracks&&S.tracks.audio),E.hasVideo=!!(S&&S.tracks&&S.tracks.video),E.hasAudio&&S.tracks.audio){var C=S.tracks.audio;E.audioChannelCount=C.metadata&&C.metadata.channelCount?C.metadata.channelCount:0,E.audioCodec=C.codec}if(E.hasVideo&&S.tracks.video){var P=S.tracks.video;E.videoCodec=P.codec,E.width=P.metadata&&P.metadata.width?P.metadata.width:0,E.height=P.metadata&&P.metadata.height?P.metadata.height:0}E.duration=S.frag&&S.frag.duration?S.frag.duration:0,E.level=S.frag&&S.frag.level?S.frag.level:0,(E.videoCodec||E.audioCodec)&&(E.mimeType='video/hls; codecs="'+E.videoCodec+";"+E.audioCodec+'"'),D.mediainfo=E,D.emit("media_info",E)}),this._statisticsTimmer=setInterval(function(){D.emit("statistics_info",d),d.speed=0},1e3)}},{key:"destroy",value:function(){r(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"destroy",this).call(this),clearInterval(this._statisticsTimmer)}}]),p}(l.default);v.isSupported=n.default.isSupported,v.HlsJs=n.default,K.default=v,I.exports=K.default},function(I,K){I.exports=X},function(I,K,F){typeof window!="undefined"&&function(m,r){I.exports=r()}(this,function(){return function(G){var m={};function r(c){if(m[c])return m[c].exports;var l=m[c]={i:c,l:!1,exports:{}};return G[c].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=G,r.c=m,r.d=function(c,l,e){r.o(c,l)||Object.defineProperty(c,l,{enumerable:!0,get:e})},r.r=function(c){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},r.t=function(c,l){if(l&1&&(c=r(c)),l&8||l&4&&typeof c=="object"&&c&&c.__esModule)return c;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:c}),l&2&&typeof c!="string")for(var n in c)r.d(e,n,function(a){return c[a]}.bind(null,n));return e},r.n=function(c){var l=c&&c.__esModule?function(){return c.default}:function(){return c};return r.d(l,"a",l),l},r.o=function(c,l){return Object.prototype.hasOwnProperty.call(c,l)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(G,m,r){var c=Object.prototype.hasOwnProperty,l="~";function e(){}Object.create&&(e.prototype=Object.create(null),new e().__proto__||(l=!1));function n(t,f,h){this.fn=t,this.context=f,this.once=h||!1}function a(t,f,h,v,y){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new n(h,v||t,y),g=l?l+f:f;return t._events[g]?t._events[g].fn?t._events[g]=[t._events[g],p]:t._events[g].push(p):(t._events[g]=p,t._eventsCount++),t}function s(t,f){--t._eventsCount==0?t._events=new e:delete t._events[f]}function u(){this._events=new e,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,v;if(this._eventsCount===0)return f;for(v in h=this._events)c.call(h,v)&&f.push(l?v.slice(1):v);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=l?l+f:f,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var y=0,p=v.length,g=new Array(p);y<p;y++)g[y]=v[y].fn;return g},u.prototype.listenerCount=function(f){var h=l?l+f:f,v=this._events[h];return v?v.fn?1:v.length:0},u.prototype.emit=function(f,h,v,y,p,g){var d=l?l+f:f;if(!this._events[d])return!1;var E=this._events[d],w=arguments.length,D,b;if(E.fn){switch(E.once&&this.removeListener(f,E.fn,void 0,!0),w){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,h),!0;case 3:return E.fn.call(E.context,h,v),!0;case 4:return E.fn.call(E.context,h,v,y),!0;case 5:return E.fn.call(E.context,h,v,y,p),!0;case 6:return E.fn.call(E.context,h,v,y,p,g),!0}for(b=1,D=new Array(w-1);b<w;b++)D[b-1]=arguments[b];E.fn.apply(E.context,D)}else{var S=E.length,C;for(b=0;b<S;b++)switch(E[b].once&&this.removeListener(f,E[b].fn,void 0,!0),w){case 1:E[b].fn.call(E[b].context);break;case 2:E[b].fn.call(E[b].context,h);break;case 3:E[b].fn.call(E[b].context,h,v);break;case 4:E[b].fn.call(E[b].context,h,v,y);break;default:if(!D)for(C=1,D=new Array(w-1);C<w;C++)D[C-1]=arguments[C];E[b].fn.apply(E[b].context,D)}}return!0},u.prototype.on=function(f,h,v){return a(this,f,h,v,!1)},u.prototype.once=function(f,h,v){return a(this,f,h,v,!0)},u.prototype.removeListener=function(f,h,v,y){var p=l?l+f:f;if(!this._events[p])return this;if(!h)return s(this,p),this;var g=this._events[p];if(g.fn)g.fn===h&&(!y||g.once)&&(!v||g.context===v)&&s(this,p);else{for(var d=0,E=[],w=g.length;d<w;d++)(g[d].fn!==h||y&&!g[d].once||v&&g[d].context!==v)&&E.push(g[d]);E.length?this._events[p]=E.length===1?E[0]:E:s(this,p)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=l?l+f:f,this._events[h]&&s(this,h)):(this._events=new e,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=l,u.EventEmitter=u,G.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(G,m,r){(function(c){var l=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,e=/^([^\/?#]*)([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(u,t,f){if(f=f||{},u=u.trim(),t=t.trim(),!t){if(!f.alwaysNormalize)return u;var h=s.parseURL(u);if(!h)throw new Error("Error trying to parse base URL.");return h.path=s.normalizePath(h.path),s.buildURLFromParts(h)}var v=s.parseURL(t);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return f.alwaysNormalize?(v.path=s.normalizePath(v.path),s.buildURLFromParts(v)):t;var y=s.parseURL(u);if(!y)throw new Error("Error trying to parse base URL.");if(!y.netLoc&&y.path&&y.path[0]!=="/"){var p=e.exec(y.path);y.netLoc=p[1],y.path=p[2]}y.netLoc&&!y.path&&(y.path="/");var g={scheme:y.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(g.netLoc=y.netLoc,v.path[0]!=="/"))if(!v.path)g.path=y.path,v.params||(g.params=y.params,v.query||(g.query=y.query));else{var d=y.path,E=d.substring(0,d.lastIndexOf("/")+1)+v.path;g.path=s.normalizePath(E)}return g.path===null&&(g.path=f.alwaysNormalize?s.normalizePath(v.path):v.path),s.buildURLFromParts(g)},parseURL:function(u){var t=l.exec(u);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(n,"");u.length!==(u=u.replace(a,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};G.exports=s})()},"./node_modules/webworkify-webpack/index.js":function(G,m,r){function c(f){var h={};function v(p){if(h[p])return h[p].exports;var g=h[p]={i:p,l:!1,exports:{}};return f[p].call(g.exports,g,g.exports,v),g.l=!0,g.exports}v.m=f,v.c=h,v.i=function(p){return p},v.d=function(p,g,d){v.o(p,g)||Object.defineProperty(p,g,{configurable:!1,enumerable:!0,get:d})},v.r=function(p){Object.defineProperty(p,"__esModule",{value:!0})},v.n=function(p){var g=p&&p.__esModule?function(){return p.default}:function(){return p};return v.d(g,"a",g),g},v.o=function(p,g){return Object.prototype.hasOwnProperty.call(p,g)},v.p="/",v.oe=function(p){throw console.error(p),p};var y=v(v.s=ENTRY_MODULE);return y.default||y}var l="[\\.|\\-|\\+|\\w|/|@]+",e="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+l+").*?\\)";function n(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(f){return!isNaN(1*f)}function s(f,h,v){var y={};y[v]=[];var p=h.toString(),g=p.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!g)return y;for(var d=g[1],E=new RegExp("(\\\\n|\\W)"+n(d)+e,"g"),w;w=E.exec(p);)w[3]!=="dll-reference"&&y[v].push(w[3]);for(E=new RegExp("\\("+n(d)+'\\("(dll-reference\\s('+l+'))"\\)\\)'+e,"g");w=E.exec(p);)f[w[2]]||(y[v].push(w[1]),f[w[2]]=r(w[1]).m),y[w[2]]=y[w[2]]||[],y[w[2]].push(w[4]);for(var D=Object.keys(y),b=0;b<D.length;b++)for(var S=0;S<y[D[b]].length;S++)a(y[D[b]][S])&&(y[D[b]][S]=1*y[D[b]][S]);return y}function u(f){var h=Object.keys(f);return h.reduce(function(v,y){return v||f[y].length>0},!1)}function t(f,h){for(var v={main:[h]},y={main:[]},p={main:{}};u(v);)for(var g=Object.keys(v),d=0;d<g.length;d++){var E=g[d],w=v[E],D=w.pop();if(p[E]=p[E]||{},!(p[E][D]||!f[E][D])){p[E][D]=!0,y[E]=y[E]||[],y[E].push(D);for(var b=s(f,f[E][D],E),S=Object.keys(b),C=0;C<S.length;C++)v[S[C]]=v[S[C]]||[],v[S[C]]=v[S[C]].concat(b[S[C]])}}return y}G.exports=function(f,h){h=h||{};var v={main:r.m},y=h.all?{main:Object.keys(v.main)}:t(v,f),p="";Object.keys(y).filter(function(D){return D!=="main"}).forEach(function(D){for(var b=0;y[D][b];)b++;y[D].push(b),v[D][b]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",p=p+"var "+D+" = ("+c.toString().replace("ENTRY_MODULE",JSON.stringify(b))+")({"+y[D].map(function(S){return""+JSON.stringify(S)+": "+v[D][S].toString()}).join(",")+`});
`}),p=p+"new (("+c.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+y.main.map(function(D){return""+JSON.stringify(D)+": "+v.main[D].toString()}).join(",")+"}))(self);";var g=new window.Blob([p],{type:"text/javascript"});if(h.bare)return g;var d=window.URL||window.webkitURL||window.mozURL||window.msURL,E=d.createObjectURL(g),w=new window.Worker(E);return w.objectURL=E,w}},"./src/config.ts":function(G,m,r){r.r(m),r.d(m,"hlsDefaultConfig",function(){return C}),r.d(m,"mergeConfig",function(){return R}),r.d(m,"enableStreamingMode",function(){return L});var c=r("./src/controller/abr-controller.ts"),l=r("./src/controller/audio-stream-controller.ts"),e=r("./src/controller/audio-track-controller.ts"),n=r("./src/controller/subtitle-stream-controller.ts"),a=r("./src/controller/subtitle-track-controller.ts"),s=r("./src/controller/buffer-controller.ts"),u=r("./src/controller/timeline-controller.ts"),t=r("./src/controller/cap-level-controller.ts"),f=r("./src/controller/fps-controller.ts"),h=r("./src/controller/eme-controller.ts"),v=r("./src/controller/cmcd-controller.ts"),y=r("./src/utils/xhr-loader.ts"),p=r("./src/utils/fetch-loader.ts"),g=r("./src/utils/cues.ts"),d=r("./src/utils/mediakeys-helper.ts"),E=r("./src/utils/logger.ts");function w(){return w=Object.assign||function(O){for(var _=1;_<arguments.length;_++){var x=arguments[_];for(var A in x)Object.prototype.hasOwnProperty.call(x,A)&&(O[A]=x[A])}return O},w.apply(this,arguments)}function D(O,_){var x=Object.keys(O);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(O);_&&(A=A.filter(function(k){return Object.getOwnPropertyDescriptor(O,k).enumerable})),x.push.apply(x,A)}return x}function b(O){for(var _=1;_<arguments.length;_++){var x=arguments[_]!=null?arguments[_]:{};_%2?D(Object(x),!0).forEach(function(A){S(O,A,x[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(x)):D(Object(x)).forEach(function(A){Object.defineProperty(O,A,Object.getOwnPropertyDescriptor(x,A))})}return O}function S(O,_,x){return _ in O?Object.defineProperty(O,_,{value:x,enumerable:!0,configurable:!0,writable:!0}):O[_]=x,O}var C=b(b({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:y.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:c.default,bufferController:s.default,capLevelController:t.default,fpsController:f.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:d.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},P()),{},{subtitleStreamController:n.SubtitleStreamController,subtitleTrackController:a.default,timelineController:u.TimelineController,audioStreamController:l.default,audioTrackController:e.default,emeController:h.default,cmcdController:v.default});function P(){return{cueHandler:g.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function R(O,_){if((_.liveSyncDurationCount||_.liveMaxLatencyDurationCount)&&(_.liveSyncDuration||_.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(_.liveMaxLatencyDurationCount!==void 0&&(_.liveSyncDurationCount===void 0||_.liveMaxLatencyDurationCount<=_.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(_.liveMaxLatencyDuration!==void 0&&(_.liveSyncDuration===void 0||_.liveMaxLatencyDuration<=_.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return w({},O,_)}function L(O){var _=O.loader;if(_!==p.default&&_!==y.default)E.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),O.progressive=!1;else{var x=Object(p.fetchSupported)();x&&(O.loader=p.default,O.progressive=!0,O.enableSoftwareAES=!0,E.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(G,m,r){r.r(m);var c=r("./src/polyfills/number.ts"),l=r("./src/utils/ewma-bandwidth-estimator.ts"),e=r("./src/events.ts"),n=r("./src/utils/buffer-helper.ts"),a=r("./src/errors.ts"),s=r("./src/types/loader.ts"),u=r("./src/utils/logger.ts");function t(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}function f(v,y,p){return y&&t(v.prototype,y),p&&t(v,p),v}var h=function(){function v(p){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=p;var g=p.config;this.bwEstimator=new l.default(g.abrEwmaSlowVoD,g.abrEwmaFastVoD,g.abrEwmaDefaultEstimate),this.registerListeners()}var y=v.prototype;return y.registerListeners=function(){var g=this.hls;g.on(e.Events.FRAG_LOADING,this.onFragLoading,this),g.on(e.Events.FRAG_LOADED,this.onFragLoaded,this),g.on(e.Events.FRAG_BUFFERED,this.onFragBuffered,this),g.on(e.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.on(e.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){var g=this.hls;g.off(e.Events.FRAG_LOADING,this.onFragLoading,this),g.off(e.Events.FRAG_LOADED,this.onFragLoaded,this),g.off(e.Events.FRAG_BUFFERED,this.onFragBuffered,this),g.off(e.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.off(e.Events.ERROR,this.onError,this)},y.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},y.onFragLoading=function(g,d){var E=d.frag;if(E.type===s.PlaylistLevelType.MAIN&&!this.timer){var w;this.fragCurrent=E,this.partCurrent=(w=d.part)!=null?w:null,this.timer=self.setInterval(this.onCheck,100)}},y.onLevelLoaded=function(g,d){var E=this.hls.config;d.details.live?this.bwEstimator.update(E.abrEwmaSlowLive,E.abrEwmaFastLive):this.bwEstimator.update(E.abrEwmaSlowVoD,E.abrEwmaFastVoD)},y._abandonRulesCheck=function(){var g=this.fragCurrent,d=this.partCurrent,E=this.hls,w=E.autoLevelEnabled,D=E.config,b=E.media;if(!(!g||!b)){var S=d?d.stats:g.stats,C=d?d.duration:g.duration;if(S.aborted){u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!w||b.paused||!b.playbackRate||!b.readyState)){var P=performance.now()-S.loading.start,R=Math.abs(b.playbackRate);if(!(P<=500*C/R)){var L=E.levels,O=E.minAutoLevel,_=L[g.level],x=S.total||Math.max(S.loaded,Math.round(C*_.maxBitrate/8)),A=Math.max(1,S.bwEstimate?S.bwEstimate/8:S.loaded*1e3/P),k=(x-S.loaded)/A,M=b.currentTime,N=(n.BufferHelper.bufferInfo(b,M,D.maxBufferHole).end-M)/R;if(!(N>=2*C/R||k<=N)){var U=Number.POSITIVE_INFINITY,j;for(j=g.level-1;j>O;j--){var z=L[j].maxBitrate;if(U=C*z/(8*.8*A),U<N)break}if(!(U>=k)){var J=this.bwEstimator.getEstimate();u.logger.warn("Fragment "+g.sn+(d?" part "+d.index:"")+" of level "+g.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+j+`
      Current BW estimate: `+(Object(c.isFiniteNumber)(J)?(J/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+k.toFixed(3)+` s
      Estimated load time for the next fragment: `+U.toFixed(3)+` s
      Time to underbuffer: `+N.toFixed(3)+" s"),E.nextLoadLevel=j,this.bwEstimator.sample(P,S.loaded),this.clearTimer(),g.loader&&(this.fragCurrent=this.partCurrent=null,g.loader.abort()),E.trigger(e.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:g,part:d,stats:S})}}}}}},y.onFragLoaded=function(g,d){var E=d.frag,w=d.part;if(E.type===s.PlaylistLevelType.MAIN&&Object(c.isFiniteNumber)(E.sn)){var D=w?w.stats:E.stats,b=w?w.duration:E.duration;if(this.clearTimer(),this.lastLoadedFragLevel=E.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var S=this.hls.levels[E.level],C=(S.loaded?S.loaded.bytes:0)+D.loaded,P=(S.loaded?S.loaded.duration:0)+b;S.loaded={bytes:C,duration:P},S.realBitrate=Math.round(8*C/P)}if(E.bitrateTest){var R={stats:D,frag:E,part:w,id:E.type};this.onFragBuffered(e.Events.FRAG_BUFFERED,R),E.bitrateTest=!1}}},y.onFragBuffered=function(g,d){var E=d.frag,w=d.part,D=w?w.stats:E.stats;if(!D.aborted&&!(E.type!==s.PlaylistLevelType.MAIN||E.sn==="initSegment")){var b=D.parsing.end-D.loading.start;this.bwEstimator.sample(b,D.loaded),D.bwEstimate=this.bwEstimator.getEstimate(),E.bitrateTest?this.bitrateTestDelay=b/1e3:this.bitrateTestDelay=0}},y.onError=function(g,d){switch(d.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},y.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},y.getNextABRAutoLevel=function(){var g=this.fragCurrent,d=this.partCurrent,E=this.hls,w=E.maxAutoLevel,D=E.config,b=E.minAutoLevel,S=E.media,C=d?d.duration:g?g.duration:0,P=S?S.currentTime:0,R=S&&S.playbackRate!==0?Math.abs(S.playbackRate):1,L=this.bwEstimator?this.bwEstimator.getEstimate():D.abrEwmaDefaultEstimate,O=(n.BufferHelper.bufferInfo(S,P,D.maxBufferHole).end-P)/R,_=this.findBestLevel(L,b,w,O,D.abrBandWidthFactor,D.abrBandWidthUpFactor);if(_>=0)return _;u.logger.trace((O?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var x=C?Math.min(C,D.maxStarvationDelay):D.maxStarvationDelay,A=D.abrBandWidthFactor,k=D.abrBandWidthUpFactor;if(!O){var M=this.bitrateTestDelay;if(M){var N=C?Math.min(C,D.maxLoadingDelay):D.maxLoadingDelay;x=N-M,u.logger.trace("bitrate test took "+Math.round(1e3*M)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*x)+" ms"),A=k=1}}return _=this.findBestLevel(L,b,w,O+x,A,k),Math.max(_,0)},y.findBestLevel=function(g,d,E,w,D,b){for(var S,C=this.fragCurrent,P=this.partCurrent,R=this.lastLoadedFragLevel,L=this.hls.levels,O=L[R],_=!!(O!=null&&(S=O.details)!==null&&S!==void 0&&S.live),x=O==null?void 0:O.codecSet,A=P?P.duration:C?C.duration:0,k=E;k>=d;k--){var M=L[k];if(!(!M||x&&M.codecSet!==x)){var N=M.details,U=(P?N==null?void 0:N.partTarget:N==null?void 0:N.averagetargetduration)||A,j=void 0;k<=R?j=D*g:j=b*g;var z=L[k].maxBitrate,J=z*U/j;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+k+"/"+Math.round(j)+"/"+z+"/"+U+"/"+w+"/"+J),j>z&&(!J||_&&!this.bitrateTestDelay||J<w))return k}}return-1},f(v,[{key:"nextAutoLevel",get:function(){var g=this._nextAutoLevel,d=this.bwEstimator;if(g!==-1&&(!d||!d.canEstimate()))return g;var E=this.getNextABRAutoLevel();return g!==-1&&(E=Math.min(g,E)),E},set:function(g){this._nextAutoLevel=g}}]),v}();m.default=h},"./src/controller/audio-stream-controller.ts":function(G,m,r){r.r(m);var c=r("./src/polyfills/number.ts"),l=r("./src/controller/base-stream-controller.ts"),e=r("./src/events.ts"),n=r("./src/utils/buffer-helper.ts"),a=r("./src/controller/fragment-tracker.ts"),s=r("./src/types/level.ts"),u=r("./src/types/loader.ts"),t=r("./src/loader/fragment.ts"),f=r("./src/demux/chunk-cache.ts"),h=r("./src/demux/transmuxer-interface.ts"),v=r("./src/types/transmuxer.ts"),y=r("./src/controller/fragment-finders.ts"),p=r("./src/utils/discontinuities.ts"),g=r("./src/errors.ts"),d=r("./src/utils/logger.ts");function E(){return E=Object.assign||function(C){for(var P=1;P<arguments.length;P++){var R=arguments[P];for(var L in R)Object.prototype.hasOwnProperty.call(R,L)&&(C[L]=R[L])}return C},E.apply(this,arguments)}function w(C,P){C.prototype=Object.create(P.prototype),C.prototype.constructor=C,D(C,P)}function D(C,P){return D=Object.setPrototypeOf||function(L,O){return L.__proto__=O,L},D(C,P)}var b=100,S=function(C){w(P,C);function P(L,O){var _;return _=C.call(this,L,O,"[audio-stream-controller]")||this,_.videoBuffer=null,_.videoTrackCC=-1,_.waitingVideoCC=-1,_.audioSwitch=!1,_.trackId=-1,_.waitingData=null,_.mainDetails=null,_.bufferFlushed=!1,_._registerListeners(),_}var R=P.prototype;return R.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},R._registerListeners=function(){var O=this.hls;O.on(e.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.on(e.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.on(e.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.on(e.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.on(e.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.on(e.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.on(e.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.on(e.Events.ERROR,this.onError,this),O.on(e.Events.BUFFER_RESET,this.onBufferReset,this),O.on(e.Events.BUFFER_CREATED,this.onBufferCreated,this),O.on(e.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.on(e.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.on(e.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R._unregisterListeners=function(){var O=this.hls;O.off(e.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.off(e.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.off(e.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.off(e.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.off(e.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.off(e.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.off(e.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.off(e.Events.ERROR,this.onError,this),O.off(e.Events.BUFFER_RESET,this.onBufferReset,this),O.off(e.Events.BUFFER_CREATED,this.onBufferCreated,this),O.off(e.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.off(e.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.off(e.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R.onInitPtsFound=function(O,_){var x=_.frag,A=_.id,k=_.initPTS;if(A==="main"){var M=x.cc;this.initPTS[x.cc]=k,this.log("InitPTS for cc: "+M+" found from main: "+k),this.videoTrackCC=M,this.state===l.State.WAITING_INIT_PTS&&this.tick()}},R.startLoad=function(O){if(!this.levels){this.startPosition=O,this.state=l.State.STOPPED;return}var _=this.lastCurrentTime;this.stopLoad(),this.setInterval(b),this.fragLoadError=0,_>0&&O===-1?(this.log("Override startPosition with lastCurrentTime @"+_.toFixed(3)),this.state=l.State.IDLE):(this.loadedmetadata=!1,this.state=l.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=O,this.tick()},R.doTick=function(){switch(this.state){case l.State.IDLE:this.doTickIdle();break;case l.State.WAITING_TRACK:{var O,_=this.levels,x=this.trackId,A=_==null||(O=_[x])===null||O===void 0?void 0:O.details;if(A){if(this.waitForCdnTuneIn(A))break;this.state=l.State.WAITING_INIT_PTS}break}case l.State.FRAG_LOADING_WAITING_RETRY:{var k,M=performance.now(),N=this.retryDate;(!N||M>=N||(k=this.media)!==null&&k!==void 0&&k.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=l.State.IDLE);break}case l.State.WAITING_INIT_PTS:{var U=this.waitingData;if(U){var j=U.frag,z=U.part,J=U.cache,te=U.complete;if(this.initPTS[j.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=l.State.FRAG_LOADING;var re=J.flush(),oe={frag:j,part:z,payload:re,networkDetails:null};this._handleFragmentLoadProgress(oe),te&&C.prototype._handleFragmentLoadComplete.call(this,oe)}else if(this.videoTrackCC!==this.waitingVideoCC)d.logger.log("Waiting fragment cc ("+j.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var se=this.getLoadPosition(),me=n.BufferHelper.bufferInfo(this.mediaBuffer,se,this.config.maxBufferHole),fe=Object(y.fragmentWithinToleranceTest)(me.end,this.config.maxFragLookUpTolerance,j);fe<0&&(d.logger.log("Waiting fragment cc ("+j.cc+") @ "+j.start+" cancelled because another fragment at "+me.end+" is needed"),this.clearWaitingFragment())}}else this.state=l.State.IDLE}}this.onTickEnd()},R.clearWaitingFragment=function(){var O=this.waitingData;O&&(this.fragmentTracker.removeFragment(O.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=l.State.IDLE)},R.onTickEnd=function(){var O=this.media;if(!(!O||!O.readyState)){var _=this.mediaBuffer?this.mediaBuffer:O,x=_.buffered;!this.loadedmetadata&&x.length&&(this.loadedmetadata=!0),this.lastCurrentTime=O.currentTime}},R.doTickIdle=function(){var O,_,x=this.hls,A=this.levels,k=this.media,M=this.trackId,N=x.config;if(!(!A||!A[M])&&!(!k&&(this.startFragRequested||!N.startFragPrefetch))){var U=A[M],j=U.details;if(!j||j.live&&this.levelLastLoaded!==M||this.waitForCdnTuneIn(j)){this.state=l.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,t.ElementaryStreamTypes.AUDIO,u.PlaylistLevelType.AUDIO));var z=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,u.PlaylistLevelType.AUDIO);if(z!==null){var J=z.len,te=this.getMaxBufferLength(),re=this.audioSwitch;if(!(J>=te&&!re)){if(!re&&this._streamEnded(z,j)){x.trigger(e.Events.BUFFER_EOS,{type:"audio"}),this.state=l.State.ENDED;return}var oe=j.fragments,se=oe[0].start,me=z.end;if(re){var fe=this.getLoadPosition();me=fe,j.PTSKnown&&fe<se&&(z.end>se||z.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),k.currentTime=se+.05)}var ue=this.getNextFragment(me,j);if(!ue){this.bufferFlushed=!0;return}((O=ue.decryptdata)===null||O===void 0?void 0:O.keyFormat)==="identity"&&!((_=ue.decryptdata)!==null&&_!==void 0&&_.key)?this.loadKey(ue,j):this.loadFragment(ue,j,me)}}}},R.getMaxBufferLength=function(){var O=C.prototype.getMaxBufferLength.call(this),_=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,u.PlaylistLevelType.MAIN);return _===null?O:Math.max(O,_.len)},R.onMediaDetaching=function(){this.videoBuffer=null,C.prototype.onMediaDetaching.call(this)},R.onAudioTracksUpdated=function(O,_){var x=_.audioTracks;this.resetTransmuxer(),this.levels=x.map(function(A){return new s.Level(A)})},R.onAudioTrackSwitching=function(O,_){var x=!!_.url;this.trackId=_.id;var A=this.fragCurrent;A!=null&&A.loader&&A.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),x?this.setInterval(b):this.resetTransmuxer(),x?(this.audioSwitch=!0,this.state=l.State.IDLE):this.state=l.State.STOPPED,this.tick()},R.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},R.onLevelLoaded=function(O,_){this.mainDetails=_.details},R.onAudioTrackLoaded=function(O,_){var x,A=this.levels,k=_.details,M=_.id;if(!A){this.warn("Audio tracks were reset while loading level "+M);return}this.log("Track "+M+" loaded ["+k.startSN+","+k.endSN+"],duration:"+k.totalduration);var N=A[M],U=0;if(k.live||(x=N.details)!==null&&x!==void 0&&x.live){var j=this.mainDetails;if(k.fragments[0]||(k.deltaUpdateFailed=!0),k.deltaUpdateFailed||!j)return;!N.details&&k.hasProgramDateTime&&j.hasProgramDateTime?(Object(p.alignMediaPlaylistByPDT)(k,j),U=k.fragments[0].start):U=this.alignPlaylists(k,N.details)}N.details=k,this.levelLastLoaded=M,!this.startFragRequested&&(this.mainDetails||!k.live)&&this.setStartPosition(N.details,U),this.state===l.State.WAITING_TRACK&&!this.waitForCdnTuneIn(k)&&(this.state=l.State.IDLE),this.tick()},R._handleFragmentLoadProgress=function(O){var _,x=O.frag,A=O.part,k=O.payload,M=this.config,N=this.trackId,U=this.levels;if(!U){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+x.sn+" of level "+x.level+" will not be buffered");return}var j=U[N];console.assert(j,"Audio track is defined on fragment load progress");var z=j.details;console.assert(z,"Audio track details are defined on fragment load progress");var J=M.defaultAudioCodec||j.audioCodec||"mp4a.40.2",te=this.transmuxer;te||(te=this.transmuxer=new h.default(this.hls,u.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var re=this.initPTS[x.cc],oe=(_=x.initSegment)===null||_===void 0?void 0:_.data;if(re!==void 0){var se=!1,me=A?A.index:-1,fe=me!==-1,ue=new v.ChunkMetadata(x.level,x.sn,x.stats.chunkCount,k.byteLength,me,fe);te.push(k,oe,J,"",x,A,z.totalduration,se,ue,re)}else{d.logger.log("Unknown video PTS for cc "+x.cc+", waiting for video PTS before demuxing audio frag "+x.sn+" of ["+z.startSN+" ,"+z.endSN+"],track "+N);var ye=this.waitingData=this.waitingData||{frag:x,part:A,cache:new f.default,complete:!1},pe=ye.cache;pe.push(new Uint8Array(k)),this.waitingVideoCC=this.videoTrackCC,this.state=l.State.WAITING_INIT_PTS}},R._handleFragmentLoadComplete=function(O){if(this.waitingData){this.waitingData.complete=!0;return}C.prototype._handleFragmentLoadComplete.call(this,O)},R.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},R.onBufferCreated=function(O,_){var x=_.tracks.audio;x&&(this.mediaBuffer=x.buffer),_.tracks.video&&(this.videoBuffer=_.tracks.video.buffer)},R.onFragBuffered=function(O,_){var x=_.frag,A=_.part;if(x.type===u.PlaylistLevelType.AUDIO){if(this.fragContextChanged(x)){this.warn("Fragment "+x.sn+(A?" p: "+A.index:"")+" of level "+x.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}x.sn!=="initSegment"&&(this.fragPrevious=x,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(e.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(x,A)}},R.onError=function(O,_){switch(_.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.AUDIO,_);break;case g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==l.State.ERROR&&this.state!==l.State.STOPPED&&(this.state=_.fatal?l.State.ERROR:l.State.IDLE,this.warn(_.details+" while loading frag, switching to "+this.state+" state"));break;case g.ErrorDetails.BUFFER_FULL_ERROR:if(_.parent==="audio"&&(this.state===l.State.PARSING||this.state===l.State.PARSED)){var x=!0,A=this.getFwdBufferInfo(this.mediaBuffer,u.PlaylistLevelType.AUDIO);A&&A.len>.5&&(x=!this.reduceMaxBufferLength(A.len)),x&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,C.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},R.onBufferFlushed=function(O,_){var x=_.type;x===t.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},R._handleTransmuxComplete=function(O){var _,x="audio",A=this.hls,k=O.remuxResult,M=O.chunkMeta,N=this.getCurrentContext(M);if(!N){this.warn("The loading context changed while buffering fragment "+M.sn+" of level "+M.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(M.level);return}var U=N.frag,j=N.part,z=k.audio,J=k.text,te=k.id3,re=k.initSegment;if(!this.fragContextChanged(U)){if(this.state=l.State.PARSING,this.audioSwitch&&z&&this.completeAudioSwitch(),re!=null&&re.tracks&&(this._bufferInitSegment(re.tracks,U,M),A.trigger(e.Events.FRAG_PARSING_INIT_SEGMENT,{frag:U,id:x,tracks:re.tracks})),z){var oe=z.startPTS,se=z.endPTS,me=z.startDTS,fe=z.endDTS;j&&(j.elementaryStreams[t.ElementaryStreamTypes.AUDIO]={startPTS:oe,endPTS:se,startDTS:me,endDTS:fe}),U.setElementaryStreamInfo(t.ElementaryStreamTypes.AUDIO,oe,se,me,fe),this.bufferFragmentData(z,U,j,M)}if(te!=null&&(_=te.samples)!==null&&_!==void 0&&_.length){var ue=E({frag:U,id:x},te);A.trigger(e.Events.FRAG_PARSING_METADATA,ue)}if(J){var ye=E({frag:U,id:x},J);A.trigger(e.Events.FRAG_PARSING_USERDATA,ye)}}},R._bufferInitSegment=function(O,_,x){if(this.state===l.State.PARSING){O.video&&delete O.video;var A=O.audio;if(!!A){A.levelCodec=A.codec,A.id="audio",this.log("Init audio buffer, container:"+A.container+", codecs[parsed]=["+A.codec+"]"),this.hls.trigger(e.Events.BUFFER_CODECS,O);var k=A.initSegment;if(k!=null&&k.byteLength){var M={type:"audio",frag:_,part:null,chunkMeta:x,parent:_.type,data:k};this.hls.trigger(e.Events.BUFFER_APPENDING,M)}this.tick()}}},R.loadFragment=function(O,_,x){var A=this.fragmentTracker.getState(O);this.fragCurrent=O,(this.audioSwitch||A===a.FragmentState.NOT_LOADED||A===a.FragmentState.PARTIAL)&&(O.sn==="initSegment"?this._loadInitSegment(O):_.live&&!Object(c.isFiniteNumber)(this.initPTS[O.cc])?(this.log("Waiting for video PTS in continuity counter "+O.cc+" of live stream before loading audio fragment "+O.sn+" of level "+this.trackId),this.state=l.State.WAITING_INIT_PTS):(this.startFragRequested=!0,C.prototype.loadFragment.call(this,O,_,x)))},R.completeAudioSwitch=function(){var O=this.hls,_=this.media,x=this.trackId;_&&(this.log("Switching audio track : flushing all audio"),C.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,O.trigger(e.Events.AUDIO_TRACK_SWITCHED,{id:x})},P}(l.default);m.default=S},"./src/controller/audio-track-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts"),l=r("./src/errors.ts"),e=r("./src/controller/base-playlist-controller.ts"),n=r("./src/types/loader.ts");function a(h,v){for(var y=0;y<v.length;y++){var p=v[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(h,p.key,p)}}function s(h,v,y){return v&&a(h.prototype,v),y&&a(h,y),h}function u(h,v){h.prototype=Object.create(v.prototype),h.prototype.constructor=h,t(h,v)}function t(h,v){return t=Object.setPrototypeOf||function(p,g){return p.__proto__=g,p},t(h,v)}var f=function(h){u(v,h);function v(p){var g;return g=h.call(this,p,"[audio-track-controller]")||this,g.tracks=[],g.groupId=null,g.tracksInGroup=[],g.trackId=-1,g.trackName="",g.selectDefaultTrack=!0,g.registerListeners(),g}var y=v.prototype;return y.registerListeners=function(){var g=this.hls;g.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.on(c.Events.LEVEL_LOADING,this.onLevelLoading,this),g.on(c.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.on(c.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.on(c.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){var g=this.hls;g.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.off(c.Events.LEVEL_LOADING,this.onLevelLoading,this),g.off(c.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.off(c.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.off(c.Events.ERROR,this.onError,this)},y.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,h.prototype.destroy.call(this)},y.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},y.onManifestParsed=function(g,d){this.tracks=d.audioTracks||[]},y.onAudioTrackLoaded=function(g,d){var E=d.id,w=d.details,D=this.tracksInGroup[E];if(!D){this.warn("Invalid audio track id "+E);return}var b=D.details;D.details=d.details,this.log("audioTrack "+E+" loaded ["+w.startSN+"-"+w.endSN+"]"),E===this.trackId&&(this.retryCount=0,this.playlistLoaded(E,d,b))},y.onLevelLoading=function(g,d){this.switchLevel(d.level)},y.onLevelSwitching=function(g,d){this.switchLevel(d.level)},y.switchLevel=function(g){var d=this.hls.levels[g];if(!!(d!=null&&d.audioGroupIds)){var E=d.audioGroupIds[d.urlId];if(this.groupId!==E){this.groupId=E;var w=this.tracks.filter(function(b){return!E||b.groupId===E});this.selectDefaultTrack&&!w.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=w;var D={audioTracks:w};this.log("Updating audio tracks, "+w.length+' track(s) found in "'+E+'" group-id'),this.hls.trigger(c.Events.AUDIO_TRACKS_UPDATED,D),this.selectInitialTrack()}}},y.onError=function(g,d){h.prototype.onError.call(this,g,d),!(d.fatal||!d.context)&&d.context.type===n.PlaylistContextType.AUDIO_TRACK&&d.context.id===this.trackId&&d.context.groupId===this.groupId&&this.retryLoadingOrFail(d)},y.setAudioTrack=function(g){var d=this.tracksInGroup;if(g<0||g>=d.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var E=d[this.trackId];this.log("Now switching to audio-track index "+g);var w=d[g],D=w.id,b=w.groupId,S=b===void 0?"":b,C=w.name,P=w.type,R=w.url;if(this.trackId=g,this.trackName=C,this.selectDefaultTrack=!1,this.hls.trigger(c.Events.AUDIO_TRACK_SWITCHING,{id:D,groupId:S,name:C,type:P,url:R}),!(w.details&&!w.details.live)){var L=this.switchParams(w.url,E==null?void 0:E.details);this.loadPlaylist(L)}},y.selectInitialTrack=function(){var g=this.tracksInGroup;console.assert(g.length,"Initial audio track should be selected when tracks are known");var d=this.trackName,E=this.findTrackId(d)||this.findTrackId();E!==-1?this.setAudioTrack(E):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},y.findTrackId=function(g){for(var d=this.tracksInGroup,E=0;E<d.length;E++){var w=d[E];if((!this.selectDefaultTrack||w.default)&&(!g||g===w.name))return w.id}return-1},y.loadPlaylist=function(g){var d=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(d)){var E=d.id,w=d.groupId,D=d.url;if(g)try{D=g.addDirectives(D)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+E),this.clearTimer(),this.hls.trigger(c.Events.AUDIO_TRACK_LOADING,{url:D,id:E,groupId:w,deliveryDirectives:g||null})}},s(v,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(g){this.selectDefaultTrack=!1,this.setAudioTrack(g)}}]),v}(e.default);m.default=f},"./src/controller/base-playlist-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return s});var c=r("./src/polyfills/number.ts"),l=r("./src/types/level.ts"),e=r("./src/controller/level-helper.ts"),n=r("./src/utils/logger.ts"),a=r("./src/errors.ts"),s=function(){function u(f,h){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=n.logger.log.bind(n.logger,h+":"),this.warn=n.logger.warn.bind(n.logger,h+":"),this.hls=f}var t=u.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.onError=function(h,v){v.fatal&&v.type===a.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(h,v){var y=v==null?void 0:v.renditionReports;if(y)for(var p=0;p<y.length;p++){var g=y[p],d=""+g.URI;if(d===h.substr(-d.length)){var E=parseInt(g["LAST-MSN"]),w=parseInt(g["LAST-PART"]);if(v&&this.hls.config.lowLatencyMode){var D=Math.min(v.age-v.partTarget,v.targetduration);w!==void 0&&D>v.partTarget&&(w+=1)}if(Object(c.isFiniteNumber)(E))return new l.HlsUrlParameters(E,Object(c.isFiniteNumber)(w)?w:void 0,l.HlsSkip.No)}}},t.loadPlaylist=function(h){},t.shouldLoadTrack=function(h){return this.canLoad&&h&&!!h.url&&(!h.details||h.details.live)},t.playlistLoaded=function(h,v,y){var p=this,g=v.details,d=v.stats,E=d.loading.end?Math.max(0,self.performance.now()-d.loading.end):0;if(g.advancedDateTime=Date.now()-E,g.live||y!=null&&y.live){if(g.reloaded(y),y&&this.log("live playlist "+h+" "+(g.advanced?"REFRESHED "+g.lastPartSn+"-"+g.lastPartIndex:"MISSED")),y&&g.fragments.length>0&&Object(e.mergeDetails)(y,g),!this.canLoad||!g.live)return;var w,D=void 0,b=void 0;if(g.canBlockReload&&g.endSN&&g.advanced){var S=this.hls.config.lowLatencyMode,C=g.lastPartSn,P=g.endSN,R=g.lastPartIndex,L=R!==-1,O=C===P,_=S?0:R;L?(D=O?P+1:C,b=O?_:R+1):D=P+1;var x=g.age,A=x+g.ageHeader,k=Math.min(A-g.partTarget,g.targetduration*1.5);if(k>0){if(y&&k>y.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+y.tuneInGoal+" to: "+k+" with playlist age: "+g.age),k=0;else{var M=Math.floor(k/g.targetduration);if(D+=M,b!==void 0){var N=Math.round(k%g.targetduration/g.partTarget);b+=N}this.log("CDN Tune-in age: "+g.ageHeader+"s last advanced "+x.toFixed(2)+"s goal: "+k+" skip sn "+M+" to part "+b)}g.tuneInGoal=k}if(w=this.getDeliveryDirectives(g,v.deliveryDirectives,D,b),S||!O){this.loadPlaylist(w);return}}else w=this.getDeliveryDirectives(g,v.deliveryDirectives,D,b);var U=Object(e.computeReloadInterval)(g,d);D!==void 0&&g.canBlockReload&&(U-=g.partTarget||1),this.log("reload live playlist "+h+" in "+Math.round(U)+" ms"),this.timer=self.setTimeout(function(){return p.loadPlaylist(w)},U)}else this.clearTimer()},t.getDeliveryDirectives=function(h,v,y,p){var g=Object(l.getSkipValue)(h,y);return v!=null&&v.skip&&h.deltaUpdateFailed&&(y=v.msn,p=v.part,g=l.HlsSkip.No),new l.HlsUrlParameters(y,p,g)},t.retryLoadingOrFail=function(h){var v=this,y=this.hls.config,p=this.retryCount<y.levelLoadingMaxRetry;if(p){var g;if(this.retryCount++,h.details.indexOf("LoadTimeOut")>-1&&(g=h.context)!==null&&g!==void 0&&g.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+h.details+'"'),this.loadPlaylist();else{var d=Math.min(Math.pow(2,this.retryCount)*y.levelLoadingRetryDelay,y.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return v.loadPlaylist()},d),this.warn("retry playlist loading #"+this.retryCount+" in "+d+' ms after "'+h.details+'"')}}else this.warn('cannot recover from error "'+h.details+'"'),this.clearTimer(),h.fatal=!0;return p},u}()},"./src/controller/base-stream-controller.ts":function(G,m,r){r.r(m),r.d(m,"State",function(){return P}),r.d(m,"default",function(){return R});var c=r("./src/polyfills/number.ts"),l=r("./src/task-loop.ts"),e=r("./src/controller/fragment-tracker.ts"),n=r("./src/utils/buffer-helper.ts"),a=r("./src/utils/logger.ts"),s=r("./src/events.ts"),u=r("./src/errors.ts"),t=r("./src/types/transmuxer.ts"),f=r("./src/utils/mp4-tools.ts"),h=r("./src/utils/discontinuities.ts"),v=r("./src/controller/fragment-finders.ts"),y=r("./src/controller/level-helper.ts"),p=r("./src/loader/fragment-loader.ts"),g=r("./src/crypt/decrypter.ts"),d=r("./src/utils/time-ranges.ts"),E=r("./src/types/loader.ts");function w(L,O){for(var _=0;_<O.length;_++){var x=O[_];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(L,x.key,x)}}function D(L,O,_){return O&&w(L.prototype,O),_&&w(L,_),L}function b(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function S(L,O){L.prototype=Object.create(O.prototype),L.prototype.constructor=L,C(L,O)}function C(L,O){return C=Object.setPrototypeOf||function(x,A){return x.__proto__=A,x},C(L,O)}var P={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},R=function(L){S(O,L);function O(x,A,k){var M;return M=L.call(this)||this,M.hls=void 0,M.fragPrevious=null,M.fragCurrent=null,M.fragmentTracker=void 0,M.transmuxer=null,M._state=P.STOPPED,M.media=void 0,M.mediaBuffer=void 0,M.config=void 0,M.bitrateTest=!1,M.lastCurrentTime=0,M.nextLoadPosition=0,M.startPosition=0,M.loadedmetadata=!1,M.fragLoadError=0,M.retryDate=0,M.levels=null,M.fragmentLoader=void 0,M.levelLastLoaded=null,M.startFragRequested=!1,M.decrypter=void 0,M.initPTS=[],M.onvseeking=null,M.onvended=null,M.logPrefix="",M.log=void 0,M.warn=void 0,M.logPrefix=k,M.log=a.logger.log.bind(a.logger,k+":"),M.warn=a.logger.warn.bind(a.logger,k+":"),M.hls=x,M.fragmentLoader=new p.default(x.config),M.fragmentTracker=A,M.config=x.config,M.decrypter=new g.default(x,x.config),x.on(s.Events.KEY_LOADED,M.onKeyLoaded,b(M)),M}var _=O.prototype;return _.doTick=function(){this.onTickEnd()},_.onTickEnd=function(){},_.startLoad=function(A){},_.stopLoad=function(){this.fragmentLoader.abort();var A=this.fragCurrent;A&&this.fragmentTracker.removeFragment(A),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=P.STOPPED},_._streamEnded=function(A,k){var M=this.fragCurrent,N=this.fragmentTracker;if(!k.live&&M&&M.sn===k.endSN&&!A.nextStart){var U=N.getState(M);return U===e.FragmentState.PARTIAL||U===e.FragmentState.OK}return!1},_.onMediaAttached=function(A,k){var M=this.media=this.mediaBuffer=k.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),M.addEventListener("seeking",this.onvseeking),M.addEventListener("ended",this.onvended);var N=this.config;this.levels&&N.autoStartLoad&&this.state===P.STOPPED&&this.startLoad(N.startPosition)},_.onMediaDetaching=function(){var A=this.media;A!=null&&A.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),A&&(A.removeEventListener("seeking",this.onvseeking),A.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},_.onMediaSeeking=function(){var A=this.config,k=this.fragCurrent,M=this.media,N=this.mediaBuffer,U=this.state,j=M?M.currentTime:0,z=n.BufferHelper.bufferInfo(N||M,j,A.maxBufferHole);if(this.log("media seeking to "+(Object(c.isFiniteNumber)(j)?j.toFixed(3):j)+", state: "+U),U===P.ENDED)this.resetLoadingState();else if(k&&!z.len){var J=A.maxFragLookUpTolerance,te=k.start-J,re=k.start+k.duration+J,oe=j>re;(j<te||oe)&&(oe&&k.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),k.loader.abort()),this.resetLoadingState())}M&&(this.lastCurrentTime=j),!this.loadedmetadata&&!z.len&&(this.nextLoadPosition=this.startPosition=j),this.tickImmediate()},_.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},_.onKeyLoaded=function(A,k){if(!(this.state!==P.KEY_LOADING||k.frag!==this.fragCurrent||!this.levels)){this.state=P.IDLE;var M=this.levels[k.frag.level].details;M&&this.loadFragment(k.frag,M,k.frag.start)}},_.onHandlerDestroying=function(){this.stopLoad(),L.prototype.onHandlerDestroying.call(this)},_.onHandlerDestroyed=function(){this.state=P.STOPPED,this.hls.off(s.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,L.prototype.onHandlerDestroyed.call(this)},_.loadKey=function(A,k){this.log("Loading key for "+A.sn+" of ["+k.startSN+"-"+k.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+A.level),this.state=P.KEY_LOADING,this.fragCurrent=A,this.hls.trigger(s.Events.KEY_LOADING,{frag:A})},_.loadFragment=function(A,k,M){this._loadFragForPlayback(A,k,M)},_._loadFragForPlayback=function(A,k,M){var N=this,U=function(z){if(N.fragContextChanged(A)){N.warn("Fragment "+A.sn+(z.part?" p: "+z.part.index:"")+" of level "+A.level+" was dropped during download."),N.fragmentTracker.removeFragment(A);return}A.stats.chunkCount++,N._handleFragmentLoadProgress(z)};this._doFragLoad(A,k,M,U).then(function(j){if(!!j){N.fragLoadError=0;var z=N.state;if(N.fragContextChanged(A)){(z===P.FRAG_LOADING||z===P.BACKTRACKING||!N.fragCurrent&&z===P.PARSING)&&(N.fragmentTracker.removeFragment(A),N.state=P.IDLE);return}if("payload"in j&&(N.log("Loaded fragment "+A.sn+" of level "+A.level),N.hls.trigger(s.Events.FRAG_LOADED,j),N.state===P.BACKTRACKING)){N.fragmentTracker.backtrack(A,j),N.resetFragmentLoading(A);return}N._handleFragmentLoadComplete(j)}}).catch(function(j){N.warn(j),N.resetFragmentLoading(A)})},_.flushMainBuffer=function(A,k,M){if(M===void 0&&(M=null),!!(A-k)){var N={startOffset:A,endOffset:k,type:M};this.fragLoadError=0,this.hls.trigger(s.Events.BUFFER_FLUSHING,N)}},_._loadInitSegment=function(A){var k=this;this._doFragLoad(A).then(function(M){if(!M||k.fragContextChanged(A)||!k.levels)throw new Error("init load aborted");return M}).then(function(M){var N=k.hls,U=M.payload,j=A.decryptdata;if(U&&U.byteLength>0&&j&&j.key&&j.iv&&j.method==="AES-128"){var z=self.performance.now();return k.decrypter.webCryptoDecrypt(new Uint8Array(U),j.key.buffer,j.iv.buffer).then(function(J){var te=self.performance.now();return N.trigger(s.Events.FRAG_DECRYPTED,{frag:A,payload:J,stats:{tstart:z,tdecrypt:te}}),M.payload=J,M})}return M}).then(function(M){var N=k.fragCurrent,U=k.hls,j=k.levels;if(!j)throw new Error("init load aborted, missing levels");var z=j[A.level].details;console.assert(z,"Level details are defined when init segment is loaded");var J=A.stats;k.state=P.IDLE,k.fragLoadError=0,A.data=new Uint8Array(M.payload),J.parsing.start=J.buffering.start=self.performance.now(),J.parsing.end=J.buffering.end=self.performance.now(),M.frag===N&&U.trigger(s.Events.FRAG_BUFFERED,{stats:J,frag:N,part:null,id:A.type}),k.tick()}).catch(function(M){k.warn(M),k.resetFragmentLoading(A)})},_.fragContextChanged=function(A){var k=this.fragCurrent;return!A||!k||A.level!==k.level||A.sn!==k.sn||A.urlId!==k.urlId},_.fragBufferedComplete=function(A,k){var M=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+A.type+" sn: "+A.sn+(k?" part: "+k.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+A.level+" "+d.default.toString(n.BufferHelper.getBuffered(M))),this.state=P.IDLE,this.tick()},_._handleFragmentLoadComplete=function(A){var k=this.transmuxer;if(!!k){var M=A.frag,N=A.part,U=A.partsLoaded,j=!U||U.length===0||U.some(function(J){return!J}),z=new t.ChunkMetadata(M.level,M.sn,M.stats.chunkCount+1,0,N?N.index:-1,!j);k.flush(z)}},_._handleFragmentLoadProgress=function(A){},_._doFragLoad=function(A,k,M,N){var U=this;if(M===void 0&&(M=null),!this.levels)throw new Error("frag load aborted, missing levels");if(M=Math.max(A.start,M||0),this.config.lowLatencyMode&&k){var j=k.partList;if(j&&N){M>A.end&&k.fragmentHint&&(A=k.fragmentHint);var z=this.getNextPart(j,A,M);if(z>-1){var J=j[z];return this.log("Loading part sn: "+A.sn+" p: "+J.index+" cc: "+A.cc+" of playlist ["+k.startSN+"-"+k.endSN+"] parts [0-"+z+"-"+(j.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+A.level+", target: "+parseFloat(M.toFixed(3))),this.nextLoadPosition=J.start+J.duration,this.state=P.FRAG_LOADING,this.hls.trigger(s.Events.FRAG_LOADING,{frag:A,part:j[z],targetBufferTime:M}),this.doFragPartsLoad(A,j,z,N).catch(function(te){return U.handleFragLoadError(te)})}else if(!A.url||this.loadedEndOfParts(j,M))return Promise.resolve(null)}}return this.log("Loading fragment "+A.sn+" cc: "+A.cc+" "+(k?"of ["+k.startSN+"-"+k.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+A.level+", target: "+parseFloat(M.toFixed(3))),Object(c.isFiniteNumber)(A.sn)&&!this.bitrateTest&&(this.nextLoadPosition=A.start+A.duration),this.state=P.FRAG_LOADING,this.hls.trigger(s.Events.FRAG_LOADING,{frag:A,targetBufferTime:M}),this.fragmentLoader.load(A,N).catch(function(te){return U.handleFragLoadError(te)})},_.doFragPartsLoad=function(A,k,M,N){var U=this;return new Promise(function(j,z){var J=[],te=function re(oe){var se=k[oe];U.fragmentLoader.loadPart(A,se,N).then(function(me){J[se.index]=me;var fe=me.part;U.hls.trigger(s.Events.FRAG_LOADED,me);var ue=k[oe+1];if(ue&&ue.fragment===A)re(oe+1);else return j({frag:A,part:fe,partsLoaded:J})}).catch(z)};te(M)})},_.handleFragLoadError=function(A){var k=A.data;return k&&k.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(k.frag,k.part):this.hls.trigger(s.Events.ERROR,k),null},_._handleTransmuxerFlush=function(A){var k=this.getCurrentContext(A);if(!k||this.state!==P.PARSING){this.fragCurrent||(this.state=P.IDLE);return}var M=k.frag,N=k.part,U=k.level,j=self.performance.now();M.stats.parsing.end=j,N&&(N.stats.parsing.end=j),this.updateLevelTiming(M,N,U,A.partial)},_.getCurrentContext=function(A){var k=this.levels,M=A.level,N=A.sn,U=A.part;if(!k||!k[M])return this.warn("Levels object was unset while buffering fragment "+N+" of level "+M+". The current chunk will not be buffered."),null;var j=k[M],z=U>-1?Object(y.getPartWith)(j,N,U):null,J=z?z.fragment:Object(y.getFragmentWithSN)(j,N,this.fragCurrent);return J?{frag:J,part:z,level:j}:null},_.bufferFragmentData=function(A,k,M,N){if(!(!A||this.state!==P.PARSING)){var U=A.data1,j=A.data2,z=U;if(U&&j&&(z=Object(f.appendUint8Array)(U,j)),!(!z||!z.length)){var J={type:A.type,frag:k,part:M,chunkMeta:N,parent:k.type,data:z};this.hls.trigger(s.Events.BUFFER_APPENDING,J),A.dropped&&A.independent&&!M&&this.flushBufferGap(k)}}},_.flushBufferGap=function(A){var k=this.media;if(!!k){if(!n.BufferHelper.isBuffered(k,k.currentTime)){this.flushMainBuffer(0,A.start);return}var M=k.currentTime,N=n.BufferHelper.bufferInfo(k,M,0),U=A.duration,j=Math.min(this.config.maxFragLookUpTolerance*2,U*.25),z=Math.max(Math.min(A.start-j,N.end-j),M+j);A.start-z>j&&this.flushMainBuffer(z,A.start)}},_.getFwdBufferInfo=function(A,k){var M=this.config,N=this.getLoadPosition();if(!Object(c.isFiniteNumber)(N))return null;var U=n.BufferHelper.bufferInfo(A,N,M.maxBufferHole);if(U.len===0&&U.nextStart!==void 0){var j=this.fragmentTracker.getBufferedFrag(N,k);if(j&&U.nextStart<j.end)return n.BufferHelper.bufferInfo(A,N,Math.max(U.nextStart,M.maxBufferHole))}return U},_.getMaxBufferLength=function(A){var k=this.config,M;return A?M=Math.max(8*k.maxBufferSize/A,k.maxBufferLength):M=k.maxBufferLength,Math.min(M,k.maxMaxBufferLength)},_.reduceMaxBufferLength=function(A){var k=this.config,M=A||k.maxBufferLength;return k.maxMaxBufferLength>=M?(k.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+k.maxMaxBufferLength+"s"),!0):!1},_.getNextFragment=function(A,k){var M,N,U=k.fragments,j=U.length;if(!j)return null;var z=this.config,J=U[0].start,te;if(k.live){var re=z.initialLiveManifestSize;if(j<re)return this.warn("Not enough fragments to start playback (have: "+j+", need: "+re+")"),null;!k.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(te=this.getInitialLiveFragment(k,U),this.startPosition=te?this.hls.liveSyncPosition||te.start:A)}else A<=J&&(te=U[0]);if(!te){var oe=z.lowLatencyMode?k.partEnd:k.fragmentEnd;te=this.getFragmentAtPosition(A,oe,k)}return(M=te)!==null&&M!==void 0&&M.initSegment&&!((N=te)!==null&&N!==void 0&&N.initSegment.data)&&!this.bitrateTest&&(te=te.initSegment),te},_.getNextPart=function(A,k,M){for(var N=-1,U=!1,j=!0,z=0,J=A.length;z<J;z++){var te=A[z];if(j=j&&!te.independent,N>-1&&M<te.start)break;var re=te.loaded;!re&&(U||te.independent||j)&&te.fragment===k&&(N=z),U=re}return N},_.loadedEndOfParts=function(A,k){var M=A[A.length-1];return M&&k>M.start&&M.loaded},_.getInitialLiveFragment=function(A,k){var M=this.fragPrevious,N=null;if(M){if(A.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+M.programDateTime),N=Object(v.findFragmentByPDT)(k,M.endProgramDateTime,this.config.maxFragLookUpTolerance)),!N){var U=M.sn+1;if(U>=A.startSN&&U<=A.endSN){var j=k[U-A.startSN];M.cc===j.cc&&(N=j,this.log("Live playlist, switching playlist, load frag with next SN: "+N.sn))}N||(N=Object(v.findFragWithCC)(k,M.cc),N&&this.log("Live playlist, switching playlist, load frag with same CC: "+N.sn))}}else{var z=this.hls.liveSyncPosition;z!==null&&(N=this.getFragmentAtPosition(z,this.bitrateTest?A.fragmentEnd:A.edge,A))}return N},_.getFragmentAtPosition=function(A,k,M){var N=this.config,U=this.fragPrevious,j=M.fragments,z=M.endSN,J=M.fragmentHint,te=N.maxFragLookUpTolerance,re=!!(N.lowLatencyMode&&M.partList&&J);re&&J&&!this.bitrateTest&&(j=j.concat(J),z=J.sn);var oe;if(A<k){var se=A>k-te?0:te;oe=Object(v.findFragmentByPTS)(U,j,A,se)}else oe=j[j.length-1];if(oe){var me=oe.sn-M.startSN,fe=U&&oe.level===U.level,ue=j[me+1],ye=this.fragmentTracker.getState(oe);if(ye===e.FragmentState.BACKTRACKED){oe=null;for(var pe=me;j[pe]&&this.fragmentTracker.getState(j[pe])===e.FragmentState.BACKTRACKED;)U?oe=j[pe--]:oe=j[--pe];oe||(oe=ue)}else U&&oe.sn===U.sn&&!re&&fe&&(oe.sn<z&&this.fragmentTracker.getState(ue)!==e.FragmentState.OK?(this.log("SN "+oe.sn+" just loaded, load next one: "+ue.sn),oe=ue):oe=null)}return oe},_.synchronizeToLiveEdge=function(A){var k=this.config,M=this.media;if(!!M){var N=this.hls.liveSyncPosition,U=M.currentTime,j=A.fragments[0].start,z=A.edge,J=U>=j-k.maxFragLookUpTolerance&&U<=z;if(N!==null&&M.duration>N&&(U<N||!J)){var te=k.liveMaxLatencyDuration!==void 0?k.liveMaxLatencyDuration:k.liveMaxLatencyDurationCount*A.targetduration;(!J&&M.readyState<4||U<z-te)&&(this.loadedmetadata||(this.nextLoadPosition=N),M.readyState&&(this.warn("Playback: "+U.toFixed(3)+" is located too far from the end of live sliding playlist: "+z+", reset currentTime to : "+N.toFixed(3)),M.currentTime=N))}}},_.alignPlaylists=function(A,k){var M=this.levels,N=this.levelLastLoaded,U=this.fragPrevious,j=N!==null?M[N]:null,z=A.fragments.length;if(!z)return this.warn("No fragments in live playlist"),0;var J=A.fragments[0].start,te=!k,re=A.alignedSliding&&Object(c.isFiniteNumber)(J);if(te||!re&&!J){Object(h.alignStream)(U,j,A);var oe=A.fragments[0].start;return this.log("Live playlist sliding: "+oe.toFixed(2)+" start-sn: "+(k?k.startSN:"na")+"->"+A.startSN+" prev-sn: "+(U?U.sn:"na")+" fragments: "+z),oe}return J},_.waitForCdnTuneIn=function(A){var k=3;return A.live&&A.canBlockReload&&A.tuneInGoal>Math.max(A.partHoldBack,A.partTarget*k)},_.setStartPosition=function(A,k){var M=this.startPosition;if(M<k&&(M=-1),M===-1||this.lastCurrentTime===-1){var N=A.startTimeOffset;Object(c.isFiniteNumber)(N)?(M=k+N,N<0&&(M+=A.totalduration),M=Math.min(Math.max(k,M),k+A.totalduration),this.log("Start time offset "+N+" found in playlist, adjust startPosition to "+M),this.startPosition=M):A.live?M=this.hls.liveSyncPosition||k:this.startPosition=M=0,this.lastCurrentTime=M}this.nextLoadPosition=M},_.getLoadPosition=function(){var A=this.media,k=0;return this.loadedmetadata&&A?k=A.currentTime:this.nextLoadPosition&&(k=this.nextLoadPosition),k},_.handleFragLoadAborted=function(A,k){this.transmuxer&&A.sn!=="initSegment"&&A.stats.aborted&&(this.warn("Fragment "+A.sn+(k?" part"+k.index:"")+" of level "+A.level+" was aborted"),this.resetFragmentLoading(A))},_.resetFragmentLoading=function(A){(!this.fragCurrent||!this.fragContextChanged(A))&&(this.state=P.IDLE)},_.onFragmentOrKeyLoadError=function(A,k){if(!k.fatal){var M=k.frag;if(!(!M||M.type!==A)){var N=this.fragCurrent;console.assert(N&&M.sn===N.sn&&M.level===N.level&&M.urlId===N.urlId,"Frag load error must match current frag to retry");var U=this.config;if(this.fragLoadError+1<=U.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(M.level))return;var j=Math.min(Math.pow(2,this.fragLoadError)*U.fragLoadingRetryDelay,U.fragLoadingMaxRetryTimeout);this.warn("Fragment "+M.sn+" of "+A+" "+M.level+" failed to load, retrying in "+j+"ms"),this.retryDate=self.performance.now()+j,this.fragLoadError++,this.state=P.FRAG_LOADING_WAITING_RETRY}else k.levelRetry?(A===E.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=P.IDLE):(a.logger.error(k.details+" reaches max retry, redispatch as fatal ..."),k.fatal=!0,this.hls.stopLoad(),this.state=P.ERROR)}}},_.afterBufferFlushed=function(A,k,M){if(!!A){var N=n.BufferHelper.getBuffered(A);this.fragmentTracker.detectEvictedFragments(k,N,M),this.state===P.ENDED&&this.resetLoadingState()}},_.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=P.IDLE},_.resetLiveStartWhenNotLoaded=function(A){if(!this.loadedmetadata){this.startFragRequested=!1;var k=this.levels?this.levels[A].details:null;if(k!=null&&k.live)return this.startPosition=-1,this.setStartPosition(k,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},_.updateLevelTiming=function(A,k,M,N){var U=this,j=M.details;console.assert(!!j,"level.details must be defined");var z=Object.keys(A.elementaryStreams).reduce(function(J,te){var re=A.elementaryStreams[te];if(re){var oe=re.endPTS-re.startPTS;if(oe<=0)return U.warn("Could not parse fragment "+A.sn+" "+te+" duration reliably ("+oe+") resetting transmuxer to fallback to playlist timing"),U.resetTransmuxer(),J||!1;var se=N?0:Object(y.updateFragPTSDTS)(j,A,re.startPTS,re.endPTS,re.startDTS,re.endDTS);return U.hls.trigger(s.Events.LEVEL_PTS_UPDATED,{details:j,level:M,drift:se,type:te,frag:A,start:re.startPTS,end:re.endPTS}),!0}return J},!1);z?(this.state=P.PARSED,this.hls.trigger(s.Events.FRAG_PARSED,{frag:A,part:k})):this.resetLoadingState()},_.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},D(O,[{key:"state",get:function(){return this._state},set:function(A){var k=this._state;k!==A&&(this._state=A,this.log(k+"->"+A))}}]),O}(l.default)},"./src/controller/buffer-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return v});var c=r("./src/polyfills/number.ts"),l=r("./src/events.ts"),e=r("./src/utils/logger.ts"),n=r("./src/errors.ts"),a=r("./src/utils/buffer-helper.ts"),s=r("./src/utils/mediasource-helper.ts"),u=r("./src/loader/fragment.ts"),t=r("./src/controller/buffer-operation-queue.ts"),f=Object(s.getMediaSource)(),h=/([ha]vc.)(?:\.[^.,]+)+/,v=function(){function y(g){var d=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var E=d.hls,w=d.media,D=d.mediaSource;e.logger.log("[buffer-controller]: Media source opened"),w&&(d.updateMediaElementDuration(),E.trigger(l.Events.MEDIA_ATTACHED,{media:w})),D&&D.removeEventListener("sourceopen",d._onMediaSourceOpen),d.checkPendingTracks()},this._onMediaSourceClose=function(){e.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){e.logger.log("[buffer-controller]: Media source ended")},this.hls=g,this._initSourceBuffer(),this.registerListeners()}var p=y.prototype;return p.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},p.destroy=function(){this.unregisterListeners(),this.details=null},p.registerListeners=function(){var d=this.hls;d.on(l.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(l.Events.BUFFER_RESET,this.onBufferReset,this),d.on(l.Events.BUFFER_APPENDING,this.onBufferAppending,this),d.on(l.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.on(l.Events.BUFFER_EOS,this.onBufferEos,this),d.on(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),d.on(l.Events.LEVEL_UPDATED,this.onLevelUpdated,this),d.on(l.Events.FRAG_PARSED,this.onFragParsed,this),d.on(l.Events.FRAG_CHANGED,this.onFragChanged,this)},p.unregisterListeners=function(){var d=this.hls;d.off(l.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(l.Events.BUFFER_RESET,this.onBufferReset,this),d.off(l.Events.BUFFER_APPENDING,this.onBufferAppending,this),d.off(l.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.off(l.Events.BUFFER_EOS,this.onBufferEos,this),d.off(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),d.off(l.Events.LEVEL_UPDATED,this.onLevelUpdated,this),d.off(l.Events.FRAG_PARSED,this.onFragParsed,this),d.off(l.Events.FRAG_CHANGED,this.onFragChanged,this)},p._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new t.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},p.onManifestParsed=function(d,E){var w=2;(E.audio&&!E.video||!E.altAudio)&&(w=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=w,this.details=null,e.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},p.onMediaAttaching=function(d,E){var w=this.media=E.media;if(w&&f){var D=this.mediaSource=new f;D.addEventListener("sourceopen",this._onMediaSourceOpen),D.addEventListener("sourceended",this._onMediaSourceEnded),D.addEventListener("sourceclose",this._onMediaSourceClose),w.src=self.URL.createObjectURL(D),this._objectUrl=w.src}},p.onMediaDetaching=function(){var d=this.media,E=this.mediaSource,w=this._objectUrl;if(E){if(e.logger.log("[buffer-controller]: media source detaching"),E.readyState==="open")try{E.endOfStream()}catch(D){e.logger.warn("[buffer-controller]: onMediaDetaching: "+D.message+" while calling endOfStream")}this.onBufferReset(),E.removeEventListener("sourceopen",this._onMediaSourceOpen),E.removeEventListener("sourceended",this._onMediaSourceEnded),E.removeEventListener("sourceclose",this._onMediaSourceClose),d&&(w&&self.URL.revokeObjectURL(w),d.src===w?(d.removeAttribute("src"),d.load()):e.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(l.Events.MEDIA_DETACHED,void 0)},p.onBufferReset=function(){var d=this;this.getSourceBufferTypes().forEach(function(E){var w=d.sourceBuffer[E];try{w&&(d.removeBufferListeners(E),d.mediaSource&&d.mediaSource.removeSourceBuffer(w),d.sourceBuffer[E]=void 0)}catch(D){e.logger.warn("[buffer-controller]: Failed to reset the "+E+" buffer",D)}}),this._initSourceBuffer()},p.onBufferCodecs=function(d,E){var w=this,D=this.getSourceBufferTypes().length;Object.keys(E).forEach(function(b){if(D){var S=w.tracks[b];if(S&&typeof S.buffer.changeType=="function"){var C=E[b],P=C.codec,R=C.levelCodec,L=C.container,O=(S.levelCodec||S.codec).replace(h,"$1"),_=(R||P).replace(h,"$1");if(O!==_){var x=L+";codecs="+(R||P);w.appendChangeType(b,x)}}}else w.pendingTracks[b]=E[b]}),!D&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},p.appendChangeType=function(d,E){var w=this,D=this.operationQueue,b={execute:function(){var C=w.sourceBuffer[d];C&&(e.logger.log("[buffer-controller]: changing "+d+" sourceBuffer type to "+E),C.changeType(E)),D.shiftAndExecuteNext(d)},onStart:function(){},onComplete:function(){},onError:function(C){e.logger.warn("[buffer-controller]: Failed to change "+d+" SourceBuffer type",C)}};D.append(b,d)},p.onBufferAppending=function(d,E){var w=this,D=this.hls,b=this.operationQueue,S=this.tracks,C=E.data,P=E.type,R=E.frag,L=E.part,O=E.chunkMeta,_=O.buffering[P],x=self.performance.now();_.start=x;var A=R.stats.buffering,k=L?L.stats.buffering:null;A.start===0&&(A.start=x),k&&k.start===0&&(k.start=x);var M=S.audio,N=P==="audio"&&O.id===1&&(M==null?void 0:M.container)==="audio/mpeg",U={execute:function(){if(_.executeStart=self.performance.now(),N){var z=w.sourceBuffer[P];if(z){var J=R.start-z.timestampOffset;Math.abs(J)>=.1&&(e.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+R.start+" (delta: "+J+") sn: "+R.sn+")"),z.timestampOffset=R.start)}}w.appendExecutor(C,P)},onStart:function(){},onComplete:function(){var z=self.performance.now();_.executeEnd=_.end=z,A.first===0&&(A.first=z),k&&k.first===0&&(k.first=z);var J=w.sourceBuffer,te={};for(var re in J)te[re]=a.BufferHelper.getBuffered(J[re]);w.appendError=0,w.hls.trigger(l.Events.BUFFER_APPENDED,{type:P,frag:R,part:L,chunkMeta:O,parent:R.type,timeRanges:te})},onError:function(z){e.logger.error("[buffer-controller]: Error encountered while trying to append to the "+P+" SourceBuffer",z);var J={type:n.ErrorTypes.MEDIA_ERROR,parent:R.type,details:n.ErrorDetails.BUFFER_APPEND_ERROR,err:z,fatal:!1};z.code===DOMException.QUOTA_EXCEEDED_ERR?J.details=n.ErrorDetails.BUFFER_FULL_ERROR:(w.appendError++,J.details=n.ErrorDetails.BUFFER_APPEND_ERROR,w.appendError>D.config.appendErrorMaxRetry&&(e.logger.error("[buffer-controller]: Failed "+D.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),J.fatal=!0)),D.trigger(l.Events.ERROR,J)}};b.append(U,P)},p.onBufferFlushing=function(d,E){var w=this,D=this.operationQueue,b=function(C){return{execute:w.removeExecutor.bind(w,C,E.startOffset,E.endOffset),onStart:function(){},onComplete:function(){w.hls.trigger(l.Events.BUFFER_FLUSHED,{type:C})},onError:function(R){e.logger.warn("[buffer-controller]: Failed to remove from "+C+" SourceBuffer",R)}}};E.type?D.append(b(E.type),E.type):this.getSourceBufferTypes().forEach(function(S){D.append(b(S),S)})},p.onFragParsed=function(d,E){var w=this,D=E.frag,b=E.part,S=[],C=b?b.elementaryStreams:D.elementaryStreams;C[u.ElementaryStreamTypes.AUDIOVIDEO]?S.push("audiovideo"):(C[u.ElementaryStreamTypes.AUDIO]&&S.push("audio"),C[u.ElementaryStreamTypes.VIDEO]&&S.push("video"));var P=function(){var L=self.performance.now();D.stats.buffering.end=L,b&&(b.stats.buffering.end=L);var O=b?b.stats:D.stats;w.hls.trigger(l.Events.FRAG_BUFFERED,{frag:D,part:b,stats:O,id:D.type})};S.length===0&&e.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+D.type+" level: "+D.level+" sn: "+D.sn),this.blockBuffers(P,S)},p.onFragChanged=function(d,E){this.flushBackBuffer()},p.onBufferEos=function(d,E){var w=this,D=this.getSourceBufferTypes().reduce(function(b,S){var C=w.sourceBuffer[S];return(!E.type||E.type===S)&&C&&!C.ended&&(C.ended=!0,e.logger.log("[buffer-controller]: "+S+" sourceBuffer now EOS")),b&&!!(!C||C.ended)},!0);D&&this.blockBuffers(function(){var b=w.mediaSource;!b||b.readyState!=="open"||b.endOfStream()})},p.onLevelUpdated=function(d,E){var w=E.details;!w.fragments.length||(this.details=w,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},p.flushBackBuffer=function(){var d=this.hls,E=this.details,w=this.media,D=this.sourceBuffer;if(!(!w||E===null)){var b=this.getSourceBufferTypes();if(!!b.length){var S=E.live&&d.config.liveBackBufferLength!==null?d.config.liveBackBufferLength:d.config.backBufferLength;if(!(!Object(c.isFiniteNumber)(S)||S<0)){var C=w.currentTime,P=E.levelTargetDuration,R=Math.max(S,P),L=Math.floor(C/P)*P-R;b.forEach(function(O){var _=D[O];if(_){var x=a.BufferHelper.getBuffered(_);x.length>0&&L>x.start(0)&&(d.trigger(l.Events.BACK_BUFFER_REACHED,{bufferEnd:L}),E.live&&d.trigger(l.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:L}),d.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:L,type:O}))}})}}}},p.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var d=this.details,E=this.hls,w=this.media,D=this.mediaSource,b=d.fragments[0].start+d.totalduration,S=w.duration,C=Object(c.isFiniteNumber)(D.duration)?D.duration:0;d.live&&E.config.liveDurationInfinity?(e.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),D.duration=1/0,this.updateSeekableRange(d)):(b>C&&b>S||!Object(c.isFiniteNumber)(S))&&(e.logger.log("[buffer-controller]: Updating Media Source duration to "+b.toFixed(3)),D.duration=b)}},p.updateSeekableRange=function(d){var E=this.mediaSource,w=d.fragments,D=w.length;if(D&&d.live&&E!==null&&E!==void 0&&E.setLiveSeekableRange){var b=Math.max(0,w[0].start),S=Math.max(b,b+d.totalduration);E.setLiveSeekableRange(b,S)}},p.checkPendingTracks=function(){var d=this.bufferCodecEventsExpected,E=this.operationQueue,w=this.pendingTracks,D=Object.keys(w).length;if(D&&!d||D===2){this.createSourceBuffers(w),this.pendingTracks={};var b=this.getSourceBufferTypes();if(b.length===0){this.hls.trigger(l.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}b.forEach(function(S){E.executeNext(S)})}},p.createSourceBuffers=function(d){var E=this.sourceBuffer,w=this.mediaSource;if(!w)throw Error("createSourceBuffers called when mediaSource was null");var D=0;for(var b in d)if(!E[b]){var S=d[b];if(!S)throw Error("source buffer exists for track "+b+", however track does not");var C=S.levelCodec||S.codec,P=S.container+";codecs="+C;e.logger.log("[buffer-controller]: creating sourceBuffer("+P+")");try{var R=E[b]=w.addSourceBuffer(P),L=b;this.addBufferListener(L,"updatestart",this._onSBUpdateStart),this.addBufferListener(L,"updateend",this._onSBUpdateEnd),this.addBufferListener(L,"error",this._onSBUpdateError),this.tracks[b]={buffer:R,codec:C,container:S.container,levelCodec:S.levelCodec,id:S.id},D++}catch(O){e.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+O.message),this.hls.trigger(l.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:O,mimeType:P})}}D&&this.hls.trigger(l.Events.BUFFER_CREATED,{tracks:this.tracks})},p._onSBUpdateStart=function(d){var E=this.operationQueue,w=E.current(d);w.onStart()},p._onSBUpdateEnd=function(d){var E=this.operationQueue,w=E.current(d);w.onComplete(),E.shiftAndExecuteNext(d)},p._onSBUpdateError=function(d,E){e.logger.error("[buffer-controller]: "+d+" SourceBuffer error",E),this.hls.trigger(l.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var w=this.operationQueue.current(d);w&&w.onError(E)},p.removeExecutor=function(d,E,w){var D=this.media,b=this.mediaSource,S=this.operationQueue,C=this.sourceBuffer,P=C[d];if(!D||!b||!P){e.logger.warn("[buffer-controller]: Attempting to remove from the "+d+" SourceBuffer, but it does not exist"),S.shiftAndExecuteNext(d);return}var R=Object(c.isFiniteNumber)(D.duration)?D.duration:1/0,L=Object(c.isFiniteNumber)(b.duration)?b.duration:1/0,O=Math.max(0,E),_=Math.min(w,R,L);_>O?(e.logger.log("[buffer-controller]: Removing ["+O+","+_+"] from the "+d+" SourceBuffer"),console.assert(!P.updating,d+" sourceBuffer must not be updating"),P.remove(O,_)):S.shiftAndExecuteNext(d)},p.appendExecutor=function(d,E){var w=this.operationQueue,D=this.sourceBuffer,b=D[E];if(!b){e.logger.warn("[buffer-controller]: Attempting to append to the "+E+" SourceBuffer, but it does not exist"),w.shiftAndExecuteNext(E);return}b.ended=!1,console.assert(!b.updating,E+" sourceBuffer must not be updating"),b.appendBuffer(d)},p.blockBuffers=function(d,E){var w=this;if(E===void 0&&(E=this.getSourceBufferTypes()),!E.length){e.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(d);return}var D=this.operationQueue,b=E.map(function(S){return D.appendBlocker(S)});Promise.all(b).then(function(){d(),E.forEach(function(S){var C=w.sourceBuffer[S];(!C||!C.updating)&&D.shiftAndExecuteNext(S)})})},p.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},p.addBufferListener=function(d,E,w){var D=this.sourceBuffer[d];if(!!D){var b=w.bind(this,d);this.listeners[d].push({event:E,listener:b}),D.addEventListener(E,b)}},p.removeBufferListeners=function(d){var E=this.sourceBuffer[d];!E||this.listeners[d].forEach(function(w){E.removeEventListener(w.event,w.listener)})},y}()},"./src/controller/buffer-operation-queue.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return l});var c=r("./src/utils/logger.ts"),l=function(){function e(a){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=a}var n=e.prototype;return n.append=function(s,u){var t=this.queues[u];t.push(s),t.length===1&&this.buffers[u]&&this.executeNext(u)},n.insertAbort=function(s,u){var t=this.queues[u];t.unshift(s),this.executeNext(u)},n.appendBlocker=function(s){var u,t=new Promise(function(h){u=h}),f={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(f,s),t},n.executeNext=function(s){var u=this.buffers,t=this.queues,f=u[s],h=t[s];if(h.length){var v=h[0];try{v.execute()}catch(y){c.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),v.onError(y),(!f||!f.updating)&&(h.shift(),this.executeNext(s))}}},n.shiftAndExecuteNext=function(s){this.queues[s].shift(),this.executeNext(s)},n.current=function(s){return this.queues[s][0]},e}()},"./src/controller/cap-level-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts");function l(a,s){for(var u=0;u<s.length;u++){var t=s[u];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,t.key,t)}}function e(a,s,u){return s&&l(a.prototype,s),u&&l(a,u),a}var n=function(){function a(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var s=a.prototype;return s.setStreamController=function(t){this.streamController=t},s.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},s.registerListeners=function(){var t=this.hls;t.on(c.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.unregisterListener=function(){var t=this.hls;t.off(c.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.onFpsDropLevelCapping=function(t,f){a.isLevelAllowed(f.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(f.droppedLevel)},s.onMediaAttaching=function(t,f){this.media=f.media instanceof HTMLVideoElement?f.media:null},s.onManifestParsed=function(t,f){var h=this.hls;this.restrictedLevels=[],this.firstLevel=f.firstLevel,h.config.capLevelToPlayerSize&&f.video&&this.startCapping()},s.onBufferCodecs=function(t,f){var h=this.hls;h.config.capLevelToPlayerSize&&f.video&&this.startCapping()},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var t=this.hls.levels;if(t.length){var f=this.hls;f.autoLevelCapping=this.getMaxLevel(t.length-1),f.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=f.autoLevelCapping}}},s.getMaxLevel=function(t){var f=this,h=this.hls.levels;if(!h.length)return-1;var v=h.filter(function(y,p){return a.isLevelAllowed(p,f.restrictedLevels)&&p<=t});return this.clientRect=null,a.getMaxLevelByMediaSize(v,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,f={width:0,height:0};if(t){var h=t.getBoundingClientRect();f.width=h.width,f.height=h.height,!f.width&&!f.height&&(f.width=h.right-h.left||t.width||0,f.height=h.bottom-h.top||t.height||0)}return this.clientRect=f,f},a.isLevelAllowed=function(t,f){return f===void 0&&(f=[]),f.indexOf(t)===-1},a.getMaxLevelByMediaSize=function(t,f,h){if(!t||!t.length)return-1;for(var v=function(E,w){return w?E.width!==w.width||E.height!==w.height:!0},y=t.length-1,p=0;p<t.length;p+=1){var g=t[p];if((g.width>=f||g.height>=h)&&v(g,t[p+1])){y=p;break}}return y},e(a,[{key:"mediaWidth",get:function(){return this.getDimensions().width*a.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*a.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var t=1;try{t=self.devicePixelRatio}catch{}return t}}]),a}();m.default=n},"./src/controller/cmcd-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return v});var c=r("./src/events.ts"),l=r("./src/types/cmcd.ts"),e=r("./src/utils/buffer-helper.ts"),n=r("./src/utils/logger.ts");function a(y,p){for(var g=0;g<p.length;g++){var d=p[g];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(y,d.key,d)}}function s(y,p,g){return p&&a(y.prototype,p),g&&a(y,g),y}function u(y,p){var g=typeof Symbol!="undefined"&&y[Symbol.iterator]||y["@@iterator"];if(g)return(g=g.call(y)).next.bind(g);if(Array.isArray(y)||(g=t(y))||p&&y&&typeof y.length=="number"){g&&(y=g);var d=0;return function(){return d>=y.length?{done:!0}:{done:!1,value:y[d++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(y,p){if(!!y){if(typeof y=="string")return f(y,p);var g=Object.prototype.toString.call(y).slice(8,-1);if(g==="Object"&&y.constructor&&(g=y.constructor.name),g==="Map"||g==="Set")return Array.from(y);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return f(y,p)}}function f(y,p){(p==null||p>y.length)&&(p=y.length);for(var g=0,d=new Array(p);g<p;g++)d[g]=y[g];return d}function h(){return h=Object.assign||function(y){for(var p=1;p<arguments.length;p++){var g=arguments[p];for(var d in g)Object.prototype.hasOwnProperty.call(g,d)&&(y[d]=g[d])}return y},h.apply(this,arguments)}var v=function(){function y(g){var d=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){d.initialized&&(d.starved=!0),d.buffering=!0},this.onPlaying=function(){d.initialized||(d.initialized=!0),d.buffering=!1},this.applyPlaylistData=function(D){try{d.apply(D,{ot:l.CMCDObjectType.MANIFEST,su:!d.initialized})}catch(b){n.logger.warn("Could not generate manifest CMCD data.",b)}},this.applyFragmentData=function(D){try{var b=D.frag,S=d.hls.levels[b.level],C=d.getObjectType(b),P={d:b.duration*1e3,ot:C};(C===l.CMCDObjectType.VIDEO||C===l.CMCDObjectType.AUDIO||C==l.CMCDObjectType.MUXED)&&(P.br=S.bitrate/1e3,P.tb=d.getTopBandwidth(C),P.bl=d.getBufferLength(C)),d.apply(D,P)}catch(R){n.logger.warn("Could not generate segment CMCD data.",R)}},this.hls=g;var E=this.config=g.config,w=E.cmcd;w!=null&&(E.pLoader=this.createPlaylistLoader(),E.fLoader=this.createFragmentLoader(),this.sid=w.sessionId||y.uuid(),this.cid=w.contentId,this.useHeaders=w.useHeaders===!0,this.registerListeners())}var p=y.prototype;return p.registerListeners=function(){var d=this.hls;d.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.on(c.Events.MEDIA_DETACHED,this.onMediaDetached,this),d.on(c.Events.BUFFER_CREATED,this.onBufferCreated,this)},p.unregisterListeners=function(){var d=this.hls;d.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.off(c.Events.MEDIA_DETACHED,this.onMediaDetached,this),d.off(c.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},p.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},p.onMediaAttached=function(d,E){this.media=E.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},p.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},p.onBufferCreated=function(d,E){var w,D;this.audioBuffer=(w=E.tracks.audio)===null||w===void 0?void 0:w.buffer,this.videoBuffer=(D=E.tracks.video)===null||D===void 0?void 0:D.buffer},p.createData=function(){var d;return{v:l.CMCDVersion,sf:l.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(d=this.media)===null||d===void 0?void 0:d.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},p.apply=function(d,E){E===void 0&&(E={}),h(E,this.createData());var w=E.ot===l.CMCDObjectType.INIT||E.ot===l.CMCDObjectType.VIDEO||E.ot===l.CMCDObjectType.MUXED;if(this.starved&&w&&(E.bs=!0,E.su=!0,this.starved=!1),E.su==null&&(E.su=this.buffering),this.useHeaders){var D=y.toHeaders(E);if(!Object.keys(D).length)return;d.headers||(d.headers={}),h(d.headers,D)}else{var b=y.toQuery(E);if(!b)return;d.url=y.appendQueryToUri(d.url,b)}},p.getObjectType=function(d){var E=d.type;if(E==="subtitle")return l.CMCDObjectType.TIMED_TEXT;if(d.sn==="initSegment")return l.CMCDObjectType.INIT;if(E==="audio")return l.CMCDObjectType.AUDIO;if(E==="main")return this.hls.audioTracks.length?l.CMCDObjectType.VIDEO:l.CMCDObjectType.MUXED},p.getTopBandwidth=function(d){for(var E=0,w=d===l.CMCDObjectType.AUDIO?this.hls.audioTracks:this.hls.levels,D=u(w),b;!(b=D()).done;){var S=b.value;S.bitrate>E&&(E=S.bitrate)}return E>0?E:NaN},p.getBufferLength=function(d){var E=this.hls.media,w=d===l.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!w||!E)return NaN;var D=e.BufferHelper.bufferInfo(w,E.currentTime,this.config.maxBufferHole);return D.len*1e3},p.createPlaylistLoader=function(){var d=this.config.pLoader,E=this.applyPlaylistData,w=d||this.config.loader;return function(){function D(S){this.loader=void 0,this.loader=new w(S)}var b=D.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(C,P,R){E(C),this.loader.load(C,P,R)},s(D,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),D}()},p.createFragmentLoader=function(){var d=this.config.fLoader,E=this.applyFragmentData,w=d||this.config.loader;return function(){function D(S){this.loader=void 0,this.loader=new w(S)}var b=D.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(C,P,R){E(C),this.loader.load(C,P,R)},s(D,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),D}()},y.uuid=function(){var d=URL.createObjectURL(new Blob),E=d.toString();return URL.revokeObjectURL(d),E.substr(E.lastIndexOf("/")+1)},y.serialize=function(d){for(var E=[],w=function(N){return!Number.isNaN(N)&&N!=null&&N!==""&&N!==!1},D=function(N){return Math.round(N)},b=function(N){return D(N/100)*100},S=function(N){return encodeURIComponent(N)},C={br:D,d:D,bl:b,dl:b,mtp:b,nor:S,rtp:b,tb:D},P=Object.keys(d||{}).sort(),R=u(P),L;!(L=R()).done;){var O=L.value,_=d[O];if(!!w(_)&&!(O==="v"&&_===1)&&!(O=="pr"&&_===1)){var x=C[O];x&&(_=x(_));var A=typeof _,k=void 0;O==="ot"||O==="sf"||O==="st"?k=O+"="+_:A==="boolean"?k=O:A==="number"?k=O+"="+_:k=O+"="+JSON.stringify(_),E.push(k)}}return E.join(",")},y.toHeaders=function(d){for(var E=Object.keys(d),w={},D=["Object","Request","Session","Status"],b=[{},{},{},{}],S={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},C=0,P=E;C<P.length;C++){var R=P[C],L=S[R]!=null?S[R]:1;b[L][R]=d[R]}for(var O=0;O<b.length;O++){var _=y.serialize(b[O]);_&&(w["CMCD-"+D[O]]=_)}return w},y.toQuery=function(d){return"CMCD="+encodeURIComponent(y.serialize(d))},y.appendQueryToUri=function(d,E){if(!E)return d;var w=d.includes("?")?"&":"?";return""+d+w+E},y}()},"./src/controller/eme-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts"),l=r("./src/errors.ts"),e=r("./src/utils/logger.ts"),n=r("./src/utils/mediakeys-helper.ts");function a(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}function s(v,y,p){return y&&a(v.prototype,y),p&&a(v,p),v}var u=3,t=function(y,p,g){var d={audioCapabilities:[],videoCapabilities:[]};return y.forEach(function(E){d.audioCapabilities.push({contentType:'audio/mp4; codecs="'+E+'"',robustness:g.audioRobustness||""})}),p.forEach(function(E){d.videoCapabilities.push({contentType:'video/mp4; codecs="'+E+'"',robustness:g.videoRobustness||""})}),[d]},f=function(y,p,g,d){switch(y){case n.KeySystems.WIDEVINE:return t(p,g,d);default:throw new Error("Unknown key-system: "+y)}},h=function(){function v(p){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=p,this._config=p.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var y=v.prototype;return y.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},y._registerListeners=function(){this.hls.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(c.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this)},y._unregisterListeners=function(){this.hls.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(c.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this)},y.getLicenseServerUrl=function(g){switch(g){case n.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+g+'"')},y._attemptKeySystemAccess=function(g,d,E){var w=this,D=f(g,d,E,this._drmSystemOptions);e.logger.log("Requesting encrypted media key-system access");var b=this.requestMediaKeySystemAccess(g,D);this.mediaKeysPromise=b.then(function(S){return w._onMediaKeySystemAccessObtained(g,S)}),b.catch(function(S){e.logger.error('Failed to obtain key-system "'+g+'" access:',S)})},y._onMediaKeySystemAccessObtained=function(g,d){var E=this;e.logger.log('Access for key-system "'+g+'" obtained');var w={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:d,mediaKeySystemDomain:g};this._mediaKeysList.push(w);var D=Promise.resolve().then(function(){return d.createMediaKeys()}).then(function(b){return w.mediaKeys=b,e.logger.log('Media-keys created for key-system "'+g+'"'),E._onMediaKeysCreated(),b});return D.catch(function(b){e.logger.error("Failed to create media-keys:",b)}),D},y._onMediaKeysCreated=function(){var g=this;this._mediaKeysList.forEach(function(d){d.mediaKeysSession||(d.mediaKeysSession=d.mediaKeys.createSession(),g._onNewMediaKeySession(d.mediaKeysSession))})},y._onNewMediaKeySession=function(g){var d=this;e.logger.log("New key-system session "+g.sessionId),g.addEventListener("message",function(E){d._onKeySessionMessage(g,E.message)},!1)},y._onKeySessionMessage=function(g,d){e.logger.log("Got EME message event, creating license request"),this._requestLicense(d,function(E){e.logger.log("Received license data (length: "+(E&&E.byteLength)+"), updating key-session"),g.update(E)})},y.onMediaEncrypted=function(g){var d=this;if(e.logger.log('Media is encrypted using "'+g.initDataType+'" init data type'),!this.mediaKeysPromise){e.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var E=function(D){!d._media||(d._attemptSetMediaKeys(D),d._generateRequestWithPreferredKeySession(g.initDataType,g.initData))};this.mediaKeysPromise.then(E).catch(E)},y._attemptSetMediaKeys=function(g){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var d=this._mediaKeysList[0];if(!d||!d.mediaKeys){e.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}e.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(d.mediaKeys),this._hasSetMediaKeys=!0}},y._generateRequestWithPreferredKeySession=function(g,d){var E=this,w=this._mediaKeysList[0];if(!w){e.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(w.mediaKeysSessionInitialized){e.logger.warn("Key-Session already initialized but requested again");return}var D=w.mediaKeysSession;if(!D){e.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!d){e.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}e.logger.log('Generating key-session request for "'+g+'" init data type'),w.mediaKeysSessionInitialized=!0,D.generateRequest(g,d).then(function(){e.logger.debug("Key-session generation succeeded")}).catch(function(b){e.logger.error("Error generating key-session request:",b),E.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},y._createLicenseXhr=function(g,d,E){var w=new XMLHttpRequest;w.responseType="arraybuffer",w.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,w,g,d,E);var D=this._licenseXhrSetup;if(D)try{D.call(this.hls,w,g),D=void 0}catch(b){e.logger.error(b)}try{w.readyState||w.open("POST",g,!0),D&&D.call(this.hls,w,g)}catch(b){throw new Error("issue setting up KeySystem license XHR "+b)}return w},y._onLicenseRequestReadyStageChange=function(g,d,E,w){switch(g.readyState){case 4:if(g.status===200){this._requestLicenseFailureCount=0,e.logger.log("License request succeeded");var D=g.response,b=this._licenseResponseCallback;if(b)try{D=b.call(this.hls,g,d)}catch(C){e.logger.error(C)}w(D)}else{if(e.logger.error("License Request XHR failed ("+d+"). Status: "+g.status+" ("+g.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u){this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var S=u-this._requestLicenseFailureCount+1;e.logger.warn("Retrying license request, "+S+" attempts left"),this._requestLicense(E,w)}break}},y._generateLicenseRequestChallenge=function(g,d){switch(g.mediaKeySystemDomain){case n.KeySystems.WIDEVINE:return d}throw new Error("unsupported key-system: "+g.mediaKeySystemDomain)},y._requestLicense=function(g,d){e.logger.log("Requesting content license for key-system");var E=this._mediaKeysList[0];if(!E){e.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var w=this.getLicenseServerUrl(E.mediaKeySystemDomain),D=this._createLicenseXhr(w,g,d);e.logger.log("Sending license request to URL: "+w);var b=this._generateLicenseRequestChallenge(E,g);D.send(b)}catch(S){e.logger.error("Failure requesting DRM license: "+S),this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},y.onMediaAttached=function(g,d){if(!!this._emeEnabled){var E=d.media;this._media=E,E.addEventListener("encrypted",this._onMediaEncrypted)}},y.onMediaDetached=function(){var g=this._media,d=this._mediaKeysList;!g||(g.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(d.map(function(E){if(E.mediaKeysSession)return E.mediaKeysSession.close().catch(function(){})})).then(function(){return g.setMediaKeys(null)}).catch(function(){}))},y.onManifestParsed=function(g,d){if(!!this._emeEnabled){var E=d.levels.map(function(D){return D.audioCodec}).filter(function(D){return!!D}),w=d.levels.map(function(D){return D.videoCodec}).filter(function(D){return!!D});this._attemptKeySystemAccess(n.KeySystems.WIDEVINE,E,w)}},s(v,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),v}();m.default=h},"./src/controller/fps-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts"),l=r("./src/utils/logger.ts"),e=function(){function n(s){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=s,this.registerListeners()}var a=n.prototype;return a.setStreamController=function(u){this.streamController=u},a.registerListeners=function(){this.hls.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},a.unregisterListeners=function(){this.hls.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching)},a.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},a.onMediaAttaching=function(u,t){var f=this.hls.config;if(f.capLevelOnFPSDrop){var h=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=h,h&&typeof h.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),f.fpsDroppedMonitoringPeriod)}},a.checkFPS=function(u,t,f){var h=performance.now();if(t){if(this.lastTime){var v=h-this.lastTime,y=f-this.lastDroppedFrames,p=t-this.lastDecodedFrames,g=1e3*y/v,d=this.hls;if(d.trigger(c.Events.FPS_DROP,{currentDropped:y,currentDecoded:p,totalDroppedFrames:f}),g>0&&y>d.config.fpsDroppedMonitoringThreshold*p){var E=d.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+E),E>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=E)&&(E=E-1,d.trigger(c.Events.FPS_DROP_LEVEL_CAPPING,{level:E,droppedLevel:d.currentLevel}),d.autoLevelCapping=E,this.streamController.nextLevelSwitch())}}this.lastTime=h,this.lastDroppedFrames=f,this.lastDecodedFrames=t}},a.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var t=u.getVideoPlaybackQuality();this.checkFPS(u,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},n}();m.default=e},"./src/controller/fragment-finders.ts":function(G,m,r){r.r(m),r.d(m,"findFragmentByPDT",function(){return e}),r.d(m,"findFragmentByPTS",function(){return n}),r.d(m,"fragmentWithinToleranceTest",function(){return a}),r.d(m,"pdtWithinToleranceTest",function(){return s}),r.d(m,"findFragWithCC",function(){return u});var c=r("./src/polyfills/number.ts"),l=r("./src/utils/binary-search.ts");function e(t,f,h){if(f===null||!Array.isArray(t)||!t.length||!Object(c.isFiniteNumber)(f))return null;var v=t[0].programDateTime;if(f<(v||0))return null;var y=t[t.length-1].endProgramDateTime;if(f>=(y||0))return null;h=h||0;for(var p=0;p<t.length;++p){var g=t[p];if(s(f,h,g))return g}return null}function n(t,f,h,v){h===void 0&&(h=0),v===void 0&&(v=0);var y=null;if(t?y=f[t.sn-f[0].sn+1]||null:h===0&&f[0].start===0&&(y=f[0]),y&&a(h,v,y)===0)return y;var p=l.default.search(f,a.bind(null,h,v));return p||y}function a(t,f,h){t===void 0&&(t=0),f===void 0&&(f=0);var v=Math.min(f,h.duration+(h.deltaPTS?h.deltaPTS:0));return h.start+h.duration-v<=t?1:h.start-v>t&&h.start?-1:0}function s(t,f,h){var v=Math.min(f,h.duration+(h.deltaPTS?h.deltaPTS:0))*1e3,y=h.endProgramDateTime||0;return y-v>t}function u(t,f){return l.default.search(t,function(h){return h.cc<f?1:h.cc>f?-1:0})}},"./src/controller/fragment-tracker.ts":function(G,m,r){r.r(m),r.d(m,"FragmentState",function(){return e}),r.d(m,"FragmentTracker",function(){return n});var c=r("./src/events.ts"),l=r("./src/types/loader.ts"),e;(function(u){u.NOT_LOADED="NOT_LOADED",u.BACKTRACKED="BACKTRACKED",u.APPENDING="APPENDING",u.PARTIAL="PARTIAL",u.OK="OK"})(e||(e={}));var n=function(){function u(f){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=f,this._registerListeners()}var t=u.prototype;return t._registerListeners=function(){var h=this.hls;h.on(c.Events.BUFFER_APPENDED,this.onBufferAppended,this),h.on(c.Events.FRAG_BUFFERED,this.onFragBuffered,this),h.on(c.Events.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var h=this.hls;h.off(c.Events.BUFFER_APPENDED,this.onBufferAppended,this),h.off(c.Events.FRAG_BUFFERED,this.onFragBuffered,this),h.off(c.Events.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},t.getAppendedFrag=function(h,v){if(v===l.PlaylistLevelType.MAIN){var y=this.activeFragment,p=this.activeParts;if(!y)return null;if(p)for(var g=p.length;g--;){var d=p[g],E=d?d.end:y.appendedPTS;if(d.start<=h&&E!==void 0&&h<=E)return g>9&&(this.activeParts=p.slice(g-9)),d}else if(y.start<=h&&y.appendedPTS!==void 0&&h<=y.appendedPTS)return y}return this.getBufferedFrag(h,v)},t.getBufferedFrag=function(h,v){for(var y=this.fragments,p=Object.keys(y),g=p.length;g--;){var d=y[p[g]];if((d==null?void 0:d.body.type)===v&&d.buffered){var E=d.body;if(E.start<=h&&h<=E.end)return E}}return null},t.detectEvictedFragments=function(h,v,y){var p=this;Object.keys(this.fragments).forEach(function(g){var d=p.fragments[g];if(!!d){if(!d.buffered){d.body.type===y&&p.removeFragment(d.body);return}var E=d.range[h];!E||E.time.some(function(w){var D=!p.isTimeBuffered(w.startPTS,w.endPTS,v);return D&&p.removeFragment(d.body),D})}})},t.detectPartialFragments=function(h){var v=this,y=this.timeRanges,p=h.frag,g=h.part;if(!(!y||p.sn==="initSegment")){var d=s(p),E=this.fragments[d];!E||(Object.keys(y).forEach(function(w){var D=p.elementaryStreams[w];if(!!D){var b=y[w],S=g!==null||D.partial===!0;E.range[w]=v.getBufferedTimes(p,g,S,b)}}),E.backtrack=E.loaded=null,Object.keys(E.range).length?E.buffered=!0:this.removeFragment(E.body))}},t.fragBuffered=function(h){var v=s(h),y=this.fragments[v];y&&(y.backtrack=y.loaded=null,y.buffered=!0)},t.getBufferedTimes=function(h,v,y,p){for(var g={time:[],partial:y},d=v?v.start:h.start,E=v?v.end:h.end,w=h.minEndPTS||E,D=h.maxStartPTS||d,b=0;b<p.length;b++){var S=p.start(b)-this.bufferPadding,C=p.end(b)+this.bufferPadding;if(D>=S&&w<=C){g.time.push({startPTS:Math.max(d,p.start(b)),endPTS:Math.min(E,p.end(b))});break}else if(d<C&&E>S)g.partial=!0,g.time.push({startPTS:Math.max(d,p.start(b)),endPTS:Math.min(E,p.end(b))});else if(E<=S)break}return g},t.getPartialFragment=function(h){var v=null,y,p,g,d=0,E=this.bufferPadding,w=this.fragments;return Object.keys(w).forEach(function(D){var b=w[D];!b||a(b)&&(p=b.body.start-E,g=b.body.end+E,h>=p&&h<=g&&(y=Math.min(h-p,g-h),d<=y&&(v=b.body,d=y)))}),v},t.getState=function(h){var v=s(h),y=this.fragments[v];return y?y.buffered?a(y)?e.PARTIAL:e.OK:y.backtrack?e.BACKTRACKED:e.APPENDING:e.NOT_LOADED},t.backtrack=function(h,v){var y=s(h),p=this.fragments[y];if(!p||p.backtrack)return null;var g=p.backtrack=v||p.loaded;return p.loaded=null,g},t.getBacktrackData=function(h){var v=s(h),y=this.fragments[v];if(y){var p,g=y.backtrack;if(g!=null&&(p=g.payload)!==null&&p!==void 0&&p.byteLength)return g;this.removeFragment(h)}return null},t.isTimeBuffered=function(h,v,y){for(var p,g,d=0;d<y.length;d++){if(p=y.start(d)-this.bufferPadding,g=y.end(d)+this.bufferPadding,h>=p&&v<=g)return!0;if(v<=p)return!1}return!1},t.onFragLoaded=function(h,v){var y=v.frag,p=v.part;if(!(y.sn==="initSegment"||y.bitrateTest||p)){var g=s(y);this.fragments[g]={body:y,loaded:v,backtrack:null,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(h,v){var y=this,p=v.frag,g=v.part,d=v.timeRanges;if(p.type===l.PlaylistLevelType.MAIN)if(this.activeFragment=p,g){var E=this.activeParts;E||(this.activeParts=E=[]),E.push(g)}else this.activeParts=null;this.timeRanges=d,Object.keys(d).forEach(function(w){var D=d[w];if(y.detectEvictedFragments(w,D),!g)for(var b=0;b<D.length;b++)p.appendedPTS=Math.max(D.end(b),p.appendedPTS||0)})},t.onFragBuffered=function(h,v){this.detectPartialFragments(v)},t.hasFragment=function(h){var v=s(h);return!!this.fragments[v]},t.removeFragmentsInRange=function(h,v,y){var p=this;Object.keys(this.fragments).forEach(function(g){var d=p.fragments[g];if(!!d&&d.buffered){var E=d.body;E.type===y&&E.start<v&&E.end>h&&p.removeFragment(E)}})},t.removeFragment=function(h){var v=s(h);h.stats.loaded=0,h.clearElementaryStreamInfo(),delete this.fragments[v]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},u}();function a(u){var t,f;return u.buffered&&(((t=u.range.video)===null||t===void 0?void 0:t.partial)||((f=u.range.audio)===null||f===void 0?void 0:f.partial))}function s(u){return u.type+"_"+u.level+"_"+u.urlId+"_"+u.sn}},"./src/controller/gap-controller.ts":function(G,m,r){r.r(m),r.d(m,"STALL_MINIMUM_DURATION_MS",function(){return a}),r.d(m,"MAX_START_GAP_JUMP",function(){return s}),r.d(m,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return u}),r.d(m,"SKIP_BUFFER_RANGE_START",function(){return t}),r.d(m,"default",function(){return f});var c=r("./src/utils/buffer-helper.ts"),l=r("./src/errors.ts"),e=r("./src/events.ts"),n=r("./src/utils/logger.ts"),a=250,s=2,u=.1,t=.05,f=function(){function h(y,p,g,d){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=y,this.media=p,this.fragmentTracker=g,this.hls=d}var v=h.prototype;return v.destroy=function(){this.hls=this.fragmentTracker=this.media=null},v.poll=function(p){var g=this.config,d=this.media,E=this.stalled,w=d.currentTime,D=d.seeking,b=this.seeking&&!D,S=!this.seeking&&D;if(this.seeking=D,w!==p){if(this.moved=!0,E!==null){if(this.stallReported){var C=self.performance.now()-E;n.logger.warn("playback not stuck anymore @"+w+", after "+Math.round(C)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((S||b)&&(this.stalled=null),!(d.paused||d.ended||d.playbackRate===0||!c.BufferHelper.getBuffered(d).length)){var P=c.BufferHelper.bufferInfo(d,w,0),R=P.len>0,L=P.nextStart||0;if(!(!R&&!L)){if(D){var O=P.len>s,_=!L||L-w>s&&!this.fragmentTracker.getPartialFragment(w);if(O||_)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var x,A=Math.max(L,P.start||0)-w,k=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,M=k==null||(x=k.details)===null||x===void 0?void 0:x.live,N=M?k.details.targetduration*2:s;if(A>0&&A<=N){this._trySkipBufferHole(null);return}}var U=self.performance.now();if(E===null){this.stalled=U;return}var j=U-E;!D&&j>=a&&this._reportStall(P.len);var z=c.BufferHelper.bufferInfo(d,w,g.maxBufferHole);this._tryFixBufferStall(z,j)}}},v._tryFixBufferStall=function(p,g){var d=this.config,E=this.fragmentTracker,w=this.media,D=w.currentTime,b=E.getPartialFragment(D);if(b){var S=this._trySkipBufferHole(b);if(S)return}p.len>d.maxBufferHole&&g>d.highBufferWatchdogPeriod*1e3&&(n.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},v._reportStall=function(p){var g=this.hls,d=this.media,E=this.stallReported;E||(this.stallReported=!0,n.logger.warn("Playback stalling at @"+d.currentTime+" due to low buffer (buffer="+p+")"),g.trigger(e.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:p}))},v._trySkipBufferHole=function(p){for(var g=this.config,d=this.hls,E=this.media,w=E.currentTime,D=0,b=c.BufferHelper.getBuffered(E),S=0;S<b.length;S++){var C=b.start(S);if(w+g.maxBufferHole>=D&&w<C){var P=Math.max(C+t,E.currentTime+u);return n.logger.warn("skipping hole, adjusting currentTime from "+w+" to "+P),this.moved=!0,this.stalled=null,E.currentTime=P,p&&d.trigger(e.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+w+" to "+P,frag:p}),P}D=b.end(S)}return 0},v._tryNudgeBuffer=function(){var p=this.config,g=this.hls,d=this.media,E=d.currentTime,w=(this.nudgeRetry||0)+1;if(this.nudgeRetry=w,w<p.nudgeMaxRetry){var D=E+w*p.nudgeOffset;n.logger.warn("Nudging 'currentTime' from "+E+" to "+D),d.currentTime=D,g.trigger(e.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else n.logger.error("Playhead still not moving while enough data buffered @"+E+" after "+p.nudgeMaxRetry+" nudges"),g.trigger(e.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},h}()},"./src/controller/id3-track-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts"),l=r("./src/utils/texttrack-utils.ts"),e=r("./src/demux/id3.ts"),n=.25,a=function(){function s(t){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=t,this._registerListeners()}var u=s.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var f=this.hls;f.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(c.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var f=this.hls;f.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(c.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(f,h){this.media=h.media},u.onMediaDetaching=function(){!this.id3Track||(Object(l.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(f){if(!!this.media){for(var h=0;h<f.length;h++){var v=f[h];if(v.kind==="metadata"&&v.label==="id3")return Object(l.sendAddTrackEvent)(v,this.media),v}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(f,h){if(!!this.media){var v=h.frag,y=h.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var p=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,g=0;g<y.length;g++){var d=e.getID3Frames(y[g].data);if(d){var E=y[g].pts,w=g<y.length-1?y[g+1].pts:v.end,D=w-E;D<=0&&(w=E+n);for(var b=0;b<d.length;b++){var S=d[b];if(!e.isTimeStampFrame(S)){var C=new p(E,w,"");C.value=S,this.id3Track.addCue(C)}}}}}},u.onBufferFlushing=function(f,h){var v=h.startOffset,y=h.endOffset,p=h.type;if(!p||p==="audio"){var g=this.id3Track;g&&Object(l.removeCuesInRange)(g,v,y)}},s}();m.default=a},"./src/controller/latency-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return s});var c=r("./src/errors.ts"),l=r("./src/events.ts"),e=r("./src/utils/logger.ts");function n(u,t){for(var f=0;f<t.length;f++){var h=t[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}function a(u,t,f){return t&&n(u.prototype,t),f&&n(u,f),u}var s=function(){function u(f){var h=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return h.timeupdate()},this.hls=f,this.config=f.config,this.registerListeners()}var t=u.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},t.registerListeners=function(){this.hls.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(l.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(l.Events.ERROR,this.onError,this)},t.unregisterListeners=function(){this.hls.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(l.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(l.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(l.Events.ERROR,this.onError)},t.onMediaAttached=function(h,v){this.media=v.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},t.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},t.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},t.onLevelUpdated=function(h,v){var y=v.details;this.levelDetails=y,y.advanced&&this.timeupdate(),!y.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},t.onError=function(h,v){v.details===c.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,e.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},t.timeupdate=function(){var h=this.media,v=this.levelDetails;if(!(!h||!v)){this.currentTime=h.currentTime;var y=this.computeLatency();if(y!==null){this._latency=y;var p=this.config,g=p.lowLatencyMode,d=p.maxLiveSyncPlaybackRate;if(!(!g||d===1)){var E=this.targetLatency;if(E!==null){var w=y-E,D=Math.min(this.maxLatency,E+v.targetduration),b=w<D;if(v.live&&b&&w>.05&&this.forwardBufferLength>1){var S=Math.min(2,Math.max(1,d)),C=Math.round(2/(1+Math.exp(-.75*w-this.edgeStalled))*20)/20;h.playbackRate=Math.min(S,Math.max(1,C))}else h.playbackRate!==1&&h.playbackRate!==0&&(h.playbackRate=1)}}}}},t.estimateLiveEdge=function(){var h=this.levelDetails;return h===null?null:h.edge+h.age},t.computeLatency=function(){var h=this.estimateLiveEdge();return h===null?null:h-this.currentTime},a(u,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var h=this.config,v=this.levelDetails;return h.liveMaxLatencyDuration!==void 0?h.liveMaxLatencyDuration:v?h.liveMaxLatencyDurationCount*v.targetduration:0}},{key:"targetLatency",get:function(){var h=this.levelDetails;if(h===null)return null;var v=h.holdBack,y=h.partHoldBack,p=h.targetduration,g=this.config,d=g.liveSyncDuration,E=g.liveSyncDurationCount,w=g.lowLatencyMode,D=this.hls.userConfig,b=w&&y||v;(D.liveSyncDuration||D.liveSyncDurationCount||b===0)&&(b=d!==void 0?d:E*p);var S=p,C=1;return b+Math.min(this.stallCount*C,S)}},{key:"liveSyncPosition",get:function(){var h=this.estimateLiveEdge(),v=this.targetLatency,y=this.levelDetails;if(h===null||v===null||y===null)return null;var p=y.edge,g=h-v-this.edgeStalled,d=p-y.totalduration,E=p-(this.config.lowLatencyMode&&y.partTarget||y.targetduration);return Math.min(Math.max(d,g),E)}},{key:"drift",get:function(){var h=this.levelDetails;return h===null?1:h.drift}},{key:"edgeStalled",get:function(){var h=this.levelDetails;if(h===null)return 0;var v=(this.config.lowLatencyMode&&h.partTarget||h.targetduration)*3;return Math.max(h.age-v,0)}},{key:"forwardBufferLength",get:function(){var h=this.media,v=this.levelDetails;if(!h||!v)return 0;var y=h.buffered.length;return y?h.buffered.end(y-1):v.edge-this.currentTime}}]),u}()},"./src/controller/level-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return g});var c=r("./src/types/level.ts"),l=r("./src/events.ts"),e=r("./src/errors.ts"),n=r("./src/utils/codecs.ts"),a=r("./src/controller/level-helper.ts"),s=r("./src/controller/base-playlist-controller.ts"),u=r("./src/types/loader.ts");function t(){return t=Object.assign||function(d){for(var E=1;E<arguments.length;E++){var w=arguments[E];for(var D in w)Object.prototype.hasOwnProperty.call(w,D)&&(d[D]=w[D])}return d},t.apply(this,arguments)}function f(d,E){for(var w=0;w<E.length;w++){var D=E[w];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(d,D.key,D)}}function h(d,E,w){return E&&f(d.prototype,E),w&&f(d,w),d}function v(d,E){d.prototype=Object.create(E.prototype),d.prototype.constructor=d,y(d,E)}function y(d,E){return y=Object.setPrototypeOf||function(D,b){return D.__proto__=b,D},y(d,E)}var p=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),g=function(d){v(E,d);function E(D){var b;return b=d.call(this,D,"[level-controller]")||this,b._levels=[],b._firstLevel=-1,b._startLevel=void 0,b.currentLevelIndex=-1,b.manualLevelIndex=-1,b.onParsedComplete=void 0,b._registerListeners(),b}var w=E.prototype;return w._registerListeners=function(){var b=this.hls;b.on(l.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(l.Events.FRAG_LOADED,this.onFragLoaded,this),b.on(l.Events.ERROR,this.onError,this)},w._unregisterListeners=function(){var b=this.hls;b.off(l.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(l.Events.FRAG_LOADED,this.onFragLoaded,this),b.off(l.Events.ERROR,this.onError,this)},w.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,d.prototype.destroy.call(this)},w.startLoad=function(){var b=this._levels;b.forEach(function(S){S.loadError=0}),d.prototype.startLoad.call(this)},w.onManifestLoaded=function(b,S){var C=[],P=[],R=[],L,O={},_,x=!1,A=!1,k=!1;if(S.levels.forEach(function(j){var z=j.attrs;x=x||!!(j.width&&j.height),A=A||!!j.videoCodec,k=k||!!j.audioCodec,p&&j.audioCodec&&j.audioCodec.indexOf("mp4a.40.34")!==-1&&(j.audioCodec=void 0);var J=j.bitrate+"-"+j.attrs.RESOLUTION+"-"+j.attrs.CODECS;_=O[J],_?_.url.push(j.url):(_=new c.Level(j),O[J]=_,C.push(_)),z&&(z.AUDIO&&Object(a.addGroupId)(_,"audio",z.AUDIO),z.SUBTITLES&&Object(a.addGroupId)(_,"text",z.SUBTITLES))}),(x||A)&&k&&(C=C.filter(function(j){var z=j.videoCodec,J=j.width,te=j.height;return!!z||!!(J&&te)})),C=C.filter(function(j){var z=j.audioCodec,J=j.videoCodec;return(!z||Object(n.isCodecSupportedInMp4)(z,"audio"))&&(!J||Object(n.isCodecSupportedInMp4)(J,"video"))}),S.audioTracks&&(P=S.audioTracks.filter(function(j){return!j.audioCodec||Object(n.isCodecSupportedInMp4)(j.audioCodec,"audio")}),Object(a.assignTrackIdsByGroup)(P)),S.subtitles&&(R=S.subtitles,Object(a.assignTrackIdsByGroup)(R)),C.length>0){L=C[0].bitrate,C.sort(function(j,z){return j.bitrate-z.bitrate}),this._levels=C;for(var M=0;M<C.length;M++)if(C[M].bitrate===L){this._firstLevel=M,this.log("manifest loaded, "+C.length+" level(s) found, first bitrate: "+L);break}var N=k&&!A,U={levels:C,audioTracks:P,subtitleTracks:R,firstLevel:this._firstLevel,stats:S.stats,audio:k,video:A,altAudio:!N&&P.some(function(j){return!!j.url})};this.hls.trigger(l.Events.MANIFEST_PARSED,U),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(l.Events.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:S.url,reason:"no level with compatible codecs found in manifest"})},w.onError=function(b,S){if(d.prototype.onError.call(this,b,S),!S.fatal){var C=S.context,P=this._levels[this.currentLevelIndex];if(C&&(C.type===u.PlaylistContextType.AUDIO_TRACK&&P.audioGroupIds&&C.groupId===P.audioGroupIds[P.urlId]||C.type===u.PlaylistContextType.SUBTITLE_TRACK&&P.textGroupIds&&C.groupId===P.textGroupIds[P.urlId])){this.redundantFailover(this.currentLevelIndex);return}var R=!1,L=!0,O;switch(S.details){case e.ErrorDetails.FRAG_LOAD_ERROR:case e.ErrorDetails.FRAG_LOAD_TIMEOUT:case e.ErrorDetails.KEY_LOAD_ERROR:case e.ErrorDetails.KEY_LOAD_TIMEOUT:if(S.frag){var _=this._levels[S.frag.level];_?(_.fragmentError++,_.fragmentError>this.hls.config.fragLoadingMaxRetry&&(O=S.frag.level)):O=S.frag.level}break;case e.ErrorDetails.LEVEL_LOAD_ERROR:case e.ErrorDetails.LEVEL_LOAD_TIMEOUT:C&&(C.deliveryDirectives&&(L=!1),O=C.level),R=!0;break;case e.ErrorDetails.REMUX_ALLOC_ERROR:O=S.level,R=!0;break}O!==void 0&&this.recoverLevel(S,O,R,L)}},w.recoverLevel=function(b,S,C,P){var R=b.details,L=this._levels[S];if(L.loadError++,C){var O=this.retryLoadingOrFail(b);if(O)b.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(P){var _=L.url.length;if(_>1&&L.loadError<_)b.levelRetry=!0,this.redundantFailover(S);else if(this.manualLevelIndex===-1){var x=S===0?this._levels.length-1:S-1;this.currentLevelIndex!==x&&this._levels[x].loadError===0&&(this.warn(R+": switch to "+x),b.levelRetry=!0,this.hls.nextAutoLevel=x)}}},w.redundantFailover=function(b){var S=this._levels[b],C=S.url.length;if(C>1){var P=(S.urlId+1)%C;this.warn("Switching to redundant URL-id "+P),this._levels.forEach(function(R){R.urlId=P}),this.level=b}},w.onFragLoaded=function(b,S){var C=S.frag;if(C!==void 0&&C.type===u.PlaylistLevelType.MAIN){var P=this._levels[C.level];P!==void 0&&(P.fragmentError=0,P.loadError=0)}},w.onLevelLoaded=function(b,S){var C,P=S.level,R=S.details,L=this._levels[P];if(!L){var O;this.warn("Invalid level index "+P),(O=S.deliveryDirectives)!==null&&O!==void 0&&O.skip&&(R.deltaUpdateFailed=!0);return}P===this.currentLevelIndex?(L.fragmentError===0&&(L.loadError=0,this.retryCount=0),this.playlistLoaded(P,S,L.details)):(C=S.deliveryDirectives)!==null&&C!==void 0&&C.skip&&(R.deltaUpdateFailed=!0)},w.onAudioTrackSwitched=function(b,S){var C=this.hls.levels[this.currentLevelIndex];if(!!C&&C.audioGroupIds){for(var P=-1,R=this.hls.audioTracks[S.id].groupId,L=0;L<C.audioGroupIds.length;L++)if(C.audioGroupIds[L]===R){P=L;break}P!==C.urlId&&(C.urlId=P,this.startLoad())}},w.loadPlaylist=function(b){var S=this.currentLevelIndex,C=this._levels[S];if(this.canLoad&&C&&C.url.length>0){var P=C.urlId,R=C.url[P];if(b)try{R=b.addDirectives(R)}catch(L){this.warn("Could not construct new URL with HLS Delivery Directives: "+L)}this.log("Attempt loading level index "+S+(b?" at sn "+b.msn+" part "+b.part:"")+" with URL-id "+P+" "+R),this.clearTimer(),this.hls.trigger(l.Events.LEVEL_LOADING,{url:R,level:S,id:P,deliveryDirectives:b||null})}},w.removeLevel=function(b,S){var C=function(L,O){return O!==S},P=this._levels.filter(function(R,L){return L!==b?!0:R.url.length>1&&S!==void 0?(R.url=R.url.filter(C),R.audioGroupIds&&(R.audioGroupIds=R.audioGroupIds.filter(C)),R.textGroupIds&&(R.textGroupIds=R.textGroupIds.filter(C)),R.urlId=0,!0):!1}).map(function(R,L){var O=R.details;return O!=null&&O.fragments&&O.fragments.forEach(function(_){_.level=L}),R});this._levels=P,this.hls.trigger(l.Events.LEVELS_UPDATED,{levels:P})},h(E,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(b){var S,C=this._levels;if(C.length!==0&&!(this.currentLevelIndex===b&&(S=C[b])!==null&&S!==void 0&&S.details)){if(b<0||b>=C.length){var P=b<0;if(this.hls.trigger(l.Events.ERROR,{type:e.ErrorTypes.OTHER_ERROR,details:e.ErrorDetails.LEVEL_SWITCH_ERROR,level:b,fatal:P,reason:"invalid level idx"}),P)return;b=Math.min(b,C.length-1)}this.clearTimer();var R=this.currentLevelIndex,L=C[R],O=C[b];this.log("switching to level "+b+" from "+R),this.currentLevelIndex=b;var _=t({},O,{level:b,maxBitrate:O.maxBitrate,uri:O.uri,urlId:O.urlId});delete _._urlId,this.hls.trigger(l.Events.LEVEL_SWITCHING,_);var x=O.details;if(!x||x.live){var A=this.switchParams(O.uri,L==null?void 0:L.details);this.loadPlaylist(A)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(b){this.manualLevelIndex=b,this._startLevel===void 0&&(this._startLevel=b),b!==-1&&(this.level=b)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(b){this._firstLevel=b}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var b=this.hls.config.startLevel;return b!==void 0?b:this._firstLevel}else return this._startLevel},set:function(b){this._startLevel=b}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(b){this.level=b,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=b)}}]),E}(s.default)},"./src/controller/level-helper.ts":function(G,m,r){r.r(m),r.d(m,"addGroupId",function(){return e}),r.d(m,"assignTrackIdsByGroup",function(){return n}),r.d(m,"updatePTS",function(){return a}),r.d(m,"updateFragPTSDTS",function(){return u}),r.d(m,"mergeDetails",function(){return t}),r.d(m,"mapPartIntersection",function(){return f}),r.d(m,"mapFragmentIntersection",function(){return h}),r.d(m,"adjustSliding",function(){return v}),r.d(m,"addSliding",function(){return y}),r.d(m,"computeReloadInterval",function(){return p}),r.d(m,"getFragmentWithSN",function(){return g}),r.d(m,"getPartWith",function(){return d});var c=r("./src/polyfills/number.ts"),l=r("./src/utils/logger.ts");function e(E,w,D){switch(w){case"audio":E.audioGroupIds||(E.audioGroupIds=[]),E.audioGroupIds.push(D);break;case"text":E.textGroupIds||(E.textGroupIds=[]),E.textGroupIds.push(D);break}}function n(E){var w={};E.forEach(function(D){var b=D.groupId||"";D.id=w[b]=w[b]||0,w[b]++})}function a(E,w,D){var b=E[w],S=E[D];s(b,S)}function s(E,w){var D=w.startPTS;if(Object(c.isFiniteNumber)(D)){var b=0,S;w.sn>E.sn?(b=D-E.start,S=E):(b=E.start-D,S=w),S.duration!==b&&(S.duration=b)}else if(w.sn>E.sn){var C=E.cc===w.cc;C&&E.minEndPTS?w.start=E.start+(E.minEndPTS-E.start):w.start=E.start+E.duration}else w.start=Math.max(E.start-w.duration,0)}function u(E,w,D,b,S,C){var P=b-D;P<=0&&(l.logger.warn("Fragment should have a positive duration",w),b=D+w.duration,C=S+w.duration);var R=D,L=b,O=w.startPTS,_=w.endPTS;if(Object(c.isFiniteNumber)(O)){var x=Math.abs(O-D);Object(c.isFiniteNumber)(w.deltaPTS)?w.deltaPTS=Math.max(x,w.deltaPTS):w.deltaPTS=x,R=Math.max(D,O),D=Math.min(D,O),S=Math.min(S,w.startDTS),L=Math.min(b,_),b=Math.max(b,_),C=Math.max(C,w.endDTS)}w.duration=b-D;var A=D-w.start;w.appendedPTS=b,w.start=w.startPTS=D,w.maxStartPTS=R,w.startDTS=S,w.endPTS=b,w.minEndPTS=L,w.endDTS=C;var k=w.sn;if(!E||k<E.startSN||k>E.endSN)return 0;var M,N=k-E.startSN,U=E.fragments;for(U[N]=w,M=N;M>0;M--)s(U[M],U[M-1]);for(M=N;M<U.length-1;M++)s(U[M],U[M+1]);return E.fragmentHint&&s(U[U.length-1],E.fragmentHint),E.PTSKnown=E.alignedSliding=!0,A}function t(E,w){for(var D=null,b=E.fragments,S=b.length-1;S>=0;S--){var C=b[S].initSegment;if(C){D=C;break}}E.fragmentHint&&delete E.fragmentHint.endPTS;var P=0,R;if(h(E,w,function(k,M){var N;k.relurl&&(P=k.cc-M.cc),Object(c.isFiniteNumber)(k.startPTS)&&Object(c.isFiniteNumber)(k.endPTS)&&(M.start=M.startPTS=k.startPTS,M.startDTS=k.startDTS,M.appendedPTS=k.appendedPTS,M.maxStartPTS=k.maxStartPTS,M.endPTS=k.endPTS,M.endDTS=k.endDTS,M.minEndPTS=k.minEndPTS,M.duration=k.endPTS-k.startPTS,M.duration&&(R=M),w.PTSKnown=w.alignedSliding=!0),M.elementaryStreams=k.elementaryStreams,M.loader=k.loader,M.stats=k.stats,M.urlId=k.urlId,k.initSegment?(M.initSegment=k.initSegment,D=k.initSegment):(!M.initSegment||M.initSegment.relurl==((N=D)===null||N===void 0?void 0:N.relurl))&&(M.initSegment=D)}),w.skippedSegments&&(w.deltaUpdateFailed=w.fragments.some(function(k){return!k}),w.deltaUpdateFailed)){l.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var L=w.skippedSegments;L--;)w.fragments.shift();w.startSN=w.fragments[0].sn,w.startCC=w.fragments[0].cc}var O=w.fragments;if(P){l.logger.warn("discontinuity sliding from playlist, take drift into account");for(var _=0;_<O.length;_++)O[_].cc+=P}w.skippedSegments&&(w.startCC=w.fragments[0].cc),f(E.partList,w.partList,function(k,M){M.elementaryStreams=k.elementaryStreams,M.stats=k.stats}),R?u(w,R,R.startPTS,R.endPTS,R.startDTS,R.endDTS):v(E,w),O.length&&(w.totalduration=w.edge-O[0].start),w.driftStartTime=E.driftStartTime,w.driftStart=E.driftStart;var x=w.advancedDateTime;if(w.advanced&&x){var A=w.edge;w.driftStart||(w.driftStartTime=x,w.driftStart=A),w.driftEndTime=x,w.driftEnd=A}else w.driftEndTime=E.driftEndTime,w.driftEnd=E.driftEnd,w.advancedDateTime=E.advancedDateTime}function f(E,w,D){if(E&&w)for(var b=0,S=0,C=E.length;S<=C;S++){var P=E[S],R=w[S+b];P&&R&&P.index===R.index&&P.fragment.sn===R.fragment.sn?D(P,R):b--}}function h(E,w,D){for(var b=w.skippedSegments,S=Math.max(E.startSN,w.startSN)-w.startSN,C=(E.fragmentHint?1:0)+(b?w.endSN:Math.min(E.endSN,w.endSN))-w.startSN,P=w.startSN-E.startSN,R=w.fragmentHint?w.fragments.concat(w.fragmentHint):w.fragments,L=E.fragmentHint?E.fragments.concat(E.fragmentHint):E.fragments,O=S;O<=C;O++){var _=L[P+O],x=R[O];b&&!x&&O<b&&(x=w.fragments[O]=_),_&&x&&D(_,x)}}function v(E,w){var D=w.startSN+w.skippedSegments-E.startSN,b=E.fragments;D<0||D>=b.length||y(w,b[D].start)}function y(E,w){if(w){for(var D=E.fragments,b=E.skippedSegments;b<D.length;b++)D[b].start+=w;E.fragmentHint&&(E.fragmentHint.start+=w)}}function p(E,w){var D=1e3*E.levelTargetDuration,b=D/2,S=E.age,C=S>0&&S<D*3,P=w.loading.end-w.loading.start,R,L=E.availabilityDelay;if(E.updated===!1)if(C){var O=333*E.misses;R=Math.max(Math.min(b,P*2),O),E.availabilityDelay=(E.availabilityDelay||0)+R}else R=b;else C?(L=Math.min(L||D/2,S),E.availabilityDelay=L,R=L+D-S):R=D-P;return Math.round(R)}function g(E,w,D){if(!E||!E.details)return null;var b=E.details,S=b.fragments[w-b.startSN];return S||(S=b.fragmentHint,S&&S.sn===w)?S:w<b.startSN&&D&&D.sn===w?D:null}function d(E,w,D){if(!E||!E.details)return null;var b=E.details.partList;if(b)for(var S=b.length;S--;){var C=b[S];if(C.index===D&&C.fragment.sn===w)return C}return null}},"./src/controller/stream-controller.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return b});var c=r("./src/polyfills/number.ts"),l=r("./src/controller/base-stream-controller.ts"),e=r("./src/is-supported.ts"),n=r("./src/events.ts"),a=r("./src/utils/buffer-helper.ts"),s=r("./src/controller/fragment-tracker.ts"),u=r("./src/types/loader.ts"),t=r("./src/loader/fragment.ts"),f=r("./src/demux/transmuxer-interface.ts"),h=r("./src/types/transmuxer.ts"),v=r("./src/controller/gap-controller.ts"),y=r("./src/errors.ts"),p=r("./src/utils/logger.ts");function g(S,C){for(var P=0;P<C.length;P++){var R=C[P];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(S,R.key,R)}}function d(S,C,P){return C&&g(S.prototype,C),P&&g(S,P),S}function E(S,C){S.prototype=Object.create(C.prototype),S.prototype.constructor=S,w(S,C)}function w(S,C){return w=Object.setPrototypeOf||function(R,L){return R.__proto__=L,R},w(S,C)}var D=100,b=function(S){E(C,S);function C(R,L){var O;return O=S.call(this,R,L,"[stream-controller]")||this,O.audioCodecSwap=!1,O.gapController=null,O.level=-1,O._forceStartLoad=!1,O.altAudio=!1,O.audioOnly=!1,O.fragPlaying=null,O.onvplaying=null,O.onvseeked=null,O.fragLastKbps=0,O.stalled=!1,O.couldBacktrack=!1,O.audioCodecSwitch=!1,O.videoBuffer=null,O._registerListeners(),O}var P=C.prototype;return P._registerListeners=function(){var L=this.hls;L.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),L.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),L.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),L.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),L.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),L.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),L.on(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),L.on(n.Events.ERROR,this.onError,this),L.on(n.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),L.on(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),L.on(n.Events.BUFFER_CREATED,this.onBufferCreated,this),L.on(n.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),L.on(n.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),L.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this)},P._unregisterListeners=function(){var L=this.hls;L.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),L.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),L.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),L.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),L.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),L.off(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),L.off(n.Events.ERROR,this.onError,this),L.off(n.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),L.off(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),L.off(n.Events.BUFFER_CREATED,this.onBufferCreated,this),L.off(n.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),L.off(n.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),L.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this)},P.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},P.startLoad=function(L){if(this.levels){var O=this.lastCurrentTime,_=this.hls;if(this.stopLoad(),this.setInterval(D),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var x=_.startLevel;x===-1&&(_.config.testBandwidth?(x=0,this.bitrateTest=!0):x=_.nextAutoLevel),this.level=_.nextLoadLevel=x,this.loadedmetadata=!1}O>0&&L===-1&&(this.log("Override startPosition with lastCurrentTime @"+O.toFixed(3)),L=O),this.state=l.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=L,this.tick()}else this._forceStartLoad=!0,this.state=l.State.STOPPED},P.stopLoad=function(){this._forceStartLoad=!1,S.prototype.stopLoad.call(this)},P.doTick=function(){switch(this.state){case l.State.IDLE:this.doTickIdle();break;case l.State.WAITING_LEVEL:{var L,O=this.levels,_=this.level,x=O==null||(L=O[_])===null||L===void 0?void 0:L.details;if(x&&(!x.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(x))break;this.state=l.State.IDLE;break}break}case l.State.FRAG_LOADING_WAITING_RETRY:{var A,k=self.performance.now(),M=this.retryDate;(!M||k>=M||(A=this.media)!==null&&A!==void 0&&A.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=l.State.IDLE)}break}this.onTickEnd()},P.onTickEnd=function(){S.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},P.doTickIdle=function(){var L,O,_=this.hls,x=this.levelLastLoaded,A=this.levels,k=this.media,M=_.config,N=_.nextLoadLevel;if(!(x===null||!k&&(this.startFragRequested||!M.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!A||!A[N])){var U=A[N];this.level=_.nextLoadLevel=N;var j=U.details;if(!j||this.state===l.State.WAITING_LEVEL||j.live&&this.levelLastLoaded!==N){this.state=l.State.WAITING_LEVEL;return}var z=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:k,u.PlaylistLevelType.MAIN);if(z!==null){var J=z.len,te=this.getMaxBufferLength(U.maxBitrate);if(!(J>=te)){if(this._streamEnded(z,j)){var re={};this.altAudio&&(re.type="video"),this.hls.trigger(n.Events.BUFFER_EOS,re),this.state=l.State.ENDED;return}var oe=z.end,se=this.getNextFragment(oe,j);if(this.couldBacktrack&&!this.fragPrevious&&se&&se.sn!=="initSegment"){var me=se.sn-j.startSN;me>1&&(se=j.fragments[me-1],this.fragmentTracker.removeFragment(se))}if(se&&this.fragmentTracker.getState(se)===s.FragmentState.OK&&this.nextLoadPosition>oe){var fe=this.audioOnly&&!this.altAudio?t.ElementaryStreamTypes.AUDIO:t.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(k,fe,u.PlaylistLevelType.MAIN),se=this.getNextFragment(this.nextLoadPosition,j)}!se||(se.initSegment&&!se.initSegment.data&&!this.bitrateTest&&(se=se.initSegment),((L=se.decryptdata)===null||L===void 0?void 0:L.keyFormat)==="identity"&&!((O=se.decryptdata)!==null&&O!==void 0&&O.key)?this.loadKey(se,j):this.loadFragment(se,j,oe))}}}},P.loadFragment=function(L,O,_){var x,A=this.fragmentTracker.getState(L);if(this.fragCurrent=L,A===s.FragmentState.BACKTRACKED){var k=this.fragmentTracker.getBacktrackData(L);if(k){this._handleFragmentLoadProgress(k),this._handleFragmentLoadComplete(k);return}else A=s.FragmentState.NOT_LOADED}A===s.FragmentState.NOT_LOADED||A===s.FragmentState.PARTIAL?L.sn==="initSegment"?this._loadInitSegment(L):this.bitrateTest?(L.bitrateTest=!0,this.log("Fragment "+L.sn+" of level "+L.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(L)):(this.startFragRequested=!0,S.prototype.loadFragment.call(this,L,O,_)):A===s.FragmentState.APPENDING?this.reduceMaxBufferLength(L.duration)&&this.fragmentTracker.removeFragment(L):((x=this.media)===null||x===void 0?void 0:x.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},P.getAppendedFrag=function(L){var O=this.fragmentTracker.getAppendedFrag(L,u.PlaylistLevelType.MAIN);return O&&"fragment"in O?O.fragment:O},P.getBufferedFrag=function(L){return this.fragmentTracker.getBufferedFrag(L,u.PlaylistLevelType.MAIN)},P.followingBufferedFrag=function(L){return L?this.getBufferedFrag(L.end+.5):null},P.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},P.nextLevelSwitch=function(){var L=this.levels,O=this.media;if(O!=null&&O.readyState){var _,x=this.getAppendedFrag(O.currentTime);if(x&&x.start>1&&this.flushMainBuffer(0,x.start-1),!O.paused&&L){var A=this.hls.nextLoadLevel,k=L[A],M=this.fragLastKbps;M&&this.fragCurrent?_=this.fragCurrent.duration*k.maxBitrate/(1e3*M)+1:_=0}else _=0;var N=this.getBufferedFrag(O.currentTime+_);if(N){var U=this.followingBufferedFrag(N);if(U){this.abortCurrentFrag();var j=U.maxStartPTS?U.maxStartPTS:U.start,z=U.duration,J=Math.max(N.end,j+Math.min(Math.max(z-this.config.maxFragLookUpTolerance,z*.5),z*.75));this.flushMainBuffer(J,Number.POSITIVE_INFINITY)}}}},P.abortCurrentFrag=function(){var L=this.fragCurrent;this.fragCurrent=null,L!=null&&L.loader&&L.loader.abort(),this.state===l.State.KEY_LOADING&&(this.state=l.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},P.flushMainBuffer=function(L,O){S.prototype.flushMainBuffer.call(this,L,O,this.altAudio?"video":null)},P.onMediaAttached=function(L,O){S.prototype.onMediaAttached.call(this,L,O);var _=O.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),_.addEventListener("playing",this.onvplaying),_.addEventListener("seeked",this.onvseeked),this.gapController=new v.default(this.config,_,this.fragmentTracker,this.hls)},P.onMediaDetaching=function(){var L=this.media;L&&(L.removeEventListener("playing",this.onvplaying),L.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),S.prototype.onMediaDetaching.call(this)},P.onMediaPlaying=function(){this.tick()},P.onMediaSeeked=function(){var L=this.media,O=L?L.currentTime:null;Object(c.isFiniteNumber)(O)&&this.log("Media seeked to "+O.toFixed(3)),this.tick()},P.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(n.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},P.onManifestParsed=function(L,O){var _=!1,x=!1,A;O.levels.forEach(function(k){A=k.audioCodec,A&&(A.indexOf("mp4a.40.2")!==-1&&(_=!0),A.indexOf("mp4a.40.5")!==-1&&(x=!0))}),this.audioCodecSwitch=_&&x&&!Object(e.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=O.levels,this.startFragRequested=!1},P.onLevelLoading=function(L,O){var _=this.levels;if(!(!_||this.state!==l.State.IDLE)){var x=_[O.level];(!x.details||x.details.live&&this.levelLastLoaded!==O.level||this.waitForCdnTuneIn(x.details))&&(this.state=l.State.WAITING_LEVEL)}},P.onLevelLoaded=function(L,O){var _,x=this.levels,A=O.level,k=O.details,M=k.totalduration;if(!x){this.warn("Levels were reset while loading level "+A);return}this.log("Level "+A+" loaded ["+k.startSN+","+k.endSN+"], cc ["+k.startCC+", "+k.endCC+"] duration:"+M);var N=this.fragCurrent;N&&(this.state===l.State.FRAG_LOADING||this.state===l.State.FRAG_LOADING_WAITING_RETRY)&&N.level!==O.level&&N.loader&&(this.state=l.State.IDLE,N.loader.abort());var U=x[A],j=0;if(k.live||(_=U.details)!==null&&_!==void 0&&_.live){if(k.fragments[0]||(k.deltaUpdateFailed=!0),k.deltaUpdateFailed)return;j=this.alignPlaylists(k,U.details)}if(U.details=k,this.levelLastLoaded=A,this.hls.trigger(n.Events.LEVEL_UPDATED,{details:k,level:A}),this.state===l.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(k))return;this.state=l.State.IDLE}this.startFragRequested?k.live&&this.synchronizeToLiveEdge(k):this.setStartPosition(k,j),this.tick()},P._handleFragmentLoadProgress=function(L){var O,_=L.frag,x=L.part,A=L.payload,k=this.levels;if(!k){this.warn("Levels were reset while fragment load was in progress. Fragment "+_.sn+" of level "+_.level+" will not be buffered");return}var M=k[_.level],N=M.details;if(!N){this.warn("Dropping fragment "+_.sn+" of level "+_.level+" after level details were reset");return}var U=M.videoCodec,j=N.PTSKnown||!N.live,z=(O=_.initSegment)===null||O===void 0?void 0:O.data,J=this._getAudioCodec(M),te=this.transmuxer=this.transmuxer||new f.default(this.hls,u.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),re=x?x.index:-1,oe=re!==-1,se=new h.ChunkMetadata(_.level,_.sn,_.stats.chunkCount,A.byteLength,re,oe),me=this.initPTS[_.cc];te.push(A,z,J,U,_,x,N.totalduration,j,se,me)},P.onAudioTrackSwitching=function(L,O){var _=this.altAudio,x=!!O.url,A=O.id;if(!x){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var k=this.fragCurrent;k!=null&&k.loader&&(this.log("Switching to main audio track, cancel main fragment load"),k.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var M=this.hls;_&&M.trigger(n.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),M.trigger(n.Events.AUDIO_TRACK_SWITCHED,{id:A})}},P.onAudioTrackSwitched=function(L,O){var _=O.id,x=!!this.hls.audioTracks[_].url;if(x){var A=this.videoBuffer;A&&this.mediaBuffer!==A&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=A)}this.altAudio=x,this.tick()},P.onBufferCreated=function(L,O){var _=O.tracks,x,A,k=!1;for(var M in _){var N=_[M];if(N.id==="main"){if(A=M,x=N,M==="video"){var U=_[M];U&&(this.videoBuffer=U.buffer)}}else k=!0}k&&x?(this.log("Alternate track found, use "+A+".buffered to schedule main fragment loading"),this.mediaBuffer=x.buffer):this.mediaBuffer=this.media},P.onFragBuffered=function(L,O){var _=O.frag,x=O.part;if(!(_&&_.type!==u.PlaylistLevelType.MAIN)){if(this.fragContextChanged(_)){this.warn("Fragment "+_.sn+(x?" p: "+x.index:"")+" of level "+_.level+" finished buffering, but was aborted. state: "+this.state),this.state===l.State.PARSED&&(this.state=l.State.IDLE);return}var A=x?x.stats:_.stats;this.fragLastKbps=Math.round(8*A.total/(A.buffering.end-A.loading.first)),_.sn!=="initSegment"&&(this.fragPrevious=_),this.fragBufferedComplete(_,x)}},P.onError=function(L,O){switch(O.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.MAIN,O);break;case y.ErrorDetails.LEVEL_LOAD_ERROR:case y.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==l.State.ERROR&&(O.fatal?(this.warn(""+O.details),this.state=l.State.ERROR):!O.levelRetry&&this.state===l.State.WAITING_LEVEL&&(this.state=l.State.IDLE));break;case y.ErrorDetails.BUFFER_FULL_ERROR:if(O.parent==="main"&&(this.state===l.State.PARSING||this.state===l.State.PARSED)){var _=!0,x=this.getFwdBufferInfo(this.media,u.PlaylistLevelType.MAIN);x&&x.len>.5&&(_=!this.reduceMaxBufferLength(x.len)),_&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},P.checkBuffer=function(){var L=this.media,O=this.gapController;if(!(!L||!O||!L.readyState)){var _=a.BufferHelper.getBuffered(L);!this.loadedmetadata&&_.length?(this.loadedmetadata=!0,this.seekToStartPos()):O.poll(this.lastCurrentTime),this.lastCurrentTime=L.currentTime}},P.onFragLoadEmergencyAborted=function(){this.state=l.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},P.onBufferFlushed=function(L,O){var _=O.type;if(_!==t.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var x=(_===t.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(x,_,u.PlaylistLevelType.MAIN)}},P.onLevelsUpdated=function(L,O){this.levels=O.levels},P.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},P.seekToStartPos=function(){var L=this.media,O=L.currentTime,_=this.startPosition;if(_>=0&&O<_){if(L.seeking){p.logger.log("could not seek to "+_+", already seeking at "+O);return}var x=a.BufferHelper.getBuffered(L),A=x.length?x.start(0):0,k=A-_;k>0&&(k<this.config.maxBufferHole||k<this.config.maxFragLookUpTolerance)&&(p.logger.log("adjusting start position by "+k+" to match buffer start"),_+=k,this.startPosition=_),this.log("seek to target start position "+_+" from current time "+O),L.currentTime=_}},P._getAudioCodec=function(L){var O=this.config.defaultAudioCodec||L.audioCodec;return this.audioCodecSwap&&O&&(this.log("Swapping audio codec"),O.indexOf("mp4a.40.5")!==-1?O="mp4a.40.2":O="mp4a.40.5"),O},P._loadBitrateTestFrag=function(L){var O=this;this._doFragLoad(L).then(function(_){var x=O.hls;if(!(!_||x.nextLoadLevel||O.fragContextChanged(L))){O.fragLoadError=0,O.state=l.State.IDLE,O.startFragRequested=!1,O.bitrateTest=!1;var A=L.stats;A.parsing.start=A.parsing.end=A.buffering.start=A.buffering.end=self.performance.now(),x.trigger(n.Events.FRAG_LOADED,_)}})},P._handleTransmuxComplete=function(L){var O,_="main",x=this.hls,A=L.remuxResult,k=L.chunkMeta,M=this.getCurrentContext(k);if(!M){this.warn("The loading context changed while buffering fragment "+k.sn+" of level "+k.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(k.level);return}var N=M.frag,U=M.part,j=M.level,z=A.video,J=A.text,te=A.id3,re=A.initSegment,oe=this.altAudio?void 0:A.audio;if(!this.fragContextChanged(N)){if(this.state=l.State.PARSING,re){re.tracks&&(this._bufferInitSegment(j,re.tracks,N,k),x.trigger(n.Events.FRAG_PARSING_INIT_SEGMENT,{frag:N,id:_,tracks:re.tracks}));var se=re.initPTS,me=re.timescale;Object(c.isFiniteNumber)(se)&&(this.initPTS[N.cc]=se,x.trigger(n.Events.INIT_PTS_FOUND,{frag:N,id:_,initPTS:se,timescale:me}))}if(z&&A.independent!==!1){if(j.details){var fe=z.startPTS,ue=z.endPTS,ye=z.startDTS,pe=z.endDTS;if(U)U.elementaryStreams[z.type]={startPTS:fe,endPTS:ue,startDTS:ye,endDTS:pe};else if(z.firstKeyFrame&&z.independent&&(this.couldBacktrack=!0),z.dropped&&z.independent){var de=this.getLoadPosition()+this.config.maxBufferHole;if(de<fe){this.backtrack(N);return}N.setElementaryStreamInfo(z.type,N.start,ue,N.start,pe,!0)}N.setElementaryStreamInfo(z.type,fe,ue,ye,pe),this.bufferFragmentData(z,N,U,k)}}else if(A.independent===!1){this.backtrack(N);return}if(oe){var ve=oe.startPTS,ne=oe.endPTS,we=oe.startDTS,Ce=oe.endDTS;U&&(U.elementaryStreams[t.ElementaryStreamTypes.AUDIO]={startPTS:ve,endPTS:ne,startDTS:we,endDTS:Ce}),N.setElementaryStreamInfo(t.ElementaryStreamTypes.AUDIO,ve,ne,we,Ce),this.bufferFragmentData(oe,N,U,k)}if(te!=null&&(O=te.samples)!==null&&O!==void 0&&O.length){var ge={frag:N,id:_,samples:te.samples};x.trigger(n.Events.FRAG_PARSING_METADATA,ge)}if(J){var _e={frag:N,id:_,samples:J.samples};x.trigger(n.Events.FRAG_PARSING_USERDATA,_e)}}},P._bufferInitSegment=function(L,O,_,x){var A=this;if(this.state===l.State.PARSING){this.audioOnly=!!O.audio&&!O.video,this.altAudio&&!this.audioOnly&&delete O.audio;var k=O.audio,M=O.video,N=O.audiovideo;if(k){var U=L.audioCodec,j=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(U&&(U.indexOf("mp4a.40.5")!==-1?U="mp4a.40.2":U="mp4a.40.5"),k.metadata.channelCount!==1&&j.indexOf("firefox")===-1&&(U="mp4a.40.5")),j.indexOf("android")!==-1&&k.container!=="audio/mpeg"&&(U="mp4a.40.2",this.log("Android: force audio codec to "+U)),L.audioCodec&&L.audioCodec!==U&&this.log('Swapping manifest audio codec "'+L.audioCodec+'" for "'+U+'"'),k.levelCodec=U,k.id="main",this.log("Init audio buffer, container:"+k.container+", codecs[selected/level/parsed]=["+(U||"")+"/"+(L.audioCodec||"")+"/"+k.codec+"]")}M&&(M.levelCodec=L.videoCodec,M.id="main",this.log("Init video buffer, container:"+M.container+", codecs[level/parsed]=["+(L.videoCodec||"")+"/"+M.codec+"]")),N&&this.log("Init audiovideo buffer, container:"+N.container+", codecs[level/parsed]=["+(L.attrs.CODECS||"")+"/"+N.codec+"]"),this.hls.trigger(n.Events.BUFFER_CODECS,O),Object.keys(O).forEach(function(z){var J=O[z],te=J.initSegment;te!=null&&te.byteLength&&A.hls.trigger(n.Events.BUFFER_APPENDING,{type:z,data:te,frag:_,part:null,chunkMeta:x,parent:_.type})}),this.tick()}},P.backtrack=function(L){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(L);var O=this.fragmentTracker.backtrack(L);this.fragPrevious=null,this.nextLoadPosition=L.start,O?this.resetFragmentLoading(L):this.state=l.State.BACKTRACKING},P.checkFragmentChanged=function(){var L=this.media,O=null;if(L&&L.readyState>1&&L.seeking===!1){var _=L.currentTime;if(a.BufferHelper.isBuffered(L,_)?O=this.getAppendedFrag(_):a.BufferHelper.isBuffered(L,_+.1)&&(O=this.getAppendedFrag(_+.1)),O){var x=this.fragPlaying,A=O.level;(!x||O.sn!==x.sn||x.level!==A||O.urlId!==x.urlId)&&(this.hls.trigger(n.Events.FRAG_CHANGED,{frag:O}),(!x||x.level!==A)&&this.hls.trigger(n.Events.LEVEL_SWITCHED,{level:A}),this.fragPlaying=O)}}},d(C,[{key:"nextLevel",get:function(){var L=this.nextBufferedFrag;return L?L.level:-1}},{key:"currentLevel",get:function(){var L=this.media;if(L){var O=this.getAppendedFrag(L.currentTime);if(O)return O.level}return-1}},{key:"nextBufferedFrag",get:function(){var L=this.media;if(L){var O=this.getAppendedFrag(L.currentTime);return this.followingBufferedFrag(O)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),C}(l.default)},"./src/controller/subtitle-stream-controller.ts":function(G,m,r){r.r(m),r.d(m,"SubtitleStreamController",function(){return E});var c=r("./src/events.ts"),l=r("./src/utils/logger.ts"),e=r("./src/utils/buffer-helper.ts"),n=r("./src/controller/fragment-finders.ts"),a=r("./src/utils/discontinuities.ts"),s=r("./src/controller/level-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),t=r("./src/controller/base-stream-controller.ts"),f=r("./src/types/loader.ts"),h=r("./src/types/level.ts");function v(w,D){for(var b=0;b<D.length;b++){var S=D[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}function y(w,D,b){return D&&v(w.prototype,D),b&&v(w,b),w}function p(w,D){w.prototype=Object.create(D.prototype),w.prototype.constructor=w,g(w,D)}function g(w,D){return g=Object.setPrototypeOf||function(S,C){return S.__proto__=C,S},g(w,D)}var d=500,E=function(w){p(D,w);function D(S,C){var P;return P=w.call(this,S,C,"[subtitle-stream-controller]")||this,P.levels=[],P.currentTrackId=-1,P.tracksBuffered=[],P.mainDetails=null,P._registerListeners(),P}var b=D.prototype;return b.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},b._registerListeners=function(){var C=this.hls;C.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),C.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),C.on(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),C.on(c.Events.ERROR,this.onError,this),C.on(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),C.on(c.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),C.on(c.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),C.on(c.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),C.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b._unregisterListeners=function(){var C=this.hls;C.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),C.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),C.off(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),C.off(c.Events.ERROR,this.onError,this),C.off(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),C.off(c.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),C.off(c.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),C.off(c.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),C.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b.startLoad=function(){this.stopLoad(),this.state=t.State.IDLE,this.setInterval(d),this.tick()},b.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},b.onLevelLoaded=function(C,P){this.mainDetails=P.details},b.onSubtitleFragProcessed=function(C,P){var R=P.frag,L=P.success;if(this.fragPrevious=R,this.state=t.State.IDLE,!!L){var O=this.tracksBuffered[this.currentTrackId];if(!!O){for(var _,x=R.start,A=0;A<O.length;A++)if(x>=O[A].start&&x<=O[A].end){_=O[A];break}var k=R.start+R.duration;_?_.end=k:(_={start:x,end:k},O.push(_)),this.fragmentTracker.fragBuffered(R)}}},b.onBufferFlushing=function(C,P){var R=P.startOffset,L=P.endOffset;if(R===0&&L!==Number.POSITIVE_INFINITY){var O=this.currentTrackId,_=this.levels;if(!_.length||!_[O]||!_[O].details)return;var x=_[O].details,A=x.targetduration,k=L-A;if(k<=0)return;P.endOffsetSubtitles=Math.max(0,k),this.tracksBuffered.forEach(function(M){for(var N=0;N<M.length;){if(M[N].end<=k){M.shift();continue}else if(M[N].start<k)M[N].start=k;else break;N++}}),this.fragmentTracker.removeFragmentsInRange(R,k,f.PlaylistLevelType.SUBTITLE)}},b.onError=function(C,P){var R,L=P.frag;!L||L.type!==f.PlaylistLevelType.SUBTITLE||((R=this.fragCurrent)!==null&&R!==void 0&&R.loader&&this.fragCurrent.loader.abort(),this.state=t.State.IDLE)},b.onSubtitleTracksUpdated=function(C,P){var R=this,L=P.subtitleTracks;this.tracksBuffered=[],this.levels=L.map(function(O){return new h.Level(O)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(O){R.tracksBuffered[O.id]=[]}),this.mediaBuffer=null},b.onSubtitleTrackSwitch=function(C,P){if(this.currentTrackId=P.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var R=this.levels[this.currentTrackId];R!=null&&R.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(d)):this.mediaBuffer=null},b.onSubtitleTrackLoaded=function(C,P){var R,L=P.details,O=P.id,_=this.currentTrackId,x=this.levels;if(!!x.length){var A=x[_];if(!(O>=x.length||O!==_||!A)){if(this.mediaBuffer=this.mediaBufferTimeRanges,L.live||(R=A.details)!==null&&R!==void 0&&R.live){var k=this.mainDetails;if(L.deltaUpdateFailed||!k)return;var M=k.fragments[0];if(!A.details)L.hasProgramDateTime&&k.hasProgramDateTime?Object(a.alignMediaPlaylistByPDT)(L,k):M&&Object(s.addSliding)(L,M.start);else{var N=this.alignPlaylists(L,A.details);N===0&&M&&Object(s.addSliding)(L,M.start)}}if(A.details=L,this.levelLastLoaded=O,this.tick(),L.live&&!this.fragCurrent&&this.media&&this.state===t.State.IDLE){var U=Object(n.findFragmentByPTS)(null,L.fragments,this.media.currentTime,0);U||(this.warn("Subtitle playlist not aligned with playback"),A.details=void 0)}}}},b._handleFragmentLoadComplete=function(C){var P=C.frag,R=C.payload,L=P.decryptdata,O=this.hls;if(!this.fragContextChanged(P)&&R&&R.byteLength>0&&L&&L.key&&L.iv&&L.method==="AES-128"){var _=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(R),L.key.buffer,L.iv.buffer).then(function(x){var A=performance.now();O.trigger(c.Events.FRAG_DECRYPTED,{frag:P,payload:x,stats:{tstart:_,tdecrypt:A}})})}},b.doTick=function(){if(!this.media){this.state=t.State.IDLE;return}if(this.state===t.State.IDLE){var C,P=this.currentTrackId,R=this.levels;if(!R.length||!R[P]||!R[P].details)return;var L=R[P].details,O=L.targetduration,_=this.config,x=this.media,A=e.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,x.currentTime-O,_.maxBufferHole),k=A.end,M=A.len,N=this.getMaxBufferLength()+O;if(M>N)return;console.assert(L,"Subtitle track details are defined on idle subtitle stream controller tick");var U=L.fragments,j=U.length,z=L.edge,J,te=this.fragPrevious;if(k<z){var re=_.maxFragLookUpTolerance;te&&L.hasProgramDateTime&&(J=Object(n.findFragmentByPDT)(U,te.endProgramDateTime,re)),J||(J=Object(n.findFragmentByPTS)(te,U,k,re),!J&&te&&te.start<U[0].start&&(J=U[0]))}else J=U[j-1];(C=J)!==null&&C!==void 0&&C.encrypted?(l.logger.log("Loading key for "+J.sn),this.state=t.State.KEY_LOADING,this.hls.trigger(c.Events.KEY_LOADING,{frag:J})):J&&this.fragmentTracker.getState(J)===u.FragmentState.NOT_LOADED&&this.loadFragment(J,L,k)}},b.loadFragment=function(C,P,R){this.fragCurrent=C,w.prototype.loadFragment.call(this,C,P,R)},y(D,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),D}(t.default)},"./src/controller/subtitle-track-controller.ts":function(G,m,r){r.r(m);var c=r("./src/events.ts"),l=r("./src/utils/texttrack-utils.ts"),e=r("./src/controller/base-playlist-controller.ts"),n=r("./src/types/loader.ts");function a(v,y){for(var p=0;p<y.length;p++){var g=y[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(v,g.key,g)}}function s(v,y,p){return y&&a(v.prototype,y),p&&a(v,p),v}function u(v,y){v.prototype=Object.create(y.prototype),v.prototype.constructor=v,t(v,y)}function t(v,y){return t=Object.setPrototypeOf||function(g,d){return g.__proto__=d,g},t(v,y)}var f=function(v){u(y,v);function y(g){var d;return d=v.call(this,g,"[subtitle-track-controller]")||this,d.media=null,d.tracks=[],d.groupId=null,d.tracksInGroup=[],d.trackId=-1,d.selectDefaultTrack=!0,d.queuedDefaultTrack=-1,d.trackChangeListener=function(){return d.onTextTracksChanged()},d.asyncPollTrackChange=function(){return d.pollTrackChange(0)},d.useTextTrackPolling=!1,d.subtitlePollingInterval=-1,d.subtitleDisplay=!0,d.registerListeners(),d}var p=y.prototype;return p.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,v.prototype.destroy.call(this)},p.registerListeners=function(){var d=this.hls;d.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(c.Events.LEVEL_LOADING,this.onLevelLoading,this),d.on(c.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),d.on(c.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),d.on(c.Events.ERROR,this.onError,this)},p.unregisterListeners=function(){var d=this.hls;d.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),d.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),d.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(c.Events.LEVEL_LOADING,this.onLevelLoading,this),d.off(c.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),d.off(c.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),d.off(c.Events.ERROR,this.onError,this)},p.onMediaAttached=function(d,E){this.media=E.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},p.pollTrackChange=function(d){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,d)},p.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var d=h(this.media.textTracks);d.forEach(function(E){Object(l.clearCurrentCues)(E)}),this.subtitleTrack=-1,this.media=null}},p.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},p.onManifestParsed=function(d,E){this.tracks=E.subtitleTracks},p.onSubtitleTrackLoaded=function(d,E){var w=E.id,D=E.details,b=this.trackId,S=this.tracksInGroup[b];if(!S){this.warn("Invalid subtitle track id "+w);return}var C=S.details;S.details=E.details,this.log("subtitle track "+w+" loaded ["+D.startSN+"-"+D.endSN+"]"),w===this.trackId&&(this.retryCount=0,this.playlistLoaded(w,E,C))},p.onLevelLoading=function(d,E){this.switchLevel(E.level)},p.onLevelSwitching=function(d,E){this.switchLevel(E.level)},p.switchLevel=function(d){var E=this.hls.levels[d];if(!!(E!=null&&E.textGroupIds)){var w=E.textGroupIds[E.urlId];if(this.groupId!==w){var D=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,b=this.tracks.filter(function(P){return!w||P.groupId===w});this.tracksInGroup=b;var S=this.findTrackId(D==null?void 0:D.name)||this.findTrackId();this.groupId=w;var C={subtitleTracks:b};this.log("Updating subtitle tracks, "+b.length+' track(s) found in "'+w+'" group-id'),this.hls.trigger(c.Events.SUBTITLE_TRACKS_UPDATED,C),S!==-1&&this.setSubtitleTrack(S,D)}}},p.findTrackId=function(d){for(var E=this.tracksInGroup,w=0;w<E.length;w++){var D=E[w];if((!this.selectDefaultTrack||D.default)&&(!d||d===D.name))return D.id}return-1},p.onError=function(d,E){v.prototype.onError.call(this,d,E),!(E.fatal||!E.context)&&E.context.type===n.PlaylistContextType.SUBTITLE_TRACK&&E.context.id===this.trackId&&E.context.groupId===this.groupId&&this.retryLoadingOrFail(E)},p.loadPlaylist=function(d){var E=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(E)){var w=E.id,D=E.groupId,b=E.url;if(d)try{b=d.addDirectives(b)}catch(S){this.warn("Could not construct new URL with HLS Delivery Directives: "+S)}this.log("Loading subtitle playlist for id "+w),this.hls.trigger(c.Events.SUBTITLE_TRACK_LOADING,{url:b,id:w,groupId:D,deliveryDirectives:d||null})}},p.toggleTrackModes=function(d){var E=this,w=this.media,D=this.subtitleDisplay,b=this.trackId;if(!!w){var S=h(w.textTracks),C=S.filter(function(L){return L.groupId===E.groupId});if(d===-1)[].slice.call(S).forEach(function(L){L.mode="disabled"});else{var P=C[b];P&&(P.mode="disabled")}var R=C[d];R&&(R.mode=D?"showing":"hidden")}},p.setSubtitleTrack=function(d,E){var w,D=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=d;return}if(this.trackId!==d&&this.toggleTrackModes(d),!(this.trackId===d&&(d===-1||(w=D[d])!==null&&w!==void 0&&w.details)||d<-1||d>=D.length)){this.clearTimer();var b=D[d];if(this.log("Switching to subtitle track "+d),this.trackId=d,b){var S=b.id,C=b.groupId,P=C===void 0?"":C,R=b.name,L=b.type,O=b.url;this.hls.trigger(c.Events.SUBTITLE_TRACK_SWITCH,{id:S,groupId:P,name:R,type:L,url:O});var _=this.switchParams(b.url,E==null?void 0:E.details);this.loadPlaylist(_)}else this.hls.trigger(c.Events.SUBTITLE_TRACK_SWITCH,{id:d})}},p.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var d=-1,E=h(this.media.textTracks),w=0;w<E.length;w++)if(E[w].mode==="hidden")d=w;else if(E[w].mode==="showing"){d=w;break}this.subtitleTrack!==d&&(this.subtitleTrack=d)}},s(y,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(d){this.selectDefaultTrack=!1;var E=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(d,E)}}]),y}(e.default);function h(v){for(var y=[],p=0;p<v.length;p++){var g=v[p];g.kind==="subtitles"&&g.label&&y.push(v[p])}return y}m.default=f},"./src/controller/timeline-controller.ts":function(G,m,r){r.r(m),r.d(m,"TimelineController",function(){return h});var c=r("./src/polyfills/number.ts"),l=r("./src/events.ts"),e=r("./src/utils/cea-608-parser.ts"),n=r("./src/utils/output-filter.ts"),a=r("./src/utils/webvtt-parser.ts"),s=r("./src/utils/texttrack-utils.ts"),u=r("./src/utils/imsc1-ttml-parser.ts"),t=r("./src/types/loader.ts"),f=r("./src/utils/logger.ts"),h=function(){function g(E){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs=p(),this.captionsProperties=void 0,this.hls=E,this.config=E.config,this.Cues=E.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var w=new n.default(this,"textTrack1"),D=new n.default(this,"textTrack2"),b=new n.default(this,"textTrack3"),S=new n.default(this,"textTrack4");this.cea608Parser1=new e.default(1,w,D),this.cea608Parser2=new e.default(3,b,S)}E.on(l.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),E.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(l.Events.MANIFEST_LOADED,this.onManifestLoaded,this),E.on(l.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),E.on(l.Events.FRAG_LOADING,this.onFragLoading,this),E.on(l.Events.FRAG_LOADED,this.onFragLoaded,this),E.on(l.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),E.on(l.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),E.on(l.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(l.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),E.on(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var d=g.prototype;return d.destroy=function(){var w=this.hls;w.off(l.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),w.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),w.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),w.off(l.Events.MANIFEST_LOADED,this.onManifestLoaded,this),w.off(l.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),w.off(l.Events.FRAG_LOADING,this.onFragLoading,this),w.off(l.Events.FRAG_LOADED,this.onFragLoaded,this),w.off(l.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),w.off(l.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),w.off(l.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),w.off(l.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),w.off(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},d.addCues=function(w,D,b,S,C){for(var P=!1,R=C.length;R--;){var L=C[R],O=y(L[0],L[1],D,b);if(O>=0&&(L[0]=Math.min(L[0],D),L[1]=Math.max(L[1],b),P=!0,O/(b-D)>.5))return}if(P||C.push([D,b]),this.config.renderTextTracksNatively){var _=this.captionsTracks[w];this.Cues.newCue(_,D,b,S)}else{var x=this.Cues.newCue(null,D,b,S);this.hls.trigger(l.Events.CUES_PARSED,{type:"captions",cues:x,track:w})}},d.onInitPtsFound=function(w,D){var b=this,S=D.frag,C=D.id,P=D.initPTS,R=D.timescale,L=this.unparsedVttFrags;C==="main"&&(this.initPTS[S.cc]=P,this.timescale[S.cc]=R),L.length&&(this.unparsedVttFrags=[],L.forEach(function(O){b.onFragLoaded(l.Events.FRAG_LOADED,O)}))},d.getExistingTrack=function(w){var D=this.media;if(D)for(var b=0;b<D.textTracks.length;b++){var S=D.textTracks[b];if(S[w])return S}return null},d.createCaptionsTrack=function(w){this.config.renderTextTracksNatively?this.createNativeTrack(w):this.createNonNativeTrack(w)},d.createNativeTrack=function(w){if(!this.captionsTracks[w]){var D=this.captionsProperties,b=this.captionsTracks,S=this.media,C=D[w],P=C.label,R=C.languageCode,L=this.getExistingTrack(w);if(L)b[w]=L,Object(s.clearCurrentCues)(b[w]),Object(s.sendAddTrackEvent)(b[w],S);else{var O=this.createTextTrack("captions",P,R);O&&(O[w]=!0,b[w]=O)}}},d.createNonNativeTrack=function(w){if(!this.nonNativeCaptionsTracks[w]){var D=this.captionsProperties[w];if(!!D){var b=D.label,S={_id:w,label:b,kind:"captions",default:D.media?!!D.media.default:!1,closedCaptions:D.media};this.nonNativeCaptionsTracks[w]=S,this.hls.trigger(l.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[S]})}}},d.createTextTrack=function(w,D,b){var S=this.media;if(!!S)return S.addTextTrack(w,D,b)},d.onMediaAttaching=function(w,D){this.media=D.media,this._cleanTracks()},d.onMediaDetaching=function(){var w=this.captionsTracks;Object.keys(w).forEach(function(D){Object(s.clearCurrentCues)(w[D]),delete w[D]}),this.nonNativeCaptionsTracks={}},d.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=p(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},d._cleanTracks=function(){var w=this.media;if(!!w){var D=w.textTracks;if(D)for(var b=0;b<D.length;b++)Object(s.clearCurrentCues)(D[b])}},d.onSubtitleTracksUpdated=function(w,D){var b=this;this.textTracks=[];var S=D.subtitleTracks||[],C=S.some(function(O){return O.textCodec===u.IMSC1_CODEC});if(this.config.enableWebVTT||C&&this.config.enableIMSC1){var P=this.tracks&&S&&this.tracks.length===S.length;if(this.tracks=S||[],this.config.renderTextTracksNatively){var R=this.media?this.media.textTracks:[];this.tracks.forEach(function(O,_){var x;if(_<R.length){for(var A=null,k=0;k<R.length;k++)if(v(R[k],O)){A=R[k];break}A&&(x=A)}x?Object(s.clearCurrentCues)(x):(x=b.createTextTrack("subtitles",O.name,O.lang),x&&(x.mode="disabled")),x&&(x.groupId=O.groupId,b.textTracks.push(x))})}else if(!P&&this.tracks&&this.tracks.length){var L=this.tracks.map(function(O){return{label:O.name,kind:O.type.toLowerCase(),default:O.default,subtitleTrack:O}});this.hls.trigger(l.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:L})}}},d.onManifestLoaded=function(w,D){var b=this;this.config.enableCEA708Captions&&D.captions&&D.captions.forEach(function(S){var C=/(?:CC|SERVICE)([1-4])/.exec(S.instreamId);if(!!C){var P="textTrack"+C[1],R=b.captionsProperties[P];!R||(R.label=S.name,S.lang&&(R.languageCode=S.lang),R.media=S)}})},d.onFragLoading=function(w,D){var b=this.cea608Parser1,S=this.cea608Parser2,C=this.lastSn;if(!(!this.enabled||!(b&&S))&&D.frag.type===t.PlaylistLevelType.MAIN){var P=D.frag.sn;P!==C+1&&(b.reset(),S.reset()),this.lastSn=P}},d.onFragLoaded=function(w,D){var b=D.frag,S=D.payload,C=this.initPTS,P=this.unparsedVttFrags;if(b.type===t.PlaylistLevelType.SUBTITLE)if(S.byteLength){if(!Object(c.isFiniteNumber)(C[b.cc])){P.push(D),C.length&&this.hls.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Missing initial subtitle PTS")});return}var R=b.decryptdata;if(R==null||R.key==null||R.method!=="AES-128"){var L=this.tracks[b.level],O=this.vttCCs;O[b.cc]||(O[b.cc]={start:b.start,prevCC:this.prevCC,new:!0},this.prevCC=b.cc),L&&L.textCodec===u.IMSC1_CODEC?this._parseIMSC1(b,S):this._parseVTTs(b,S,O)}}else this.hls.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Empty subtitle payload")})},d._parseIMSC1=function(w,D){var b=this,S=this.hls;Object(u.parseIMSC1)(D,this.initPTS[w.cc],this.timescale[w.cc],function(C){b._appendCues(C,w.level),S.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:w})},function(C){f.logger.log("Failed to parse IMSC1: "+C),S.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:w,error:C})})},d._parseVTTs=function(w,D,b){var S=this,C=this.hls;Object(a.parseWebVTT)(D,this.initPTS[w.cc],this.timescale[w.cc],b,w.cc,w.start,function(P){S._appendCues(P,w.level),C.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:w})},function(P){S._fallbackToIMSC1(w,D),f.logger.log("Failed to parse VTT cue: "+P),C.trigger(l.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:w,error:P})})},d._fallbackToIMSC1=function(w,D){var b=this,S=this.tracks[w.level];S.textCodec||Object(u.parseIMSC1)(D,this.initPTS[w.cc],this.timescale[w.cc],function(){S.textCodec=u.IMSC1_CODEC,b._parseIMSC1(w,D)},function(){S.textCodec="wvtt"})},d._appendCues=function(w,D){var b=this.hls;if(this.config.renderTextTracksNatively){var S=this.textTracks[D];if(S.mode==="disabled")return;w.forEach(function(R){return Object(s.addCueToTrack)(S,R)})}else{var C=this.tracks[D],P=C.default?"default":"subtitles"+D;b.trigger(l.Events.CUES_PARSED,{type:"subtitles",cues:w,track:P})}},d.onFragDecrypted=function(w,D){var b=D.frag;if(b.type===t.PlaylistLevelType.SUBTITLE){if(!Object(c.isFiniteNumber)(this.initPTS[b.cc])){this.unparsedVttFrags.push(D);return}this.onFragLoaded(l.Events.FRAG_LOADED,D)}},d.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},d.onFragParsingUserdata=function(w,D){var b=this.cea608Parser1,S=this.cea608Parser2;if(!(!this.enabled||!(b&&S)))for(var C=0;C<D.samples.length;C++){var P=D.samples[C].bytes;if(P){var R=this.extractCea608Data(P);b.addData(D.samples[C].pts,R[0]),S.addData(D.samples[C].pts,R[1])}}},d.onBufferFlushing=function(w,D){var b=D.startOffset,S=D.endOffset,C=D.endOffsetSubtitles,P=D.type,R=this.media;if(!(!R||R.currentTime<S)){if(!P||P==="video"){var L=this.captionsTracks;Object.keys(L).forEach(function(_){return Object(s.removeCuesInRange)(L[_],b,S)})}if(this.config.renderTextTracksNatively&&b===0&&C!==void 0){var O=this.textTracks;Object.keys(O).forEach(function(_){return Object(s.removeCuesInRange)(O[_],b,C)})}}},d.extractCea608Data=function(w){for(var D=w[0]&31,b=2,S=[[],[]],C=0;C<D;C++){var P=w[b++],R=127&w[b++],L=127&w[b++],O=(4&P)!=0,_=3&P;R===0&&L===0||O&&(_===0||_===1)&&(S[_].push(R),S[_].push(L))}return S},g}();function v(g,d){return g&&g.label===d.name&&!(g.textTrack1||g.textTrack2)}function y(g,d,E,w){return Math.min(d,w)-Math.max(g,E)}function p(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return c});var c=function(){function l(n,a){this.subtle=void 0,this.aesIV=void 0,this.subtle=n,this.aesIV=a}var e=l.prototype;return e.decrypt=function(a,s){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},s,a)},l}()},"./src/crypt/aes-decryptor.ts":function(G,m,r){r.r(m),r.d(m,"removePadding",function(){return l}),r.d(m,"default",function(){return e});var c=r("./src/utils/typed-array.ts");function l(n){var a=n.byteLength,s=a&&new DataView(n.buffer).getUint8(a-1);return s?Object(c.sliceUint8)(n,0,a-s):n}var e=function(){function n(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var a=n.prototype;return a.uint8ArrayToUint32Array_=function(u){for(var t=new DataView(u),f=new Uint32Array(4),h=0;h<4;h++)f[h]=t.getUint32(h*4);return f},a.initTable=function(){var u=this.sBox,t=this.invSBox,f=this.subMix,h=f[0],v=f[1],y=f[2],p=f[3],g=this.invSubMix,d=g[0],E=g[1],w=g[2],D=g[3],b=new Uint32Array(256),S=0,C=0,P=0;for(P=0;P<256;P++)P<128?b[P]=P<<1:b[P]=P<<1^283;for(P=0;P<256;P++){var R=C^C<<1^C<<2^C<<3^C<<4;R=R>>>8^R&255^99,u[S]=R,t[R]=S;var L=b[S],O=b[L],_=b[O],x=b[R]*257^R*16843008;h[S]=x<<24|x>>>8,v[S]=x<<16|x>>>16,y[S]=x<<8|x>>>24,p[S]=x,x=_*16843009^O*65537^L*257^S*16843008,d[R]=x<<24|x>>>8,E[R]=x<<16|x>>>16,w[R]=x<<8|x>>>24,D[R]=x,S?(S=L^b[b[b[_^L]]],C^=b[b[C]]):S=C=1}},a.expandKey=function(u){for(var t=this.uint8ArrayToUint32Array_(u),f=!0,h=0;h<t.length&&f;)f=t[h]===this.key[h],h++;if(!f){this.key=t;var v=this.keySize=t.length;if(v!==4&&v!==6&&v!==8)throw new Error("Invalid aes key size="+v);var y=this.ksRows=(v+6+1)*4,p,g,d=this.keySchedule=new Uint32Array(y),E=this.invKeySchedule=new Uint32Array(y),w=this.sBox,D=this.rcon,b=this.invSubMix,S=b[0],C=b[1],P=b[2],R=b[3],L,O;for(p=0;p<y;p++){if(p<v){L=d[p]=t[p];continue}O=L,p%v==0?(O=O<<8|O>>>24,O=w[O>>>24]<<24|w[O>>>16&255]<<16|w[O>>>8&255]<<8|w[O&255],O^=D[p/v|0]<<24):v>6&&p%v==4&&(O=w[O>>>24]<<24|w[O>>>16&255]<<16|w[O>>>8&255]<<8|w[O&255]),d[p]=L=(d[p-v]^O)>>>0}for(g=0;g<y;g++)p=y-g,g&3?O=d[p]:O=d[p-4],g<4||p<=4?E[g]=O:E[g]=S[w[O>>>24]]^C[w[O>>>16&255]]^P[w[O>>>8&255]]^R[w[O&255]],E[g]=E[g]>>>0}},a.networkToHostOrderSwap=function(u){return u<<24|(u&65280)<<8|(u&16711680)>>8|u>>>24},a.decrypt=function(u,t,f){for(var h=this.keySize+6,v=this.invKeySchedule,y=this.invSBox,p=this.invSubMix,g=p[0],d=p[1],E=p[2],w=p[3],D=this.uint8ArrayToUint32Array_(f),b=D[0],S=D[1],C=D[2],P=D[3],R=new Int32Array(u),L=new Int32Array(R.length),O,_,x,A,k,M,N,U,j,z,J,te,re,oe,se=this.networkToHostOrderSwap;t<R.length;){for(j=se(R[t]),z=se(R[t+1]),J=se(R[t+2]),te=se(R[t+3]),k=j^v[0],M=te^v[1],N=J^v[2],U=z^v[3],re=4,oe=1;oe<h;oe++)O=g[k>>>24]^d[M>>16&255]^E[N>>8&255]^w[U&255]^v[re],_=g[M>>>24]^d[N>>16&255]^E[U>>8&255]^w[k&255]^v[re+1],x=g[N>>>24]^d[U>>16&255]^E[k>>8&255]^w[M&255]^v[re+2],A=g[U>>>24]^d[k>>16&255]^E[M>>8&255]^w[N&255]^v[re+3],k=O,M=_,N=x,U=A,re=re+4;O=y[k>>>24]<<24^y[M>>16&255]<<16^y[N>>8&255]<<8^y[U&255]^v[re],_=y[M>>>24]<<24^y[N>>16&255]<<16^y[U>>8&255]<<8^y[k&255]^v[re+1],x=y[N>>>24]<<24^y[U>>16&255]<<16^y[k>>8&255]<<8^y[M&255]^v[re+2],A=y[U>>>24]<<24^y[k>>16&255]<<16^y[M>>8&255]<<8^y[N&255]^v[re+3],L[t]=se(O^b),L[t+1]=se(A^S),L[t+2]=se(x^C),L[t+3]=se(_^P),b=j,S=z,C=J,P=te,t=t+4}return L.buffer},n}()},"./src/crypt/decrypter.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return t});var c=r("./src/crypt/aes-crypto.ts"),l=r("./src/crypt/fast-aes-key.ts"),e=r("./src/crypt/aes-decryptor.ts"),n=r("./src/utils/logger.ts"),a=r("./src/utils/mp4-tools.ts"),s=r("./src/utils/typed-array.ts"),u=16,t=function(){function f(v,y,p){var g=p===void 0?{}:p,d=g.removePKCS7Padding,E=d===void 0?!0:d;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=v,this.config=y,this.removePKCS7Padding=E,E)try{var w=self.crypto;w&&(this.subtle=w.subtle||w.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var h=f.prototype;return h.destroy=function(){this.observer=null},h.isSync=function(){return this.config.enableSoftwareAES},h.flush=function(){var y=this.currentResult;if(!y){this.reset();return}var p=new Uint8Array(y);return this.reset(),this.removePKCS7Padding?Object(e.removePadding)(p):p},h.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},h.decrypt=function(y,p,g,d){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(y),p,g);var E=this.flush();E&&d(E.buffer)}else this.webCryptoDecrypt(new Uint8Array(y),p,g).then(d)},h.softwareDecrypt=function(y,p,g){var d=this.currentIV,E=this.currentResult,w=this.remainderData;this.logOnce("JS AES decrypt"),w&&(y=Object(a.appendUint8Array)(w,y),this.remainderData=null);var D=this.getValidChunk(y);if(!D.length)return null;d&&(g=d);var b=this.softwareDecrypter;b||(b=this.softwareDecrypter=new e.default),b.expandKey(p);var S=E;return this.currentResult=b.decrypt(D.buffer,0,g),this.currentIV=Object(s.sliceUint8)(D,-16).buffer,S||null},h.webCryptoDecrypt=function(y,p,g){var d=this,E=this.subtle;return(this.key!==p||!this.fastAesKey)&&(this.key=p,this.fastAesKey=new l.default(E,p)),this.fastAesKey.expandKey().then(function(w){if(!E)return Promise.reject(new Error("web crypto not initialized"));var D=new c.default(E,g);return D.decrypt(y.buffer,w)}).catch(function(w){return d.onWebCryptoError(w,y,p,g)})},h.onWebCryptoError=function(y,p,g,d){return n.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",y),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(p,g,d)},h.getValidChunk=function(y){var p=y,g=y.length-y.length%u;return g!==y.length&&(p=Object(s.sliceUint8)(y,0,g),this.remainderData=Object(s.sliceUint8)(y,g)),p},h.logOnce=function(y){!this.logEnabled||(n.logger.log("[decrypter.ts]: "+y),this.logEnabled=!1)},f}()},"./src/crypt/fast-aes-key.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return c});var c=function(){function l(n,a){this.subtle=void 0,this.key=void 0,this.subtle=n,this.key=a}var e=l.prototype;return e.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},l}()},"./src/demux/aacdemuxer.ts":function(G,m,r){r.r(m);var c=r("./src/demux/base-audio-demuxer.ts"),l=r("./src/demux/adts.ts"),e=r("./src/utils/logger.ts"),n=r("./src/demux/id3.ts");function a(t,f){t.prototype=Object.create(f.prototype),t.prototype.constructor=t,s(t,f)}function s(t,f){return s=Object.setPrototypeOf||function(v,y){return v.__proto__=y,v},s(t,f)}var u=function(t){a(f,t);function f(v,y){var p;return p=t.call(this)||this,p.observer=void 0,p.config=void 0,p.observer=v,p.config=y,p}var h=f.prototype;return h.resetInitSegment=function(y,p,g){t.prototype.resetInitSegment.call(this,y,p,g),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:y,duration:g,inputTimeScale:9e4,dropped:0}},f.probe=function(y){if(!y)return!1;for(var p=n.getID3Data(y,0)||[],g=p.length,d=y.length;g<d;g++)if(l.probe(y,g))return e.logger.log("ADTS sync word found !"),!0;return!1},h.canParse=function(y,p){return l.canParse(y,p)},h.appendFrame=function(y,p,g){l.initTrackConfig(y,this.observer,p,g,y.manifestCodec);var d=l.appendFrame(y,p,g,this.initPTS,this.frameIndex);if(d&&d.missing===0)return d},f}(c.default);u.minProbeByteLength=9,m.default=u},"./src/demux/adts.ts":function(G,m,r){r.r(m),r.d(m,"getAudioConfig",function(){return n}),r.d(m,"isHeaderPattern",function(){return a}),r.d(m,"getHeaderLength",function(){return s}),r.d(m,"getFullFrameLength",function(){return u}),r.d(m,"canGetFrameLength",function(){return t}),r.d(m,"isHeader",function(){return f}),r.d(m,"canParse",function(){return h}),r.d(m,"probe",function(){return v}),r.d(m,"initTrackConfig",function(){return y}),r.d(m,"getFrameDuration",function(){return p}),r.d(m,"parseFrameHeader",function(){return g}),r.d(m,"appendFrame",function(){return d});var c=r("./src/utils/logger.ts"),l=r("./src/errors.ts"),e=r("./src/events.ts");function n(E,w,D,b){var S,C,P,R,L=navigator.userAgent.toLowerCase(),O=b,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];S=((w[D+2]&192)>>>6)+1;var x=(w[D+2]&60)>>>2;if(x>_.length-1){E.trigger(e.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+x});return}return P=(w[D+2]&1)<<2,P|=(w[D+3]&192)>>>6,c.logger.log("manifest codec:"+b+", ADTS type:"+S+", samplingIndex:"+x),/firefox/i.test(L)?x>=6?(S=5,R=new Array(4),C=x-3):(S=2,R=new Array(2),C=x):L.indexOf("android")!==-1?(S=2,R=new Array(2),C=x):(S=5,R=new Array(4),b&&(b.indexOf("mp4a.40.29")!==-1||b.indexOf("mp4a.40.5")!==-1)||!b&&x>=6?C=x-3:((b&&b.indexOf("mp4a.40.2")!==-1&&(x>=6&&P===1||/vivaldi/i.test(L))||!b&&P===1)&&(S=2,R=new Array(2)),C=x)),R[0]=S<<3,R[0]|=(x&14)>>1,R[1]|=(x&1)<<7,R[1]|=P<<3,S===5&&(R[1]|=(C&14)>>1,R[2]=(C&1)<<7,R[2]|=2<<2,R[3]=0),{config:R,samplerate:_[x],channelCount:P,codec:"mp4a.40."+S,manifestCodec:O}}function a(E,w){return E[w]===255&&(E[w+1]&246)==240}function s(E,w){return E[w+1]&1?7:9}function u(E,w){return(E[w+3]&3)<<11|E[w+4]<<3|(E[w+5]&224)>>>5}function t(E,w){return w+5<E.length}function f(E,w){return w+1<E.length&&a(E,w)}function h(E,w){return t(E,w)&&a(E,w)&&u(E,w)<=E.length-w}function v(E,w){if(f(E,w)){var D=s(E,w);if(w+D>=E.length)return!1;var b=u(E,w);if(b<=D)return!1;var S=w+b;return S===E.length||f(E,S)}return!1}function y(E,w,D,b,S){if(!E.samplerate){var C=n(w,D,b,S);if(!C)return;E.config=C.config,E.samplerate=C.samplerate,E.channelCount=C.channelCount,E.codec=C.codec,E.manifestCodec=C.manifestCodec,c.logger.log("parsed codec:"+E.codec+", rate:"+C.samplerate+", channels:"+C.channelCount)}}function p(E){return 1024*9e4/E}function g(E,w,D,b,S){var C=s(E,w),P=u(E,w);if(P-=C,P>0){var R=D+b*S;return{headerLength:C,frameLength:P,stamp:R}}}function d(E,w,D,b,S){var C=p(E.samplerate),P=g(w,D,b,S,C);if(P){var R=P.frameLength,L=P.headerLength,O=P.stamp,_=L+R,x=Math.max(0,D+_-w.length),A;x?(A=new Uint8Array(_-L),A.set(w.subarray(D+L,w.length),0)):A=w.subarray(D+L,D+_);var k={unit:A,pts:O};return x||E.samples.push(k),{sample:k,length:_,missing:x}}}},"./src/demux/base-audio-demuxer.ts":function(G,m,r){r.r(m),r.d(m,"initPTSFn",function(){return u});var c=r("./src/polyfills/number.ts"),l=r("./src/demux/id3.ts"),e=r("./src/demux/dummy-demuxed-track.ts"),n=r("./src/utils/mp4-tools.ts"),a=r("./src/utils/typed-array.ts"),s=function(){function t(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var f=t.prototype;return f.resetInitSegment=function(v,y,p){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},f.resetTimeStamp=function(){},f.resetContiguity=function(){},f.canParse=function(v,y){return!1},f.appendFrame=function(v,y,p){},f.demux=function(v,y){this.cachedData&&(v=Object(n.appendUint8Array)(this.cachedData,v),this.cachedData=null);var p=l.getID3Data(v,0),g=p?p.length:0,d,E,w=this._audioTrack,D=this._id3Track,b=p?l.getTimeStamp(p):void 0,S=v.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=u(b,y)),p&&p.length>0&&D.samples.push({pts:this.initPTS,dts:this.initPTS,data:p}),E=this.initPTS;g<S;){if(this.canParse(v,g)){var C=this.appendFrame(w,v,g);C?(this.frameIndex++,E=C.sample.pts,g+=C.length,d=g):g=S}else l.canParse(v,g)?(p=l.getID3Data(v,g),D.samples.push({pts:E,dts:E,data:p}),g+=p.length,d=g):g++;if(g===S&&d!==S){var P=Object(a.sliceUint8)(v,d);this.cachedData?this.cachedData=Object(n.appendUint8Array)(this.cachedData,P):this.cachedData=P}}return{audioTrack:w,avcTrack:Object(e.dummyTrack)(),id3Track:D,textTrack:Object(e.dummyTrack)()}},f.demuxSampleAes=function(v,y,p){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},f.flush=function(v){var y=this.cachedData;return y&&(this.cachedData=null,this.demux(y,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(e.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(e.dummyTrack)()}},f.destroy=function(){},t}(),u=function(f,h){return Object(c.isFiniteNumber)(f)?f*90:h*9e4};m.default=s},"./src/demux/chunk-cache.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return c});var c=function(){function e(){this.chunks=[],this.dataLength=0}var n=e.prototype;return n.push=function(s){this.chunks.push(s),this.dataLength+=s.length},n.flush=function(){var s=this.chunks,u=this.dataLength,t;if(s.length)s.length===1?t=s[0]:t=l(s,u);else return new Uint8Array(0);return this.reset(),t},n.reset=function(){this.chunks.length=0,this.dataLength=0},e}();function l(e,n){for(var a=new Uint8Array(n),s=0,u=0;u<e.length;u++){var t=e[u];a.set(t,s),s+=t.length}return a}},"./src/demux/dummy-demuxed-track.ts":function(G,m,r){r.r(m),r.d(m,"dummyTrack",function(){return c});function c(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(G,m,r){r.r(m);var c=r("./src/utils/logger.ts"),l=function(){function e(a){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=a,this.bytesAvailable=a.byteLength,this.word=0,this.bitsAvailable=0}var n=e.prototype;return n.loadWord=function(){var s=this.data,u=this.bytesAvailable,t=s.byteLength-u,f=new Uint8Array(4),h=Math.min(4,u);if(h===0)throw new Error("no bytes available");f.set(s.subarray(t,t+h)),this.word=new DataView(f.buffer).getUint32(0),this.bitsAvailable=h*8,this.bytesAvailable-=h},n.skipBits=function(s){var u;this.bitsAvailable>s?(this.word<<=s,this.bitsAvailable-=s):(s-=this.bitsAvailable,u=s>>3,s-=u>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=s,this.bitsAvailable-=s)},n.readBits=function(s){var u=Math.min(this.bitsAvailable,s),t=this.word>>>32-u;return s>32&&c.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),u=s-u,u>0&&this.bitsAvailable?t<<u|this.readBits(u):t},n.skipLZ=function(){var s;for(s=0;s<this.bitsAvailable;++s)if((this.word&2147483648>>>s)!=0)return this.word<<=s,this.bitsAvailable-=s,s;return this.loadWord(),s+this.skipLZ()},n.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.skipEG=function(){this.skipBits(1+this.skipLZ())},n.readUEG=function(){var s=this.skipLZ();return this.readBits(s+1)-1},n.readEG=function(){var s=this.readUEG();return 1&s?1+s>>>1:-1*(s>>>1)},n.readBoolean=function(){return this.readBits(1)===1},n.readUByte=function(){return this.readBits(8)},n.readUShort=function(){return this.readBits(16)},n.readUInt=function(){return this.readBits(32)},n.skipScalingList=function(s){for(var u=8,t=8,f,h=0;h<s;h++)t!==0&&(f=this.readEG(),t=(u+f+256)%256),u=t===0?u:t},n.readSPS=function(){var s=0,u=0,t=0,f=0,h,v,y,p=this.readUByte.bind(this),g=this.readBits.bind(this),d=this.readUEG.bind(this),E=this.readBoolean.bind(this),w=this.skipBits.bind(this),D=this.skipEG.bind(this),b=this.skipUEG.bind(this),S=this.skipScalingList.bind(this);p();var C=p();if(g(5),w(3),p(),b(),C===100||C===110||C===122||C===244||C===44||C===83||C===86||C===118||C===128){var P=d();if(P===3&&w(1),b(),b(),w(1),E())for(v=P!==3?8:12,y=0;y<v;y++)E()&&(y<6?S(16):S(64))}b();var R=d();if(R===0)d();else if(R===1)for(w(1),D(),D(),h=d(),y=0;y<h;y++)D();b(),w(1);var L=d(),O=d(),_=g(1);_===0&&w(1),w(1),E()&&(s=d(),u=d(),t=d(),f=d());var x=[1,1];if(E()&&E()){var A=p();switch(A){case 1:x=[1,1];break;case 2:x=[12,11];break;case 3:x=[10,11];break;case 4:x=[16,11];break;case 5:x=[40,33];break;case 6:x=[24,11];break;case 7:x=[20,11];break;case 8:x=[32,11];break;case 9:x=[80,33];break;case 10:x=[18,11];break;case 11:x=[15,11];break;case 12:x=[64,33];break;case 13:x=[160,99];break;case 14:x=[4,3];break;case 15:x=[3,2];break;case 16:x=[2,1];break;case 255:{x=[p()<<8|p(),p()<<8|p()];break}}}return{width:Math.ceil((L+1)*16-s*2-u*2),height:(2-_)*(O+1)*16-(_?2:4)*(t+f),pixelRatio:x}},n.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();m.default=l},"./src/demux/id3.ts":function(G,m,r){r.r(m),r.d(m,"isHeader",function(){return c}),r.d(m,"isFooter",function(){return l}),r.d(m,"getID3Data",function(){return e}),r.d(m,"canParse",function(){return a}),r.d(m,"getTimeStamp",function(){return s}),r.d(m,"isTimeStampFrame",function(){return u}),r.d(m,"getID3Frames",function(){return f}),r.d(m,"decodeFrame",function(){return h}),r.d(m,"utf8ArrayToStr",function(){return d}),r.d(m,"testables",function(){return E});var c=function(S,C){return C+10<=S.length&&S[C]===73&&S[C+1]===68&&S[C+2]===51&&S[C+3]<255&&S[C+4]<255&&S[C+6]<128&&S[C+7]<128&&S[C+8]<128&&S[C+9]<128},l=function(S,C){return C+10<=S.length&&S[C]===51&&S[C+1]===68&&S[C+2]===73&&S[C+3]<255&&S[C+4]<255&&S[C+6]<128&&S[C+7]<128&&S[C+8]<128&&S[C+9]<128},e=function(S,C){for(var P=C,R=0;c(S,C);){R+=10;var L=n(S,C+6);R+=L,l(S,C+10)&&(R+=10),C+=R}if(R>0)return S.subarray(P,P+R)},n=function(S,C){var P=0;return P=(S[C]&127)<<21,P|=(S[C+1]&127)<<14,P|=(S[C+2]&127)<<7,P|=S[C+3]&127,P},a=function(S,C){return c(S,C)&&n(S,C+6)+10<=S.length-C},s=function(S){for(var C=f(S),P=0;P<C.length;P++){var R=C[P];if(u(R))return g(R)}},u=function(S){return S&&S.key==="PRIV"&&S.info==="com.apple.streaming.transportStreamTimestamp"},t=function(S){var C=String.fromCharCode(S[0],S[1],S[2],S[3]),P=n(S,4),R=10;return{type:C,size:P,data:S.subarray(R,R+P)}},f=function(S){for(var C=0,P=[];c(S,C);){var R=n(S,C+6);C+=10;for(var L=C+R;C+8<L;){var O=t(S.subarray(C)),_=h(O);_&&P.push(_),C+=O.size+10}l(S,C)&&(C+=10)}return P},h=function(S){return S.type==="PRIV"?v(S):S.type[0]==="W"?p(S):y(S)},v=function(S){if(!(S.size<2)){var C=d(S.data,!0),P=new Uint8Array(S.data.subarray(C.length+1));return{key:S.type,info:C,data:P.buffer}}},y=function(S){if(!(S.size<2)){if(S.type==="TXXX"){var C=1,P=d(S.data.subarray(C),!0);C+=P.length+1;var R=d(S.data.subarray(C));return{key:S.type,info:P,data:R}}var L=d(S.data.subarray(1));return{key:S.type,data:L}}},p=function(S){if(S.type==="WXXX"){if(S.size<2)return;var C=1,P=d(S.data.subarray(C),!0);C+=P.length+1;var R=d(S.data.subarray(C));return{key:S.type,info:P,data:R}}var L=d(S.data);return{key:S.type,data:L}},g=function(S){if(S.data.byteLength===8){var C=new Uint8Array(S.data),P=C[3]&1,R=(C[4]<<23)+(C[5]<<15)+(C[6]<<7)+C[7];return R/=45,P&&(R+=4772185884e-2),Math.round(R)}},d=function(S,C){C===void 0&&(C=!1);var P=D();if(P){var R=P.decode(S);if(C){var L=R.indexOf("\0");return L!==-1?R.substring(0,L):R}return R.replace(/\0/g,"")}for(var O=S.length,_,x,A,k="",M=0;M<O;){if(_=S[M++],_===0&&C)return k;if(_===0||_===3)continue;switch(_>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:k+=String.fromCharCode(_);break;case 12:case 13:x=S[M++],k+=String.fromCharCode((_&31)<<6|x&63);break;case 14:x=S[M++],A=S[M++],k+=String.fromCharCode((_&15)<<12|(x&63)<<6|(A&63)<<0);break}}return k},E={decodeTextFrame:y},w;function D(){return!w&&typeof self.TextDecoder!="undefined"&&(w=new self.TextDecoder("utf-8")),w}},"./src/demux/mp3demuxer.ts":function(G,m,r){r.r(m);var c=r("./src/demux/base-audio-demuxer.ts"),l=r("./src/demux/id3.ts"),e=r("./src/utils/logger.ts"),n=r("./src/demux/mpegaudio.ts");function a(t,f){t.prototype=Object.create(f.prototype),t.prototype.constructor=t,s(t,f)}function s(t,f){return s=Object.setPrototypeOf||function(v,y){return v.__proto__=y,v},s(t,f)}var u=function(t){a(f,t);function f(){return t.apply(this,arguments)||this}var h=f.prototype;return h.resetInitSegment=function(y,p,g){t.prototype.resetInitSegment.call(this,y,p,g),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:y,duration:g,inputTimeScale:9e4,dropped:0}},f.probe=function(y){if(!y)return!1;for(var p=l.getID3Data(y,0)||[],g=p.length,d=y.length;g<d;g++)if(n.probe(y,g))return e.logger.log("MPEG Audio sync word found !"),!0;return!1},h.canParse=function(y,p){return n.canParse(y,p)},h.appendFrame=function(y,p,g){if(this.initPTS!==null)return n.appendFrame(y,p,g,this.initPTS,this.frameIndex)},f}(c.default);u.minProbeByteLength=4,m.default=u},"./src/demux/mp4demuxer.ts":function(G,m,r){r.r(m);var c=r("./src/utils/mp4-tools.ts"),l=r("./src/demux/dummy-demuxed-track.ts"),e=function(){function n(s,u){this.remainderData=null,this.config=void 0,this.config=u}var a=n.prototype;return a.resetTimeStamp=function(){},a.resetInitSegment=function(){},a.resetContiguity=function(){},n.probe=function(u){return Object(c.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},a.demux=function(u){var t=u,f=Object(l.dummyTrack)();if(this.config.progressive){this.remainderData&&(t=Object(c.appendUint8Array)(this.remainderData,u));var h=Object(c.segmentValidRange)(t);this.remainderData=h.remainder,f.samples=h.valid||new Uint8Array}else f.samples=t;return{audioTrack:Object(l.dummyTrack)(),avcTrack:f,id3Track:Object(l.dummyTrack)(),textTrack:Object(l.dummyTrack)()}},a.flush=function(){var u=Object(l.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(l.dummyTrack)(),avcTrack:u,id3Track:Object(l.dummyTrack)(),textTrack:Object(l.dummyTrack)()}},a.demuxSampleAes=function(u,t,f){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},a.destroy=function(){},n}();e.minProbeByteLength=1024,m.default=e},"./src/demux/mpegaudio.ts":function(G,m,r){r.r(m),r.d(m,"appendFrame",function(){return s}),r.d(m,"parseHeader",function(){return u}),r.d(m,"isHeaderPattern",function(){return t}),r.d(m,"isHeader",function(){return f}),r.d(m,"canParse",function(){return h}),r.d(m,"probe",function(){return v});var c=null,l=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],e=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],n=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],a=[0,1,1,4];function s(y,p,g,d,E){if(!(g+24>p.length)){var w=u(p,g);if(w&&g+w.frameLength<=p.length){var D=w.samplesPerFrame*9e4/w.sampleRate,b=d+E*D,S={unit:p.subarray(g,g+w.frameLength),pts:b,dts:b};return y.config=[],y.channelCount=w.channelCount,y.samplerate=w.sampleRate,y.samples.push(S),{sample:S,length:w.frameLength,missing:0}}}}function u(y,p){var g=y[p+1]>>3&3,d=y[p+1]>>1&3,E=y[p+2]>>4&15,w=y[p+2]>>2&3;if(g!==1&&E!==0&&E!==15&&w!==3){var D=y[p+2]>>1&1,b=y[p+3]>>6,S=g===3?3-d:d===3?3:4,C=l[S*14+E-1]*1e3,P=g===3?0:g===2?1:2,R=e[P*3+w],L=b===3?1:2,O=n[g][d],_=a[d],x=O*8*_,A=Math.floor(O*C/R+D)*_;if(c===null){var k=navigator.userAgent||"",M=k.match(/Chrome\/(\d+)/i);c=M?parseInt(M[1]):0}var N=!!c&&c<=87;return N&&d===2&&C>=224e3&&b===0&&(y[p+3]=y[p+3]|128),{sampleRate:R,channelCount:L,frameLength:A,samplesPerFrame:x}}}function t(y,p){return y[p]===255&&(y[p+1]&224)==224&&(y[p+1]&6)!=0}function f(y,p){return p+1<y.length&&t(y,p)}function h(y,p){var g=4;return t(y,p)&&g<=y.length-p}function v(y,p){if(p+1<y.length&&t(y,p)){var g=4,d=u(y,p),E=g;d!=null&&d.frameLength&&(E=d.frameLength);var w=p+E;return w===y.length||f(y,w)}return!1}},"./src/demux/sample-aes.ts":function(G,m,r){r.r(m);var c=r("./src/crypt/decrypter.ts"),l=r("./src/demux/tsdemuxer.ts"),e=function(){function n(s,u,t){this.keyData=void 0,this.decrypter=void 0,this.keyData=t,this.decrypter=new c.default(s,u,{removePKCS7Padding:!1})}var a=n.prototype;return a.decryptBuffer=function(u,t){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,t)},a.decryptAacSample=function(u,t,f,h){var v=u[t].unit,y=v.subarray(16,v.length-v.length%16),p=y.buffer.slice(y.byteOffset,y.byteOffset+y.length),g=this;this.decryptBuffer(p,function(d){var E=new Uint8Array(d);v.set(E,16),h||g.decryptAacSamples(u,t+1,f)})},a.decryptAacSamples=function(u,t,f){for(;;t++){if(t>=u.length){f();return}if(!(u[t].unit.length<32)){var h=this.decrypter.isSync();if(this.decryptAacSample(u,t,f,h),!h)return}}},a.getAvcEncryptedData=function(u){for(var t=Math.floor((u.length-48)/160)*16+16,f=new Int8Array(t),h=0,v=32;v<=u.length-16;v+=160,h+=16)f.set(u.subarray(v,v+16),h);return f},a.getAvcDecryptedUnit=function(u,t){for(var f=new Uint8Array(t),h=0,v=32;v<=u.length-16;v+=160,h+=16)u.set(f.subarray(h,h+16),v);return u},a.decryptAvcSample=function(u,t,f,h,v,y){var p=Object(l.discardEPB)(v.data),g=this.getAvcEncryptedData(p),d=this;this.decryptBuffer(g.buffer,function(E){v.data=d.getAvcDecryptedUnit(p,E),y||d.decryptAvcSamples(u,t,f+1,h)})},a.decryptAvcSamples=function(u,t,f,h){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,f=0){if(t>=u.length){h();return}for(var v=u[t].units;!(f>=v.length);f++){var y=v[f];if(!(y.data.length<=48||y.type!==1&&y.type!==5)){var p=this.decrypter.isSync();if(this.decryptAvcSample(u,t,f,h,y,p),!p)return}}}},n}();m.default=e},"./src/demux/transmuxer-interface.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return f});var c=r("./node_modules/webworkify-webpack/index.js"),l=r("./src/events.ts"),e=r("./src/demux/transmuxer.ts"),n=r("./src/utils/logger.ts"),a=r("./src/errors.ts"),s=r("./src/utils/mediasource-helper.ts"),u=r("./node_modules/eventemitter3/index.js"),t=Object(s.getMediaSource)()||{isTypeSupported:function(){return!1}},f=function(){function h(y,p,g,d){var E=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=y,this.id=p,this.onTransmuxComplete=g,this.onFlush=d;var w=y.config,D=function(R,L){L=L||{},L.frag=E.frag,L.id=E.id,y.trigger(R,L)};this.observer=new u.EventEmitter,this.observer.on(l.Events.FRAG_DECRYPTED,D),this.observer.on(l.Events.ERROR,D);var b={mp4:t.isTypeSupported("video/mp4"),mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"')},S=navigator.vendor;if(w.enableWorker&&typeof Worker!="undefined"){n.logger.log("demuxing in webworker");var C;try{C=this.worker=c("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),C.addEventListener("message",this.onwmsg),C.onerror=function(P){y.trigger(l.Events.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(P.message+"  ("+P.filename+":"+P.lineno+")")})},C.postMessage({cmd:"init",typeSupported:b,vendor:S,id:p,config:JSON.stringify(w)})}catch(P){n.logger.warn("Error in worker:",P),n.logger.error("Error while initializing DemuxerWorker, fallback to inline"),C&&self.URL.revokeObjectURL(C.objectURL),this.transmuxer=new e.default(this.observer,b,w,S,p),this.worker=null}}else this.transmuxer=new e.default(this.observer,b,w,S,p)}var v=h.prototype;return v.destroy=function(){var p=this.worker;if(p)p.removeEventListener("message",this.onwmsg),p.terminate(),this.worker=null;else{var g=this.transmuxer;g&&(g.destroy(),this.transmuxer=null)}var d=this.observer;d&&d.removeAllListeners(),this.observer=null},v.push=function(p,g,d,E,w,D,b,S,C,P){var R=this;C.transmuxing.start=self.performance.now();var L=this.transmuxer,O=this.worker,_=D?D.start:w.start,x=w.decryptdata,A=this.frag,k=!(A&&w.cc===A.cc),M=!(A&&C.level===A.level),N=A?C.sn-A.sn:-1,U=this.part?C.part-this.part.index:1,j=!M&&(N===1||N===0&&U===1),z=self.performance.now();(M||N||w.stats.parsing.start===0)&&(w.stats.parsing.start=z),D&&(U||!j)&&(D.stats.parsing.start=z);var J=new e.TransmuxState(k,j,S,M,_);if(!j||k){n.logger.log("[transmuxer-interface, "+w.type+"]: Starting new transmux session for sn: "+C.sn+" p: "+C.part+" level: "+C.level+" id: "+C.id+`
        discontinuity: `+k+`
        trackSwitch: `+M+`
        contiguous: `+j+`
        accurateTimeOffset: `+S+`
        timeOffset: `+_);var te=new e.TransmuxConfig(d,E,g,b,P);this.configureTransmuxer(te)}if(this.frag=w,this.part=D,O)O.postMessage({cmd:"demux",data:p,decryptdata:x,chunkMeta:C,state:J},p instanceof ArrayBuffer?[p]:[]);else if(L){var re=L.push(p,x,C,J);Object(e.isPromise)(re)?re.then(function(oe){R.handleTransmuxComplete(oe)}):this.handleTransmuxComplete(re)}},v.flush=function(p){var g=this;p.transmuxing.start=self.performance.now();var d=this.transmuxer,E=this.worker;if(E)E.postMessage({cmd:"flush",chunkMeta:p});else if(d){var w=d.flush(p);Object(e.isPromise)(w)?w.then(function(D){g.handleFlushResult(D,p)}):this.handleFlushResult(w,p)}},v.handleFlushResult=function(p,g){var d=this;p.forEach(function(E){d.handleTransmuxComplete(E)}),this.onFlush(g)},v.onWorkerMessage=function(p){var g=p.data,d=this.hls;switch(g.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(g.data);break}case"flush":{this.onFlush(g.data);break}default:{g.data=g.data||{},g.data.frag=this.frag,g.data.id=this.id,d.trigger(g.event,g.data);break}}},v.configureTransmuxer=function(p){var g=this.worker,d=this.transmuxer;g?g.postMessage({cmd:"configure",config:p}):d&&d.configure(p)},v.handleTransmuxComplete=function(p){p.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(p)},h}()},"./src/demux/transmuxer-worker.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return a});var c=r("./src/demux/transmuxer.ts"),l=r("./src/events.ts"),e=r("./src/utils/logger.ts"),n=r("./node_modules/eventemitter3/index.js");function a(h){var v=new n.EventEmitter,y=function(g,d){h.postMessage({event:g,data:d})};v.on(l.Events.FRAG_DECRYPTED,y),v.on(l.Events.ERROR,y),h.addEventListener("message",function(p){var g=p.data;switch(g.cmd){case"init":{var d=JSON.parse(g.config);h.transmuxer=new c.default(v,g.typeSupported,d,g.vendor,g.id),Object(e.enableLogs)(d.debug),y("init",null);break}case"configure":{h.transmuxer.configure(g.config);break}case"demux":{var E=h.transmuxer.push(g.data,g.decryptdata,g.chunkMeta,g.state);Object(c.isPromise)(E)?E.then(function(b){s(h,b)}):s(h,E);break}case"flush":{var w=g.chunkMeta,D=h.transmuxer.flush(w);Object(c.isPromise)(D)?D.then(function(b){t(h,b,w)}):t(h,D,w);break}}})}function s(h,v){if(!f(v.remuxResult)){var y=[],p=v.remuxResult,g=p.audio,d=p.video;g&&u(y,g),d&&u(y,d),h.postMessage({event:"transmuxComplete",data:v},y)}}function u(h,v){v.data1&&h.push(v.data1.buffer),v.data2&&h.push(v.data2.buffer)}function t(h,v,y){v.forEach(function(p){s(h,p)}),h.postMessage({event:"flush",data:y})}function f(h){return!h.audio&&!h.video&&!h.text&&!h.id3&&!h.initSegment}},"./src/demux/transmuxer.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return E}),r.d(m,"isPromise",function(){return b}),r.d(m,"TransmuxConfig",function(){return S}),r.d(m,"TransmuxState",function(){return C});var c=r("./src/events.ts"),l=r("./src/errors.ts"),e=r("./src/crypt/decrypter.ts"),n=r("./src/demux/aacdemuxer.ts"),a=r("./src/demux/mp4demuxer.ts"),s=r("./src/demux/tsdemuxer.ts"),u=r("./src/demux/mp3demuxer.ts"),t=r("./src/remux/mp4-remuxer.ts"),f=r("./src/remux/passthrough-remuxer.ts"),h=r("./src/demux/chunk-cache.ts"),v=r("./src/utils/mp4-tools.ts"),y=r("./src/utils/logger.ts"),p;try{p=self.performance.now.bind(self.performance)}catch{y.logger.debug("Unable to use Performance API on this environment"),p=self.Date.now}var g=[{demux:s.default,remux:t.default},{demux:a.default,remux:f.default},{demux:n.default,remux:t.default},{demux:u.default,remux:t.default}],d=1024;g.forEach(function(P){var R=P.demux;d=Math.max(d,R.minProbeByteLength)});var E=function(){function P(L,O,_,x,A){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new h.default,this.observer=L,this.typeSupported=O,this.config=_,this.vendor=x,this.id=A}var R=P.prototype;return R.configure=function(O){this.transmuxConfig=O,this.decrypter&&this.decrypter.reset()},R.push=function(O,_,x,A){var k=this,M=x.transmuxing;M.executeStart=p();var N=new Uint8Array(O),U=this.cache,j=this.config,z=this.currentTransmuxState,J=this.transmuxConfig;A&&(this.currentTransmuxState=A);var te=w(N,_);if(te&&te.method==="AES-128"){var re=this.getDecrypter();if(j.enableSoftwareAES){var oe=re.softwareDecrypt(N,te.key.buffer,te.iv.buffer);if(!oe)return M.executeEnd=p(),D(x);N=new Uint8Array(oe)}else return this.decryptionPromise=re.webCryptoDecrypt(N,te.key.buffer,te.iv.buffer).then(function(Q){var B=k.push(Q,null,x);return k.decryptionPromise=null,B}),this.decryptionPromise}var se=A||z,me=se.contiguous,fe=se.discontinuity,ue=se.trackSwitch,ye=se.accurateTimeOffset,pe=se.timeOffset,de=J.audioCodec,ve=J.videoCodec,ne=J.defaultInitPts,we=J.duration,Ce=J.initSegmentData;if((fe||ue)&&this.resetInitSegment(Ce,de,ve,we),fe&&this.resetInitialTimestamp(ne),me||this.resetContiguity(),this.needsProbing(N,fe,ue)){if(U.dataLength){var ge=U.flush();N=Object(v.appendUint8Array)(ge,N)}this.configureTransmuxer(N,J)}var _e=this.transmux(N,te,pe,ye,x),Pe=this.currentTransmuxState;return Pe.contiguous=!0,Pe.discontinuity=!1,Pe.trackSwitch=!1,M.executeEnd=p(),_e},R.flush=function(O){var _=this,x=O.transmuxing;x.executeStart=p();var A=this.decrypter,k=this.cache,M=this.currentTransmuxState,N=this.decryptionPromise;if(N)return N.then(function(){return _.flush(O)});var U=[],j=M.timeOffset;if(A){var z=A.flush();z&&U.push(this.push(z,null,O))}var J=k.dataLength;k.reset();var te=this.demuxer,re=this.remuxer;if(!te||!re)return J>=d&&this.observer.emit(c.Events.ERROR,c.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),x.executeEnd=p(),[D(O)];var oe=te.flush(j);return b(oe)?oe.then(function(se){return _.flushRemux(U,se,O),U}):(this.flushRemux(U,oe,O),U)},R.flushRemux=function(O,_,x){var A=_.audioTrack,k=_.avcTrack,M=_.id3Track,N=_.textTrack,U=this.currentTransmuxState,j=U.accurateTimeOffset,z=U.timeOffset;y.logger.log("[transmuxer.ts]: Flushed fragment "+x.sn+(x.part>-1?" p: "+x.part:"")+" of level "+x.level);var J=this.remuxer.remux(A,k,M,N,z,j,!0,this.id);O.push({remuxResult:J,chunkMeta:x}),x.transmuxing.executeEnd=p()},R.resetInitialTimestamp=function(O){var _=this.demuxer,x=this.remuxer;!_||!x||(_.resetTimeStamp(O),x.resetTimeStamp(O))},R.resetContiguity=function(){var O=this.demuxer,_=this.remuxer;!O||!_||(O.resetContiguity(),_.resetNextTimestamp())},R.resetInitSegment=function(O,_,x,A){var k=this.demuxer,M=this.remuxer;!k||!M||(k.resetInitSegment(_,x,A),M.resetInitSegment(O,_,x))},R.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},R.transmux=function(O,_,x,A,k){var M;return _&&_.method==="SAMPLE-AES"?M=this.transmuxSampleAes(O,_,x,A,k):M=this.transmuxUnencrypted(O,x,A,k),M},R.transmuxUnencrypted=function(O,_,x,A){var k=this.demuxer.demux(O,_,!1,!this.config.progressive),M=k.audioTrack,N=k.avcTrack,U=k.id3Track,j=k.textTrack,z=this.remuxer.remux(M,N,U,j,_,x,!1,this.id);return{remuxResult:z,chunkMeta:A}},R.transmuxSampleAes=function(O,_,x,A,k){var M=this;return this.demuxer.demuxSampleAes(O,_,x).then(function(N){var U=M.remuxer.remux(N.audioTrack,N.avcTrack,N.id3Track,N.textTrack,x,A,!1,M.id);return{remuxResult:U,chunkMeta:k}})},R.configureTransmuxer=function(O,_){for(var x=this.config,A=this.observer,k=this.typeSupported,M=this.vendor,N=_.audioCodec,U=_.defaultInitPts,j=_.duration,z=_.initSegmentData,J=_.videoCodec,te,re=0,oe=g.length;re<oe;re++)if(g[re].demux.probe(O)){te=g[re];break}te||(y.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),te={demux:a.default,remux:f.default});var se=this.demuxer,me=this.remuxer,fe=te.remux,ue=te.demux;(!me||!(me instanceof fe))&&(this.remuxer=new fe(A,x,k,M)),(!se||!(se instanceof ue))&&(this.demuxer=new ue(A,x,k),this.probe=ue.probe),this.resetInitSegment(z,N,J,j),this.resetInitialTimestamp(U)},R.needsProbing=function(O,_,x){return!this.demuxer||!this.remuxer||_||x},R.getDecrypter=function(){var O=this.decrypter;return O||(O=this.decrypter=new e.default(this.observer,this.config)),O},P}();function w(P,R){var L=null;return P.byteLength>0&&R!=null&&R.key!=null&&R.iv!==null&&R.method!=null&&(L=R),L}var D=function(R){return{remuxResult:{},chunkMeta:R}};function b(P){return"then"in P&&P.then instanceof Function}var S=function(R,L,O,_,x){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=R,this.videoCodec=L,this.initSegmentData=O,this.duration=_,this.defaultInitPts=x},C=function(R,L,O,_,x){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=R,this.contiguous=L,this.accurateTimeOffset=O,this.trackSwitch=_,this.timeOffset=x}},"./src/demux/tsdemuxer.ts":function(G,m,r){r.r(m),r.d(m,"discardEPB",function(){return D});var c=r("./src/demux/adts.ts"),l=r("./src/demux/mpegaudio.ts"),e=r("./src/demux/exp-golomb.ts"),n=r("./src/demux/id3.ts"),a=r("./src/demux/sample-aes.ts"),s=r("./src/events.ts"),u=r("./src/utils/mp4-tools.ts"),t=r("./src/utils/logger.ts"),f=r("./src/errors.ts"),h={video:1,audio:2,id3:3,text:4},v=function(){function b(C,P,R){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=C,this.config=P,this.typeSupported=R}b.probe=function(P){var R=b.syncOffset(P);return R<0?!1:(R&&t.logger.warn("MPEG2-TS detected but first sync word found @ offset "+R+", junk ahead ?"),!0)},b.syncOffset=function(P){for(var R=Math.min(1e3,P.length-3*188),L=0;L<R;){if(P[L]===71&&P[L+188]===71&&P[L+2*188]===71)return L;L++}return-1},b.createTrack=function(P,R){return{container:P==="video"||P==="audio"?"video/mp2t":void 0,type:P,id:h[P],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:P==="audio"?R:void 0}};var S=b.prototype;return S.resetInitSegment=function(P,R,L){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=b.createTrack("video",L),this._audioTrack=b.createTrack("audio",L),this._id3Track=b.createTrack("id3",L),this._txtTrack=b.createTrack("text",L),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=P,this.videoCodec=R,this._duration=L},S.resetTimeStamp=function(){},S.resetContiguity=function(){var P=this._audioTrack,R=this._avcTrack,L=this._id3Track;P&&(P.pesData=null),R&&(R.pesData=null),L&&(L.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},S.demux=function(P,R,L,O){L===void 0&&(L=!1),O===void 0&&(O=!1),L||(this.sampleAes=null);var _,x=this._avcTrack,A=this._audioTrack,k=this._id3Track,M=x.pid,N=x.pesData,U=A.pid,j=k.pid,z=A.pesData,J=k.pesData,te=!1,re=this.pmtParsed,oe=this._pmtId,se=P.length;if(this.remainderData&&(P=Object(u.appendUint8Array)(this.remainderData,P),se=P.length,this.remainderData=null),se<188&&!O)return this.remainderData=P,{audioTrack:A,avcTrack:x,id3Track:k,textTrack:this._txtTrack};var me=Math.max(0,b.syncOffset(P));se-=(se+me)%188,se<P.byteLength&&!O&&(this.remainderData=new Uint8Array(P.buffer,se,P.buffer.byteLength-se));for(var fe=me;fe<se;fe+=188)if(P[fe]===71){var ue=!!(P[fe+1]&64),ye=((P[fe+1]&31)<<8)+P[fe+2],pe=(P[fe+3]&48)>>4,de=void 0;if(pe>1){if(de=fe+5+P[fe+4],de===fe+188)continue}else de=fe+4;switch(ye){case M:ue&&(N&&(_=d(N))&&this.parseAVCPES(_,!1),N={data:[],size:0}),N&&(N.data.push(P.subarray(de,fe+188)),N.size+=fe+188-de);break;case U:ue&&(z&&(_=d(z))&&(A.isAAC?this.parseAACPES(_):this.parseMPEGPES(_)),z={data:[],size:0}),z&&(z.data.push(P.subarray(de,fe+188)),z.size+=fe+188-de);break;case j:ue&&(J&&(_=d(J))&&this.parseID3PES(_),J={data:[],size:0}),J&&(J.data.push(P.subarray(de,fe+188)),J.size+=fe+188-de);break;case 0:ue&&(de+=P[de]+1),oe=this._pmtId=p(P,de);break;case oe:{ue&&(de+=P[de]+1);var ve=g(P,de,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,L);M=ve.avc,M>0&&(x.pid=M),U=ve.audio,U>0&&(A.pid=U,A.isAAC=ve.isAAC),j=ve.id3,j>0&&(k.pid=j),te&&!re&&(t.logger.log("reparse from beginning"),te=!1,fe=me-188),re=this.pmtParsed=!0;break}case 17:case 8191:break;default:te=!0;break}}else this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});x.pesData=N,A.pesData=z,k.pesData=J;var ne={audioTrack:A,avcTrack:x,id3Track:k,textTrack:this._txtTrack};return O&&this.extractRemainingSamples(ne),ne},S.flush=function(){var P=this.remainderData;this.remainderData=null;var R;return P?R=this.demux(P,-1,!1,!0):R={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(R),this.sampleAes?this.decrypt(R,this.sampleAes):R},S.extractRemainingSamples=function(P){var R=P.audioTrack,L=P.avcTrack,O=P.id3Track,_=L.pesData,x=R.pesData,A=O.pesData,k;_&&(k=d(_))?(this.parseAVCPES(k,!0),L.pesData=null):L.pesData=_,x&&(k=d(x))?(R.isAAC?this.parseAACPES(k):this.parseMPEGPES(k),R.pesData=null):(x!=null&&x.size&&t.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=x),A&&(k=d(A))?(this.parseID3PES(k),O.pesData=null):O.pesData=A},S.demuxSampleAes=function(P,R,L){var O=this.demux(P,L,!0,!this.config.progressive),_=this.sampleAes=new a.default(this.observer,this.config,R);return this.decrypt(O,_)},S.decrypt=function(P,R){return new Promise(function(L){var O=P.audioTrack,_=P.avcTrack;O.samples&&O.isAAC?R.decryptAacSamples(O.samples,0,function(){_.samples?R.decryptAvcSamples(_.samples,0,0,function(){L(P)}):L(P)}):_.samples&&R.decryptAvcSamples(_.samples,0,0,function(){L(P)})})},S.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},S.parseAVCPES=function(P,R){var L=this,O=this._avcTrack,_=this.parseAVCNALu(P.data),x=this.avcSample,A,k=!1;P.data=null,x&&_.length&&!O.audFound&&(E(x,O),x=this.avcSample=y(!1,P.pts,P.dts,"")),_.forEach(function(M){switch(M.type){case 1:{A=!0,x||(x=L.avcSample=y(!0,P.pts,P.dts,"")),x.frame=!0;var N=M.data;if(k&&N.length>4){var U=new e.default(N).readSliceType();(U===2||U===4||U===7||U===9)&&(x.key=!0)}break}case 5:A=!0,x||(x=L.avcSample=y(!0,P.pts,P.dts,"")),x.key=!0,x.frame=!0;break;case 6:{A=!0;var j=new e.default(D(M.data));j.readUByte();for(var z=0,J=0,te=!1,re=0;!te&&j.bytesAvailable>1;){z=0;do re=j.readUByte(),z+=re;while(re===255);J=0;do re=j.readUByte(),J+=re;while(re===255);if(z===4&&j.bytesAvailable!==0){te=!0;var oe=j.readUByte();if(oe===181){var se=j.readUShort();if(se===49){var me=j.readUInt();if(me===1195456820){var fe=j.readUByte();if(fe===3){for(var ue=j.readUByte(),ye=j.readUByte(),pe=31&ue,de=[ue,ye],ve=0;ve<pe;ve++)de.push(j.readUByte()),de.push(j.readUByte()),de.push(j.readUByte());w(L._txtTrack.samples,{type:3,pts:P.pts,bytes:de})}}}}}else if(z===5&&j.bytesAvailable!==0){if(te=!0,J>16){for(var ne=[],we=0;we<16;we++)ne.push(j.readUByte().toString(16)),(we===3||we===5||we===7||we===9)&&ne.push("-");for(var Ce=J-16,ge=new Uint8Array(Ce),_e=0;_e<Ce;_e++)ge[_e]=j.readUByte();w(L._txtTrack.samples,{pts:P.pts,payloadType:z,uuid:ne.join(""),userData:Object(n.utf8ArrayToStr)(ge),userDataBytes:ge})}}else if(J<j.bytesAvailable)for(var Pe=0;Pe<J;Pe++)j.readUByte()}break}case 7:if(A=!0,k=!0,!O.sps){var Q=new e.default(M.data),B=Q.readSPS();O.width=B.width,O.height=B.height,O.pixelRatio=B.pixelRatio,O.sps=[M.data],O.duration=L._duration;for(var W=M.data.subarray(1,4),Y="avc1.",$=0;$<3;$++){var ie=W[$].toString(16);ie.length<2&&(ie="0"+ie),Y+=ie}O.codec=Y}break;case 8:A=!0,O.pps||(O.pps=[M.data]);break;case 9:A=!1,O.audFound=!0,x&&E(x,O),x=L.avcSample=y(!1,P.pts,P.dts,"");break;case 12:A=!1;break;default:A=!1,x&&(x.debug+="unknown NAL "+M.type+" ");break}if(x&&A){var le=x.units;le.push(M)}}),R&&x&&(E(x,O),this.avcSample=null)},S.getLastNalUnit=function(){var P,R=this.avcSample,L;if(!R||R.units.length===0){var O=this._avcTrack.samples;R=O[O.length-1]}if((P=R)!==null&&P!==void 0&&P.units){var _=R.units;L=_[_.length-1]}return L},S.parseAVCNALu=function(P){var R=P.byteLength,L=this._avcTrack,O=L.naluState||0,_=O,x=[],A=0,k,M,N,U=-1,j=0;for(O===-1&&(U=0,j=P[0]&31,O=0,A=1);A<R;){if(k=P[A++],!O){O=k?0:1;continue}if(O===1){O=k?0:2;continue}if(!k)O=3;else if(k===1){if(U>=0){var z={data:P.subarray(U,A-O-1),type:j};x.push(z)}else{var J=this.getLastNalUnit();if(J&&(_&&A<=4-_&&J.state&&(J.data=J.data.subarray(0,J.data.byteLength-_)),M=A-O-1,M>0)){var te=new Uint8Array(J.data.byteLength+M);te.set(J.data,0),te.set(P.subarray(0,M),J.data.byteLength),J.data=te}}A<R?(N=P[A]&31,U=A,j=N,O=0):O=-1}else O=0}if(U>=0&&O>=0){var re={data:P.subarray(U,R),type:j,state:O};x.push(re)}if(x.length===0){var oe=this.getLastNalUnit();if(oe){var se=new Uint8Array(oe.data.byteLength+P.byteLength);se.set(oe.data,0),se.set(P,oe.data.byteLength),oe.data=se}}return L.naluState=O,x},S.parseAACPES=function(P){var R=0,L=this._audioTrack,O=this.aacOverFlow,_=P.data;if(O){this.aacOverFlow=null;var x=O.sample.unit.byteLength,A=Math.min(O.missing,x),k=x-A;O.sample.unit.set(_.subarray(0,A),k),L.samples.push(O.sample),R=O.missing}var M,N;for(M=R,N=_.length;M<N-1&&!c.isHeader(_,M);M++);if(M!==R){var U,j;if(M<N-1?(U="AAC PES did not start with ADTS header,offset:"+M,j=!1):(U="no ADTS header found in AAC PES",j=!0),t.logger.warn("parsing error:"+U),this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:j,reason:U}),j)return}c.initTrackConfig(L,this.observer,_,M,this.audioCodec);var z;if(P.pts!==void 0)z=P.pts;else if(O){var J=c.getFrameDuration(L.samplerate);z=O.sample.pts+J}else{t.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var te=0;M<N;)if(c.isHeader(_,M)){if(M+5<N){var re=c.appendFrame(L,_,M,z,te);if(re)if(re.missing)this.aacOverFlow=re;else{M+=re.length,te++;continue}}break}else M++},S.parseMPEGPES=function(P){var R=P.data,L=R.length,O=0,_=0,x=P.pts;if(x===void 0){t.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;_<L;)if(l.isHeader(R,_)){var A=l.appendFrame(this._audioTrack,R,_,x,O);if(A)_+=A.length,O++;else break}else _++},S.parseID3PES=function(P){if(P.pts===void 0){t.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(P)},b}();v.minProbeByteLength=188;function y(b,S,C,P){return{key:b,frame:!1,pts:S,dts:C,units:[],debug:P,length:0}}function p(b,S){return(b[S+10]&31)<<8|b[S+11]}function g(b,S,C,P){var R={audio:-1,avc:-1,id3:-1,isAAC:!0},L=(b[S+1]&15)<<8|b[S+2],O=S+3+L-4,_=(b[S+10]&15)<<8|b[S+11];for(S+=12+_;S<O;){var x=(b[S+1]&31)<<8|b[S+2];switch(b[S]){case 207:if(!P){t.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:R.audio===-1&&(R.audio=x);break;case 21:R.id3===-1&&(R.id3=x);break;case 219:if(!P){t.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:R.avc===-1&&(R.avc=x);break;case 3:case 4:C?R.audio===-1&&(R.audio=x,R.isAAC=!1):t.logger.log("MPEG audio found, not supported in this browser");break;case 36:t.logger.warn("Unsupported HEVC stream type found");break}S+=((b[S+3]&15)<<8|b[S+4])+5}return R}function d(b){var S=0,C,P,R,L,O,_=b.data;if(!b||b.size===0)return null;for(;_[0].length<19&&_.length>1;){var x=new Uint8Array(_[0].length+_[1].length);x.set(_[0]),x.set(_[1],_[0].length),_[0]=x,_.splice(1,1)}C=_[0];var A=(C[0]<<16)+(C[1]<<8)+C[2];if(A===1){if(P=(C[4]<<8)+C[5],P&&P>b.size-6)return null;var k=C[7];k&192&&(L=(C[9]&14)*536870912+(C[10]&255)*4194304+(C[11]&254)*16384+(C[12]&255)*128+(C[13]&254)/2,k&64?(O=(C[14]&14)*536870912+(C[15]&255)*4194304+(C[16]&254)*16384+(C[17]&255)*128+(C[18]&254)/2,L-O>60*9e4&&(t.logger.warn(Math.round((L-O)/9e4)+"s delta between PTS and DTS, align them"),L=O)):O=L),R=C[8];var M=R+9;if(b.size<=M)return null;b.size-=M;for(var N=new Uint8Array(b.size),U=0,j=_.length;U<j;U++){C=_[U];var z=C.byteLength;if(M)if(M>z){M-=z;continue}else C=C.subarray(M),z-=M,M=0;N.set(C,S),S+=z}return P&&(P-=R+3),{data:N,pts:L,dts:O,len:P}}return null}function E(b,S){if(b.units.length&&b.frame){if(b.pts===void 0){var C=S.samples,P=C.length;if(P){var R=C[P-1];b.pts=R.pts,b.dts=R.dts}else{S.dropped++;return}}S.samples.push(b)}b.debug.length&&t.logger.log(b.pts+"/"+b.dts+":"+b.debug)}function w(b,S){var C=b.length;if(C>0){if(S.pts>=b[C-1].pts)b.push(S);else for(var P=C-1;P>=0;P--)if(S.pts<b[P].pts){b.splice(P,0,S);break}}else b.push(S)}function D(b){for(var S=b.byteLength,C=[],P=1;P<S-2;)b[P]===0&&b[P+1]===0&&b[P+2]===3?(C.push(P+2),P+=2):P++;if(C.length===0)return b;var R=S-C.length,L=new Uint8Array(R),O=0;for(P=0;P<R;O++,P++)O===C[0]&&(O++,C.shift()),L[P]=b[O];return L}m.default=v},"./src/errors.ts":function(G,m,r){r.r(m),r.d(m,"ErrorTypes",function(){return c}),r.d(m,"ErrorDetails",function(){return l});var c;(function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"})(c||(c={}));var l;(function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown"})(l||(l={}))},"./src/events.ts":function(G,m,r){r.r(m),r.d(m,"Events",function(){return c});var c;(function(l){l.MEDIA_ATTACHING="hlsMediaAttaching",l.MEDIA_ATTACHED="hlsMediaAttached",l.MEDIA_DETACHING="hlsMediaDetaching",l.MEDIA_DETACHED="hlsMediaDetached",l.BUFFER_RESET="hlsBufferReset",l.BUFFER_CODECS="hlsBufferCodecs",l.BUFFER_CREATED="hlsBufferCreated",l.BUFFER_APPENDING="hlsBufferAppending",l.BUFFER_APPENDED="hlsBufferAppended",l.BUFFER_EOS="hlsBufferEos",l.BUFFER_FLUSHING="hlsBufferFlushing",l.BUFFER_FLUSHED="hlsBufferFlushed",l.MANIFEST_LOADING="hlsManifestLoading",l.MANIFEST_LOADED="hlsManifestLoaded",l.MANIFEST_PARSED="hlsManifestParsed",l.LEVEL_SWITCHING="hlsLevelSwitching",l.LEVEL_SWITCHED="hlsLevelSwitched",l.LEVEL_LOADING="hlsLevelLoading",l.LEVEL_LOADED="hlsLevelLoaded",l.LEVEL_UPDATED="hlsLevelUpdated",l.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",l.LEVELS_UPDATED="hlsLevelsUpdated",l.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",l.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",l.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",l.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",l.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",l.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",l.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",l.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",l.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",l.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",l.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",l.CUES_PARSED="hlsCuesParsed",l.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",l.INIT_PTS_FOUND="hlsInitPtsFound",l.FRAG_LOADING="hlsFragLoading",l.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",l.FRAG_LOADED="hlsFragLoaded",l.FRAG_DECRYPTED="hlsFragDecrypted",l.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",l.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",l.FRAG_PARSING_METADATA="hlsFragParsingMetadata",l.FRAG_PARSED="hlsFragParsed",l.FRAG_BUFFERED="hlsFragBuffered",l.FRAG_CHANGED="hlsFragChanged",l.FPS_DROP="hlsFpsDrop",l.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",l.ERROR="hlsError",l.DESTROYING="hlsDestroying",l.KEY_LOADING="hlsKeyLoading",l.KEY_LOADED="hlsKeyLoaded",l.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",l.BACK_BUFFER_REACHED="hlsBackBufferReached"})(c||(c={}))},"./src/hls.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return w});var c=r("./node_modules/url-toolkit/src/url-toolkit.js"),l=r("./src/loader/playlist-loader.ts"),e=r("./src/loader/key-loader.ts"),n=r("./src/controller/id3-track-controller.ts"),a=r("./src/controller/latency-controller.ts"),s=r("./src/controller/level-controller.ts"),u=r("./src/controller/fragment-tracker.ts"),t=r("./src/controller/stream-controller.ts"),f=r("./src/is-supported.ts"),h=r("./src/utils/logger.ts"),v=r("./src/config.ts"),y=r("./node_modules/eventemitter3/index.js"),p=r("./src/events.ts"),g=r("./src/errors.ts");function d(D,b){for(var S=0;S<b.length;S++){var C=b[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(D,C.key,C)}}function E(D,b,S){return b&&d(D.prototype,b),S&&d(D,S),D}var w=function(){D.isSupported=function(){return Object(f.isSupported)()};function D(S){S===void 0&&(S={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new y.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var C=this.config=Object(v.mergeConfig)(D.DefaultConfig,S);this.userConfig=S,Object(h.enableLogs)(C.debug),this._autoLevelCapping=-1,C.progressive&&Object(v.enableStreamingMode)(C);var P=C.abrController,R=C.bufferController,L=C.capLevelController,O=C.fpsController,_=this.abrController=new P(this),x=this.bufferController=new R(this),A=this.capLevelController=new L(this),k=new O(this),M=new l.default(this),N=new e.default(this),U=new n.default(this),j=this.levelController=new s.default(this),z=new u.FragmentTracker(this),J=this.streamController=new t.default(this,z);A.setStreamController(J),k.setStreamController(J);var te=[j,J];this.networkControllers=te;var re=[M,N,_,x,A,k,U,z];this.audioTrackController=this.createController(C.audioTrackController,null,te),this.createController(C.audioStreamController,z,te),this.subtitleTrackController=this.createController(C.subtitleTrackController,null,te),this.createController(C.subtitleStreamController,z,te),this.createController(C.timelineController,null,re),this.emeController=this.createController(C.emeController,null,re),this.cmcdController=this.createController(C.cmcdController,null,re),this.latencyController=this.createController(a.default,null,re),this.coreComponents=re}var b=D.prototype;return b.createController=function(C,P,R){if(C){var L=P?new C(this,P):new C(this);return R&&R.push(L),L}return null},b.on=function(C,P,R){R===void 0&&(R=this),this._emitter.on(C,P,R)},b.once=function(C,P,R){R===void 0&&(R=this),this._emitter.once(C,P,R)},b.removeAllListeners=function(C){this._emitter.removeAllListeners(C)},b.off=function(C,P,R,L){R===void 0&&(R=this),this._emitter.off(C,P,R,L)},b.listeners=function(C){return this._emitter.listeners(C)},b.emit=function(C,P,R){return this._emitter.emit(C,P,R)},b.trigger=function(C,P){if(this.config.debug)return this.emit(C,C,P);try{return this.emit(C,C,P)}catch(R){h.logger.error("An internal error happened while handling event "+C+'. Error message: "'+R.message+'". Here is a stacktrace:',R),this.trigger(p.Events.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:C,error:R})}return!1},b.listenerCount=function(C){return this._emitter.listenerCount(C)},b.destroy=function(){h.logger.log("destroy"),this.trigger(p.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(C){return C.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(C){return C.destroy()}),this.coreComponents.length=0},b.attachMedia=function(C){h.logger.log("attachMedia"),this._media=C,this.trigger(p.Events.MEDIA_ATTACHING,{media:C})},b.detachMedia=function(){h.logger.log("detachMedia"),this.trigger(p.Events.MEDIA_DETACHING,void 0),this._media=null},b.loadSource=function(C){this.stopLoad();var P=this.media,R=this.url,L=this.url=c.buildAbsoluteURL(self.location.href,C,{alwaysNormalize:!0});h.logger.log("loadSource:"+L),P&&R&&R!==L&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(P)),this.trigger(p.Events.MANIFEST_LOADING,{url:C})},b.startLoad=function(C){C===void 0&&(C=-1),h.logger.log("startLoad("+C+")"),this.networkControllers.forEach(function(P){P.startLoad(C)})},b.stopLoad=function(){h.logger.log("stopLoad"),this.networkControllers.forEach(function(C){C.stopLoad()})},b.swapAudioCodec=function(){h.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},b.recoverMediaError=function(){h.logger.log("recoverMediaError");var C=this._media;this.detachMedia(),C&&this.attachMedia(C)},b.removeLevel=function(C,P){P===void 0&&(P=0),this.levelController.removeLevel(C,P)},E(D,[{key:"levels",get:function(){var C=this.levelController.levels;return C||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(C){h.logger.log("set currentLevel:"+C),this.loadLevel=C,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(C){h.logger.log("set nextLevel:"+C),this.levelController.manualLevel=C,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(C){h.logger.log("set loadLevel:"+C),this.levelController.manualLevel=C}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(C){this.levelController.nextLoadLevel=C}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(C){h.logger.log("set firstLevel:"+C),this.levelController.firstLevel=C}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(C){h.logger.log("set startLevel:"+C),C!==-1&&(C=Math.max(C,this.minAutoLevel)),this.levelController.startLevel=C}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(C){var P=!!C;P!==this.config.capLevelToPlayerSize&&(P?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=P)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(C){this._autoLevelCapping!==C&&(h.logger.log("set autoLevelCapping:"+C),this._autoLevelCapping=C)}},{key:"bandwidthEstimate",get:function(){var C=this.abrController.bwEstimator;return C?C.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var C=this.levels,P=this.config.minAutoBitrate;if(!C)return 0;for(var R=C.length,L=0;L<R;L++)if(C[L].maxBitrate>P)return L;return 0}},{key:"maxAutoLevel",get:function(){var C=this.levels,P=this.autoLevelCapping,R;return P===-1&&C&&C.length?R=C.length-1:R=P,R}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(C){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,C)}},{key:"audioTracks",get:function(){var C=this.audioTrackController;return C?C.audioTracks:[]}},{key:"audioTrack",get:function(){var C=this.audioTrackController;return C?C.audioTrack:-1},set:function(C){var P=this.audioTrackController;P&&(P.audioTrack=C)}},{key:"subtitleTracks",get:function(){var C=this.subtitleTrackController;return C?C.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var C=this.subtitleTrackController;return C?C.subtitleTrack:-1},set:function(C){var P=this.subtitleTrackController;P&&(P.subtitleTrack=C)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var C=this.subtitleTrackController;return C?C.subtitleDisplay:!1},set:function(C){var P=this.subtitleTrackController;P&&(P.subtitleDisplay=C)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(C){this.config.lowLatencyMode=C}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.1"}},{key:"Events",get:function(){return p.Events}},{key:"ErrorTypes",get:function(){return g.ErrorTypes}},{key:"ErrorDetails",get:function(){return g.ErrorDetails}},{key:"DefaultConfig",get:function(){return D.defaultConfig?D.defaultConfig:v.hlsDefaultConfig},set:function(C){D.defaultConfig=C}}]),D}();w.defaultConfig=void 0},"./src/is-supported.ts":function(G,m,r){r.r(m),r.d(m,"isSupported",function(){return e}),r.d(m,"changeTypeSupported",function(){return n});var c=r("./src/utils/mediasource-helper.ts");function l(){return self.SourceBuffer||self.WebKitSourceBuffer}function e(){var a=Object(c.getMediaSource)();if(!a)return!1;var s=l(),u=a&&typeof a.isTypeSupported=="function"&&a.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),t=!s||s.prototype&&typeof s.prototype.appendBuffer=="function"&&typeof s.prototype.remove=="function";return!!u&&!!t}function n(){var a,s=l();return typeof(s==null||(a=s.prototype)===null||a===void 0?void 0:a.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return v}),r.d(m,"LoadError",function(){return p});var c=r("./src/polyfills/number.ts"),l=r("./src/errors.ts");function e(g,d){g.prototype=Object.create(d.prototype),g.prototype.constructor=g,t(g,d)}function n(g){var d=typeof Map=="function"?new Map:void 0;return n=function(w){if(w===null||!u(w))return w;if(typeof w!="function")throw new TypeError("Super expression must either be null or a function");if(typeof d!="undefined"){if(d.has(w))return d.get(w);d.set(w,D)}function D(){return a(w,arguments,f(this).constructor)}return D.prototype=Object.create(w.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),t(D,w)},n(g)}function a(g,d,E){return s()?a=Reflect.construct:a=function(D,b,S){var C=[null];C.push.apply(C,b);var P=Function.bind.apply(D,C),R=new P;return S&&t(R,S.prototype),R},a.apply(null,arguments)}function s(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function u(g){return Function.toString.call(g).indexOf("[native code]")!==-1}function t(g,d){return t=Object.setPrototypeOf||function(w,D){return w.__proto__=D,w},t(g,d)}function f(g){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)},f(g)}var h=Math.pow(2,17),v=function(){function g(E){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=E}var d=g.prototype;return d.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},d.abort=function(){this.loader&&this.loader.abort()},d.load=function(w,D){var b=this,S=w.url;if(!S)return Promise.reject(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:w,networkDetails:null},"Fragment does not have a "+(S?"part list":"url")));this.abort();var C=this.config,P=C.fLoader,R=C.loader;return new Promise(function(L,O){b.loader&&b.loader.destroy();var _=b.loader=w.loader=P?new P(C):new R(C),x=y(w),A={timeout:C.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:C.fragLoadingMaxRetryTimeout,highWaterMark:h};w.stats=_.stats,_.load(x,A,{onSuccess:function(M,N,U,j){b.resetLoader(w,_),L({frag:w,part:null,payload:M.data,networkDetails:j})},onError:function(M,N,U){b.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:w,response:M,networkDetails:U}))},onAbort:function(M,N,U){b.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:w,networkDetails:U}))},onTimeout:function(M,N,U){b.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:w,networkDetails:U}))},onProgress:function(M,N,U,j){D&&D({frag:w,part:null,payload:U,networkDetails:j})}})})},d.loadPart=function(w,D,b){var S=this;this.abort();var C=this.config,P=C.fLoader,R=C.loader;return new Promise(function(L,O){S.loader&&S.loader.destroy();var _=S.loader=w.loader=P?new P(C):new R(C),x=y(w,D),A={timeout:C.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:C.fragLoadingMaxRetryTimeout,highWaterMark:h};D.stats=_.stats,_.load(x,A,{onSuccess:function(M,N,U,j){S.resetLoader(w,_),S.updateStatsFromPart(w,D);var z={frag:w,part:D,payload:M.data,networkDetails:j};b(z),L(z)},onError:function(M,N,U){S.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:w,part:D,response:M,networkDetails:U}))},onAbort:function(M,N,U){w.stats.aborted=D.stats.aborted,S.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:w,part:D,networkDetails:U}))},onTimeout:function(M,N,U){S.resetLoader(w,_),O(new p({type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:w,part:D,networkDetails:U}))}})})},d.updateStatsFromPart=function(w,D){var b=w.stats,S=D.stats,C=S.total;if(b.loaded+=S.loaded,C){var P=Math.round(w.duration/D.duration),R=Math.min(Math.round(b.loaded/C),P),L=P-R,O=L*Math.round(b.loaded/R);b.total=b.loaded+O}else b.total=Math.max(b.loaded,b.total);var _=b.loading,x=S.loading;_.start?_.first+=x.first-x.start:(_.start=x.start,_.first=x.first),_.end=x.end},d.resetLoader=function(w,D){w.loader=null,this.loader===D&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),D.destroy()},g}();function y(g,d){d===void 0&&(d=null);var E=d||g,w={frag:g,part:d,responseType:"arraybuffer",url:E.url,headers:{},rangeStart:0,rangeEnd:0},D=E.byteRangeStartOffset,b=E.byteRangeEndOffset;return Object(c.isFiniteNumber)(D)&&Object(c.isFiniteNumber)(b)&&(w.rangeStart=D,w.rangeEnd=b),w}var p=function(g){e(d,g);function d(E){for(var w,D=arguments.length,b=new Array(D>1?D-1:0),S=1;S<D;S++)b[S-1]=arguments[S];return w=g.call.apply(g,[this].concat(b))||this,w.data=void 0,w.data=E,w}return d}(n(Error))},"./src/loader/fragment.ts":function(G,m,r){r.r(m),r.d(m,"ElementaryStreamTypes",function(){return h}),r.d(m,"BaseSegment",function(){return v}),r.d(m,"Fragment",function(){return y}),r.d(m,"Part",function(){return p});var c=r("./src/polyfills/number.ts"),l=r("./node_modules/url-toolkit/src/url-toolkit.js"),e=r("./src/utils/logger.ts"),n=r("./src/loader/level-key.ts"),a=r("./src/loader/load-stats.ts");function s(g,d){g.prototype=Object.create(d.prototype),g.prototype.constructor=g,u(g,d)}function u(g,d){return u=Object.setPrototypeOf||function(w,D){return w.__proto__=D,w},u(g,d)}function t(g,d){for(var E=0;E<d.length;E++){var w=d[E];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}function f(g,d,E){return d&&t(g.prototype,d),E&&t(g,E),g}var h;(function(g){g.AUDIO="audio",g.VIDEO="video",g.AUDIOVIDEO="audiovideo"})(h||(h={}));var v=function(){function g(E){var w;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(w={},w[h.AUDIO]=null,w[h.VIDEO]=null,w[h.AUDIOVIDEO]=null,w),this.baseurl=E}var d=g.prototype;return d.setByteRange=function(w,D){var b=w.split("@",2),S=[];b.length===1?S[0]=D?D.byteRangeEndOffset:0:S[0]=parseInt(b[1]),S[1]=parseInt(b[0])+S[0],this._byteRange=S},f(g,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(l.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(w){this._url=w}}]),g}(),y=function(g){s(d,g);function d(w,D){var b;return b=g.call(this,D)||this,b._decryptdata=null,b.rawProgramDateTime=null,b.programDateTime=null,b.tagList=[],b.duration=0,b.sn=0,b.levelkey=void 0,b.type=void 0,b.loader=null,b.level=-1,b.cc=0,b.startPTS=void 0,b.endPTS=void 0,b.appendedPTS=void 0,b.startDTS=void 0,b.endDTS=void 0,b.start=0,b.deltaPTS=void 0,b.maxStartPTS=void 0,b.minEndPTS=void 0,b.stats=new a.LoadStats,b.urlId=0,b.data=void 0,b.bitrateTest=!1,b.title=null,b.initSegment=null,b.type=w,b}var E=d.prototype;return E.createInitializationVector=function(D){for(var b=new Uint8Array(16),S=12;S<16;S++)b[S]=D>>8*(15-S)&255;return b},E.setDecryptDataFromLevelKey=function(D,b){var S=D;return(D==null?void 0:D.method)==="AES-128"&&D.uri&&!D.iv&&(S=n.LevelKey.fromURI(D.uri),S.method=D.method,S.iv=this.createInitializationVector(b),S.keyFormat="identity"),S},E.setElementaryStreamInfo=function(D,b,S,C,P,R){R===void 0&&(R=!1);var L=this.elementaryStreams,O=L[D];if(!O){L[D]={startPTS:b,endPTS:S,startDTS:C,endDTS:P,partial:R};return}O.startPTS=Math.min(O.startPTS,b),O.endPTS=Math.max(O.endPTS,S),O.startDTS=Math.min(O.startDTS,C),O.endDTS=Math.max(O.endDTS,P)},E.clearElementaryStreamInfo=function(){var D=this.elementaryStreams;D[h.AUDIO]=null,D[h.VIDEO]=null,D[h.AUDIOVIDEO]=null},f(d,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var D=this.sn;typeof D!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&e.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),D=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,D)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(c.isFiniteNumber)(this.programDateTime))return null;var D=Object(c.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+D*1e3}},{key:"encrypted",get:function(){var D;return!!((D=this.decryptdata)!==null&&D!==void 0&&D.keyFormat&&this.decryptdata.uri)}}]),d}(v),p=function(g){s(d,g);function d(E,w,D,b,S){var C;C=g.call(this,D)||this,C.fragOffset=0,C.duration=0,C.gap=!1,C.independent=!1,C.relurl=void 0,C.fragment=void 0,C.index=void 0,C.stats=new a.LoadStats,C.duration=E.decimalFloatingPoint("DURATION"),C.gap=E.bool("GAP"),C.independent=E.bool("INDEPENDENT"),C.relurl=E.enumeratedString("URI"),C.fragment=w,C.index=b;var P=E.enumeratedString("BYTERANGE");return P&&C.setByteRange(P,S),S&&(C.fragOffset=S.fragOffset+S.duration),C}return f(d,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var w=this.elementaryStreams;return!!(w.audio||w.video||w.audiovideo)}}]),d}(v)},"./src/loader/key-loader.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return n});var c=r("./src/events.ts"),l=r("./src/errors.ts"),e=r("./src/utils/logger.ts"),n=function(){function a(u){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=u,this._registerListeners()}var s=a.prototype;return s._registerListeners=function(){this.hls.on(c.Events.KEY_LOADING,this.onKeyLoading,this)},s._unregisterListeners=function(){this.hls.off(c.Events.KEY_LOADING,this.onKeyLoading)},s.destroy=function(){this._unregisterListeners();for(var t in this.loaders){var f=this.loaders[t];f&&f.destroy()}this.loaders={}},s.onKeyLoading=function(t,f){var h=f.frag,v=h.type,y=this.loaders[v];if(!h.decryptdata){e.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var p=h.decryptdata.uri;if(p!==this.decrypturl||this.decryptkey===null){var g=this.hls.config;if(y&&(e.logger.warn("abort previous key loader for type:"+v),y.abort()),!p){e.logger.warn("key uri is falsy");return}var d=g.loader,E=h.loader=this.loaders[v]=new d(g);this.decrypturl=p,this.decryptkey=null;var w={url:p,frag:h,responseType:"arraybuffer"},D={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:g.fragLoadingRetryDelay,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:0},b={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};E.load(w,D,b)}else this.decryptkey&&(h.decryptdata.key=this.decryptkey,this.hls.trigger(c.Events.KEY_LOADED,{frag:h}))},s.loadsuccess=function(t,f,h){var v=h.frag;if(!v.decryptdata){e.logger.error("after key load, decryptdata unset");return}this.decryptkey=v.decryptdata.key=new Uint8Array(t.data),v.loader=null,delete this.loaders[v.type],this.hls.trigger(c.Events.KEY_LOADED,{frag:v})},s.loaderror=function(t,f){var h=f.frag,v=h.loader;v&&v.abort(),delete this.loaders[h.type],this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:h,response:t})},s.loadtimeout=function(t,f){var h=f.frag,v=h.loader;v&&v.abort(),delete this.loaders[h.type],this.hls.trigger(c.Events.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:h})},a}()},"./src/loader/level-details.ts":function(G,m,r){r.r(m),r.d(m,"LevelDetails",function(){return a});var c=r("./src/polyfills/number.ts");function l(s,u){for(var t=0;t<u.length;t++){var f=u[t];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(s,f.key,f)}}function e(s,u,t){return u&&l(s.prototype,u),t&&l(s,t),s}var n=10,a=function(){function s(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=t}var u=s.prototype;return u.reloaded=function(f){if(!f){this.advanced=!0,this.updated=!0;return}var h=this.lastPartSn-f.lastPartSn,v=this.lastPartIndex-f.lastPartIndex;this.updated=this.endSN!==f.endSN||!!v||!!h,this.advanced=this.endSN>f.endSN||h>0||h===0&&v>0,this.updated||this.advanced?this.misses=Math.floor(f.misses*.6):this.misses=f.misses+1,this.availabilityDelay=f.availabilityDelay},e(s,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(c.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||n}},{key:"drift",get:function(){var f=this.driftEndTime-this.driftStartTime;if(f>0){var h=this.driftEnd-this.driftStart;return h*1e3/f}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var f;return(f=this.fragments)!==null&&f!==void 0&&f.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),s}()},"./src/loader/level-key.ts":function(G,m,r){r.r(m),r.d(m,"LevelKey",function(){return n});var c=r("./node_modules/url-toolkit/src/url-toolkit.js");function l(a,s){for(var u=0;u<s.length;u++){var t=s[u];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(a,t.key,t)}}function e(a,s,u){return s&&l(a.prototype,s),u&&l(a,u),a}var n=function(){a.fromURL=function(u,t){return new a(u,t)},a.fromURI=function(u){return new a(u)};function a(s,u){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,u?this._uri=Object(c.buildAbsoluteURL)(s,u,{alwaysNormalize:!0}):this._uri=s}return e(a,[{key:"uri",get:function(){return this._uri}}]),a}()},"./src/loader/load-stats.ts":function(G,m,r){r.r(m),r.d(m,"LoadStats",function(){return c});var c=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return d});var c=r("./src/polyfills/number.ts"),l=r("./node_modules/url-toolkit/src/url-toolkit.js"),e=r("./src/loader/fragment.ts"),n=r("./src/loader/level-details.ts"),a=r("./src/loader/level-key.ts"),s=r("./src/utils/attr-list.ts"),u=r("./src/utils/logger.ts"),t=r("./src/utils/codecs.ts"),f=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,h=/#EXT-X-MEDIA:(.*)/g,v=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),y=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),p=/\.(mp4|m4s|m4v|m4a)$/i;function g(S){var C,P;return p.test((C=(P=l.parseURL(S))===null||P===void 0?void 0:P.path)!=null?C:"")}var d=function(){function S(){}return S.findGroup=function(P,R){for(var L=0;L<P.length;L++){var O=P[L];if(O.id===R)return O}},S.convertAVC1ToAVCOTI=function(P){var R=P.split(".");if(R.length>2){var L=R.shift()+".";return L+=parseInt(R.shift()).toString(16),L+=("000"+parseInt(R.shift()).toString(16)).substr(-4),L}return P},S.resolve=function(P,R){return l.buildAbsoluteURL(R,P,{alwaysNormalize:!0})},S.parseMasterPlaylist=function(P,R){var L=[],O={},_=!1;f.lastIndex=0;for(var x;(x=f.exec(P))!=null;)if(x[1]){var A=new s.AttrList(x[1]),k={attrs:A,bitrate:A.decimalInteger("AVERAGE-BANDWIDTH")||A.decimalInteger("BANDWIDTH"),name:A.NAME,url:S.resolve(x[2],R)},M=A.decimalResolution("RESOLUTION");M&&(k.width=M.width,k.height=M.height),E((A.CODECS||"").split(/[ ,]+/).filter(function(U){return U}),k),k.videoCodec&&k.videoCodec.indexOf("avc1")!==-1&&(k.videoCodec=S.convertAVC1ToAVCOTI(k.videoCodec)),L.push(k)}else if(x[3]){var N=new s.AttrList(x[3]);N["DATA-ID"]&&(_=!0,O[N["DATA-ID"]]=N)}return{levels:L,sessionData:_?O:null}},S.parseMasterPlaylistMedia=function(P,R,L,O){O===void 0&&(O=[]);var _,x=[],A=0;for(h.lastIndex=0;(_=h.exec(P))!==null;){var k=new s.AttrList(_[1]);if(k.TYPE===L){var M={attrs:k,bitrate:0,id:A++,groupId:k["GROUP-ID"],instreamId:k["INSTREAM-ID"],name:k.NAME||k.LANGUAGE||"",type:L,default:k.bool("DEFAULT"),autoselect:k.bool("AUTOSELECT"),forced:k.bool("FORCED"),lang:k.LANGUAGE,url:k.URI?S.resolve(k.URI,R):""};if(O.length){var N=S.findGroup(O,M.groupId)||O[0];w(M,N,"audioCodec"),w(M,N,"textCodec")}x.push(M)}}return x},S.parseLevelPlaylist=function(P,R,L,O,_){var x=new n.LevelDetails(R),A=x.fragments,k=null,M=0,N=0,U=0,j=0,z=null,J=new e.Fragment(O,R),te,re,oe,se=-1,me=!1;for(v.lastIndex=0,x.m3u8=P;(te=v.exec(P))!==null;){me&&(me=!1,J=new e.Fragment(O,R),J.start=U,J.sn=M,J.cc=j,J.level=L,k&&(J.initSegment=k,J.rawProgramDateTime=k.rawProgramDateTime));var fe=te[1];if(fe){J.duration=parseFloat(fe);var ue=(" "+te[2]).slice(1);J.title=ue||null,J.tagList.push(ue?["INF",fe,ue]:["INF",fe])}else if(te[3])Object(c.isFiniteNumber)(J.duration)&&(J.start=U,oe&&(J.levelkey=oe),J.sn=M,J.level=L,J.cc=j,J.urlId=_,A.push(J),J.relurl=(" "+te[3]).slice(1),b(J,z),z=J,U+=J.duration,M++,N=0,me=!0);else if(te[4]){var ye=(" "+te[4]).slice(1);z?J.setByteRange(ye,z):J.setByteRange(ye)}else if(te[5])J.rawProgramDateTime=(" "+te[5]).slice(1),J.tagList.push(["PROGRAM-DATE-TIME",J.rawProgramDateTime]),se===-1&&(se=A.length);else{if(te=te[0].match(y),!te){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(re=1;re<te.length&&typeof te[re]=="undefined";re++);var pe=(" "+te[re]).slice(1),de=(" "+te[re+1]).slice(1),ve=te[re+2]?(" "+te[re+2]).slice(1):"";switch(pe){case"PLAYLIST-TYPE":x.type=de.toUpperCase();break;case"MEDIA-SEQUENCE":M=x.startSN=parseInt(de);break;case"SKIP":{var ne=new s.AttrList(de),we=ne.decimalInteger("SKIPPED-SEGMENTS");if(Object(c.isFiniteNumber)(we)){x.skippedSegments=we;for(var Ce=we;Ce--;)A.unshift(null);M+=we}var ge=ne.enumeratedString("RECENTLY-REMOVED-DATERANGES");ge&&(x.recentlyRemovedDateranges=ge.split("	"));break}case"TARGETDURATION":x.targetduration=parseFloat(de);break;case"VERSION":x.version=parseInt(de);break;case"EXTM3U":break;case"ENDLIST":x.live=!1;break;case"#":(de||ve)&&J.tagList.push(ve?[de,ve]:[de]);break;case"DIS":j++;case"GAP":J.tagList.push([pe]);break;case"BITRATE":J.tagList.push([pe,de]);break;case"DISCONTINUITY-SEQ":j=parseInt(de);break;case"KEY":{var _e,Pe=new s.AttrList(de),Q=Pe.enumeratedString("METHOD"),B=Pe.URI,W=Pe.hexadecimalInteger("IV"),Y=Pe.enumeratedString("KEYFORMATVERSIONS"),$=Pe.enumeratedString("KEYID"),ie=(_e=Pe.enumeratedString("KEYFORMAT"))!=null?_e:"identity",le=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(le.indexOf(ie)>-1){u.logger.warn("Keyformat "+ie+" is not supported from the manifest");continue}else if(ie!=="identity")continue;Q&&(oe=a.LevelKey.fromURL(R,B),B&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Q)>=0&&(oe.method=Q,oe.keyFormat=ie,$&&(oe.keyID=$),Y&&(oe.keyFormatVersions=Y),oe.iv=W));break}case"START":{var ce=new s.AttrList(de),xe=ce.decimalFloatingPoint("TIME-OFFSET");Object(c.isFiniteNumber)(xe)&&(x.startTimeOffset=xe);break}case"MAP":{var Oe=new s.AttrList(de);J.relurl=Oe.URI,Oe.BYTERANGE&&J.setByteRange(Oe.BYTERANGE),J.level=L,J.sn="initSegment",oe&&(J.levelkey=oe),J.initSegment=null,k=J,me=!0;break}case"SERVER-CONTROL":{var ke=new s.AttrList(de);x.canBlockReload=ke.bool("CAN-BLOCK-RELOAD"),x.canSkipUntil=ke.optionalFloat("CAN-SKIP-UNTIL",0),x.canSkipDateRanges=x.canSkipUntil>0&&ke.bool("CAN-SKIP-DATERANGES"),x.partHoldBack=ke.optionalFloat("PART-HOLD-BACK",0),x.holdBack=ke.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Ue=new s.AttrList(de);x.partTarget=Ue.decimalFloatingPoint("PART-TARGET");break}case"PART":{var Ne=x.partList;Ne||(Ne=x.partList=[]);var We=N>0?Ne[Ne.length-1]:void 0,Ke=N++,Qe=new e.Part(new s.AttrList(de),J,R,Ke,We);Ne.push(Qe),J.duration+=Qe.duration;break}case"PRELOAD-HINT":{var Ge=new s.AttrList(de);x.preloadHint=Ge;break}case"RENDITION-REPORT":{var qe=new s.AttrList(de);x.renditionReports=x.renditionReports||[],x.renditionReports.push(qe);break}default:u.logger.warn("line parsed but not handled: "+te);break}}}z&&!z.relurl?(A.pop(),U-=z.duration,x.partList&&(x.fragmentHint=z)):x.partList&&(b(J,z),J.cc=j,x.fragmentHint=J);var Ye=A.length,ze=A[0],$e=A[Ye-1];if(U+=x.skippedSegments*x.targetduration,U>0&&Ye&&$e){x.averagetargetduration=U/Ye;var je=$e.sn;x.endSN=je!=="initSegment"?je:0,ze&&(x.startCC=ze.cc,ze.initSegment||x.fragments.every(function(et){return et.relurl&&g(et.relurl)})&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),J=new e.Fragment(O,R),J.relurl=$e.relurl,J.level=L,J.sn="initSegment",ze.initSegment=J,x.needSidxRanges=!0))}else x.endSN=0,x.startCC=0;return x.fragmentHint&&(U+=x.fragmentHint.duration),x.totalduration=U,x.endCC=j,se>0&&D(A,se),x},S}();function E(S,C){["video","audio","text"].forEach(function(P){var R=S.filter(function(O){return Object(t.isCodecType)(O,P)});if(R.length){var L=R.filter(function(O){return O.lastIndexOf("avc1",0)===0||O.lastIndexOf("mp4a",0)===0});C[P+"Codec"]=L.length>0?L[0]:R[0],S=S.filter(function(O){return R.indexOf(O)===-1})}}),C.unknownCodecs=S}function w(S,C,P){var R=C[P];R&&(S[P]=R)}function D(S,C){for(var P=S[C],R=C;R--;){var L=S[R];if(!L)return;L.programDateTime=P.programDateTime-L.duration*1e3,P=L}}function b(S,C){S.rawProgramDateTime?S.programDateTime=Date.parse(S.rawProgramDateTime):C!=null&&C.programDateTime&&(S.programDateTime=C.endProgramDateTime),Object(c.isFiniteNumber)(S.programDateTime)||(S.programDateTime=null,S.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(G,m,r){r.r(m);var c=r("./src/polyfills/number.ts"),l=r("./src/events.ts"),e=r("./src/errors.ts"),n=r("./src/utils/logger.ts"),a=r("./src/utils/mp4-tools.ts"),s=r("./src/loader/m3u8-parser.ts"),u=r("./src/types/loader.ts"),t=r("./src/utils/attr-list.ts");function f(y){var p=y.type;switch(p){case u.PlaylistContextType.AUDIO_TRACK:return u.PlaylistLevelType.AUDIO;case u.PlaylistContextType.SUBTITLE_TRACK:return u.PlaylistLevelType.SUBTITLE;default:return u.PlaylistLevelType.MAIN}}function h(y,p){var g=y.url;return(g===void 0||g.indexOf("data:")===0)&&(g=p.url),g}var v=function(){function y(g){this.hls=void 0,this.loaders=Object.create(null),this.hls=g,this.registerListeners()}var p=y.prototype;return p.registerListeners=function(){var d=this.hls;d.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this),d.on(l.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),d.on(l.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},p.unregisterListeners=function(){var d=this.hls;d.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),d.off(l.Events.LEVEL_LOADING,this.onLevelLoading,this),d.off(l.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),d.off(l.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},p.createInternalLoader=function(d){var E=this.hls.config,w=E.pLoader,D=E.loader,b=w||D,S=new b(E);return d.loader=S,this.loaders[d.type]=S,S},p.getInternalLoader=function(d){return this.loaders[d.type]},p.resetInternalLoader=function(d){this.loaders[d]&&delete this.loaders[d]},p.destroyInternalLoaders=function(){for(var d in this.loaders){var E=this.loaders[d];E&&E.destroy(),this.resetInternalLoader(d)}},p.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},p.onManifestLoading=function(d,E){var w=E.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:u.PlaylistContextType.MANIFEST,url:w,deliveryDirectives:null})},p.onLevelLoading=function(d,E){var w=E.id,D=E.level,b=E.url,S=E.deliveryDirectives;this.load({id:w,groupId:null,level:D,responseType:"text",type:u.PlaylistContextType.LEVEL,url:b,deliveryDirectives:S})},p.onAudioTrackLoading=function(d,E){var w=E.id,D=E.groupId,b=E.url,S=E.deliveryDirectives;this.load({id:w,groupId:D,level:null,responseType:"text",type:u.PlaylistContextType.AUDIO_TRACK,url:b,deliveryDirectives:S})},p.onSubtitleTrackLoading=function(d,E){var w=E.id,D=E.groupId,b=E.url,S=E.deliveryDirectives;this.load({id:w,groupId:D,level:null,responseType:"text",type:u.PlaylistContextType.SUBTITLE_TRACK,url:b,deliveryDirectives:S})},p.load=function(d){var E,w=this.hls.config,D=this.getInternalLoader(d);if(D){var b=D.context;if(b&&b.url===d.url){n.logger.trace("[playlist-loader]: playlist request ongoing");return}n.logger.log("[playlist-loader]: aborting previous loader for type: "+d.type),D.abort()}var S,C,P,R;switch(d.type){case u.PlaylistContextType.MANIFEST:S=w.manifestLoadingMaxRetry,C=w.manifestLoadingTimeOut,P=w.manifestLoadingRetryDelay,R=w.manifestLoadingMaxRetryTimeout;break;case u.PlaylistContextType.LEVEL:case u.PlaylistContextType.AUDIO_TRACK:case u.PlaylistContextType.SUBTITLE_TRACK:S=0,C=w.levelLoadingTimeOut;break;default:S=w.levelLoadingMaxRetry,C=w.levelLoadingTimeOut,P=w.levelLoadingRetryDelay,R=w.levelLoadingMaxRetryTimeout;break}if(D=this.createInternalLoader(d),(E=d.deliveryDirectives)!==null&&E!==void 0&&E.part){var L;if(d.type===u.PlaylistContextType.LEVEL&&d.level!==null?L=this.hls.levels[d.level].details:d.type===u.PlaylistContextType.AUDIO_TRACK&&d.id!==null?L=this.hls.audioTracks[d.id].details:d.type===u.PlaylistContextType.SUBTITLE_TRACK&&d.id!==null&&(L=this.hls.subtitleTracks[d.id].details),L){var O=L.partTarget,_=L.targetduration;O&&_&&(C=Math.min(Math.max(O*3,_*.8)*1e3,C))}}var x={timeout:C,maxRetry:S,retryDelay:P,maxRetryDelay:R,highWaterMark:0},A={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};D.load(d,x,A)},p.loadsuccess=function(d,E,w,D){if(D===void 0&&(D=null),w.isSidxRequest){this.handleSidxRequest(d,w),this.handlePlaylistLoaded(d,E,w,D);return}this.resetInternalLoader(w.type);var b=d.data;if(b.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(d,w,"no EXTM3U delimiter",D);return}E.parsing.start=performance.now(),b.indexOf("#EXTINF:")>0||b.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(d,E,w,D):this.handleMasterPlaylist(d,E,w,D)},p.loaderror=function(d,E,w){w===void 0&&(w=null),this.handleNetworkError(E,w,!1,d)},p.loadtimeout=function(d,E,w){w===void 0&&(w=null),this.handleNetworkError(E,w,!0)},p.handleMasterPlaylist=function(d,E,w,D){var b=this.hls,S=d.data,C=h(d,w),P=s.default.parseMasterPlaylist(S,C),R=P.levels,L=P.sessionData;if(!R.length){this.handleManifestParsingError(d,w,"no level found in manifest",D);return}var O=R.map(function(N){return{id:N.attrs.AUDIO,audioCodec:N.audioCodec}}),_=R.map(function(N){return{id:N.attrs.SUBTITLES,textCodec:N.textCodec}}),x=s.default.parseMasterPlaylistMedia(S,C,"AUDIO",O),A=s.default.parseMasterPlaylistMedia(S,C,"SUBTITLES",_),k=s.default.parseMasterPlaylistMedia(S,C,"CLOSED-CAPTIONS");if(x.length){var M=x.some(function(N){return!N.url});!M&&R[0].audioCodec&&!R[0].attrs.AUDIO&&(n.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),x.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new t.AttrList({}),bitrate:0,url:""}))}b.trigger(l.Events.MANIFEST_LOADED,{levels:R,audioTracks:x,subtitles:A,captions:k,url:C,stats:E,networkDetails:D,sessionData:L})},p.handleTrackOrLevelPlaylist=function(d,E,w,D){var b=this.hls,S=w.id,C=w.level,P=w.type,R=h(d,w),L=Object(c.isFiniteNumber)(S)?S:0,O=Object(c.isFiniteNumber)(C)?C:L,_=f(w),x=s.default.parseLevelPlaylist(d.data,R,O,_,L);if(!x.fragments.length){b.trigger(l.Events.ERROR,{type:e.ErrorTypes.NETWORK_ERROR,details:e.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:R,reason:"no fragments found in level",level:typeof w.level=="number"?w.level:void 0});return}if(P===u.PlaylistContextType.MANIFEST){var A={attrs:new t.AttrList({}),bitrate:0,details:x,name:"",url:R};b.trigger(l.Events.MANIFEST_LOADED,{levels:[A],audioTracks:[],url:R,stats:E,networkDetails:D,sessionData:null})}if(E.parsing.end=performance.now(),x.needSidxRanges){var k,M=(k=x.fragments[0].initSegment)===null||k===void 0?void 0:k.url;this.load({url:M,isSidxRequest:!0,type:P,level:C,levelDetails:x,id:S,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}w.levelDetails=x,this.handlePlaylistLoaded(d,E,w,D)},p.handleSidxRequest=function(d,E){var w=Object(a.parseSegmentIndex)(new Uint8Array(d.data));if(!!w){var D=w.references,b=E.levelDetails;D.forEach(function(S,C){var P=S.info,R=b.fragments[C];R.byteRange.length===0&&R.setByteRange(String(1+P.end-P.start)+"@"+String(P.start)),R.initSegment&&R.initSegment.setByteRange(String(w.moovEndOffset)+"@0")})}},p.handleManifestParsingError=function(d,E,w,D){this.hls.trigger(l.Events.ERROR,{type:e.ErrorTypes.NETWORK_ERROR,details:e.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:E.type===u.PlaylistContextType.MANIFEST,url:d.url,reason:w,response:d,context:E,networkDetails:D})},p.handleNetworkError=function(d,E,w,D){w===void 0&&(w=!1),n.logger.warn("[playlist-loader]: A network "+(w?"timeout":"error")+" occurred while loading "+d.type+" level: "+d.level+" id: "+d.id+' group-id: "'+d.groupId+'"');var b=e.ErrorDetails.UNKNOWN,S=!1,C=this.getInternalLoader(d);switch(d.type){case u.PlaylistContextType.MANIFEST:b=w?e.ErrorDetails.MANIFEST_LOAD_TIMEOUT:e.ErrorDetails.MANIFEST_LOAD_ERROR,S=!0;break;case u.PlaylistContextType.LEVEL:b=w?e.ErrorDetails.LEVEL_LOAD_TIMEOUT:e.ErrorDetails.LEVEL_LOAD_ERROR,S=!1;break;case u.PlaylistContextType.AUDIO_TRACK:b=w?e.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:e.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,S=!1;break;case u.PlaylistContextType.SUBTITLE_TRACK:b=w?e.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:e.ErrorDetails.SUBTITLE_LOAD_ERROR,S=!1;break}C&&this.resetInternalLoader(d.type);var P={type:e.ErrorTypes.NETWORK_ERROR,details:b,fatal:S,url:d.url,loader:C,context:d,networkDetails:E};D&&(P.response=D),this.hls.trigger(l.Events.ERROR,P)},p.handlePlaylistLoaded=function(d,E,w,D){var b=w.type,S=w.level,C=w.id,P=w.groupId,R=w.loader,L=w.levelDetails,O=w.deliveryDirectives;if(!(L!=null&&L.targetduration)){this.handleManifestParsingError(d,w,"invalid target duration",D);return}if(!!R)switch(L.live&&(R.getCacheAge&&(L.ageHeader=R.getCacheAge()||0),(!R.getCacheAge||isNaN(L.ageHeader))&&(L.ageHeader=0)),b){case u.PlaylistContextType.MANIFEST:case u.PlaylistContextType.LEVEL:this.hls.trigger(l.Events.LEVEL_LOADED,{details:L,level:S||0,id:C||0,stats:E,networkDetails:D,deliveryDirectives:O});break;case u.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(l.Events.AUDIO_TRACK_LOADED,{details:L,id:C||0,groupId:P||"",stats:E,networkDetails:D,deliveryDirectives:O});break;case u.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(l.Events.SUBTITLE_TRACK_LOADED,{details:L,id:C||0,groupId:P||"",stats:E,networkDetails:D,deliveryDirectives:O});break}},y}();m.default=v},"./src/polyfills/number.ts":function(G,m,r){r.r(m),r.d(m,"isFiniteNumber",function(){return c}),r.d(m,"MAX_SAFE_INTEGER",function(){return l});var c=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},l=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(G,m,r){r.r(m);var c=function(){function l(){}return l.getSilentFrame=function(n,a){switch(n){case"mp4a.40.2":if(a===1)return new Uint8Array([0,200,0,128,35,128]);if(a===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(a===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(a===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(a===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(a===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(a===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(a===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},l}();m.default=c},"./src/remux/mp4-generator.ts":function(G,m,r){r.r(m);var c=Math.pow(2,32)-1,l=function(){function e(){}return e.init=function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var a;for(a in e.types)e.types.hasOwnProperty(a)&&(e.types[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);var s=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:s,audio:u};var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=f,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var h=new Uint8Array([105,115,111,109]),v=new Uint8Array([97,118,99,49]),y=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,h,y,h,v),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,t))},e.box=function(a){for(var s=8,u=arguments.length,t=new Array(u>1?u-1:0),f=1;f<u;f++)t[f-1]=arguments[f];for(var h=t.length,v=h;h--;)s+=t[h].byteLength;var y=new Uint8Array(s);for(y[0]=s>>24&255,y[1]=s>>16&255,y[2]=s>>8&255,y[3]=s&255,y.set(a,4),h=0,s=8;h<v;h++)y.set(t[h],s),s+=t[h].byteLength;return y},e.hdlr=function(a){return e.box(e.types.hdlr,e.HDLR_TYPES[a])},e.mdat=function(a){return e.box(e.types.mdat,a)},e.mdhd=function(a,s){s*=a;var u=Math.floor(s/(c+1)),t=Math.floor(s%(c+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,a&255,u>>24,u>>16&255,u>>8&255,u&255,t>>24,t>>16&255,t>>8&255,t&255,85,196,0,0]))},e.mdia=function(a){return e.box(e.types.mdia,e.mdhd(a.timescale,a.duration),e.hdlr(a.type),e.minf(a))},e.mfhd=function(a){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255]))},e.minf=function(a){return a.type==="audio"?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(a)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(a))},e.moof=function(a,s,u){return e.box(e.types.moof,e.mfhd(a),e.traf(u,s))},e.moov=function(a){for(var s=a.length,u=[];s--;)u[s]=e.trak(a[s]);return e.box.apply(null,[e.types.moov,e.mvhd(a[0].timescale,a[0].duration)].concat(u).concat(e.mvex(a)))},e.mvex=function(a){for(var s=a.length,u=[];s--;)u[s]=e.trex(a[s]);return e.box.apply(null,[e.types.mvex].concat(u))},e.mvhd=function(a,s){s*=a;var u=Math.floor(s/(c+1)),t=Math.floor(s%(c+1)),f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,a&255,u>>24,u>>16&255,u>>8&255,u&255,t>>24,t>>16&255,t>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,f)},e.sdtp=function(a){var s=a.samples||[],u=new Uint8Array(4+s.length),t,f;for(t=0;t<s.length;t++)f=s[t].flags,u[t+4]=f.dependsOn<<4|f.isDependedOn<<2|f.hasRedundancy;return e.box(e.types.sdtp,u)},e.stbl=function(a){return e.box(e.types.stbl,e.stsd(a),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(a){var s=[],u=[],t,f,h;for(t=0;t<a.sps.length;t++)f=a.sps[t],h=f.byteLength,s.push(h>>>8&255),s.push(h&255),s=s.concat(Array.prototype.slice.call(f));for(t=0;t<a.pps.length;t++)f=a.pps[t],h=f.byteLength,u.push(h>>>8&255),u.push(h&255),u=u.concat(Array.prototype.slice.call(f));var v=e.box(e.types.avcC,new Uint8Array([1,s[3],s[4],s[5],252|3,224|a.sps.length].concat(s).concat([a.pps.length]).concat(u))),y=a.width,p=a.height,g=a.pixelRatio[0],d=a.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,y>>8&255,y&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),v,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,d>>24,d>>16&255,d>>8&255,d&255])))},e.esds=function(a){var s=a.config.length;return new Uint8Array([0,0,0,0,3,23+s,0,1,0,4,15+s,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([s]).concat(a.config).concat([6,1,2]))},e.mp4a=function(a){var s=a.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,s>>8&255,s&255,0,0]),e.box(e.types.esds,e.esds(a)))},e.mp3=function(a){var s=a.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,s>>8&255,s&255,0,0]))},e.stsd=function(a){return a.type==="audio"?!a.isAAC&&a.codec==="mp3"?e.box(e.types.stsd,e.STSD,e.mp3(a)):e.box(e.types.stsd,e.STSD,e.mp4a(a)):e.box(e.types.stsd,e.STSD,e.avc1(a))},e.tkhd=function(a){var s=a.id,u=a.duration*a.timescale,t=a.width,f=a.height,h=Math.floor(u/(c+1)),v=Math.floor(u%(c+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,s>>24&255,s>>16&255,s>>8&255,s&255,0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255,v>>24,v>>16&255,v>>8&255,v&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,t>>8&255,t&255,0,0,f>>8&255,f&255,0,0]))},e.traf=function(a,s){var u=e.sdtp(a),t=a.id,f=Math.floor(s/(c+1)),h=Math.floor(s%(c+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,f>>24,f>>16&255,f>>8&255,f&255,h>>24,h>>16&255,h>>8&255,h&255])),e.trun(a,u.length+16+20+8+16+8+8),u)},e.trak=function(a){return a.duration=a.duration||4294967295,e.box(e.types.trak,e.tkhd(a),e.mdia(a))},e.trex=function(a){var s=a.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(a,s){var u=a.samples||[],t=u.length,f=12+16*t,h=new Uint8Array(f),v,y,p,g,d,E;for(s+=8+f,h.set([0,0,15,1,t>>>24&255,t>>>16&255,t>>>8&255,t&255,s>>>24&255,s>>>16&255,s>>>8&255,s&255],0),v=0;v<t;v++)y=u[v],p=y.duration,g=y.size,d=y.flags,E=y.cts,h.set([p>>>24&255,p>>>16&255,p>>>8&255,p&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&240<<8,d.degradPrio&15,E>>>24&255,E>>>16&255,E>>>8&255,E&255],12+16*v);return e.box(e.types.trun,h)},e.initSegment=function(a){e.types||e.init();var s=e.moov(a),u=new Uint8Array(e.FTYP.byteLength+s.byteLength);return u.set(e.FTYP),u.set(s,e.FTYP.byteLength),u},e}();l.types=void 0,l.HDLR_TYPES=void 0,l.STTS=void 0,l.STSC=void 0,l.STCO=void 0,l.STSZ=void 0,l.VMHD=void 0,l.SMHD=void 0,l.STSD=void 0,l.FTYP=void 0,l.DINF=void 0,m.default=l},"./src/remux/mp4-remuxer.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return E}),r.d(m,"normalizePts",function(){return w});var c=r("./src/polyfills/number.ts"),l=r("./src/remux/aac-helper.ts"),e=r("./src/remux/mp4-generator.ts"),n=r("./src/events.ts"),a=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),u=r("./src/types/loader.ts"),t=r("./src/utils/timescale-conversion.ts");function f(){return f=Object.assign||function(C){for(var P=1;P<arguments.length;P++){var R=arguments[P];for(var L in R)Object.prototype.hasOwnProperty.call(R,L)&&(C[L]=R[L])}return C},f.apply(this,arguments)}var h=10*1e3,v=1024,y=1152,p=null,g=null,d=!1,E=function(){function C(R,L,O,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=R,this.config=L,this.typeSupported=O,this.ISGenerated=!1,p===null){var x=navigator.userAgent||"",A=x.match(/Chrome\/(\d+)/i);p=A?parseInt(A[1]):0}if(g===null){var k=navigator.userAgent.match(/Safari\/(\d+)/i);g=k?parseInt(k[1]):0}d=!!p&&p<75||!!g&&g<600}var P=C.prototype;return P.destroy=function(){},P.resetTimeStamp=function(L){s.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=L},P.resetNextTimestamp=function(){s.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},P.resetInitSegment=function(){s.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},P.getVideoStartPts=function(L){var O=!1,_=L.reduce(function(x,A){var k=A.pts-x;return k<-4294967296?(O=!0,w(x,A.pts)):k>0?x:A.pts},L[0].pts);return O&&s.logger.debug("PTS rollover detected"),_},P.remux=function(L,O,_,x,A,k,M,N){var U,j,z,J,te,re,oe=A,se=A,me=L.pid>-1,fe=O.pid>-1,ue=O.samples.length,ye=L.samples.length>0,pe=ue>1,de=(!me||ye)&&(!fe||pe)||this.ISGenerated||M;if(de){this.ISGenerated||(z=this.generateIS(L,O,A));var ve=this.isVideoContiguous,ne=-1;if(pe&&(ne=D(O.samples),!ve&&this.config.forceKeyFrameOnDiscontinuity))if(re=!0,ne>0){s.logger.warn("[mp4-remuxer]: Dropped "+ne+" out of "+ue+" video samples due to a missing keyframe");var we=this.getVideoStartPts(O.samples);O.samples=O.samples.slice(ne),O.dropped+=ne,se+=(O.samples[0].pts-we)/(O.timescale||9e4)}else ne===-1&&(s.logger.warn("[mp4-remuxer]: No keyframe found out of "+ue+" video samples"),re=!1);if(this.ISGenerated){if(ye&&pe){var Ce=this.getVideoStartPts(O.samples),ge=w(L.samples[0].pts,Ce)-Ce,_e=ge/O.inputTimeScale;oe+=Math.max(0,_e),se+=Math.max(0,-_e)}if(ye){if(L.samplerate||(s.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),z=this.generateIS(L,O,A)),j=this.remuxAudio(L,oe,this.isAudioContiguous,k,fe||pe||N===u.PlaylistLevelType.AUDIO?se:void 0),pe){var Pe=j?j.endPTS-j.startPTS:0;O.inputTimeScale||(s.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),z=this.generateIS(L,O,A)),U=this.remuxVideo(O,se,ve,Pe)}}else pe&&(U=this.remuxVideo(O,se,ve,0));U&&(U.firstKeyFrame=ne,U.independent=ne!==-1)}}return this.ISGenerated&&(_.samples.length&&(te=this.remuxID3(_,A)),x.samples.length&&(J=this.remuxText(x,A))),{audio:j,video:U,initSegment:z,independent:re,text:J,id3:te}},P.generateIS=function(L,O,_){var x=L.samples,A=O.samples,k=this.typeSupported,M={},N=!Object(c.isFiniteNumber)(this._initPTS),U="audio/mp4",j,z,J;if(N&&(j=z=1/0),L.config&&x.length&&(L.timescale=L.samplerate,L.isAAC||(k.mpeg?(U="audio/mpeg",L.codec=""):k.mp3&&(L.codec="mp3")),M.audio={id:"audio",container:U,codec:L.codec,initSegment:!L.isAAC&&k.mpeg?new Uint8Array(0):e.default.initSegment([L]),metadata:{channelCount:L.channelCount}},N&&(J=L.inputTimeScale,j=z=x[0].pts-Math.round(J*_))),O.sps&&O.pps&&A.length&&(O.timescale=O.inputTimeScale,M.video={id:"main",container:"video/mp4",codec:O.codec,initSegment:e.default.initSegment([O]),metadata:{width:O.width,height:O.height}},N)){J=O.inputTimeScale;var te=this.getVideoStartPts(A),re=Math.round(J*_);z=Math.min(z,w(A[0].dts,te)-re),j=Math.min(j,te-re)}if(Object.keys(M).length)return this.ISGenerated=!0,N&&(this._initPTS=j,this._initDTS=z),{tracks:M,initPTS:j,timescale:J}},P.remuxVideo=function(L,O,_,x){var A=L.inputTimeScale,k=L.samples,M=[],N=k.length,U=this._initPTS,j=this.nextAvcDts,z=8,J,te,re,oe=Number.POSITIVE_INFINITY,se=Number.NEGATIVE_INFINITY,me=0,fe=!1;if(!_||j===null){var ue=O*A,ye=k[0].pts-w(k[0].dts,k[0].pts);j=ue-ye}for(var pe=0;pe<N;pe++){var de=k[pe];if(de.pts=w(de.pts-U,j),de.dts=w(de.dts-U,j),de.dts>de.pts){var ve=9e4*.2;me=Math.max(Math.min(me,de.pts-de.dts),-1*ve)}de.dts<k[pe>0?pe-1:pe].dts&&(fe=!0)}fe&&k.sort(function(lt,yt){var jt=lt.dts-yt.dts,xt=lt.pts-yt.pts;return jt||xt}),te=k[0].dts,re=k[k.length-1].dts;var ne=Math.round((re-te)/(N-1));if(me<0){if(me<ne*-2){s.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(t.toMsFromMpegTsClock)(-ne,!0)+" ms");for(var we=me,Ce=0;Ce<N;Ce++)k[Ce].dts=we=Math.max(we,k[Ce].pts-ne),k[Ce].pts=Math.max(we,k[Ce].pts)}else{s.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(t.toMsFromMpegTsClock)(me,!0)+" ms to overcome this issue");for(var ge=0;ge<N;ge++)k[ge].dts=k[ge].dts+me}te=k[0].dts}if(_){var _e=te-j,Pe=_e>ne,Q=_e<-1;if(Pe||Q){Pe?s.logger.warn("AVC: "+Object(t.toMsFromMpegTsClock)(_e,!0)+" ms ("+_e+"dts) hole between fragments detected, filling it"):s.logger.warn("AVC: "+Object(t.toMsFromMpegTsClock)(-_e,!0)+" ms ("+_e+"dts) overlapping between fragments detected"),te=j;var B=k[0].pts-_e;k[0].dts=te,k[0].pts=B,s.logger.log("Video: First PTS/DTS adjusted: "+Object(t.toMsFromMpegTsClock)(B,!0)+"/"+Object(t.toMsFromMpegTsClock)(te,!0)+", delta: "+Object(t.toMsFromMpegTsClock)(_e,!0)+" ms")}}d&&(te=Math.max(0,te));for(var W=0,Y=0,$=0;$<N;$++){for(var ie=k[$],le=ie.units,ce=le.length,xe=0,Oe=0;Oe<ce;Oe++)xe+=le[Oe].data.length;Y+=xe,W+=ce,ie.length=xe,ie.dts=Math.max(ie.dts,te),ie.pts=Math.max(ie.pts,ie.dts,0),oe=Math.min(ie.pts,oe),se=Math.max(ie.pts,se)}re=k[N-1].dts;var ke=Y+4*W+8,Ue;try{Ue=new Uint8Array(ke)}catch{this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MUX_ERROR,details:a.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ke,reason:"fail allocating video mdat "+ke});return}var Ne=new DataView(Ue.buffer);Ne.setUint32(0,ke),Ue.set(e.default.types.mdat,4);for(var We=0;We<N;We++){for(var Ke=k[We],Qe=Ke.units,Ge=0,qe=0,Ye=Qe.length;qe<Ye;qe++){var ze=Qe[qe],$e=ze.data,je=ze.data.byteLength;Ne.setUint32(z,je),z+=4,Ue.set($e,z),z+=je,Ge+=4+je}if(We<N-1)J=k[We+1].dts-Ke.dts;else{var et=this.config,tt=Ke.dts-k[We>0?We-1:We].dts;if(et.stretchShortVideoTrack&&this.nextAudioPts!==null){var at=Math.floor(et.maxBufferHole*A),st=(x?oe+x*A:this.nextAudioPts)-Ke.pts;st>at?(J=st-tt,J<0&&(J=tt),s.logger.log("[mp4-remuxer]: It is approximately "+st/90+" ms to the next segment; using duration "+J/90+" ms for the last video frame.")):J=tt}else J=tt}var Ze=Math.round(Ke.pts-Ke.dts);M.push(new b(Ke.key,J,Ge,Ze))}if(M.length&&p&&p<70){var nt=M[0].flags;nt.dependsOn=2,nt.isNonSync=0}console.assert(J!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=j=re+J,this.isVideoContiguous=!0;var Ve=e.default.moof(L.sequenceNumber++,te,f({},L,{samples:M})),Nt="video",Dt={data1:Ve,data2:Ue,startPTS:oe/A,endPTS:(se+J)/A,startDTS:te/A,endDTS:j/A,type:Nt,hasAudio:!1,hasVideo:!0,nb:M.length,dropped:L.dropped};return L.samples=[],L.dropped=0,console.assert(Ue.length,"MDAT length must not be zero"),Dt},P.remuxAudio=function(L,O,_,x,A){var k=L.inputTimeScale,M=L.samplerate?L.samplerate:k,N=k/M,U=L.isAAC?v:y,j=U*N,z=this._initPTS,J=!L.isAAC&&this.typeSupported.mpeg,te=[],re=L.samples,oe=J?0:8,se=this.nextAudioPts||-1,me=O*k;if(this.isAudioContiguous=_=_||re.length&&se>0&&(x&&Math.abs(me-se)<9e3||Math.abs(w(re[0].pts-z,me)-se)<20*j),re.forEach(function($e){$e.pts=w($e.pts-z,me)}),!_||se<0){if(re=re.filter(function($e){return $e.pts>=0}),!re.length)return;A===0?se=0:x?se=Math.max(0,me):se=re[0].pts}if(L.isAAC)for(var fe=A!==void 0,ue=this.config.maxAudioFramesDrift,ye=0,pe=se;ye<re.length;ye++){var de=re[ye],ve=de.pts,ne=ve-pe,we=Math.abs(1e3*ne/k);if(ne<=-ue*j&&fe)ye===0&&(s.logger.warn("Audio frame @ "+(ve/k).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*ne/k)+" ms."),this.nextAudioPts=se=pe=ve);else if(ne>=ue*j&&we<h&&fe){var Ce=Math.round(ne/j);pe=ve-Ce*j,pe<0&&(Ce--,pe+=j),ye===0&&(this.nextAudioPts=se=pe),s.logger.warn("[mp4-remuxer]: Injecting "+Ce+" audio frame @ "+(pe/k).toFixed(3)+"s due to "+Math.round(1e3*ne/k)+" ms gap.");for(var ge=0;ge<Ce;ge++){var _e=Math.max(pe,0),Pe=l.default.getSilentFrame(L.manifestCodec||L.codec,L.channelCount);Pe||(s.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Pe=de.unit.subarray()),re.splice(ye,0,{unit:Pe,pts:_e}),pe+=j,ye++}}de.pts=pe,pe+=j}for(var Q=null,B=null,W,Y=0,$=re.length;$--;)Y+=re[$].unit.byteLength;for(var ie=0,le=re.length;ie<le;ie++){var ce=re[ie],xe=ce.unit,Oe=ce.pts;if(B!==null){var ke=te[ie-1];ke.duration=Math.round((Oe-B)/N)}else if(_&&L.isAAC&&(Oe=se),Q=Oe,Y>0){Y+=oe;try{W=new Uint8Array(Y)}catch{this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MUX_ERROR,details:a.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Y,reason:"fail allocating audio mdat "+Y});return}if(!J){var Ue=new DataView(W.buffer);Ue.setUint32(0,Y),W.set(e.default.types.mdat,4)}}else return;W.set(xe,oe);var Ne=xe.byteLength;oe+=Ne,te.push(new b(!0,U,Ne,0)),B=Oe}var We=te.length;if(!!We){var Ke=te[te.length-1];this.nextAudioPts=se=B+N*Ke.duration;var Qe=J?new Uint8Array(0):e.default.moof(L.sequenceNumber++,Q/N,f({},L,{samples:te}));L.samples=[];var Ge=Q/k,qe=se/k,Ye="audio",ze={data1:Qe,data2:W,startPTS:Ge,endPTS:qe,startDTS:Ge,endDTS:qe,type:Ye,hasAudio:!0,hasVideo:!1,nb:We};return this.isAudioContiguous=!0,console.assert(W.length,"MDAT length must not be zero"),ze}},P.remuxEmptyAudio=function(L,O,_,x){var A=L.inputTimeScale,k=L.samplerate?L.samplerate:A,M=A/k,N=this.nextAudioPts,U=(N!==null?N:x.startDTS*A)+this._initDTS,j=x.endDTS*A+this._initDTS,z=M*v,J=Math.ceil((j-U)/z),te=l.default.getSilentFrame(L.manifestCodec||L.codec,L.channelCount);if(s.logger.warn("[mp4-remuxer]: remux empty Audio"),!te){s.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var re=[],oe=0;oe<J;oe++){var se=U+oe*z;re.push({unit:te,pts:se,dts:se})}return L.samples=re,this.remuxAudio(L,O,_,!1)},P.remuxID3=function(L,O){var _=L.samples.length;if(!!_){for(var x=L.inputTimeScale,A=this._initPTS,k=this._initDTS,M=0;M<_;M++){var N=L.samples[M];N.pts=w(N.pts-A,O*x)/x,N.dts=w(N.dts-k,O*x)/x}var U=L.samples;return L.samples=[],{samples:U}}},P.remuxText=function(L,O){var _=L.samples.length;if(!!_){for(var x=L.inputTimeScale,A=this._initPTS,k=0;k<_;k++){var M=L.samples[k];M.pts=w(M.pts-A,O*x)/x}L.samples.sort(function(U,j){return U.pts-j.pts});var N=L.samples;return L.samples=[],{samples:N}}},C}();function w(C,P){var R;if(P===null)return C;for(P<C?R=-8589934592:R=8589934592;Math.abs(C-P)>4294967296;)C+=R;return C}function D(C){for(var P=0;P<C.length;P++)if(C[P].key)return P;return-1}var b=function(P,R,L,O){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=R,this.size=L,this.cts=O,this.flags=new S(P)},S=function(P){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=P?2:1,this.isNonSync=P?0:1}},"./src/remux/passthrough-remuxer.ts":function(G,m,r){r.r(m);var c=r("./src/polyfills/number.ts"),l=r("./src/utils/mp4-tools.ts"),e=r("./src/loader/fragment.ts"),n=r("./src/utils/logger.ts"),a=function(){function t(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var f=t.prototype;return f.destroy=function(){},f.resetTimeStamp=function(v){this.initPTS=v,this.lastEndDTS=null},f.resetNextTimestamp=function(){this.lastEndDTS=null},f.resetInitSegment=function(v,y,p){this.audioCodec=y,this.videoCodec=p,this.generateInitSegment(v),this.emitInitSegment=!0},f.generateInitSegment=function(v){var y=this.audioCodec,p=this.videoCodec;if(!v||!v.byteLength){this.initTracks=void 0,this.initData=void 0;return}var g=this.initData=Object(l.parseInitSegment)(v);y||(y=u(g.audio,e.ElementaryStreamTypes.AUDIO)),p||(p=u(g.video,e.ElementaryStreamTypes.VIDEO));var d={};g.audio&&g.video?d.audiovideo={container:"video/mp4",codec:y+","+p,initSegment:v,id:"main"}:g.audio?d.audio={container:"audio/mp4",codec:y,initSegment:v,id:"audio"}:g.video?d.video={container:"video/mp4",codec:p,initSegment:v,id:"main"}:n.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=d},f.remux=function(v,y,p,g,d){var E=this.initPTS,w=this.lastEndDTS,D={audio:void 0,video:void 0,text:g,id3:p,initSegment:void 0};Object(c.isFiniteNumber)(w)||(w=this.lastEndDTS=d||0);var b=y.samples;if(!b||!b.length)return D;var S={initPTS:void 0,timescale:1},C=this.initData;if((!C||!C.length)&&(this.generateInitSegment(b),C=this.initData),!C||!C.length)return n.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),D;this.emitInitSegment&&(S.tracks=this.initTracks,this.emitInitSegment=!1),Object(c.isFiniteNumber)(E)||(this.initPTS=S.initPTS=E=s(C,b,w));var P=Object(l.getDuration)(b,C),R=w,L=P+R;Object(l.offsetStartDTS)(C,b,E),P>0?this.lastEndDTS=L:(n.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var O=!!C.audio,_=!!C.video,x="";O&&(x+="audio"),_&&(x+="video");var A={data1:b,startPTS:R,startDTS:R,endPTS:L,endDTS:L,type:x,hasAudio:O,hasVideo:_,nb:1,dropped:0};return D.audio=A.type==="audio"?A:void 0,D.video=A.type!=="audio"?A:void 0,D.text=g,D.id3=p,D.initSegment=S,D},t}(),s=function(f,h,v){return Object(l.getStartDTS)(f,h)-v};function u(t,f){var h=t==null?void 0:t.codec;return h&&h.length>4?h:h==="hvc1"?"hvc1.1.c.L120.90":h==="av01"?"av01.0.04M.08":h==="avc1"||f===e.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}m.default=a},"./src/task-loop.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return c});var c=function(){function l(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var e=l.prototype;return e.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},e.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},e.onHandlerDestroyed=function(){},e.hasInterval=function(){return!!this._tickInterval},e.hasNextTick=function(){return!!this._tickTimer},e.setInterval=function(a){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,a),!0)},e.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},e.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},e.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},e.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},e.doTick=function(){},l}()},"./src/types/cmcd.ts":function(G,m,r){r.r(m),r.d(m,"CMCDVersion",function(){return c}),r.d(m,"CMCDObjectType",function(){return l}),r.d(m,"CMCDStreamingFormat",function(){return e}),r.d(m,"CMCDStreamType",function(){return n});var c=1,l;(function(a){a.MANIFEST="m",a.AUDIO="a",a.VIDEO="v",a.MUXED="av",a.INIT="i",a.CAPTION="c",a.TIMED_TEXT="tt",a.KEY="k",a.OTHER="o"})(l||(l={}));var e;(function(a){a.DASH="d",a.HLS="h",a.SMOOTH="s",a.OTHER="o"})(e||(e={}));var n;(function(a){a.VOD="v",a.LIVE="l"})(n||(n={}))},"./src/types/level.ts":function(G,m,r){r.r(m),r.d(m,"HlsSkip",function(){return e}),r.d(m,"getSkipValue",function(){return n}),r.d(m,"HlsUrlParameters",function(){return a}),r.d(m,"Level",function(){return s});function c(u,t){for(var f=0;f<t.length;f++){var h=t[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(u,h.key,h)}}function l(u,t,f){return t&&c(u.prototype,t),f&&c(u,f),u}var e;(function(u){u.No="",u.Yes="YES",u.v2="v2"})(e||(e={}));function n(u,t){var f=u.canSkipUntil,h=u.canSkipDateRanges,v=u.endSN,y=t!==void 0?t-v:0;return f&&y<f?h?e.v2:e.Yes:e.No}var a=function(){function u(f,h,v){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=f,this.part=h,this.skip=v}var t=u.prototype;return t.addDirectives=function(h){var v=new self.URL(h);return this.msn!==void 0&&v.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&v.searchParams.set("_HLS_part",this.part.toString()),this.skip&&v.searchParams.set("_HLS_skip",this.skip),v.toString()},u}(),s=function(){function u(t){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[t.url],this.attrs=t.attrs,this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter(function(f){return f}).join(",").replace(/\.[^.,]+/g,"")}return l(u,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(f){var h=f%this.url.length;this._urlId!==h&&(this.details=void 0,this._urlId=h)}}]),u}()},"./src/types/loader.ts":function(G,m,r){r.r(m),r.d(m,"PlaylistContextType",function(){return c}),r.d(m,"PlaylistLevelType",function(){return l});var c;(function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"})(c||(c={}));var l;(function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"})(l||(l={}))},"./src/types/transmuxer.ts":function(G,m,r){r.r(m),r.d(m,"ChunkMetadata",function(){return c});var c=function(n,a,s,u,t,f){u===void 0&&(u=0),t===void 0&&(t=-1),f===void 0&&(f=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=l(),this.buffering={audio:l(),video:l(),audiovideo:l()},this.level=n,this.sn=a,this.id=s,this.size=u,this.part=t,this.partial=f};function l(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(G,m,r){r.r(m),r.d(m,"AttrList",function(){return e});var c=/^(\d+)x(\d+)$/,l=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,e=function(){function n(s){typeof s=="string"&&(s=n.parseAttrList(s));for(var u in s)s.hasOwnProperty(u)&&(this[u]=s[u])}var a=n.prototype;return a.decimalInteger=function(u){var t=parseInt(this[u],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},a.hexadecimalInteger=function(u){if(this[u]){var t=(this[u]||"0x").slice(2);t=(t.length&1?"0":"")+t;for(var f=new Uint8Array(t.length/2),h=0;h<t.length/2;h++)f[h]=parseInt(t.slice(h*2,h*2+2),16);return f}else return null},a.hexadecimalIntegerAsNumber=function(u){var t=parseInt(this[u],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},a.decimalFloatingPoint=function(u){return parseFloat(this[u])},a.optionalFloat=function(u,t){var f=this[u];return f?parseFloat(f):t},a.enumeratedString=function(u){return this[u]},a.bool=function(u){return this[u]==="YES"},a.decimalResolution=function(u){var t=c.exec(this[u]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},n.parseAttrList=function(u){var t,f={},h='"';for(l.lastIndex=0;(t=l.exec(u))!==null;){var v=t[2];v.indexOf(h)===0&&v.lastIndexOf(h)===v.length-1&&(v=v.slice(1,-1)),f[t[1]]=v}return f},n}()},"./src/utils/binary-search.ts":function(G,m,r){r.r(m);var c={search:function(e,n){for(var a=0,s=e.length-1,u=null,t=null;a<=s;){u=(a+s)/2|0,t=e[u];var f=n(t);if(f>0)a=u+1;else if(f<0)s=u-1;else return t}return null}};m.default=c},"./src/utils/buffer-helper.ts":function(G,m,r){r.r(m),r.d(m,"BufferHelper",function(){return e});var c=r("./src/utils/logger.ts"),l={length:0,start:function(){return 0},end:function(){return 0}},e=function(){function n(){}return n.isBuffered=function(s,u){try{if(s){for(var t=n.getBuffered(s),f=0;f<t.length;f++)if(u>=t.start(f)&&u<=t.end(f))return!0}}catch{}return!1},n.bufferInfo=function(s,u,t){try{if(s){var f=n.getBuffered(s),h=[],v;for(v=0;v<f.length;v++)h.push({start:f.start(v),end:f.end(v)});return this.bufferedInfo(h,u,t)}}catch{}return{len:0,start:u,end:u,nextStart:void 0}},n.bufferedInfo=function(s,u,t){u=Math.max(0,u),s.sort(function(S,C){var P=S.start-C.start;return P||C.end-S.end});var f=[];if(t)for(var h=0;h<s.length;h++){var v=f.length;if(v){var y=f[v-1].end;s[h].start-y<t?s[h].end>y&&(f[v-1].end=s[h].end):f.push(s[h])}else f.push(s[h])}else f=s;for(var p=0,g,d=u,E=u,w=0;w<f.length;w++){var D=f[w].start,b=f[w].end;if(u+t>=D&&u<b)d=D,E=b,p=E-u;else if(u+t<D){g=D;break}}return{len:p,start:d||0,end:E||0,nextStart:g}},n.getBuffered=function(s){try{return s.buffered}catch(u){return c.logger.log("failed to get media.buffered",u),l}},n}()},"./src/utils/cea-608-parser.ts":function(G,m,r){r.r(m),r.d(m,"Row",function(){return E}),r.d(m,"CaptionScreen",function(){return w});var c=r("./src/utils/logger.ts"),l={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},e=function(L){var O=L;return l.hasOwnProperty(L)&&(O=l[L]),String.fromCharCode(O)},n=15,a=100,s={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},t={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],v;(function(R){R[R.ERROR=0]="ERROR",R[R.TEXT=1]="TEXT",R[R.WARNING=2]="WARNING",R[R.INFO=2]="INFO",R[R.DEBUG=3]="DEBUG",R[R.DATA=3]="DATA"})(v||(v={}));var y=function(){function R(){this.time=null,this.verboseLevel=v.ERROR}var L=R.prototype;return L.log=function(_,x){this.verboseLevel>=_&&c.logger.log(this.time+" ["+_+"] "+x)},R}(),p=function(L){for(var O=[],_=0;_<L.length;_++)O.push(L[_].toString(16));return O},g=function(){function R(O,_,x,A,k){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=O||"white",this.underline=_||!1,this.italics=x||!1,this.background=A||"black",this.flash=k||!1}var L=R.prototype;return L.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},L.setStyles=function(_){for(var x=["foreground","underline","italics","background","flash"],A=0;A<x.length;A++){var k=x[A];_.hasOwnProperty(k)&&(this[k]=_[k])}},L.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},L.equals=function(_){return this.foreground===_.foreground&&this.underline===_.underline&&this.italics===_.italics&&this.background===_.background&&this.flash===_.flash},L.copy=function(_){this.foreground=_.foreground,this.underline=_.underline,this.italics=_.italics,this.background=_.background,this.flash=_.flash},L.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},R}(),d=function(){function R(O,_,x,A,k,M){this.uchar=void 0,this.penState=void 0,this.uchar=O||" ",this.penState=new g(_,x,A,k,M)}var L=R.prototype;return L.reset=function(){this.uchar=" ",this.penState.reset()},L.setChar=function(_,x){this.uchar=_,this.penState.copy(x)},L.setPenState=function(_){this.penState.copy(_)},L.equals=function(_){return this.uchar===_.uchar&&this.penState.equals(_.penState)},L.copy=function(_){this.uchar=_.uchar,this.penState.copy(_.penState)},L.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},R}(),E=function(){function R(O){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var _=0;_<a;_++)this.chars.push(new d);this.logger=O,this.pos=0,this.currPenState=new g}var L=R.prototype;return L.equals=function(_){for(var x=!0,A=0;A<a;A++)if(!this.chars[A].equals(_.chars[A])){x=!1;break}return x},L.copy=function(_){for(var x=0;x<a;x++)this.chars[x].copy(_.chars[x])},L.isEmpty=function(){for(var _=!0,x=0;x<a;x++)if(!this.chars[x].isEmpty()){_=!1;break}return _},L.setCursor=function(_){this.pos!==_&&(this.pos=_),this.pos<0?(this.logger.log(v.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>a&&(this.logger.log(v.DEBUG,"Too large cursor position "+this.pos),this.pos=a)},L.moveCursor=function(_){var x=this.pos+_;if(_>1)for(var A=this.pos+1;A<x+1;A++)this.chars[A].setPenState(this.currPenState);this.setCursor(x)},L.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},L.insertChar=function(_){_>=144&&this.backSpace();var x=e(_);if(this.pos>=a){this.logger.log(v.ERROR,"Cannot insert "+_.toString(16)+" ("+x+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(x,this.currPenState),this.moveCursor(1)},L.clearFromPos=function(_){var x;for(x=_;x<a;x++)this.chars[x].reset()},L.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},L.clearToEndOfRow=function(){this.clearFromPos(this.pos)},L.getTextString=function(){for(var _=[],x=!0,A=0;A<a;A++){var k=this.chars[A].uchar;k!==" "&&(x=!1),_.push(k)}return x?"":_.join("")},L.setPenStyles=function(_){this.currPenState.setStyles(_);var x=this.chars[this.pos];x.setPenState(this.currPenState)},R}(),w=function(){function R(O){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var _=0;_<n;_++)this.rows.push(new E(O));this.logger=O,this.currRow=n-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var L=R.prototype;return L.reset=function(){for(var _=0;_<n;_++)this.rows[_].clear();this.currRow=n-1},L.equals=function(_){for(var x=!0,A=0;A<n;A++)if(!this.rows[A].equals(_.rows[A])){x=!1;break}return x},L.copy=function(_){for(var x=0;x<n;x++)this.rows[x].copy(_.rows[x])},L.isEmpty=function(){for(var _=!0,x=0;x<n;x++)if(!this.rows[x].isEmpty()){_=!1;break}return _},L.backSpace=function(){var _=this.rows[this.currRow];_.backSpace()},L.clearToEndOfRow=function(){var _=this.rows[this.currRow];_.clearToEndOfRow()},L.insertChar=function(_){var x=this.rows[this.currRow];x.insertChar(_)},L.setPen=function(_){var x=this.rows[this.currRow];x.setPenStyles(_)},L.moveCursor=function(_){var x=this.rows[this.currRow];x.moveCursor(_)},L.setCursor=function(_){this.logger.log(v.INFO,"setCursor: "+_);var x=this.rows[this.currRow];x.setCursor(_)},L.setPAC=function(_){this.logger.log(v.INFO,"pacData = "+JSON.stringify(_));var x=_.row-1;if(this.nrRollUpRows&&x<this.nrRollUpRows-1&&(x=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==x){for(var A=0;A<n;A++)this.rows[A].clear();var k=this.currRow+1-this.nrRollUpRows,M=this.lastOutputScreen;if(M){var N=M.rows[k].cueStartTime,U=this.logger.time;if(N&&U!==null&&N<U)for(var j=0;j<this.nrRollUpRows;j++)this.rows[x-this.nrRollUpRows+j+1].copy(M.rows[k+j])}}this.currRow=x;var z=this.rows[this.currRow];if(_.indent!==null){var J=_.indent,te=Math.max(J-1,0);z.setCursor(_.indent),_.color=z.chars[te].penState.foreground}var re={foreground:_.color,underline:_.underline,italics:_.italics,background:"black",flash:!1};this.setPen(re)},L.setBkgData=function(_){this.logger.log(v.INFO,"bkgData = "+JSON.stringify(_)),this.backSpace(),this.setPen(_),this.insertChar(32)},L.setRollUpRows=function(_){this.nrRollUpRows=_},L.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(v.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(v.TEXT,this.getDisplayText());var _=this.currRow+1-this.nrRollUpRows,x=this.rows.splice(_,1)[0];x.clear(),this.rows.splice(this.currRow,0,x),this.logger.log(v.INFO,"Rolling up")},L.getDisplayText=function(_){_=_||!1;for(var x=[],A="",k=-1,M=0;M<n;M++){var N=this.rows[M].getTextString();N&&(k=M+1,_?x.push("Row "+k+": '"+N+"'"):x.push(N.trim()))}return x.length>0&&(_?A="["+x.join(" | ")+"]":A=x.join(`
`)),A},L.getTextAndFormat=function(){return this.rows},R}(),D=function(){function R(O,_,x){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=O,this.outputFilter=_,this.mode=null,this.verbose=0,this.displayedMemory=new w(x),this.nonDisplayedMemory=new w(x),this.lastOutputScreen=new w(x),this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=x}var L=R.prototype;return L.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},L.getHandler=function(){return this.outputFilter},L.setHandler=function(_){this.outputFilter=_},L.setPAC=function(_){this.writeScreen.setPAC(_)},L.setBkgData=function(_){this.writeScreen.setBkgData(_)},L.setMode=function(_){_!==this.mode&&(this.mode=_,this.logger.log(v.INFO,"MODE="+_),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=_)},L.insertChars=function(_){for(var x=0;x<_.length;x++)this.writeScreen.insertChar(_[x]);var A=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(v.INFO,A+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(v.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},L.ccRCL=function(){this.logger.log(v.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},L.ccBS=function(){this.logger.log(v.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},L.ccAOF=function(){},L.ccAON=function(){},L.ccDER=function(){this.logger.log(v.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},L.ccRU=function(_){this.logger.log(v.INFO,"RU("+_+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(_)},L.ccFON=function(){this.logger.log(v.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},L.ccRDC=function(){this.logger.log(v.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},L.ccTR=function(){this.logger.log(v.INFO,"TR"),this.setMode("MODE_TEXT")},L.ccRTD=function(){this.logger.log(v.INFO,"RTD"),this.setMode("MODE_TEXT")},L.ccEDM=function(){this.logger.log(v.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},L.ccCR=function(){this.logger.log(v.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},L.ccENM=function(){this.logger.log(v.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},L.ccEOC=function(){if(this.logger.log(v.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var _=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=_,this.writeScreen=this.nonDisplayedMemory,this.logger.log(v.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},L.ccTO=function(_){this.logger.log(v.INFO,"TO("+_+") - Tab Offset"),this.writeScreen.moveCursor(_)},L.ccMIDROW=function(_){var x={flash:!1};if(x.underline=_%2==1,x.italics=_>=46,x.italics)x.foreground="white";else{var A=Math.floor(_/2)-16,k=["white","green","blue","cyan","red","yellow","magenta"];x.foreground=k[A]}this.logger.log(v.INFO,"MIDROW: "+JSON.stringify(x)),this.writeScreen.setPen(x)},L.outputDataUpdate=function(_){_===void 0&&(_=!1);var x=this.logger.time;x!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=x:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,x,this.lastOutputScreen),_&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:x),this.lastOutputScreen.copy(this.displayedMemory))},L.cueSplitAtTime=function(_){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,_,this.displayedMemory),this.cueStartTime=_))},R}(),b=function(){function R(O,_,x){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var A=new y;this.channels=[null,new D(O,_,A),new D(O+1,x,A)],this.cmdHistory=P(),this.logger=A}var L=R.prototype;return L.getHandler=function(_){return this.channels[_].getHandler()},L.setHandler=function(_,x){this.channels[_].setHandler(x)},L.addData=function(_,x){var A,k,M,N=!1;this.logger.time=_;for(var U=0;U<x.length;U+=2)if(k=x[U]&127,M=x[U+1]&127,!(k===0&&M===0)){if(this.logger.log(v.DATA,"["+p([x[U],x[U+1]])+"] -> ("+p([k,M])+")"),A=this.parseCmd(k,M),A||(A=this.parseMidrow(k,M)),A||(A=this.parsePAC(k,M)),A||(A=this.parseBackgroundAttributes(k,M)),!A&&(N=this.parseChars(k,M),N)){var j=this.currentChannel;if(j&&j>0){var z=this.channels[j];z.insertChars(N)}else this.logger.log(v.WARNING,"No channel found yet. TEXT-MODE?")}!A&&!N&&this.logger.log(v.WARNING,"Couldn't parse cleaned data "+p([k,M])+" orig: "+p([x[U],x[U+1]]))}},L.parseCmd=function(_,x){var A=this.cmdHistory,k=(_===20||_===28||_===21||_===29)&&x>=32&&x<=47,M=(_===23||_===31)&&x>=33&&x<=35;if(!(k||M))return!1;if(C(_,x,A))return S(null,null,A),this.logger.log(v.DEBUG,"Repeated command ("+p([_,x])+") is dropped"),!0;var N=_===20||_===21||_===23?1:2,U=this.channels[N];return _===20||_===21||_===28||_===29?x===32?U.ccRCL():x===33?U.ccBS():x===34?U.ccAOF():x===35?U.ccAON():x===36?U.ccDER():x===37?U.ccRU(2):x===38?U.ccRU(3):x===39?U.ccRU(4):x===40?U.ccFON():x===41?U.ccRDC():x===42?U.ccTR():x===43?U.ccRTD():x===44?U.ccEDM():x===45?U.ccCR():x===46?U.ccENM():x===47&&U.ccEOC():U.ccTO(x-32),S(_,x,A),this.currentChannel=N,!0},L.parseMidrow=function(_,x){var A=0;if((_===17||_===25)&&x>=32&&x<=47){if(_===17?A=1:A=2,A!==this.currentChannel)return this.logger.log(v.ERROR,"Mismatch channel in midrow parsing"),!1;var k=this.channels[A];return k?(k.ccMIDROW(x),this.logger.log(v.DEBUG,"MIDROW ("+p([_,x])+")"),!0):!1}return!1},L.parsePAC=function(_,x){var A,k=this.cmdHistory,M=(_>=17&&_<=23||_>=25&&_<=31)&&x>=64&&x<=127,N=(_===16||_===24)&&x>=64&&x<=95;if(!(M||N))return!1;if(C(_,x,k))return S(null,null,k),!0;var U=_<=23?1:2;x>=64&&x<=95?A=U===1?s[_]:t[_]:A=U===1?u[_]:f[_];var j=this.channels[U];return j?(j.setPAC(this.interpretPAC(A,x)),S(_,x,k),this.currentChannel=U,!0):!1},L.interpretPAC=function(_,x){var A,k={color:null,italics:!1,indent:null,underline:!1,row:_};return x>95?A=x-96:A=x-64,k.underline=(A&1)==1,A<=13?k.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(A/2)]:A<=15?(k.italics=!0,k.color="white"):k.indent=Math.floor((A-16)/2)*4,k},L.parseChars=function(_,x){var A,k=null,M=null;if(_>=25?(A=2,M=_-8):(A=1,M=_),M>=17&&M<=19){var N;M===17?N=x+80:M===18?N=x+112:N=x+144,this.logger.log(v.INFO,"Special char '"+e(N)+"' in channel "+A),k=[N]}else _>=32&&_<=127&&(k=x===0?[_]:[_,x]);if(k){var U=p(k);this.logger.log(v.DEBUG,"Char codes =  "+U.join(",")),S(_,x,this.cmdHistory)}return k},L.parseBackgroundAttributes=function(_,x){var A=(_===16||_===24)&&x>=32&&x<=47,k=(_===23||_===31)&&x>=45&&x<=47;if(!(A||k))return!1;var M,N={};_===16||_===24?(M=Math.floor((x-32)/2),N.background=h[M],x%2==1&&(N.background=N.background+"_semi")):x===45?N.background="transparent":(N.foreground="black",x===47&&(N.underline=!0));var U=_<=23?1:2,j=this.channels[U];return j.setBkgData(N),S(_,x,this.cmdHistory),!0},L.reset=function(){for(var _=0;_<Object.keys(this.channels).length;_++){var x=this.channels[_];x&&x.reset()}this.cmdHistory=P()},L.cueSplitAtTime=function(_){for(var x=0;x<this.channels.length;x++){var A=this.channels[x];A&&A.cueSplitAtTime(_)}},R}();function S(R,L,O){O.a=R,O.b=L}function C(R,L,O){return O.a===R&&O.b===L}function P(){return{a:null,b:null}}m.default=b},"./src/utils/codecs.ts":function(G,m,r){r.r(m),r.d(m,"isCodecType",function(){return l}),r.d(m,"isCodecSupportedInMp4",function(){return e});var c={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function l(n,a){var s=c[a];return!!s&&s[n.slice(0,4)]===!0}function e(n,a){return MediaSource.isTypeSupported((a||"video")+'/mp4;codecs="'+n+'"')}},"./src/utils/cues.ts":function(G,m,r){r.r(m);var c=r("./src/utils/vttparser.ts"),l=r("./src/utils/webvtt-parser.ts"),e=r("./src/utils/texttrack-utils.ts"),n=/\s/,a={newCue:function(u,t,f,h){for(var v=[],y,p,g,d,E,w=self.VTTCue||self.TextTrackCue,D=0;D<h.rows.length;D++)if(y=h.rows[D],g=!0,d=0,E="",!y.isEmpty()){for(var b=0;b<y.chars.length;b++)n.test(y.chars[b].uchar)&&g?d++:(E+=y.chars[b].uchar,g=!1);y.cueStartTime=t,t===f&&(f+=1e-4),d>=16?d--:d++;var S=Object(c.fixLineBreaks)(E.trim()),C=Object(l.generateCueId)(t,f,S);(!u||!u.cues||!u.cues.getCueById(C))&&(p=new w(t,f,S),p.id=C,p.line=D+1,p.align="left",p.position=10+Math.min(80,Math.floor(d*8/32)*10),v.push(p))}return u&&v.length&&(v.sort(function(P,R){return P.line==="auto"||R.line==="auto"?0:P.line>8&&R.line>8?R.line-P.line:P.line-R.line}),v.forEach(function(P){return Object(e.addCueToTrack)(u,P)})),v}};m.default=a},"./src/utils/discontinuities.ts":function(G,m,r){r.r(m),r.d(m,"findFirstFragWithCC",function(){return n}),r.d(m,"shouldAlignOnDiscontinuities",function(){return a}),r.d(m,"findDiscontinuousReferenceFrag",function(){return s}),r.d(m,"adjustSlidingStart",function(){return t}),r.d(m,"alignStream",function(){return f}),r.d(m,"alignPDT",function(){return v}),r.d(m,"alignFragmentByPDTDelta",function(){return y}),r.d(m,"alignMediaPlaylistByPDT",function(){return p});var c=r("./src/polyfills/number.ts"),l=r("./src/utils/logger.ts"),e=r("./src/controller/level-helper.ts");function n(g,d){for(var E=null,w=0,D=g.length;w<D;w++){var b=g[w];if(b&&b.cc===d){E=b;break}}return E}function a(g,d,E){return!!(d.details&&(E.endCC>E.startCC||g&&g.cc<E.startCC))}function s(g,d){var E=g.fragments,w=d.fragments;if(!w.length||!E.length){l.logger.log("No fragments to align");return}var D=n(E,w[0].cc);if(!D||D&&!D.startPTS){l.logger.log("No frag in previous level to align on");return}return D}function u(g,d){if(g){var E=g.start+d;g.start=g.startPTS=E,g.endPTS=E+g.duration}}function t(g,d){for(var E=d.fragments,w=0,D=E.length;w<D;w++)u(E[w],g);d.fragmentHint&&u(d.fragmentHint,g),d.alignedSliding=!0}function f(g,d,E){!d||(h(g,E,d),!E.alignedSliding&&d.details&&v(E,d.details),!E.alignedSliding&&d.details&&!E.skippedSegments&&Object(e.adjustSliding)(d.details,E))}function h(g,d,E){if(a(g,E,d)){var w=s(E.details,d);w&&Object(c.isFiniteNumber)(w.start)&&(l.logger.log("Adjusting PTS using last level due to CC increase within current level "+d.url),t(w.start,d))}}function v(g,d){if(!(!d.fragments.length||!g.hasProgramDateTime||!d.hasProgramDateTime)){var E=d.fragments[0].programDateTime,w=g.fragments[0].programDateTime,D=(w-E)/1e3+d.fragments[0].start;D&&Object(c.isFiniteNumber)(D)&&(l.logger.log("Adjusting PTS using programDateTime delta "+(w-E)+"ms, sliding:"+D.toFixed(3)+" "+g.url+" "),t(D,g))}}function y(g,d){var E=g.programDateTime;if(!!E){var w=(E-d)/1e3;g.start=g.startPTS=w,g.endPTS=w+g.duration}}function p(g,d){if(!(!d.fragments.length||!g.hasProgramDateTime||!d.hasProgramDateTime)){var E=d.fragments[0].programDateTime,w=d.fragments[0].start,D=E-w*1e3;g.fragments.forEach(function(b){y(b,D)}),g.fragmentHint&&y(g.fragmentHint,D),g.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(G,m,r){r.r(m);var c=r("./src/utils/ewma.ts"),l=function(){function e(a,s,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new c.default(a),this.fast_=new c.default(s)}var n=e.prototype;return n.update=function(s,u){var t=this.slow_,f=this.fast_;this.slow_.halfLife!==s&&(this.slow_=new c.default(s,t.getEstimate(),t.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new c.default(u,f.getEstimate(),f.getTotalWeight()))},n.sample=function(s,u){s=Math.max(s,this.minDelayMs_);var t=8*u,f=s/1e3,h=t/f;this.fast_.sample(f,h),this.slow_.sample(f,h)},n.canEstimate=function(){var s=this.fast_;return s&&s.getTotalWeight()>=this.minWeight_},n.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},n.destroy=function(){},e}();m.default=l},"./src/utils/ewma.ts":function(G,m,r){r.r(m);var c=function(){function l(n,a,s){a===void 0&&(a=0),s===void 0&&(s=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=n,this.alpha_=n?Math.exp(Math.log(.5)/n):0,this.estimate_=a,this.totalWeight_=s}var e=l.prototype;return e.sample=function(a,s){var u=Math.pow(this.alpha_,a);this.estimate_=s*(1-u)+u*this.estimate_,this.totalWeight_+=a},e.getTotalWeight=function(){return this.totalWeight_},e.getEstimate=function(){if(this.alpha_){var a=1-Math.pow(this.alpha_,this.totalWeight_);if(a)return this.estimate_/a}return this.estimate_},l}();m.default=c},"./src/utils/fetch-loader.ts":function(G,m,r){r.r(m),r.d(m,"fetchSupported",function(){return y});var c=r("./src/polyfills/number.ts"),l=r("./src/loader/load-stats.ts"),e=r("./src/demux/chunk-cache.ts");function n(w,D){w.prototype=Object.create(D.prototype),w.prototype.constructor=w,f(w,D)}function a(w){var D=typeof Map=="function"?new Map:void 0;return a=function(S){if(S===null||!t(S))return S;if(typeof S!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(S))return D.get(S);D.set(S,C)}function C(){return s(S,arguments,h(this).constructor)}return C.prototype=Object.create(S.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),f(C,S)},a(w)}function s(w,D,b){return u()?s=Reflect.construct:s=function(C,P,R){var L=[null];L.push.apply(L,P);var O=Function.bind.apply(C,L),_=new O;return R&&f(_,R.prototype),_},s.apply(null,arguments)}function u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function t(w){return Function.toString.call(w).indexOf("[native code]")!==-1}function f(w,D){return f=Object.setPrototypeOf||function(S,C){return S.__proto__=C,S},f(w,D)}function h(w){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)},h(w)}function v(){return v=Object.assign||function(w){for(var D=1;D<arguments.length;D++){var b=arguments[D];for(var S in b)Object.prototype.hasOwnProperty.call(b,S)&&(w[S]=b[S])}return w},v.apply(this,arguments)}function y(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var p=function(){function w(b){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=b.fetchSetup||d,this.controller=new self.AbortController,this.stats=new l.LoadStats}var D=w.prototype;return D.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},D.abortInternal=function(){var S=this.response;(!S||!S.ok)&&(this.stats.aborted=!0,this.controller.abort())},D.abort=function(){var S;this.abortInternal(),(S=this.callbacks)!==null&&S!==void 0&&S.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},D.load=function(S,C,P){var R=this,L=this.stats;if(L.loading.start)throw new Error("Loader can only be used once.");L.loading.start=self.performance.now();var O=g(S,this.controller.signal),_=P.onProgress,x=S.responseType==="arraybuffer",A=x?"byteLength":"length";this.context=S,this.config=C,this.callbacks=P,this.request=this.fetchSetup(S,O),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){R.abortInternal(),P.onTimeout(L,S,R.response)},C.timeout),self.fetch(this.request).then(function(k){if(R.response=R.loader=k,!k.ok){var M=k.status,N=k.statusText;throw new E(N||"fetch, bad network response",M,k)}return L.loading.first=Math.max(self.performance.now(),L.loading.start),L.total=parseInt(k.headers.get("Content-Length")||"0"),_&&Object(c.isFiniteNumber)(C.highWaterMark)?R.loadProgressively(k,L,S,C.highWaterMark,_):x?k.arrayBuffer():k.text()}).then(function(k){var M=R.response;self.clearTimeout(R.requestTimeout),L.loading.end=Math.max(self.performance.now(),L.loading.first),L.loaded=L.total=k[A];var N={url:M.url,data:k};_&&!Object(c.isFiniteNumber)(C.highWaterMark)&&_(L,S,k,M),P.onSuccess(N,L,S,M)}).catch(function(k){if(self.clearTimeout(R.requestTimeout),!L.aborted){var M=k.code||0;P.onError({code:M,text:k.message},S,k.details)}})},D.getCacheAge=function(){var S=null;if(this.response){var C=this.response.headers.get("age");S=C?parseFloat(C):null}return S},D.loadProgressively=function(S,C,P,R,L){R===void 0&&(R=0);var O=new e.default,_=S.body.getReader(),x=function A(){return _.read().then(function(k){if(k.done)return O.dataLength&&L(C,P,O.flush(),S),Promise.resolve(new ArrayBuffer(0));var M=k.value,N=M.length;return C.loaded+=N,N<R||O.dataLength?(O.push(M),O.dataLength>=R&&L(C,P,O.flush(),S)):L(C,P,M,S),A()}).catch(function(){return Promise.reject()})};return x()},w}();function g(w,D){var b={method:"GET",mode:"cors",credentials:"same-origin",signal:D,headers:new self.Headers(v({},w.headers))};return w.rangeEnd&&b.headers.set("Range","bytes="+w.rangeStart+"-"+String(w.rangeEnd-1)),b}function d(w,D){return new self.Request(w.url,D)}var E=function(w){n(D,w);function D(b,S,C){var P;return P=w.call(this,b)||this,P.code=void 0,P.details=void 0,P.code=S,P.details=C,P}return D}(a(Error));m.default=p},"./src/utils/imsc1-ttml-parser.ts":function(G,m,r){r.r(m),r.d(m,"IMSC1_CODEC",function(){return t}),r.d(m,"parseIMSC1",function(){return y});var c=r("./src/utils/mp4-tools.ts"),l=r("./src/utils/vttparser.ts"),e=r("./src/utils/vttcue.ts"),n=r("./src/demux/id3.ts"),a=r("./src/utils/timescale-conversion.ts"),s=r("./src/utils/webvtt-parser.ts");function u(){return u=Object.assign||function(R){for(var L=1;L<arguments.length;L++){var O=arguments[L];for(var _ in O)Object.prototype.hasOwnProperty.call(O,_)&&(R[_]=O[_])}return R},u.apply(this,arguments)}var t="stpp.ttml.im1t",f=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,h=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,v={left:"start",center:"center",right:"end",start:"start",end:"end"};function y(R,L,O,_,x){var A=Object(c.findBox)(new Uint8Array(R),["mdat"]);if(A.length===0){x(new Error("Could not parse IMSC1 mdat"));return}var k=A[0],M=Object(n.utf8ArrayToStr)(new Uint8Array(R,k.start,k.end-k.start)),N=Object(a.toTimescaleFromScale)(L,1,O);try{_(p(M,N))}catch(U){x(U)}}function p(R,L){var O=new DOMParser,_=O.parseFromString(R,"text/xml"),x=_.getElementsByTagName("tt")[0];if(!x)throw new Error("Invalid ttml");var A={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},k=Object.keys(A).reduce(function(z,J){return z[J]=x.getAttribute("ttp:"+J)||A[J],z},{}),M=x.getAttribute("xml:space")!=="preserve",N=d(g(x,"styling","style")),U=d(g(x,"layout","region")),j=g(x,"body","[begin]");return[].map.call(j,function(z){var J=E(z,M);if(!J||!z.hasAttribute("begin"))return null;var te=S(z.getAttribute("begin"),k),re=S(z.getAttribute("dur"),k),oe=S(z.getAttribute("end"),k);if(te===null)throw b(z);if(oe===null){if(re===null)throw b(z);oe=te+re}var se=new e.default(te-L,oe-L,J);se.id=Object(s.generateCueId)(se.startTime,se.endTime,se.text);var me=U[z.getAttribute("region")],fe=N[z.getAttribute("style")];se.position=10,se.size=80;var ue=w(me,fe),ye=ue.textAlign;if(ye){var pe=v[ye];pe&&(se.lineAlign=pe),se.align=ye}return u(se,ue),se}).filter(function(z){return z!==null})}function g(R,L,O){var _=R.getElementsByTagName(L)[0];return _?[].slice.call(_.querySelectorAll(O)):[]}function d(R){return R.reduce(function(L,O){var _=O.getAttribute("xml:id");return _&&(L[_]=O),L},{})}function E(R,L){return[].slice.call(R.childNodes).reduce(function(O,_,x){var A;return _.nodeName==="br"&&x?O+`
`:(A=_.childNodes)!==null&&A!==void 0&&A.length?E(_,L):L?O+_.textContent.trim().replace(/\s+/g," "):O+_.textContent},"")}function w(R,L){var O="http://www.w3.org/ns/ttml#styling",_=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return _.reduce(function(x,A){var k=D(L,O,A)||D(R,O,A);return k&&(x[A]=k),x},{})}function D(R,L,O){return R.hasAttributeNS(L,O)?R.getAttributeNS(L,O):null}function b(R){return new Error("Could not parse ttml timestamp "+R)}function S(R,L){if(!R)return null;var O=Object(l.parseTimeStamp)(R);return O===null&&(f.test(R)?O=C(R,L):h.test(R)&&(O=P(R,L))),O}function C(R,L){var O=f.exec(R),_=(O[4]|0)+(O[5]|0)/L.subFrameRate;return(O[1]|0)*3600+(O[2]|0)*60+(O[3]|0)+_/L.frameRate}function P(R,L){var O=h.exec(R),_=Number(O[1]),x=O[2];switch(x){case"h":return _*3600;case"m":return _*60;case"ms":return _*1e3;case"f":return _/L.frameRate;case"t":return _/L.tickRate}return _}},"./src/utils/logger.ts":function(G,m,r){r.r(m),r.d(m,"enableLogs",function(){return s}),r.d(m,"logger",function(){return u});var c=function(){},l={trace:c,debug:c,log:c,warn:c,info:c,error:c},e=l;function n(t){var f=self.console[t];return f?f.bind(self.console,"["+t+"] >"):c}function a(t){for(var f=arguments.length,h=new Array(f>1?f-1:0),v=1;v<f;v++)h[v-1]=arguments[v];h.forEach(function(y){e[y]=t[y]?t[y].bind(t):n(y)})}function s(t){if(self.console&&t===!0||typeof t=="object"){a(t,"debug","log","info","warn","error");try{e.log()}catch{e=l}}else e=l}var u=e},"./src/utils/mediakeys-helper.ts":function(G,m,r){r.r(m),r.d(m,"KeySystems",function(){return c}),r.d(m,"requestMediaKeySystemAccess",function(){return l});var c;(function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"})(c||(c={}));var l=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(G,m,r){r.r(m),r.d(m,"getMediaSource",function(){return c});function c(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(G,m,r){r.r(m),r.d(m,"bin2str",function(){return a}),r.d(m,"readUint16",function(){return s}),r.d(m,"readUint32",function(){return u}),r.d(m,"writeUint32",function(){return t}),r.d(m,"findBox",function(){return f}),r.d(m,"parseSegmentIndex",function(){return h}),r.d(m,"parseInitSegment",function(){return v}),r.d(m,"getStartDTS",function(){return y}),r.d(m,"getDuration",function(){return p}),r.d(m,"computeRawDurationFromSamples",function(){return g}),r.d(m,"offsetStartDTS",function(){return d}),r.d(m,"segmentValidRange",function(){return E}),r.d(m,"appendUint8Array",function(){return w});var c=r("./src/utils/typed-array.ts"),l=r("./src/loader/fragment.ts"),e=Math.pow(2,32)-1,n=[].push;function a(D){return String.fromCharCode.apply(null,D)}function s(D,b){"data"in D&&(b+=D.start,D=D.data);var S=D[b]<<8|D[b+1];return S<0?65536+S:S}function u(D,b){"data"in D&&(b+=D.start,D=D.data);var S=D[b]<<24|D[b+1]<<16|D[b+2]<<8|D[b+3];return S<0?4294967296+S:S}function t(D,b,S){"data"in D&&(b+=D.start,D=D.data),D[b]=S>>24,D[b+1]=S>>16&255,D[b+2]=S>>8&255,D[b+3]=S&255}function f(D,b){var S=[];if(!b.length)return S;var C,P,R;"data"in D?(C=D.data,P=D.start,R=D.end):(C=D,P=0,R=C.byteLength);for(var L=P;L<R;){var O=u(C,L),_=a(C.subarray(L+4,L+8)),x=O>1?L+O:R;if(_===b[0])if(b.length===1)S.push({data:C,start:L+8,end:x});else{var A=f({data:C,start:L+8,end:x},b.slice(1));A.length&&n.apply(S,A)}L=x}return S}function h(D){var b=f(D,["moov"]),S=b[0],C=S?S.end:null,P=f(D,["sidx"]);if(!P||!P[0])return null;var R=[],L=P[0],O=L.data[0],_=O===0?8:16,x=u(L,_);_+=4;var A=0,k=0;O===0?_+=8:_+=16,_+=2;var M=L.end+k,N=s(L,_);_+=2;for(var U=0;U<N;U++){var j=_,z=u(L,j);j+=4;var J=z&2147483647,te=(z&2147483648)>>>31;if(te===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var re=u(L,j);j+=4,R.push({referenceSize:J,subsegmentDuration:re,info:{duration:re/x,start:M,end:M+J-1}}),M+=J,j+=4,_=j}return{earliestPresentationTime:A,timescale:x,version:O,referencesCount:N,references:R,moovEndOffset:C}}function v(D){for(var b=[],S=f(D,["moov","trak"]),C=0;C<S.length;C++){var P=S[C],R=f(P,["tkhd"])[0];if(R){var L=R.data[R.start],O=L===0?12:20,_=u(R,O),x=f(P,["mdia","mdhd"])[0];if(x){L=x.data[x.start],O=L===0?12:20;var A=u(x,O),k=f(P,["mdia","hdlr"])[0];if(k){var M=a(k.data.subarray(k.start+8,k.start+12)),N={soun:l.ElementaryStreamTypes.AUDIO,vide:l.ElementaryStreamTypes.VIDEO}[M];if(N){var U=f(P,["mdia","minf","stbl","stsd"])[0],j=void 0;U&&(j=a(U.data.subarray(U.start+12,U.start+16))),b[_]={timescale:A,type:N},b[N]={timescale:A,id:_,codec:j}}}}}}var z=f(D,["moov","mvex","trex"]);return z.forEach(function(J){var te=u(J,4),re=b[te];re&&(re.default={duration:u(J,12),flags:u(J,20)})}),b}function y(D,b){return f(b,["moof","traf"]).reduce(function(S,C){var P=f(C,["tfdt"])[0],R=P.data[P.start],L=f(C,["tfhd"]).reduce(function(O,_){var x=u(_,4),A=D[x];if(A){var k=u(P,4);R===1&&(k*=Math.pow(2,32),k+=u(P,8));var M=A.timescale||9e4,N=k/M;if(isFinite(N)&&(O===null||N<O))return N}return O},null);return L!==null&&isFinite(L)&&(S===null||L<S)?L:S},null)||0}function p(D,b){for(var S=0,C=0,P=0,R=f(D,["moof","traf"]),L=0;L<R.length;L++){var O=R[L],_=f(O,["tfhd"])[0],x=u(_,4),A=b[x];if(!!A){var k=A.default,M=u(_,0)|(k==null?void 0:k.flags),N=k==null?void 0:k.duration;M&8&&(M&2?N=u(_,12):N=u(_,8));for(var U=A.timescale||9e4,j=f(O,["trun"]),z=0;z<j.length;z++){if(N){var J=u(j[z],4);S=N*J}else S=g(j[z]);A.type===l.ElementaryStreamTypes.VIDEO?C+=S/U:A.type===l.ElementaryStreamTypes.AUDIO&&(P+=S/U)}}}if(C===0&&P===0){var te=h(D);if(te!=null&&te.references)return te.references.reduce(function(re,oe){return re+oe.info.duration||0},0)}return C||P}function g(D){var b=u(D,0),S=8;b&1&&(S+=4),b&4&&(S+=4);for(var C=0,P=u(D,4),R=0;R<P;R++){if(b&256){var L=u(D,S);C+=L,S+=4}b&512&&(S+=4),b&1024&&(S+=4),b&2048&&(S+=4)}return C}function d(D,b,S){f(b,["moof","traf"]).forEach(function(C){f(C,["tfhd"]).forEach(function(P){var R=u(P,4),L=D[R];if(!!L){var O=L.timescale||9e4;f(C,["tfdt"]).forEach(function(_){var x=_.data[_.start],A=u(_,4);if(x===0)t(_,4,A-S*O);else{A*=Math.pow(2,32),A+=u(_,8),A-=S*O,A=Math.max(A,0);var k=Math.floor(A/(e+1)),M=Math.floor(A%(e+1));t(_,4,k),t(_,8,M)}})}})})}function E(D){var b={valid:null,remainder:null},S=f(D,["moof"]);if(S){if(S.length<2)return b.remainder=D,b}else return b;var C=S[S.length-1];return b.valid=Object(c.sliceUint8)(D,0,C.start-8),b.remainder=Object(c.sliceUint8)(D,C.start-8),b}function w(D,b){var S=new Uint8Array(D.length+b.length);return S.set(D),S.set(b,D.length),S}},"./src/utils/output-filter.ts":function(G,m,r){r.r(m),r.d(m,"default",function(){return c});var c=function(){function l(n,a){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=n,this.trackName=a}var e=l.prototype;return e.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},e.newCue=function(a,s,u){(this.startTime===null||this.startTime>a)&&(this.startTime=a),this.endTime=s,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},e.reset=function(){this.cueRanges=[]},l}()},"./src/utils/texttrack-utils.ts":function(G,m,r){r.r(m),r.d(m,"sendAddTrackEvent",function(){return l}),r.d(m,"addCueToTrack",function(){return e}),r.d(m,"clearCurrentCues",function(){return n}),r.d(m,"removeCuesInRange",function(){return a}),r.d(m,"getCuesInRange",function(){return u});var c=r("./src/utils/logger.ts");function l(t,f){var h;try{h=new Event("addtrack")}catch{h=document.createEvent("Event"),h.initEvent("addtrack",!1,!1)}h.track=t,f.dispatchEvent(h)}function e(t,f){var h=t.mode;if(h==="disabled"&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(f.id))try{if(t.addCue(f),!t.cues.getCueById(f.id))throw new Error("addCue is failed for: "+f)}catch(y){c.logger.debug("[texttrack-utils]: "+y);var v=new self.TextTrackCue(f.startTime,f.endTime,f.text);v.id=f.id,t.addCue(v)}h==="disabled"&&(t.mode=h)}function n(t){var f=t.mode;if(f==="disabled"&&(t.mode="hidden"),t.cues)for(var h=t.cues.length;h--;)t.removeCue(t.cues[h]);f==="disabled"&&(t.mode=f)}function a(t,f,h){var v=t.mode;if(v==="disabled"&&(t.mode="hidden"),t.cues&&t.cues.length>0)for(var y=u(t.cues,f,h),p=0;p<y.length;p++)t.removeCue(y[p]);v==="disabled"&&(t.mode=v)}function s(t,f){if(f<t[0].startTime)return 0;var h=t.length-1;if(f>t[h].endTime)return-1;for(var v=0,y=h;v<=y;){var p=Math.floor((y+v)/2);if(f<t[p].startTime)y=p-1;else if(f>t[p].startTime&&v<h)v=p+1;else return p}return t[v].startTime-f<f-t[y].startTime?v:y}function u(t,f,h){var v=[],y=s(t,f);if(y>-1)for(var p=y,g=t.length;p<g;p++){var d=t[p];if(d.startTime>=f&&d.endTime<=h)v.push(d);else if(d.startTime>h)return v}return v}},"./src/utils/time-ranges.ts":function(G,m,r){r.r(m);var c={toString:function(e){for(var n="",a=e.length,s=0;s<a;s++)n+="["+e.start(s).toFixed(3)+","+e.end(s).toFixed(3)+"]";return n}};m.default=c},"./src/utils/timescale-conversion.ts":function(G,m,r){r.r(m),r.d(m,"toTimescaleFromBase",function(){return l}),r.d(m,"toTimescaleFromScale",function(){return e}),r.d(m,"toMsFromMpegTsClock",function(){return n}),r.d(m,"toMpegTsClockFromTimescale",function(){return a});var c=9e4;function l(s,u,t,f){t===void 0&&(t=1),f===void 0&&(f=!1);var h=s*u*t;return f?Math.round(h):h}function e(s,u,t,f){return t===void 0&&(t=1),f===void 0&&(f=!1),l(s,u,1/t,f)}function n(s,u){return u===void 0&&(u=!1),l(s,1e3,1/c,u)}function a(s,u){return u===void 0&&(u=1),l(s,c,1/u)}},"./src/utils/typed-array.ts":function(G,m,r){r.r(m),r.d(m,"sliceUint8",function(){return c});function c(l,e,n){return Uint8Array.prototype.slice?l.slice(e,n):new Uint8Array(Array.prototype.slice.call(l,e,n))}},"./src/utils/vttcue.ts":function(G,m,r){r.r(m),m.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var c=["","lr","rl"],l=["start","middle","end","left","right"];function e(t,f){if(typeof f!="string"||!Array.isArray(t))return!1;var h=f.toLowerCase();return~t.indexOf(h)?h:!1}function n(t){return e(c,t)}function a(t){return e(l,t)}function s(t){for(var f=arguments.length,h=new Array(f>1?f-1:0),v=1;v<f;v++)h[v-1]=arguments[v];for(var y=1;y<arguments.length;y++){var p=arguments[y];for(var g in p)t[g]=p[g]}return t}function u(t,f,h){var v=this,y={enumerable:!0};v.hasBeenReset=!1;var p="",g=!1,d=t,E=f,w=h,D=null,b="",S=!0,C="auto",P="start",R=50,L="middle",O=50,_="middle";Object.defineProperty(v,"id",s({},y,{get:function(){return p},set:function(A){p=""+A}})),Object.defineProperty(v,"pauseOnExit",s({},y,{get:function(){return g},set:function(A){g=!!A}})),Object.defineProperty(v,"startTime",s({},y,{get:function(){return d},set:function(A){if(typeof A!="number")throw new TypeError("Start time must be set to a number.");d=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"endTime",s({},y,{get:function(){return E},set:function(A){if(typeof A!="number")throw new TypeError("End time must be set to a number.");E=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"text",s({},y,{get:function(){return w},set:function(A){w=""+A,this.hasBeenReset=!0}})),Object.defineProperty(v,"region",s({},y,{get:function(){return D},set:function(A){D=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"vertical",s({},y,{get:function(){return b},set:function(A){var k=n(A);if(k===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=k,this.hasBeenReset=!0}})),Object.defineProperty(v,"snapToLines",s({},y,{get:function(){return S},set:function(A){S=!!A,this.hasBeenReset=!0}})),Object.defineProperty(v,"line",s({},y,{get:function(){return C},set:function(A){if(typeof A!="number"&&A!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");C=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"lineAlign",s({},y,{get:function(){return P},set:function(A){var k=a(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");P=k,this.hasBeenReset=!0}})),Object.defineProperty(v,"position",s({},y,{get:function(){return R},set:function(A){if(A<0||A>100)throw new Error("Position must be between 0 and 100.");R=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"positionAlign",s({},y,{get:function(){return L},set:function(A){var k=a(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");L=k,this.hasBeenReset=!0}})),Object.defineProperty(v,"size",s({},y,{get:function(){return O},set:function(A){if(A<0||A>100)throw new Error("Size must be between 0 and 100.");O=A,this.hasBeenReset=!0}})),Object.defineProperty(v,"align",s({},y,{get:function(){return _},set:function(A){var k=a(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");_=k,this.hasBeenReset=!0}})),v.displayState=void 0}return u.prototype.getCueAsHTML=function(){var t=self.WebVTT;return t.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(G,m,r){r.r(m),r.d(m,"parseTimeStamp",function(){return e}),r.d(m,"fixLineBreaks",function(){return f}),r.d(m,"VTTParser",function(){return h});var c=r("./src/utils/vttcue.ts"),l=function(){function v(){}var y=v.prototype;return y.decode=function(g,d){if(!g)return"";if(typeof g!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(g))},v}();function e(v){function y(g,d,E,w){return(g|0)*3600+(d|0)*60+(E|0)+parseFloat(w||0)}var p=v.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return p?parseFloat(p[2])>59?y(p[2],p[3],0,p[4]):y(p[1],p[2],p[3],p[4]):null}var n=function(){function v(){this.values=Object.create(null)}var y=v.prototype;return y.set=function(g,d){!this.get(g)&&d!==""&&(this.values[g]=d)},y.get=function(g,d,E){return E?this.has(g)?this.values[g]:d[E]:this.has(g)?this.values[g]:d},y.has=function(g){return g in this.values},y.alt=function(g,d,E){for(var w=0;w<E.length;++w)if(d===E[w]){this.set(g,d);break}},y.integer=function(g,d){/^-?\d+$/.test(d)&&this.set(g,parseInt(d,10))},y.percent=function(g,d){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(d)){var E=parseFloat(d);if(E>=0&&E<=100)return this.set(g,E),!0}return!1},v}();function a(v,y,p,g){var d=g?v.split(g):[v];for(var E in d)if(typeof d[E]=="string"){var w=d[E].split(p);if(w.length===2){var D=w[0],b=w[1];y(D,b)}}}var s=new c.default(0,0,""),u=s.align==="middle"?"middle":"center";function t(v,y,p){var g=v;function d(){var D=e(v);if(D===null)throw new Error("Malformed timestamp: "+g);return v=v.replace(/^[^\sa-zA-Z-]+/,""),D}function E(D,b){var S=new n;a(D,function(R,L){var O;switch(R){case"region":for(var _=p.length-1;_>=0;_--)if(p[_].id===L){S.set(R,p[_].region);break}break;case"vertical":S.alt(R,L,["rl","lr"]);break;case"line":O=L.split(","),S.integer(R,O[0]),S.percent(R,O[0])&&S.set("snapToLines",!1),S.alt(R,O[0],["auto"]),O.length===2&&S.alt("lineAlign",O[1],["start",u,"end"]);break;case"position":O=L.split(","),S.percent(R,O[0]),O.length===2&&S.alt("positionAlign",O[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":S.percent(R,L);break;case"align":S.alt(R,L,["start",u,"end","left","right"]);break}},/:/,/\s/),b.region=S.get("region",null),b.vertical=S.get("vertical","");var C=S.get("line","auto");C==="auto"&&s.line===-1&&(C=-1),b.line=C,b.lineAlign=S.get("lineAlign","start"),b.snapToLines=S.get("snapToLines",!0),b.size=S.get("size",100),b.align=S.get("align",u);var P=S.get("position","auto");P==="auto"&&s.position===50&&(P=b.align==="start"||b.align==="left"?0:b.align==="end"||b.align==="right"?100:50),b.position=P}function w(){v=v.replace(/^\s+/,"")}if(w(),y.startTime=d(),w(),v.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+g);v=v.substr(3),w(),y.endTime=d(),w(),E(v,y)}function f(v){return v.replace(/<br(?: \/)?>/gi,`
`)}var h=function(){function v(){this.state="INITIAL",this.buffer="",this.decoder=new l,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var y=v.prototype;return y.parse=function(g){var d=this;g&&(d.buffer+=d.decoder.decode(g,{stream:!0}));function E(){var P=d.buffer,R=0;for(P=f(P);R<P.length&&P[R]!=="\r"&&P[R]!==`
`;)++R;var L=P.substr(0,R);return P[R]==="\r"&&++R,P[R]===`
`&&++R,d.buffer=P.substr(R),L}function w(P){a(P,function(R,L){},/:/)}try{var D="";if(d.state==="INITIAL"){if(!/\r\n|\n/.test(d.buffer))return this;D=E();var b=D.match(/^()?WEBVTT([ \t].*)?$/);if(!b||!b[0])throw new Error("Malformed WebVTT signature.");d.state="HEADER"}for(var S=!1;d.buffer;){if(!/\r\n|\n/.test(d.buffer))return this;switch(S?S=!1:D=E(),d.state){case"HEADER":/:/.test(D)?w(D):D||(d.state="ID");continue;case"NOTE":D||(d.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(D)){d.state="NOTE";break}if(!D)continue;if(d.cue=new c.default(0,0,""),d.state="CUE",D.indexOf("-->")===-1){d.cue.id=D;continue}case"CUE":if(!d.cue){d.state="BADCUE";continue}try{t(D,d.cue,d.regionList)}catch{d.cue=null,d.state="BADCUE";continue}d.state="CUETEXT";continue;case"CUETEXT":{var C=D.indexOf("-->")!==-1;if(!D||C&&(S=!0)){d.oncue&&d.cue&&d.oncue(d.cue),d.cue=null,d.state="ID";continue}if(d.cue===null)continue;d.cue.text&&(d.cue.text+=`
`),d.cue.text+=D}continue;case"BADCUE":D||(d.state="ID")}}}catch{d.state==="CUETEXT"&&d.cue&&d.oncue&&d.oncue(d.cue),d.cue=null,d.state=d.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},y.flush=function(){var g=this;try{if((g.cue||g.state==="HEADER")&&(g.buffer+=`

`,g.parse()),g.state==="INITIAL"||g.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(d){g.onparsingerror&&g.onparsingerror(d)}return g.onflush&&g.onflush(),this},v}()},"./src/utils/webvtt-parser.ts":function(G,m,r){r.r(m),r.d(m,"generateCueId",function(){return h}),r.d(m,"parseWebVTT",function(){return y});var c=r("./src/polyfills/number.ts"),l=r("./src/utils/vttparser.ts"),e=r("./src/demux/id3.ts"),n=r("./src/utils/timescale-conversion.ts"),a=r("./src/remux/mp4-remuxer.ts"),s=/\r\n|\n\r|\n|\r/g,u=function(g,d,E){return E===void 0&&(E=0),g.substr(E,d.length)===d},t=function(g){var d=parseInt(g.substr(-3)),E=parseInt(g.substr(-6,2)),w=parseInt(g.substr(-9,2)),D=g.length>9?parseInt(g.substr(0,g.indexOf(":"))):0;if(!Object(c.isFiniteNumber)(d)||!Object(c.isFiniteNumber)(E)||!Object(c.isFiniteNumber)(w)||!Object(c.isFiniteNumber)(D))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+g);return d+=1e3*E,d+=60*1e3*w,d+=60*60*1e3*D,d},f=function(g){for(var d=5381,E=g.length;E;)d=d*33^g.charCodeAt(--E);return(d>>>0).toString()};function h(p,g,d){return f(p.toString())+f(g.toString())+f(d)}var v=function(g,d,E){var w=g[d],D=g[w.prevCC];if(!D||!D.new&&w.new){g.ccOffset=g.presentationOffset=w.start,w.new=!1;return}for(;(b=D)!==null&&b!==void 0&&b.new;){var b;g.ccOffset+=w.start-D.start,w.new=!1,w=D,D=g[w.prevCC]}g.presentationOffset=E};function y(p,g,d,E,w,D,b,S){var C=new l.VTTParser,P=Object(e.utf8ArrayToStr)(new Uint8Array(p)).trim().replace(s,`
`).split(`
`),R=[],L=Object(n.toMpegTsClockFromTimescale)(g,d),O="00:00.000",_=0,x=0,A,k=!0,M=!1;C.oncue=function(N){var U=E[w],j=E.ccOffset,z=(_-L)/9e4;if(U!=null&&U.new&&(x!==void 0?j=E.ccOffset=U.start:v(E,w,z)),z&&(j=z-E.presentationOffset),M){var J=N.endTime-N.startTime,te=Object(a.normalizePts)((N.startTime+j-x)*9e4,D*9e4)/9e4;N.startTime=te,N.endTime=te+J}var re=N.text.trim();N.text=decodeURIComponent(encodeURIComponent(re)),N.id||(N.id=h(N.startTime,N.endTime,re)),N.endTime>0&&R.push(N)},C.onparsingerror=function(N){A=N},C.onflush=function(){if(A){S(A);return}b(R)},P.forEach(function(N){if(k)if(u(N,"X-TIMESTAMP-MAP=")){k=!1,M=!0,N.substr(16).split(",").forEach(function(U){u(U,"LOCAL:")?O=U.substr(6):u(U,"MPEGTS:")&&(_=parseInt(U.substr(7)))});try{x=t(O)/1e3}catch(U){M=!1,A=U}return}else N===""&&(k=!1);C.parse(N+`
`)}),C.flush()}},"./src/utils/xhr-loader.ts":function(G,m,r){r.r(m);var c=r("./src/utils/logger.ts"),l=r("./src/loader/load-stats.ts"),e=/^age:\s*[\d.]+\s*$/m,n=function(){function a(u){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=u?u.xhrSetup:null,this.stats=new l.LoadStats,this.retryDelay=0}var s=a.prototype;return s.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},s.abortInternal=function(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))},s.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!==null&&t!==void 0&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},s.load=function(t,f,h){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=f,this.callbacks=h,this.retryDelay=f.retryDelay,this.loadInternal()},s.loadInternal=function(){var t=this.config,f=this.context;if(!!t){var h=this.loader=new self.XMLHttpRequest,v=this.stats;v.loading.first=0,v.loaded=0;var y=this.xhrSetup;try{if(y)try{y(h,f.url)}catch{h.open("GET",f.url,!0),y(h,f.url)}h.readyState||h.open("GET",f.url,!0);var p=this.context.headers;if(p)for(var g in p)h.setRequestHeader(g,p[g])}catch(d){this.callbacks.onError({code:h.status,text:d.message},f,h);return}f.rangeEnd&&h.setRequestHeader("Range","bytes="+f.rangeStart+"-"+(f.rangeEnd-1)),h.onreadystatechange=this.readystatechange.bind(this),h.onprogress=this.loadprogress.bind(this),h.responseType=f.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.timeout),h.send()}},s.readystatechange=function(){var t=this.context,f=this.loader,h=this.stats;if(!(!t||!f)){var v=f.readyState,y=this.config;if(!h.aborted&&v>=2)if(self.clearTimeout(this.requestTimeout),h.loading.first===0&&(h.loading.first=Math.max(self.performance.now(),h.loading.start)),v===4){f.onreadystatechange=null,f.onprogress=null;var p=f.status;if(p>=200&&p<300){h.loading.end=Math.max(self.performance.now(),h.loading.first);var g,d;if(t.responseType==="arraybuffer"?(g=f.response,d=g.byteLength):(g=f.responseText,d=g.length),h.loaded=h.total=d,!this.callbacks)return;var E=this.callbacks.onProgress;if(E&&E(h,t,g,f),!this.callbacks)return;var w={url:f.responseURL,data:g};this.callbacks.onSuccess(w,h,t,f)}else h.retry>=y.maxRetry||p>=400&&p<499?(c.logger.error(p+" while loading "+t.url),this.callbacks.onError({code:p,text:f.statusText},t,f)):(c.logger.warn(p+" while loading "+t.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,y.maxRetryDelay),h.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),y.timeout)}},s.loadtimeout=function(){c.logger.warn("timeout while loading "+this.context.url);var t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))},s.loadprogress=function(t){var f=this.stats;f.loaded=t.loaded,t.lengthComputable&&(f.total=t.total)},s.getCacheAge=function(){var t=null;if(this.loader&&e.test(this.loader.getAllResponseHeaders())){var f=this.loader.getResponseHeader("age");t=f?parseFloat(f):null}return t},a}();m.default=n}}).default})},function(I,K,F){Object.defineProperty(K,"__esModule",{value:!0});var G={};G.getBrowserVersion=function(){var m=navigator.userAgent;if(m.toLowerCase().indexOf("mobile")>-1)return"Unknown";if(m.indexOf("Firefox")>-1){var r=m.match(/firefox\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Firefox "+r}else if(m.indexOf("Edge")>-1){var c=m.match(/edge\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Edge "+c}else{if(m.indexOf("rv:11")>-1)return"IE 11";if(m.indexOf("Opera")>-1||m.indexOf("OPR")>-1){if(m.indexOf("Opera")>-1){var l=m.match(/opera\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Opera "+l}if(m.indexOf("OPR")>-1){var e=m.match(/opr\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Opera "+e}}else if(m.indexOf("Chrome")>-1){var n=m.match(/chrome\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Chrome "+n}else if(m.indexOf("Safari")>-1){var a=m.match(/safari\/[\d.]+/gi)[0].match(/[\d]+/)[0];return"Safari "+a}else if(m.indexOf("MSIE")>-1||m.indexOf("Trident")>-1){if(m.indexOf("MSIE")>-1){var s=m.match(/msie [\d.]+/gi)[0].match(/[\d]+/)[0];return"IE "+s}if(m.indexOf("Trident")>-1){var u=m.match(/trident\/[\d.]+/gi)[0].match(/[\d]+/)[0],t=parseInt(u)+4;return"IE "+t}}else return"Unknown"}},K.default=G,I.exports=K.default}])})})(dist$1);var HlsJsPlayer=getDefaultExportFromCjs(dist$1.exports),dist={exports:{}};(function(module,exports){(function(be,H){module.exports=H()})(self,function(){return(()=>{var __webpack_modules__={727:module=>{function T(be,H,X,I,K,F,G,m){var r=!I;be=+be,H=H||[0],I=I||[[this],[{}]],K=K||{};var c,l=[],e=null;function n(){return function(t,f,h){return new(Function.bind.apply(t,f))}.apply(null,arguments)}Function.prototype.bind||(c=[].slice,Function.prototype.bind=function(t){if(typeof this!="function")throw new TypeError("bind101");var f=c.call(arguments,1),h=f.length,v=this,y=function(){},p=function(){return f.length=h,f.push.apply(f,arguments),v.apply(y.prototype.isPrototypeOf(this)?this:t,f)};return this.prototype&&(y.prototype=this.prototype),p.prototype=new y,p});for(var a=[function(){return!!e},function(){I.push(~I.pop())},function(){I[I.length-2]=I[I.length-2]>>I.pop()},function(){I.push(I[H[be++]][0])},function(){I[I.length-2]=I[I.length-2]/I.pop()},function(){I[I.length-2]=I[I.length-2]in I.pop()},function(){I[I.length-1]=H[be++]},function(){e=null},function(){var t=H[be++],f=t?I.slice(-t):[];I.length-=t,f.unshift(null),t=I.pop(),I.push(n(t[0][t[1]],f))},function(){I[I.length-2]=I[I.length-2]>>>I.pop()},function(){I[I[I.length-2][0]][0]=I[I.length-1]},function(){I[I.length-1]+=String.fromCharCode(H[be++])},function(){I.push("")},function(){for(var t=H[be++],f=[],h=H[be++],v=H[be++],y=[],p=0;p<h;p++)f[H[be++]]=I[H[be++]];for(p=0;p<v;p++)y[p]=H[be++];I.push(function g(){var d=f.slice(0);d[0]=[this],d[1]=[arguments],d[2]=[g];for(var E=0;E<y.length&&E<arguments.length;E++)0<y[E]&&(d[y[E]]=[arguments[E]]);return T(t,H,X,d,K)})},function(){},function(){I.push(H[be++])},function(){I[I.length-2]=I[I.length-2]%I.pop()},function(){I.push(I[I.pop()[0]][0])},function(){var t=I[I.length-2],f=Object.getOwnPropertyDescriptor(t[0],t[1])||{configurable:!0,enumerable:!0};f.get=I[I.length-1],Object.defineProperty(t[0],t[1],f)},function(){throw I[I.length-1]},function(){I.push([X,I.pop()])},function(){I[I.length-2]=I[I.length-2]^I.pop()},function(){var t=H[be++],f=t?I.slice(-t):[];I.length-=t,I.push(I.pop().apply(X,f))},function(){var t=I[I.length-2];t[0][t[1]]=I[I.length-1]},function(){I[I.length-2]=I[I.length-2]<=I.pop()},function(){var t=I.pop();I.push(t[0][t[1]])},function(){var t,f=[];for(t in I.pop())f.push(t);I.push(f)},function(){I.push(!1)},function(){I[I.length-2]=I[I.length-2]>=I.pop()},function(){I.pop()},function(){I.length=H[be++]},function(){I.push([I.pop(),I.pop()].reverse())},function(){I[I[I.length-1][0]]=I[I[I.length-1][0]]===void 0?[]:I[I[I.length-1][0]]},function(){I[I.length-2]=I[I.length-2]<I.pop()},function(){var t=I.pop();I.push(delete t[0][t[1]])},function(){var t=I.pop();K[t]||(X[t]=X[t](),K[t]=1),I.push([X,t])},function(){var t=H[be++],f=t?I.slice(-t):[];I.length-=t,t=I.pop(),I.push(t[0][t[1]].apply(t[0],f))},function(){var t=H[be++];I[I.length-1]&&(be=t)},function(){var t=I[I.length-2],f=Object.getOwnPropertyDescriptor(t[0],t[1])||{configurable:!0,enumerable:!0};f.set=I[I.length-1],Object.defineProperty(t[0],t[1],f)},function(){return!0},function(){I[I.length-2]=I[I.length-2]&I.pop()},function(){I.push([H[be++]])},function(){I.push(null)},function(){I.push(!0)},function(){I[I.length-2]=I[I.length-2]>I.pop()},function(){I[I.length-2]=I[I.length-2]==I.pop()},function(){var t=I.pop();K[t]||(X[t]=X[t](),K[t]=1),I.push(X[t])},function(){I[I.length-1]=X[I[I.length-1]]},function(){I[I.length-2]=I[I.length-2]===I.pop()},function(){var t=H[be++];I[t]=I[t]===void 0?[]:I[t]},function(){I.push(I[I.length-1])},function(){I.push(void 0)},function(){I[I.length-2]=I[I.length-2]instanceof I.pop()},function(){I[I.length-2]=I[I.length-2]-I.pop()},function(){I.push(typeof I.pop())},function(){var t=I.pop(),f=I.pop();I.push([f[0][f[1]],t])},function(){be=H[be++]},function(){I.push(!I.pop())},function(){var t=H[be++],f=t?I.slice(-t):[];I.length-=t,f.unshift(null),I.push(n(I.pop(),f))},function(){I[I.length-2]=I[I.length-2]+I.pop()},function(){l.push([H[be++],I.length,H[be++]])},function(){I[I.length-2]=I[I.length-2]<<I.pop()},function(){for(var t=I.pop(),f=H[be++],h=[],v=H[be++],y=H[be++],p=[],g=0;g<v;g++)h[H[be++]]=I[H[be++]];for(g=0;g<y;g++)p[g]=H[be++];var d=function(){var E=h.slice(0);E[0]=[this],E[1]=[arguments],E[2]=[d];for(var w=0;w<p.length&&w<arguments.length;w++)0<p[w]&&(E[p[w]]=[arguments[w]]);return T(f,H,X,E,K)};d.toString=function(){return t},I.push(d)},function(){l.pop()},function(){I[I.length-2]=I[I.length-2]*I.pop()},function(){I[I.length-1].length?I.push(I[I.length-1].shift(),!0):I.push(void 0,!1)},function(){var t=H[be++],f=I[I.length-2-t];I[I.length-2-t]=I.pop(),I.push(f)},function(){var t=I.pop();I.push([I[I.pop()][0],t])},function(){I.length-=H[be++]},function(){I[I.length-2]=I[I.length-2]|I.pop()}];;)try{for(var s=!1;!s;)s=a[H[be++]]();if(e)throw e;return r?(I.pop(),I.slice(3+T.v)):I.pop()}catch(t){var u=l.pop();if(u===void 0)throw t;e=t,be=u[0],I.length=u[1],u[2]&&(I[u[2]][0]=e)}}function arrayIndexOf(be,H,X){if(typeof Array.prototype.indexOf=="function")return Array.prototype.indexOf.call(be,H,X);var I,K=o.length;if(K===0)return-1;var F=0|X;if(F>=K)return-1;for(I=Math.max(F>=0?F:K-Math.abs(F),0);I<K;I++)if(I in o&&o[I]===H)return I;return-1}function base64Decode(be){for(var H,X,I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),K=String(be).replace(/[=]+$/,""),F=0,G=0,m="";X=K.charAt(G++);~X&&(H=F%4?64*H+X:X,F++%4)?m+=String.fromCharCode(255&H>>(-2*F&6)):0)X=arrayIndexOf(I,X);return m}T.v=0,module.exports.r=function(symbols){for(var result=[],i=0;i<symbols.length;i++)try{result.push(eval(symbols[i]))}catch(be){result.push(void 0)}return result},module.exports.d=function(be){if(typeof be[1]!="object")return be;var H=be[0],X=be[1],I=[],K=base64Decode(H),F=X.shift(),G=X.shift(),m=0;function r(){for(;m===F;)I.push(G),m++,F=X.shift(),G=X.shift()}for(var c=0;c<K.length;c++){var l=K.charAt(c).charCodeAt(0);r(),I.push(l),m++}return r(),I},module.exports.g=function(be){return be.shift()[0]},module.exports.v=T},801:(be,H,X)=>{/*! MIT License. Copyright 2015-2018 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */function I(L){return parseInt(L)===L}function K(L){if(!I(L.length))return!1;for(var O=0;O<L.length;O++)if(!I(L[O])||L[O]<0||L[O]>255)return!1;return!0}function F(L,O){if(L.buffer&&L.name==="Uint8Array")return O&&(L=L.slice?L.slice():Array.prototype.slice.call(L)),L;if(Array.isArray(L)){if(!K(L))throw new Error("Array contains invalid value: "+L);return new Uint8Array(L)}if(I(L.length)&&K(L))return new Uint8Array(L);throw new Error("unsupported array-like object")}function G(L){return new Uint8Array(L)}function m(L,O,_,x,A){x==null&&A==null||(L=L.slice?L.slice(x,A):Array.prototype.slice.call(L,x,A)),O.set(L,_)}X.r(H),X.d(H,{default:()=>R});var r,c={toBytes:function(L){var O=[],_=0;for(L=encodeURI(L);_<L.length;){var x=L.charCodeAt(_++);x===37?(O.push(parseInt(L.substr(_,2),16)),_+=2):O.push(x)}return F(O)},fromBytes:function(L){for(var O=[],_=0;_<L.length;){var x=L[_];x<128?(O.push(String.fromCharCode(x)),_++):x>191&&x<224?(O.push(String.fromCharCode((31&x)<<6|63&L[_+1])),_+=2):(O.push(String.fromCharCode((15&x)<<12|(63&L[_+1])<<6|63&L[_+2])),_+=3)}return O.join("")}},l=(r="0123456789abcdef",{toBytes:function(L){for(var O=[],_=0;_<L.length;_+=2)O.push(parseInt(L.substr(_,2),16));return O},fromBytes:function(L){for(var O=[],_=0;_<L.length;_++){var x=L[_];O.push(r[(240&x)>>4]+r[15&x])}return O.join("")}}),e={16:10,24:12,32:14},n=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],a=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],s=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],u=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],t=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],f=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],h=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],v=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],y=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],p=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],g=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],d=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],E=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],w=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],D=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function b(L){for(var O=[],_=0;_<L.length;_+=4)O.push(L[_]<<24|L[_+1]<<16|L[_+2]<<8|L[_+3]);return O}var S=function L(O){if(!(this instanceof L))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:F(O,!0)}),this._prepare()};S.prototype._prepare=function(){var L=e[this.key.length];if(L==null)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var O=0;O<=L;O++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);var _,x=4*(L+1),A=this.key.length/4,k=b(this.key);for(O=0;O<A;O++)_=O>>2,this._Ke[_][O%4]=k[O],this._Kd[L-_][O%4]=k[O];for(var M,N=0,U=A;U<x;){if(M=k[A-1],k[0]^=a[M>>16&255]<<24^a[M>>8&255]<<16^a[255&M]<<8^a[M>>24&255]^n[N]<<24,N+=1,A!=8)for(O=1;O<A;O++)k[O]^=k[O-1];else{for(O=1;O<A/2;O++)k[O]^=k[O-1];for(M=k[A/2-1],k[A/2]^=a[255&M]^a[M>>8&255]<<8^a[M>>16&255]<<16^a[M>>24&255]<<24,O=A/2+1;O<A;O++)k[O]^=k[O-1]}for(O=0;O<A&&U<x;)j=U>>2,z=U%4,this._Ke[j][z]=k[O],this._Kd[L-j][z]=k[O++],U++}for(var j=1;j<L;j++)for(var z=0;z<4;z++)M=this._Kd[j][z],this._Kd[j][z]=d[M>>24&255]^E[M>>16&255]^w[M>>8&255]^D[255&M]},S.prototype.encrypt=function(L){if(L.length!=16)throw new Error("invalid plaintext size (must be 16 bytes)");for(var O=this._Ke.length-1,_=[0,0,0,0],x=b(L),A=0;A<4;A++)x[A]^=this._Ke[0][A];for(var k=1;k<O;k++){for(A=0;A<4;A++)_[A]=u[x[A]>>24&255]^t[x[(A+1)%4]>>16&255]^f[x[(A+2)%4]>>8&255]^h[255&x[(A+3)%4]]^this._Ke[k][A];x=_.slice()}var M,N=G(16);for(A=0;A<4;A++)M=this._Ke[O][A],N[4*A]=255&(a[x[A]>>24&255]^M>>24),N[4*A+1]=255&(a[x[(A+1)%4]>>16&255]^M>>16),N[4*A+2]=255&(a[x[(A+2)%4]>>8&255]^M>>8),N[4*A+3]=255&(a[255&x[(A+3)%4]]^M);return N},S.prototype.decrypt=function(L){if(L.length!=16)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var O=this._Kd.length-1,_=[0,0,0,0],x=b(L),A=0;A<4;A++)x[A]^=this._Kd[0][A];for(var k=1;k<O;k++){for(A=0;A<4;A++)_[A]=v[x[A]>>24&255]^y[x[(A+3)%4]>>16&255]^p[x[(A+2)%4]>>8&255]^g[255&x[(A+1)%4]]^this._Kd[k][A];x=_.slice()}var M,N=G(16);for(A=0;A<4;A++)M=this._Kd[O][A],N[4*A]=255&(s[x[A]>>24&255]^M>>24),N[4*A+1]=255&(s[x[(A+3)%4]>>16&255]^M>>16),N[4*A+2]=255&(s[x[(A+2)%4]>>8&255]^M>>8),N[4*A+3]=255&(s[255&x[(A+1)%4]]^M);return N};var C=function L(O,_){if(!(this instanceof L))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",_){if(_.length!=16)throw new Error("invalid initialation vector size (must be 16 bytes)")}else _=G(16);this._lastCipherblock=F(_,!0),this._aes=new S(O)};C.prototype.encrypt=function(L){if((L=F(L)).length%16!=0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var O=G(L.length),_=G(16),x=0;x<L.length;x+=16){m(L,_,0,x,x+16);for(var A=0;A<16;A++)_[A]^=this._lastCipherblock[A];this._lastCipherblock=this._aes.encrypt(_),m(this._lastCipherblock,O,x)}return O},C.prototype.decrypt=function(L){if((L=F(L)).length%16!=0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var O=G(L.length),_=G(16),x=0;x<L.length;x+=16){m(L,_,0,x,x+16),_=this._aes.decrypt(_);for(var A=0;A<16;A++)O[x+A]=_[A]^this._lastCipherblock[A];m(L,this._lastCipherblock,0,x,x+16)}return O};var P=function L(O){if(!(this instanceof L))throw Error("Counter must be instanitated with `new`");O===0||O||(O=1),typeof O=="number"?(this._counter=G(16),this.setValue(O)):this.setBytes(O)};P.prototype.setValue=function(L){if(typeof L!="number"||parseInt(L)!=L)throw new Error("invalid counter value (must be an integer)");if(L>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");for(var O=15;O>=0;--O)this._counter[O]=L%256,L=parseInt(L/256)},P.prototype.setBytes=function(L){if((L=F(L,!0)).length!=16)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=L},P.prototype.increment=function(){for(var L=15;L>=0;L--){if(this._counter[L]!==255){this._counter[L]++;break}this._counter[L]=0}};const R={AES:S,Counter:P,modeOfOperation:{cbc:C},utils:{hex:l,utf8:c},padding:{pkcs7:{pad:function(L){var O=16-(L=F(L,!0)).length%16,_=G(L.length+O);m(L,_);for(var x=L.length;x<_.length;x++)_[x]=O;return _},strip:function(L){if((L=F(L,!0)).length<16)throw new Error("PKCS#7 invalid length");var O=L[L.length-1];if(O>16)throw new Error("PKCS#7 padding byte out of range");for(var _=L.length-O,x=0;x<O;x++)if(L[_+x]!==O)throw new Error("PKCS#7 invalid padding byte");var A=G(_);return m(L,A,0,0,_),A}}},_arrayTest:{coerceArray:F,createArray:G,copyArray:m}}},672:(be,H,X)=>{X.r(H),X.d(H,{SERVER_PATH_V4:()=>I,TcAdapterEvents:()=>K,TcAdapterErrors:()=>F,EventsNotExposed:()=>G});var I="//playvideo.qcloud.com",K={LOADEDMETADATA:"loadedmetadata",HLSREADY:"hlsready",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",DESTROYING:"hlsDestroying",ERROR:"hlsError",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",INIT_PTS_FOUND:"hlsInitPtsFound",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_LOADING:"hlsLevelLoading",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_UPDATED:"hlsLevelUpdated",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_PARSED:"hlsManifestParsed",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_DETACHED:"hlsMediaDetached",MEDIA_DETACHING:"hlsMediaDetaching",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch"},F={0:"Playcgi request error",1:"TcAdapter can only support V4 playcgi",2:"No stream info",3:"An error occured when loading Hls.js"},G={BUFFER_APPENDED:"hlsBufferAppended",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHED:"hlsBufferFlushed",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_RESET:"hlsBufferReset",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_LOADED:"hlsFragLoaded",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_PARSED:"hlsFragParsed",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",KEY_LOADED:"hlsKeyLoaded",KEY_LOADING:"hlsKeyLoading"}},132:(be,H,X)=>{var I=X(727);Object.defineProperty(H,"__esModule",{value:!0}),H.default=void 0;var K=m(X(333)),F=X(464),G=m(X(801));function m(p){return p&&p.__esModule?p:{default:p}}function r(p,g){for(var d=0;d<g.length;d++){var E=g[d];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(p,E.key,E)}}function c(p,g,d){if(!g.has(p))throw new TypeError("attempted to get private field on non-instance");return d}function l(p,g){var d=g.get(p);if(!d)throw new TypeError("attempted to get private field on non-instance");return d.get?d.get.call(p):d.value}function e(p,g,d){var E=g.get(p);if(!E)throw new TypeError("attempted to set private field on non-instance");if(E.set)E.set.call(p,d);else{if(!E.writable)throw new TypeError("attempted to set read only private field");E.value=d}return d}var n=new WeakMap,a=new WeakMap,s=new WeakMap,u=new WeakMap,t=new WeakSet,f=new WeakSet,h=function(){function p(E,w){(function(D,b){if(!(D instanceof b))throw new TypeError("Cannot call a class as a function")})(this,p),f.add(this),t.add(this),n.set(this,{writable:!0,value:void 0}),a.set(this,{writable:!0,value:void 0}),s.set(this,{writable:!0,value:void 0}),u.set(this,{writable:!0,value:void 0}),e(this,n,(0,F.genOverlay)()),e(this,a,(0,F.genOverlay)()),e(this,s,E),e(this,u,w)}var g,d;return g=p,(d=[{key:"generateOverlayKeyAndIv",value:function(){return I.g(I.v(0,I.d(["HgQxAjEDOIE6HgMxAg8ALjoAMgwLbwt2C2ULcgtsC2ELeQtLC2ULeR8PAAYBIwwLZwtlC24LTwt2C2ULcgtsC2ELeTcZFgAXHR0yDAtvC3YLZQtyC2wLYQt5C0kLdh8PAAYBIwwLZwtlC24LTwt2C2ULcgtsC2ELeTcZFgAXHR0nKQMNCQAACh0dMyc=",[]]),[function(){return typeof Object=="undefined"?void 0:Object},function(){return F===void 0?void 0:F}])).call(this)}},{key:"generatePlayCgiUrl",value:function(E){return I.g(I.v(0,I.d(["HgQxAjEDODgeBzECMQMxBDEFMQYPACMDAA8BLiQCJSQ4LyQdDwAjAwAPAi4kAiU0OEJEHQ8AIwMADwMuJAIPAjAlSB04PB0pAw8EIwwLZAtlC2YLYQt1C2wLdDcIAAodHSkEDAtNC0kLRwtmC00LQQswC0cLQwtTC3ELRwtTC0kLYgszC0QLUQtFC0ILQQtRC1ULQQtBCzQLRwtOC0ELRAtDC0ILaQtRC0sLQgtnC1ELQwszC3ALRAtBCzcLRwtUC3gLTwt2C04LYgtYC1ILRwtNC2kLOQtRC1MLSQt6C1ELRQtJCysLRQtNC0QLMQtIC2MLVQtQC0oLUwtRC1MLRgt1C1ILawtaC2sLVwtvCzQLVgtRC0ULQwt1C1ALUgtnCy8LeAtWC2oLcQt3C1gLMQt5C1ULcgtIC1ULdgtHC1ELSgtzC0ILdwtUC1MLLws2C0wLSQtjC1ELaQtTC3cLWQtzC08LcQtmCysLOAtUC1cLeAtHC1ELTwtKC3kLVws0CzYLZwtQC1ALUQtWC3oLVAtqC04LVAtpC1ULbwtxCzQLMws1C1ELQgswC3YLMQsxC2wLTgt4C3YLSwtXC0ILUQtJC1oLTAttC2ELYwtVC1oLMgtyCzELQQtQC3QLYQs3C2kLLwtNC1kLNAtMC3gLOQtYC2wLWgtWC00LWgtOC1ULZAtVC3kLdwtJC0QLQQtRC0ELQgodHSkDDAtzC2ULdAtQC3ULYgtsC2kLYwtLC2ULeUMDBCQBHSkFDwUjAwAPBi4PBy4kAwwLYwthC2wLbB8DACkDDAtlC24LYwtyC3kLcAt0Qw8AIwMADwEuJAIkASQCCh0dKQYPBSMDAA8GLg8HLiQDDAtjC2ELbAtsHwMAKQMMC2ULbgtjC3ILeQtwC3RDDwAjAwAPAi4kAiQBJAIKHQYIIzIZDAsmC2MLaQtwC2gLZQtyC2ULZAtPC3YLZQtyC2wLYQt5C0sLZQt5Cz0MC2MLbwtuC2MLYQt0HwMFDAsmC2MLaQtwC2gLZQtyC2ULZAtPC3YLZQtyC2wLYQt5C0kLdgs9JAIMC2MLbwtuC2MLYQt0HwMGDAsmC2sLZQt5C0kLZAs9CzEkAjsXQgAdBgguJw8AIwMADwEuJAIlOB4dDwAjAwAPAi4kAiUdODEdDwgjMhkMCyYLbwt2C2ULcgtsC2ELeQtLC2ULeQs9DAtjC28LbgtjC2ELdB8PACMDAA8BLiQCDAsmC28LdgtlC3ILbAthC3kLSQt2Cz0kAgwLYwtvC24LYwthC3QfDwAjAwAPAi4kAiQBOxcdHQ8ILicpAw0JAAAKHR0zJw==",[7,986,70,840,851,855,853,866,867,872,870,982]]),[function(){return l},function(){return n===void 0?void 0:n},function(){return a===void 0?void 0:a},function(){return s===void 0?void 0:s},function(){return K===void 0?void 0:K},function(){return c},function(){return t===void 0?void 0:t},function(){return v===void 0?void 0:v},function(){return E===void 0?void 0:E}])).call(this)}},{key:"generateKey",value:function(E){return I.g(I.v(0,I.d(["HgQxAjEDOA0eCzECMQMxBDEFMQYxBzEIMQkxCikDDwAjDwEuCAEKHQYCIwMADwMuJAI5JTk4RAYdDwIjAwAPBC4kAiVJOFQ8HQ8CIwMADwUuJAIlWh04CB0pBQ8GLjoACh0dKQYPBi46AAodHSkHDwAKHR0pBxEPEBw5JYMdODwdKQgPAiMDAA8ELiQCDAtzC3ULYgtzC3QLcgtpC24LZx8DBw8CQAMHDwJADwI7JAIKHR0pCQ8CIwMADwUuJAIMC3MLdQtiC3MLdAtyC2kLbgtnHwMHDwJAAwcPAkAPAjskAgodHSkFDAtwC3ULcwtoQw8HIwMIDxAkAiQBHSkGDAtwC3ULcwtoQw8HIwMJDxAkAiQBHSkHMhEyQgFCAA8BOwodBgBCAEUdOHY4KQoPCCMMC2QLZQtmC2ELdQtsC3Q3DAttC28LZAtlC08LZgtPC3ALZQtyC2ELdAtpC28LbjcMC2MLYgtjNwMFAwYIAgodHSkEKQoMC2QLZQtjC3ILeQtwC3RDAwMkAQodHSkEESUdAwMnKQMNCQAACh0dMyc=",[7,409,88,400,129,303,404,408]]),[function(){return typeof Uint8Array=="undefined"?void 0:Uint8Array},function(){return E===void 0?void 0:E},function(){return l},function(){return u===void 0?void 0:u},function(){return n===void 0?void 0:n},function(){return a===void 0?void 0:a},function(){return typeof Array=="undefined"?void 0:Array},function(){return typeof parseInt=="undefined"?void 0:parseInt},function(){return G===void 0?void 0:G}])).call(this)}}])&&r(g.prototype,d),p}(),v=function(p){for(var g=atob(p),d="",E=0;E<g.length;E++){var w=g.charCodeAt(E).toString(16);d+=w.length===2?w:"0"+w}return d},y=h;H.default=y},95:(be,H,X)=>{X.r(H),X.d(H,{fixEvent:()=>u,off:()=>v,on:()=>h,one:()=>p,trigger:()=>y});var I=1;function K(){return I++}var F={},G="vdata"+new Date().getTime();function m(g){var d=g[G];return d||(d=g[G]=K()),F[d]||(F[d]={}),F[d]}function r(g){var d=g[G];return!!d&&!!Object.getOwnPropertyNames(F[d]).length}var c=X(579),l=X.n(c),e=X(200),n=X.n(e);function a(g,d){var E=m(g);E.handlers[d].length===0&&(delete E.handlers[d],g.removeEventListener?g.removeEventListener(d,E.dispatcher,!1):g.detachEvent&&g.detachEvent("on"+d,E.dispatcher)),Object.getOwnPropertyNames(E.handlers).length<=0&&(delete E.handlers,delete E.dispatcher,delete E.disabled),Object.getOwnPropertyNames(E).length===0&&function(w){var D=w[G];if(D){delete F[D];try{delete w[G]}catch{w.removeAttribute?w.removeAttribute(G):w[G]=null}}}(g)}function s(g,d,E,w){E.forEach(function(D){g(d,D,w)})}function u(g){function d(){return!0}function E(){return!1}if(!g||!g.isPropagationStopped){var w=g||l().event;for(var D in g={},w)D!=="layerX"&&D!=="layerY"&&D!=="keyLocation"&&D!=="webkitMovementX"&&D!=="webkitMovementY"&&(D==="returnValue"&&w.preventDefault||(g[D]=w[D]));if(g.target||(g.target=g.srcElement||n()),g.relatedTarget||(g.relatedTarget=g.fromElement===g.target?g.toElement:g.fromElement),g.preventDefault=function(){w.preventDefault&&w.preventDefault(),g.returnValue=!1,w.returnValue=!1,g.defaultPrevented=!0},g.defaultPrevented=!1,g.stopPropagation=function(){w.stopPropagation&&w.stopPropagation(),g.cancelBubble=!0,w.cancelBubble=!0,g.isPropagationStopped=d},g.isPropagationStopped=E,g.stopImmediatePropagation=function(){w.stopImmediatePropagation&&w.stopImmediatePropagation(),g.isImmediatePropagationStopped=d,g.stopPropagation()},g.isImmediatePropagationStopped=E,g.clientX!==null&&g.clientX!==void 0){var b=n().documentElement,S=n().body;g.pageX=g.clientX+(b&&b.scrollLeft||S&&S.scrollLeft||0)-(b&&b.clientLeft||S&&S.clientLeft||0),g.pageY=g.clientY+(b&&b.scrollTop||S&&S.scrollTop||0)-(b&&b.clientTop||S&&S.clientTop||0)}g.which=g.charCode||g.keyCode,g.button!==null&&g.button!==void 0&&(g.button=1&g.button?0:4&g.button?1:2&g.button?2:0)}return g}var t=!1;(function(){try{var g=Object.defineProperty({},"passive",{get:function(){t=!0}});l().addEventListener("test",null,g),l().removeEventListener("test",null,g)}catch{}})();var f=["touchstart","touchmove"];function h(g,d,E){if(Array.isArray(d))return s(h,g,d,E);var w=m(g);if(w.handlers||(w.handlers={}),w.handlers[d]||(w.handlers[d]=[]),E.guid||(E.guid=K()),w.handlers[d].push(E),w.dispatcher||(w.disabled=!1,w.dispatcher=function(b,S){if(!w.disabled){b=u(b);var C=w.handlers[b.type];if(C)for(var P=C.slice(0),R=0,L=P.length;R<L&&!b.isImmediatePropagationStopped();R++)try{P[R].call(g,b,S)}catch(O){console.error(O)}}}),w.handlers[d].length===1)if(g.addEventListener){var D=!1;t&&f.indexOf(d)>-1&&(D={passive:!0}),g.addEventListener(d,w.dispatcher,D)}else g.attachEvent&&g.attachEvent("on"+d,w.dispatcher)}function v(g,d,E){if(r(g)){var w=m(g);if(w.handlers){if(Array.isArray(d))return s(v,g,d,E);var D=function(P,R){w.handlers[R]=[],a(P,R)};if(d!==void 0){var b=w.handlers[d];if(b)if(E){if(E.guid)for(var S=0;S<b.length;S++)b[S].guid===E.guid&&b.splice(S--,1);a(g,d)}else D(g,d)}else for(var C in w.handlers)Object.prototype.hasOwnProperty.call(w.handlers||{},C)&&D(g,C)}}}function y(g,d,E){var w=r(g)?m(g):{},D=g.parentNode||g.ownerDocument;if(typeof d=="string"&&(d={type:d,target:g}),d=u(d),w.dispatcher&&w.dispatcher.call(g,d,E),D&&!d.isPropagationStopped()&&d.bubbles===!0)y.call(null,D,d,E);else if(!D&&!d.defaultPrevented){var b=m(d.target);d.target[d.type]&&(b.disabled=!0,typeof d.target[d.type]=="function"&&d.target[d.type](),b.disabled=!1)}return!d.defaultPrevented}function p(g,d,E){if(Array.isArray(d))return s(p,g,d,E);var w=function D(){v(g,d,D),E.apply(this,arguments)};w.guid=E.guid=E.guid||K(),h(g,d,w)}},464:(be,H,X)=>{var I=X(727);function K(r,c){return Math.floor(Math.random()*(c-r+1)+r)}Object.defineProperty(H,"__esModule",{value:!0}),H.base64ToHex=function(r){for(var c=atob(r),l="",e=0;e<c.length;e++){var n=c.charCodeAt(e).toString(16);l+=n.length===2?n:"0"+n}return l},H.genOverlay=function(){return I.g(I.v(0,I.d(["HgQxAjEDOAMeBzECMQMxBDEFMQYpAwwKHR0pBA8ALjoAMg8AHwwLMBcdHTIPAR8MCzEXHR0yDwIfDAsyFx0dMg8DHwwLMxcdHTIPBB8MCzQXHR0yDwUfDAs1Fx0dMg8GHwwLNhcdHTIPBx8MCzcXHR0yDwgfDAs4Fx0dMg8JHwwLORcdHTIPCh8MC2EXHR0yDwsfDAtiFx0dMg8MHwwLYxcdHTIPDR8MC2QXHR0yDw4fDAtlFx0dMg8PHwwLZhcdHQodHSkFDwAKHR0pBREPIBw5JdkdOB4dKQYPASMPAA8PJAIKHR0pAzIRKQQDBkMZOwodHSkFMhEyQgFCAA8BOwodBgBCAEUdOMwDKQMRJykDDQkAAAodHTMn",[7,273,215,269]]),[function(){return typeof Array=="undefined"?void 0:Array},function(){return K}])).call(this)},H.newGUID=G,H.loadScript=function(r,c,l){var e=arguments.length>3&&arguments[3]!==void 0&&arguments[3],n=document.createElement("script");if(n.onload=n.onreadystatechange=function(){this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(typeof c=="function"&&c(),n.onload=n.onreadystatechange=null,n.parentNode&&!e&&n.parentNode.removeChild(n))},l){for(var a in l)if(l.hasOwnProperty(a)){var s=l[a];s===null?n.removeAttribute(s):n.setAttribute(a,s)}}n.src=r,document.getElementsByTagName("head")[0].appendChild(n)},H.unifyProtocol=function(r){r=r.replace(/^(http|https):/,"");var c=window.location.protocol;return c!="http:"&&c!="https:"&&(c="https:"),r=c+r},H.getMediaSource=m,H.isSupported=function(){var r=m();if(!r)return!1;var c=window.SourceBuffer||window.WebKitSourceBuffer,l=r&&typeof r.isTypeSupported=="function"&&r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),e=!c||c.prototype&&typeof c.prototype.appendBuffer=="function"&&typeof c.prototype.remove=="function";return!!l&&!!e},H.bind=void 0;var F=1;function G(){return F++}function m(){return window.MediaSource||window.WebKitMediaSource}H.bind=function(r,c,l){c.guid||(c.guid=G());var e=function(){return c.apply(r,arguments)};return e.guid=l?l+"_"+c.guid:c.guid,e}},200:(be,H,X)=>{var I,K=X.g!==void 0?X.g:typeof window!="undefined"?window:{},F=X(533);typeof document!="undefined"?I=document:(I=K["__GLOBAL_DOCUMENT_CACHE@4"])||(I=K["__GLOBAL_DOCUMENT_CACHE@4"]=F),be.exports=I},579:(be,H,X)=>{var I;I=typeof window!="undefined"?window:X.g!==void 0?X.g:typeof self!="undefined"?self:{},be.exports=I},135:be=>{be.exports=function(X){if(!X)return!1;var I=H.call(X);return I==="[object Function]"||typeof X=="function"&&I!=="[object RegExp]"||typeof window!="undefined"&&(X===window.setTimeout||X===window.alert||X===window.confirm||X===window.prompt)};var H=Object.prototype.toString},333:(be,H,X)=>{X.r(H),X.d(H,{default:()=>Pe});function I(Q){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(Q)}function K(Q,B){return Q&B}function F(Q,B){return Q|B}function G(Q,B){return Q^B}function m(Q,B){return Q&~B}function r(Q){if(Q==0)return-1;var B=0;return(65535&Q)==0&&(Q>>=16,B+=16),(255&Q)==0&&(Q>>=8,B+=8),(15&Q)==0&&(Q>>=4,B+=4),(3&Q)==0&&(Q>>=2,B+=2),(1&Q)==0&&++B,B}function c(Q){for(var B=0;Q!=0;)Q&=Q-1,++B;return B}var l,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function n(Q){var B,W,Y="";for(B=0;B+3<=Q.length;B+=3)W=parseInt(Q.substring(B,B+3),16),Y+=e.charAt(W>>6)+e.charAt(63&W);for(B+1==Q.length?(W=parseInt(Q.substring(B,B+1),16),Y+=e.charAt(W<<2)):B+2==Q.length&&(W=parseInt(Q.substring(B,B+2),16),Y+=e.charAt(W>>2)+e.charAt((3&W)<<4));(3&Y.length)>0;)Y+="=";return Y}function a(Q){var B,W="",Y=0,$=0;for(B=0;B<Q.length&&Q.charAt(B)!="=";++B){var ie=e.indexOf(Q.charAt(B));ie<0||(Y==0?(W+=I(ie>>2),$=3&ie,Y=1):Y==1?(W+=I($<<2|ie>>4),$=15&ie,Y=2):Y==2?(W+=I($),W+=I(ie>>2),$=3&ie,Y=3):(W+=I($<<2|ie>>4),W+=I(15&ie),Y=0))}return Y==1&&(W+=I($<<2)),W}var s,u=function(Q){var B;if(l===void 0){var W="0123456789ABCDEF",Y=` \f
\r	\xA0\u2028\u2029`;for(l={},B=0;B<16;++B)l[W.charAt(B)]=B;for(W=W.toLowerCase(),B=10;B<16;++B)l[W.charAt(B)]=B;for(B=0;B<Y.length;++B)l[Y.charAt(B)]=-1}var $=[],ie=0,le=0;for(B=0;B<Q.length;++B){var ce=Q.charAt(B);if(ce=="=")break;if((ce=l[ce])!=-1){if(ce===void 0)throw new Error("Illegal character at offset "+B);ie|=ce,++le>=2?($[$.length]=ie,ie=0,le=0):ie<<=4}}if(le)throw new Error("Hex encoding incomplete: 4 bits missing");return $},t={decode:function(Q){var B;if(s===void 0){var W=`= \f
\r	\xA0\u2028\u2029`;for(s=Object.create(null),B=0;B<64;++B)s["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(B)]=B;for(s["-"]=62,s._=63,B=0;B<W.length;++B)s[W.charAt(B)]=-1}var Y=[],$=0,ie=0;for(B=0;B<Q.length;++B){var le=Q.charAt(B);if(le=="=")break;if((le=s[le])!=-1){if(le===void 0)throw new Error("Illegal character at offset "+B);$|=le,++ie>=4?(Y[Y.length]=$>>16,Y[Y.length]=$>>8&255,Y[Y.length]=255&$,$=0,ie=0):$<<=6}}switch(ie){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:Y[Y.length]=$>>10;break;case 3:Y[Y.length]=$>>16,Y[Y.length]=$>>8&255}return Y},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(Q){var B=t.re.exec(Q);if(B)if(B[1])Q=B[1];else{if(!B[2])throw new Error("RegExp out of sync");Q=B[2]}return t.decode(Q)}},f=1e13,h=function(){function Q(B){this.buf=[+B||0]}return Q.prototype.mulAdd=function(B,W){var Y,$,ie=this.buf,le=ie.length;for(Y=0;Y<le;++Y)($=ie[Y]*B+W)<f?W=0:$-=(W=0|$/f)*f,ie[Y]=$;W>0&&(ie[Y]=W)},Q.prototype.sub=function(B){var W,Y,$=this.buf,ie=$.length;for(W=0;W<ie;++W)(Y=$[W]-B)<0?(Y+=f,B=1):B=0,$[W]=Y;for(;$[$.length-1]===0;)$.pop()},Q.prototype.toString=function(B){if((B||10)!=10)throw new Error("only base 10 is supported");for(var W=this.buf,Y=W[W.length-1].toString(),$=W.length-2;$>=0;--$)Y+=(f+W[$]).toString().substring(1);return Y},Q.prototype.valueOf=function(){for(var B=this.buf,W=0,Y=B.length-1;Y>=0;--Y)W=W*f+B[Y];return W},Q.prototype.simplify=function(){var B=this.buf;return B.length==1?B[0]:this},Q}(),v=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,y=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function p(Q,B){return Q.length>B&&(Q=Q.substring(0,B)+"\u2026"),Q}var g,d=function(){function Q(B,W){this.hexDigits="0123456789ABCDEF",B instanceof Q?(this.enc=B.enc,this.pos=B.pos):(this.enc=B,this.pos=W)}return Q.prototype.get=function(B){if(B===void 0&&(B=this.pos++),B>=this.enc.length)throw new Error("Requesting byte offset "+B+" on a stream of length "+this.enc.length);return typeof this.enc=="string"?this.enc.charCodeAt(B):this.enc[B]},Q.prototype.hexByte=function(B){return this.hexDigits.charAt(B>>4&15)+this.hexDigits.charAt(15&B)},Q.prototype.hexDump=function(B,W,Y){for(var $="",ie=B;ie<W;++ie)if($+=this.hexByte(this.get(ie)),Y!==!0)switch(15&ie){case 7:$+="  ";break;case 15:$+=`
`;break;default:$+=" "}return $},Q.prototype.isASCII=function(B,W){for(var Y=B;Y<W;++Y){var $=this.get(Y);if($<32||$>176)return!1}return!0},Q.prototype.parseStringISO=function(B,W){for(var Y="",$=B;$<W;++$)Y+=String.fromCharCode(this.get($));return Y},Q.prototype.parseStringUTF=function(B,W){for(var Y="",$=B;$<W;){var ie=this.get($++);Y+=ie<128?String.fromCharCode(ie):ie>191&&ie<224?String.fromCharCode((31&ie)<<6|63&this.get($++)):String.fromCharCode((15&ie)<<12|(63&this.get($++))<<6|63&this.get($++))}return Y},Q.prototype.parseStringBMP=function(B,W){for(var Y,$,ie="",le=B;le<W;)Y=this.get(le++),$=this.get(le++),ie+=String.fromCharCode(Y<<8|$);return ie},Q.prototype.parseTime=function(B,W,Y){var $=this.parseStringISO(B,W),ie=(Y?v:y).exec($);return ie?(Y&&(ie[1]=+ie[1],ie[1]+=+ie[1]<70?2e3:1900),$=ie[1]+"-"+ie[2]+"-"+ie[3]+" "+ie[4],ie[5]&&($+=":"+ie[5],ie[6]&&($+=":"+ie[6],ie[7]&&($+="."+ie[7]))),ie[8]&&($+=" UTC",ie[8]!="Z"&&($+=ie[8],ie[9]&&($+=":"+ie[9]))),$):"Unrecognized time: "+$},Q.prototype.parseInteger=function(B,W){for(var Y,$=this.get(B),ie=$>127,le=ie?255:0,ce="";$==le&&++B<W;)$=this.get(B);if((Y=W-B)==0)return ie?-1:0;if(Y>4){for(ce=$,Y<<=3;(128&(+ce^le))==0;)ce=+ce<<1,--Y;ce="("+Y+` bit)
`}ie&&($-=256);for(var xe=new h($),Oe=B+1;Oe<W;++Oe)xe.mulAdd(256,this.get(Oe));return ce+xe.toString()},Q.prototype.parseBitString=function(B,W,Y){for(var $=this.get(B),ie="("+((W-B-1<<3)-$)+` bit)
`,le="",ce=B+1;ce<W;++ce){for(var xe=this.get(ce),Oe=ce==W-1?$:0,ke=7;ke>=Oe;--ke)le+=xe>>ke&1?"1":"0";if(le.length>Y)return ie+p(le,Y)}return ie+le},Q.prototype.parseOctetString=function(B,W,Y){if(this.isASCII(B,W))return p(this.parseStringISO(B,W),Y);var $=W-B,ie="("+$+` byte)
`;$>(Y/=2)&&(W=B+Y);for(var le=B;le<W;++le)ie+=this.hexByte(this.get(le));return $>Y&&(ie+="\u2026"),ie},Q.prototype.parseOID=function(B,W,Y){for(var $="",ie=new h,le=0,ce=B;ce<W;++ce){var xe=this.get(ce);if(ie.mulAdd(128,127&xe),le+=7,!(128&xe)){if($==="")if((ie=ie.simplify())instanceof h)ie.sub(80),$="2."+ie.toString();else{var Oe=ie<80?ie<40?0:1:2;$=Oe+"."+(ie-40*Oe)}else $+="."+ie.toString();if($.length>Y)return p($,Y);ie=new h,le=0}}return le>0&&($+=".incomplete"),$},Q}(),E=function(){function Q(B,W,Y,$,ie){if(!($ instanceof w))throw new Error("Invalid tag value.");this.stream=B,this.header=W,this.length=Y,this.tag=$,this.sub=ie}return Q.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},Q.prototype.content=function(B){if(this.tag===void 0)return null;B===void 0&&(B=1/0);var W=this.posContent(),Y=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(W,W+Y,B);switch(this.tag.tagNumber){case 1:return this.stream.get(W)===0?"false":"true";case 2:return this.stream.parseInteger(W,W+Y);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(W,W+Y,B);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(W,W+Y,B);case 6:return this.stream.parseOID(W,W+Y,B);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return p(this.stream.parseStringUTF(W,W+Y),B);case 18:case 19:case 20:case 21:case 22:case 26:return p(this.stream.parseStringISO(W,W+Y),B);case 30:return p(this.stream.parseStringBMP(W,W+Y),B);case 23:case 24:return this.stream.parseTime(W,W+Y,this.tag.tagNumber==23)}return null},Q.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"},Q.prototype.toPrettyString=function(B){B===void 0&&(B="");var W=B+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(W+="+"),W+=this.length,this.tag.tagConstructed?W+=" (constructed)":!this.tag.isUniversal()||this.tag.tagNumber!=3&&this.tag.tagNumber!=4||this.sub===null||(W+=" (encapsulates)"),W+=`
`,this.sub!==null){B+="  ";for(var Y=0,$=this.sub.length;Y<$;++Y)W+=this.sub[Y].toPrettyString(B)}return W},Q.prototype.posStart=function(){return this.stream.pos},Q.prototype.posContent=function(){return this.stream.pos+this.header},Q.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},Q.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},Q.decodeLength=function(B){var W=B.get(),Y=127&W;if(Y==W)return Y;if(Y>6)throw new Error("Length over 48 bits not supported at position "+(B.pos-1));if(Y===0)return null;W=0;for(var $=0;$<Y;++$)W=256*W+B.get();return W},Q.prototype.getHexStringValue=function(){var B=this.toHexString(),W=2*this.header,Y=2*this.length;return B.substr(W,Y)},Q.decode=function(B){var W;W=B instanceof d?B:new d(B,0);var Y=new d(W),$=new w(W),ie=Q.decodeLength(W),le=W.pos,ce=le-Y.pos,xe=null,Oe=function(){var Ue=[];if(ie!==null){for(var Ne=le+ie;W.pos<Ne;)Ue[Ue.length]=Q.decode(W);if(W.pos!=Ne)throw new Error("Content size is not correct for container starting at offset "+le)}else try{for(;;){var We=Q.decode(W);if(We.tag.isEOC())break;Ue[Ue.length]=We}ie=le-W.pos}catch(Ke){throw new Error("Exception while decoding undefined length content: "+Ke)}return Ue};if($.tagConstructed)xe=Oe();else if($.isUniversal()&&($.tagNumber==3||$.tagNumber==4))try{if($.tagNumber==3&&W.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");xe=Oe();for(var ke=0;ke<xe.length;++ke)if(xe[ke].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{xe=null}if(xe===null){if(ie===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+le);W.pos=le+Math.abs(ie)}return new Q(Y,ce,ie,$,xe)},Q}(),w=function(){function Q(B){var W=B.get();if(this.tagClass=W>>6,this.tagConstructed=(32&W)!=0,this.tagNumber=31&W,this.tagNumber==31){var Y=new h;do W=B.get(),Y.mulAdd(128,127&W);while(128&W);this.tagNumber=Y.simplify()}}return Q.prototype.isUniversal=function(){return this.tagClass===0},Q.prototype.isEOC=function(){return this.tagClass===0&&this.tagNumber===0},Q}(),D=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],b=(1<<26)/D[D.length-1],S=function(){function Q(B,W,Y){B!=null&&(typeof B=="number"?this.fromNumber(B,W,Y):W==null&&typeof B!="string"?this.fromString(B,256):this.fromString(B,W))}return Q.prototype.toString=function(B){if(this.s<0)return"-"+this.negate().toString(B);var W;if(B==16)W=4;else if(B==8)W=3;else if(B==2)W=1;else if(B==32)W=5;else{if(B!=4)return this.toRadix(B);W=2}var Y,$=(1<<W)-1,ie=!1,le="",ce=this.t,xe=this.DB-ce*this.DB%W;if(ce-- >0)for(xe<this.DB&&(Y=this[ce]>>xe)>0&&(ie=!0,le=I(Y));ce>=0;)xe<W?(Y=(this[ce]&(1<<xe)-1)<<W-xe,Y|=this[--ce]>>(xe+=this.DB-W)):(Y=this[ce]>>(xe-=W)&$,xe<=0&&(xe+=this.DB,--ce)),Y>0&&(ie=!0),ie&&(le+=I(Y));return ie?le:"0"},Q.prototype.negate=function(){var B=O();return Q.ZERO.subTo(this,B),B},Q.prototype.abs=function(){return this.s<0?this.negate():this},Q.prototype.compareTo=function(B){var W=this.s-B.s;if(W!=0)return W;var Y=this.t;if((W=Y-B.t)!=0)return this.s<0?-W:W;for(;--Y>=0;)if((W=this[Y]-B[Y])!=0)return W;return 0},Q.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+j(this[this.t-1]^this.s&this.DM)},Q.prototype.mod=function(B){var W=O();return this.abs().divRemTo(B,null,W),this.s<0&&W.compareTo(Q.ZERO)>0&&B.subTo(W,W),W},Q.prototype.modPowInt=function(B,W){var Y;return Y=B<256||W.isEven()?new P(W):new R(W),this.exp(B,Y)},Q.prototype.clone=function(){var B=O();return this.copyTo(B),B},Q.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},Q.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},Q.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},Q.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},Q.prototype.toByteArray=function(){var B=this.t,W=[];W[0]=this.s;var Y,$=this.DB-B*this.DB%8,ie=0;if(B-- >0)for($<this.DB&&(Y=this[B]>>$)!=(this.s&this.DM)>>$&&(W[ie++]=Y|this.s<<this.DB-$);B>=0;)$<8?(Y=(this[B]&(1<<$)-1)<<8-$,Y|=this[--B]>>($+=this.DB-8)):(Y=this[B]>>($-=8)&255,$<=0&&($+=this.DB,--B)),(128&Y)!=0&&(Y|=-256),ie==0&&(128&this.s)!=(128&Y)&&++ie,(ie>0||Y!=this.s)&&(W[ie++]=Y);return W},Q.prototype.equals=function(B){return this.compareTo(B)==0},Q.prototype.min=function(B){return this.compareTo(B)<0?this:B},Q.prototype.max=function(B){return this.compareTo(B)>0?this:B},Q.prototype.and=function(B){var W=O();return this.bitwiseTo(B,K,W),W},Q.prototype.or=function(B){var W=O();return this.bitwiseTo(B,F,W),W},Q.prototype.xor=function(B){var W=O();return this.bitwiseTo(B,G,W),W},Q.prototype.andNot=function(B){var W=O();return this.bitwiseTo(B,m,W),W},Q.prototype.not=function(){for(var B=O(),W=0;W<this.t;++W)B[W]=this.DM&~this[W];return B.t=this.t,B.s=~this.s,B},Q.prototype.shiftLeft=function(B){var W=O();return B<0?this.rShiftTo(-B,W):this.lShiftTo(B,W),W},Q.prototype.shiftRight=function(B){var W=O();return B<0?this.lShiftTo(-B,W):this.rShiftTo(B,W),W},Q.prototype.getLowestSetBit=function(){for(var B=0;B<this.t;++B)if(this[B]!=0)return B*this.DB+r(this[B]);return this.s<0?this.t*this.DB:-1},Q.prototype.bitCount=function(){for(var B=0,W=this.s&this.DM,Y=0;Y<this.t;++Y)B+=c(this[Y]^W);return B},Q.prototype.testBit=function(B){var W=Math.floor(B/this.DB);return W>=this.t?this.s!=0:(this[W]&1<<B%this.DB)!=0},Q.prototype.setBit=function(B){return this.changeBit(B,F)},Q.prototype.clearBit=function(B){return this.changeBit(B,m)},Q.prototype.flipBit=function(B){return this.changeBit(B,G)},Q.prototype.add=function(B){var W=O();return this.addTo(B,W),W},Q.prototype.subtract=function(B){var W=O();return this.subTo(B,W),W},Q.prototype.multiply=function(B){var W=O();return this.multiplyTo(B,W),W},Q.prototype.divide=function(B){var W=O();return this.divRemTo(B,W,null),W},Q.prototype.remainder=function(B){var W=O();return this.divRemTo(B,null,W),W},Q.prototype.divideAndRemainder=function(B){var W=O(),Y=O();return this.divRemTo(B,W,Y),[W,Y]},Q.prototype.modPow=function(B,W){var Y,$,ie=B.bitLength(),le=U(1);if(ie<=0)return le;Y=ie<18?1:ie<48?3:ie<144?4:ie<768?5:6,$=ie<8?new P(W):W.isEven()?new L(W):new R(W);var ce=[],xe=3,Oe=Y-1,ke=(1<<Y)-1;if(ce[1]=$.convert(this),Y>1){var Ue=O();for($.sqrTo(ce[1],Ue);xe<=ke;)ce[xe]=O(),$.mulTo(Ue,ce[xe-2],ce[xe]),xe+=2}var Ne,We,Ke=B.t-1,Qe=!0,Ge=O();for(ie=j(B[Ke])-1;Ke>=0;){for(ie>=Oe?Ne=B[Ke]>>ie-Oe&ke:(Ne=(B[Ke]&(1<<ie+1)-1)<<Oe-ie,Ke>0&&(Ne|=B[Ke-1]>>this.DB+ie-Oe)),xe=Y;(1&Ne)==0;)Ne>>=1,--xe;if((ie-=xe)<0&&(ie+=this.DB,--Ke),Qe)ce[Ne].copyTo(le),Qe=!1;else{for(;xe>1;)$.sqrTo(le,Ge),$.sqrTo(Ge,le),xe-=2;xe>0?$.sqrTo(le,Ge):(We=le,le=Ge,Ge=We),$.mulTo(Ge,ce[Ne],le)}for(;Ke>=0&&(B[Ke]&1<<ie)==0;)$.sqrTo(le,Ge),We=le,le=Ge,Ge=We,--ie<0&&(ie=this.DB-1,--Ke)}return $.revert(le)},Q.prototype.modInverse=function(B){var W=B.isEven();if(this.isEven()&&W||B.signum()==0)return Q.ZERO;for(var Y=B.clone(),$=this.clone(),ie=U(1),le=U(0),ce=U(0),xe=U(1);Y.signum()!=0;){for(;Y.isEven();)Y.rShiftTo(1,Y),W?(ie.isEven()&&le.isEven()||(ie.addTo(this,ie),le.subTo(B,le)),ie.rShiftTo(1,ie)):le.isEven()||le.subTo(B,le),le.rShiftTo(1,le);for(;$.isEven();)$.rShiftTo(1,$),W?(ce.isEven()&&xe.isEven()||(ce.addTo(this,ce),xe.subTo(B,xe)),ce.rShiftTo(1,ce)):xe.isEven()||xe.subTo(B,xe),xe.rShiftTo(1,xe);Y.compareTo($)>=0?(Y.subTo($,Y),W&&ie.subTo(ce,ie),le.subTo(xe,le)):($.subTo(Y,$),W&&ce.subTo(ie,ce),xe.subTo(le,xe))}return $.compareTo(Q.ONE)!=0?Q.ZERO:xe.compareTo(B)>=0?xe.subtract(B):xe.signum()<0?(xe.addTo(B,xe),xe.signum()<0?xe.add(B):xe):xe},Q.prototype.pow=function(B){return this.exp(B,new C)},Q.prototype.gcd=function(B){var W=this.s<0?this.negate():this.clone(),Y=B.s<0?B.negate():B.clone();if(W.compareTo(Y)<0){var $=W;W=Y,Y=$}var ie=W.getLowestSetBit(),le=Y.getLowestSetBit();if(le<0)return W;for(ie<le&&(le=ie),le>0&&(W.rShiftTo(le,W),Y.rShiftTo(le,Y));W.signum()>0;)(ie=W.getLowestSetBit())>0&&W.rShiftTo(ie,W),(ie=Y.getLowestSetBit())>0&&Y.rShiftTo(ie,Y),W.compareTo(Y)>=0?(W.subTo(Y,W),W.rShiftTo(1,W)):(Y.subTo(W,Y),Y.rShiftTo(1,Y));return le>0&&Y.lShiftTo(le,Y),Y},Q.prototype.isProbablePrime=function(B){var W,Y=this.abs();if(Y.t==1&&Y[0]<=D[D.length-1]){for(W=0;W<D.length;++W)if(Y[0]==D[W])return!0;return!1}if(Y.isEven())return!1;for(W=1;W<D.length;){for(var $=D[W],ie=W+1;ie<D.length&&$<b;)$*=D[ie++];for($=Y.modInt($);W<ie;)if($%D[W++]==0)return!1}return Y.millerRabin(B)},Q.prototype.copyTo=function(B){for(var W=this.t-1;W>=0;--W)B[W]=this[W];B.t=this.t,B.s=this.s},Q.prototype.fromInt=function(B){this.t=1,this.s=B<0?-1:0,B>0?this[0]=B:B<-1?this[0]=B+this.DV:this.t=0},Q.prototype.fromString=function(B,W){var Y;if(W==16)Y=4;else if(W==8)Y=3;else if(W==256)Y=8;else if(W==2)Y=1;else if(W==32)Y=5;else{if(W!=4)return void this.fromRadix(B,W);Y=2}this.t=0,this.s=0;for(var $=B.length,ie=!1,le=0;--$>=0;){var ce=Y==8?255&+B[$]:N(B,$);ce<0?B.charAt($)=="-"&&(ie=!0):(ie=!1,le==0?this[this.t++]=ce:le+Y>this.DB?(this[this.t-1]|=(ce&(1<<this.DB-le)-1)<<le,this[this.t++]=ce>>this.DB-le):this[this.t-1]|=ce<<le,(le+=Y)>=this.DB&&(le-=this.DB))}Y==8&&(128&+B[0])!=0&&(this.s=-1,le>0&&(this[this.t-1]|=(1<<this.DB-le)-1<<le)),this.clamp(),ie&&Q.ZERO.subTo(this,this)},Q.prototype.clamp=function(){for(var B=this.s&this.DM;this.t>0&&this[this.t-1]==B;)--this.t},Q.prototype.dlShiftTo=function(B,W){var Y;for(Y=this.t-1;Y>=0;--Y)W[Y+B]=this[Y];for(Y=B-1;Y>=0;--Y)W[Y]=0;W.t=this.t+B,W.s=this.s},Q.prototype.drShiftTo=function(B,W){for(var Y=B;Y<this.t;++Y)W[Y-B]=this[Y];W.t=Math.max(this.t-B,0),W.s=this.s},Q.prototype.lShiftTo=function(B,W){for(var Y=B%this.DB,$=this.DB-Y,ie=(1<<$)-1,le=Math.floor(B/this.DB),ce=this.s<<Y&this.DM,xe=this.t-1;xe>=0;--xe)W[xe+le+1]=this[xe]>>$|ce,ce=(this[xe]&ie)<<Y;for(xe=le-1;xe>=0;--xe)W[xe]=0;W[le]=ce,W.t=this.t+le+1,W.s=this.s,W.clamp()},Q.prototype.rShiftTo=function(B,W){W.s=this.s;var Y=Math.floor(B/this.DB);if(Y>=this.t)W.t=0;else{var $=B%this.DB,ie=this.DB-$,le=(1<<$)-1;W[0]=this[Y]>>$;for(var ce=Y+1;ce<this.t;++ce)W[ce-Y-1]|=(this[ce]&le)<<ie,W[ce-Y]=this[ce]>>$;$>0&&(W[this.t-Y-1]|=(this.s&le)<<ie),W.t=this.t-Y,W.clamp()}},Q.prototype.subTo=function(B,W){for(var Y=0,$=0,ie=Math.min(B.t,this.t);Y<ie;)$+=this[Y]-B[Y],W[Y++]=$&this.DM,$>>=this.DB;if(B.t<this.t){for($-=B.s;Y<this.t;)$+=this[Y],W[Y++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;Y<B.t;)$-=B[Y],W[Y++]=$&this.DM,$>>=this.DB;$-=B.s}W.s=$<0?-1:0,$<-1?W[Y++]=this.DV+$:$>0&&(W[Y++]=$),W.t=Y,W.clamp()},Q.prototype.multiplyTo=function(B,W){var Y=this.abs(),$=B.abs(),ie=Y.t;for(W.t=ie+$.t;--ie>=0;)W[ie]=0;for(ie=0;ie<$.t;++ie)W[ie+Y.t]=Y.am(0,$[ie],W,ie,0,Y.t);W.s=0,W.clamp(),this.s!=B.s&&Q.ZERO.subTo(W,W)},Q.prototype.squareTo=function(B){for(var W=this.abs(),Y=B.t=2*W.t;--Y>=0;)B[Y]=0;for(Y=0;Y<W.t-1;++Y){var $=W.am(Y,W[Y],B,2*Y,0,1);(B[Y+W.t]+=W.am(Y+1,2*W[Y],B,2*Y+1,$,W.t-Y-1))>=W.DV&&(B[Y+W.t]-=W.DV,B[Y+W.t+1]=1)}B.t>0&&(B[B.t-1]+=W.am(Y,W[Y],B,2*Y,0,1)),B.s=0,B.clamp()},Q.prototype.divRemTo=function(B,W,Y){var $=B.abs();if(!($.t<=0)){var ie=this.abs();if(ie.t<$.t)return W!=null&&W.fromInt(0),void(Y!=null&&this.copyTo(Y));Y==null&&(Y=O());var le=O(),ce=this.s,xe=B.s,Oe=this.DB-j($[$.t-1]);Oe>0?($.lShiftTo(Oe,le),ie.lShiftTo(Oe,Y)):($.copyTo(le),ie.copyTo(Y));var ke=le.t,Ue=le[ke-1];if(Ue!=0){var Ne=Ue*(1<<this.F1)+(ke>1?le[ke-2]>>this.F2:0),We=this.FV/Ne,Ke=(1<<this.F1)/Ne,Qe=1<<this.F2,Ge=Y.t,qe=Ge-ke,Ye=W==null?O():W;for(le.dlShiftTo(qe,Ye),Y.compareTo(Ye)>=0&&(Y[Y.t++]=1,Y.subTo(Ye,Y)),Q.ONE.dlShiftTo(ke,Ye),Ye.subTo(le,le);le.t<ke;)le[le.t++]=0;for(;--qe>=0;){var ze=Y[--Ge]==Ue?this.DM:Math.floor(Y[Ge]*We+(Y[Ge-1]+Qe)*Ke);if((Y[Ge]+=le.am(0,ze,Y,qe,0,ke))<ze)for(le.dlShiftTo(qe,Ye),Y.subTo(Ye,Y);Y[Ge]<--ze;)Y.subTo(Ye,Y)}W!=null&&(Y.drShiftTo(ke,W),ce!=xe&&Q.ZERO.subTo(W,W)),Y.t=ke,Y.clamp(),Oe>0&&Y.rShiftTo(Oe,Y),ce<0&&Q.ZERO.subTo(Y,Y)}}},Q.prototype.invDigit=function(){if(this.t<1)return 0;var B=this[0];if((1&B)==0)return 0;var W=3&B;return(W=(W=(W=(W=W*(2-(15&B)*W)&15)*(2-(255&B)*W)&255)*(2-((65535&B)*W&65535))&65535)*(2-B*W%this.DV)%this.DV)>0?this.DV-W:-W},Q.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},Q.prototype.exp=function(B,W){if(B>4294967295||B<1)return Q.ONE;var Y=O(),$=O(),ie=W.convert(this),le=j(B)-1;for(ie.copyTo(Y);--le>=0;)if(W.sqrTo(Y,$),(B&1<<le)>0)W.mulTo($,ie,Y);else{var ce=Y;Y=$,$=ce}return W.revert(Y)},Q.prototype.chunkSize=function(B){return Math.floor(Math.LN2*this.DB/Math.log(B))},Q.prototype.toRadix=function(B){if(B==null&&(B=10),this.signum()==0||B<2||B>36)return"0";var W=this.chunkSize(B),Y=Math.pow(B,W),$=U(Y),ie=O(),le=O(),ce="";for(this.divRemTo($,ie,le);ie.signum()>0;)ce=(Y+le.intValue()).toString(B).substr(1)+ce,ie.divRemTo($,ie,le);return le.intValue().toString(B)+ce},Q.prototype.fromRadix=function(B,W){this.fromInt(0),W==null&&(W=10);for(var Y=this.chunkSize(W),$=Math.pow(W,Y),ie=!1,le=0,ce=0,xe=0;xe<B.length;++xe){var Oe=N(B,xe);Oe<0?B.charAt(xe)=="-"&&this.signum()==0&&(ie=!0):(ce=W*ce+Oe,++le>=Y&&(this.dMultiply($),this.dAddOffset(ce,0),le=0,ce=0))}le>0&&(this.dMultiply(Math.pow(W,le)),this.dAddOffset(ce,0)),ie&&Q.ZERO.subTo(this,this)},Q.prototype.fromNumber=function(B,W,Y){if(typeof W=="number")if(B<2)this.fromInt(1);else for(this.fromNumber(B,Y),this.testBit(B-1)||this.bitwiseTo(Q.ONE.shiftLeft(B-1),F,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(W);)this.dAddOffset(2,0),this.bitLength()>B&&this.subTo(Q.ONE.shiftLeft(B-1),this);else{var $=[],ie=7&B;$.length=1+(B>>3),W.nextBytes($),ie>0?$[0]&=(1<<ie)-1:$[0]=0,this.fromString($,256)}},Q.prototype.bitwiseTo=function(B,W,Y){var $,ie,le=Math.min(B.t,this.t);for($=0;$<le;++$)Y[$]=W(this[$],B[$]);if(B.t<this.t){for(ie=B.s&this.DM,$=le;$<this.t;++$)Y[$]=W(this[$],ie);Y.t=this.t}else{for(ie=this.s&this.DM,$=le;$<B.t;++$)Y[$]=W(ie,B[$]);Y.t=B.t}Y.s=W(this.s,B.s),Y.clamp()},Q.prototype.changeBit=function(B,W){var Y=Q.ONE.shiftLeft(B);return this.bitwiseTo(Y,W,Y),Y},Q.prototype.addTo=function(B,W){for(var Y=0,$=0,ie=Math.min(B.t,this.t);Y<ie;)$+=this[Y]+B[Y],W[Y++]=$&this.DM,$>>=this.DB;if(B.t<this.t){for($+=B.s;Y<this.t;)$+=this[Y],W[Y++]=$&this.DM,$>>=this.DB;$+=this.s}else{for($+=this.s;Y<B.t;)$+=B[Y],W[Y++]=$&this.DM,$>>=this.DB;$+=B.s}W.s=$<0?-1:0,$>0?W[Y++]=$:$<-1&&(W[Y++]=this.DV+$),W.t=Y,W.clamp()},Q.prototype.dMultiply=function(B){this[this.t]=this.am(0,B-1,this,0,0,this.t),++this.t,this.clamp()},Q.prototype.dAddOffset=function(B,W){if(B!=0){for(;this.t<=W;)this[this.t++]=0;for(this[W]+=B;this[W]>=this.DV;)this[W]-=this.DV,++W>=this.t&&(this[this.t++]=0),++this[W]}},Q.prototype.multiplyLowerTo=function(B,W,Y){var $=Math.min(this.t+B.t,W);for(Y.s=0,Y.t=$;$>0;)Y[--$]=0;for(var ie=Y.t-this.t;$<ie;++$)Y[$+this.t]=this.am(0,B[$],Y,$,0,this.t);for(ie=Math.min(B.t,W);$<ie;++$)this.am(0,B[$],Y,$,0,W-$);Y.clamp()},Q.prototype.multiplyUpperTo=function(B,W,Y){--W;var $=Y.t=this.t+B.t-W;for(Y.s=0;--$>=0;)Y[$]=0;for($=Math.max(W-this.t,0);$<B.t;++$)Y[this.t+$-W]=this.am(W-$,B[$],Y,0,0,this.t+$-W);Y.clamp(),Y.drShiftTo(1,Y)},Q.prototype.modInt=function(B){if(B<=0)return 0;var W=this.DV%B,Y=this.s<0?B-1:0;if(this.t>0)if(W==0)Y=this[0]%B;else for(var $=this.t-1;$>=0;--$)Y=(W*Y+this[$])%B;return Y},Q.prototype.millerRabin=function(B){var W=this.subtract(Q.ONE),Y=W.getLowestSetBit();if(Y<=0)return!1;var $=W.shiftRight(Y);(B=B+1>>1)>D.length&&(B=D.length);for(var ie=O(),le=0;le<B;++le){ie.fromInt(D[Math.floor(Math.random()*D.length)]);var ce=ie.modPow($,this);if(ce.compareTo(Q.ONE)!=0&&ce.compareTo(W)!=0){for(var xe=1;xe++<Y&&ce.compareTo(W)!=0;)if((ce=ce.modPowInt(2,this)).compareTo(Q.ONE)==0)return!1;if(ce.compareTo(W)!=0)return!1}}return!0},Q.prototype.square=function(){var B=O();return this.squareTo(B),B},Q.prototype.gcda=function(B,W){var Y=this.s<0?this.negate():this.clone(),$=B.s<0?B.negate():B.clone();if(Y.compareTo($)<0){var ie=Y;Y=$,$=ie}var le=Y.getLowestSetBit(),ce=$.getLowestSetBit();if(ce<0)W(Y);else{le<ce&&(ce=le),ce>0&&(Y.rShiftTo(ce,Y),$.rShiftTo(ce,$));var xe=function(){(le=Y.getLowestSetBit())>0&&Y.rShiftTo(le,Y),(le=$.getLowestSetBit())>0&&$.rShiftTo(le,$),Y.compareTo($)>=0?(Y.subTo($,Y),Y.rShiftTo(1,Y)):($.subTo(Y,$),$.rShiftTo(1,$)),Y.signum()>0?setTimeout(xe,0):(ce>0&&$.lShiftTo(ce,$),setTimeout(function(){W($)},0))};setTimeout(xe,10)}},Q.prototype.fromNumberAsync=function(B,W,Y,$){if(typeof W=="number")if(B<2)this.fromInt(1);else{this.fromNumber(B,Y),this.testBit(B-1)||this.bitwiseTo(Q.ONE.shiftLeft(B-1),F,this),this.isEven()&&this.dAddOffset(1,0);var ie=this,le=function(){ie.dAddOffset(2,0),ie.bitLength()>B&&ie.subTo(Q.ONE.shiftLeft(B-1),ie),ie.isProbablePrime(W)?setTimeout(function(){$()},0):setTimeout(le,0)};setTimeout(le,0)}else{var ce=[],xe=7&B;ce.length=1+(B>>3),W.nextBytes(ce),xe>0?ce[0]&=(1<<xe)-1:ce[0]=0,this.fromString(ce,256)}},Q}(),C=function(){function Q(){}return Q.prototype.convert=function(B){return B},Q.prototype.revert=function(B){return B},Q.prototype.mulTo=function(B,W,Y){B.multiplyTo(W,Y)},Q.prototype.sqrTo=function(B,W){B.squareTo(W)},Q}(),P=function(){function Q(B){this.m=B}return Q.prototype.convert=function(B){return B.s<0||B.compareTo(this.m)>=0?B.mod(this.m):B},Q.prototype.revert=function(B){return B},Q.prototype.reduce=function(B){B.divRemTo(this.m,null,B)},Q.prototype.mulTo=function(B,W,Y){B.multiplyTo(W,Y),this.reduce(Y)},Q.prototype.sqrTo=function(B,W){B.squareTo(W),this.reduce(W)},Q}(),R=function(){function Q(B){this.m=B,this.mp=B.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<B.DB-15)-1,this.mt2=2*B.t}return Q.prototype.convert=function(B){var W=O();return B.abs().dlShiftTo(this.m.t,W),W.divRemTo(this.m,null,W),B.s<0&&W.compareTo(S.ZERO)>0&&this.m.subTo(W,W),W},Q.prototype.revert=function(B){var W=O();return B.copyTo(W),this.reduce(W),W},Q.prototype.reduce=function(B){for(;B.t<=this.mt2;)B[B.t++]=0;for(var W=0;W<this.m.t;++W){var Y=32767&B[W],$=Y*this.mpl+((Y*this.mph+(B[W]>>15)*this.mpl&this.um)<<15)&B.DM;for(B[Y=W+this.m.t]+=this.m.am(0,$,B,W,0,this.m.t);B[Y]>=B.DV;)B[Y]-=B.DV,B[++Y]++}B.clamp(),B.drShiftTo(this.m.t,B),B.compareTo(this.m)>=0&&B.subTo(this.m,B)},Q.prototype.mulTo=function(B,W,Y){B.multiplyTo(W,Y),this.reduce(Y)},Q.prototype.sqrTo=function(B,W){B.squareTo(W),this.reduce(W)},Q}(),L=function(){function Q(B){this.m=B,this.r2=O(),this.q3=O(),S.ONE.dlShiftTo(2*B.t,this.r2),this.mu=this.r2.divide(B)}return Q.prototype.convert=function(B){if(B.s<0||B.t>2*this.m.t)return B.mod(this.m);if(B.compareTo(this.m)<0)return B;var W=O();return B.copyTo(W),this.reduce(W),W},Q.prototype.revert=function(B){return B},Q.prototype.reduce=function(B){for(B.drShiftTo(this.m.t-1,this.r2),B.t>this.m.t+1&&(B.t=this.m.t+1,B.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);B.compareTo(this.r2)<0;)B.dAddOffset(1,this.m.t+1);for(B.subTo(this.r2,B);B.compareTo(this.m)>=0;)B.subTo(this.m,B)},Q.prototype.mulTo=function(B,W,Y){B.multiplyTo(W,Y),this.reduce(Y)},Q.prototype.sqrTo=function(B,W){B.squareTo(W),this.reduce(W)},Q}();function O(){return new S(null)}function _(Q,B){return new S(Q,B)}var x=typeof navigator!="undefined";x&&navigator.appName=="Microsoft Internet Explorer"?(S.prototype.am=function(Q,B,W,Y,$,ie){for(var le=32767&B,ce=B>>15;--ie>=0;){var xe=32767&this[Q],Oe=this[Q++]>>15,ke=ce*xe+Oe*le;$=((xe=le*xe+((32767&ke)<<15)+W[Y]+(1073741823&$))>>>30)+(ke>>>15)+ce*Oe+($>>>30),W[Y++]=1073741823&xe}return $},g=30):x&&navigator.appName!="Netscape"?(S.prototype.am=function(Q,B,W,Y,$,ie){for(;--ie>=0;){var le=B*this[Q++]+W[Y]+$;$=Math.floor(le/67108864),W[Y++]=67108863&le}return $},g=26):(S.prototype.am=function(Q,B,W,Y,$,ie){for(var le=16383&B,ce=B>>14;--ie>=0;){var xe=16383&this[Q],Oe=this[Q++]>>14,ke=ce*xe+Oe*le;$=((xe=le*xe+((16383&ke)<<14)+W[Y]+$)>>28)+(ke>>14)+ce*Oe,W[Y++]=268435455&xe}return $},g=28),S.prototype.DB=g,S.prototype.DM=(1<<g)-1,S.prototype.DV=1<<g,S.prototype.FV=Math.pow(2,52),S.prototype.F1=52-g,S.prototype.F2=2*g-52;var A,k,M=[];for(A="0".charCodeAt(0),k=0;k<=9;++k)M[A++]=k;for(A="a".charCodeAt(0),k=10;k<36;++k)M[A++]=k;for(A="A".charCodeAt(0),k=10;k<36;++k)M[A++]=k;function N(Q,B){var W=M[Q.charCodeAt(B)];return W==null?-1:W}function U(Q){var B=O();return B.fromInt(Q),B}function j(Q){var B,W=1;return(B=Q>>>16)!=0&&(Q=B,W+=16),(B=Q>>8)!=0&&(Q=B,W+=8),(B=Q>>4)!=0&&(Q=B,W+=4),(B=Q>>2)!=0&&(Q=B,W+=2),(B=Q>>1)!=0&&(Q=B,W+=1),W}S.ZERO=U(0),S.ONE=U(1);var z=function(){function Q(){this.i=0,this.j=0,this.S=[]}return Q.prototype.init=function(B){var W,Y,$;for(W=0;W<256;++W)this.S[W]=W;for(Y=0,W=0;W<256;++W)Y=Y+this.S[W]+B[W%B.length]&255,$=this.S[W],this.S[W]=this.S[Y],this.S[Y]=$;this.i=0,this.j=0},Q.prototype.next=function(){var B;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,B=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=B,this.S[B+this.S[this.i]&255]},Q}(),J,te,re=null;if(re==null){re=[],te=0;var oe=void 0;if(window.crypto&&window.crypto.getRandomValues){var se=new Uint32Array(256);for(window.crypto.getRandomValues(se),oe=0;oe<se.length;++oe)re[te++]=255&se[oe]}var me=0,fe=function(Q){if((me=me||0)>=256||te>=256)window.removeEventListener?window.removeEventListener("mousemove",fe,!1):window.detachEvent&&window.detachEvent("onmousemove",fe);else try{var B=Q.x+Q.y;re[te++]=255&B,me+=1}catch{}};window.addEventListener?window.addEventListener("mousemove",fe,!1):window.attachEvent&&window.attachEvent("onmousemove",fe)}function ue(){if(J==null){for(J=new z;te<256;){var Q=Math.floor(65536*Math.random());re[te++]=255&Q}for(J.init(re),te=0;te<re.length;++te)re[te]=0;te=0}return J.next()}var ye=function(){function Q(){}return Q.prototype.nextBytes=function(B){for(var W=0;W<B.length;++W)B[W]=ue()},Q}(),pe=function(){function Q(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return Q.prototype.doPublic=function(B){return B.modPowInt(this.e,this.n)},Q.prototype.doPrivate=function(B){if(this.p==null||this.q==null)return B.modPow(this.d,this.n);for(var W=B.mod(this.p).modPow(this.dmp1,this.p),Y=B.mod(this.q).modPow(this.dmq1,this.q);W.compareTo(Y)<0;)W=W.add(this.p);return W.subtract(Y).multiply(this.coeff).mod(this.p).multiply(this.q).add(Y)},Q.prototype.setPublic=function(B,W){B!=null&&W!=null&&B.length>0&&W.length>0?(this.n=_(B,16),this.e=parseInt(W,16)):console.error("Invalid RSA public key")},Q.prototype.encrypt=function(B){var W=function(ie,le){if(le<ie.length+11)return console.error("Message too long for RSA"),null;for(var ce=[],xe=ie.length-1;xe>=0&&le>0;){var Oe=ie.charCodeAt(xe--);Oe<128?ce[--le]=Oe:Oe>127&&Oe<2048?(ce[--le]=63&Oe|128,ce[--le]=Oe>>6|192):(ce[--le]=63&Oe|128,ce[--le]=Oe>>6&63|128,ce[--le]=Oe>>12|224)}ce[--le]=0;for(var ke=new ye,Ue=[];le>2;){for(Ue[0]=0;Ue[0]==0;)ke.nextBytes(Ue);ce[--le]=Ue[0]}return ce[--le]=2,ce[--le]=0,new S(ce)}(B,this.n.bitLength()+7>>3);if(W==null)return null;var Y=this.doPublic(W);if(Y==null)return null;var $=Y.toString(16);return(1&$.length)==0?$:"0"+$},Q.prototype.setPrivate=function(B,W,Y){B!=null&&W!=null&&B.length>0&&W.length>0?(this.n=_(B,16),this.e=parseInt(W,16),this.d=_(Y,16)):console.error("Invalid RSA private key")},Q.prototype.setPrivateEx=function(B,W,Y,$,ie,le,ce,xe){B!=null&&W!=null&&B.length>0&&W.length>0?(this.n=_(B,16),this.e=parseInt(W,16),this.d=_(Y,16),this.p=_($,16),this.q=_(ie,16),this.dmp1=_(le,16),this.dmq1=_(ce,16),this.coeff=_(xe,16)):console.error("Invalid RSA private key")},Q.prototype.generate=function(B,W){var Y=new ye,$=B>>1;this.e=parseInt(W,16);for(var ie=new S(W,16);;){for(;this.p=new S(B-$,1,Y),this.p.subtract(S.ONE).gcd(ie).compareTo(S.ONE)!=0||!this.p.isProbablePrime(10););for(;this.q=new S($,1,Y),this.q.subtract(S.ONE).gcd(ie).compareTo(S.ONE)!=0||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var le=this.p;this.p=this.q,this.q=le}var ce=this.p.subtract(S.ONE),xe=this.q.subtract(S.ONE),Oe=ce.multiply(xe);if(Oe.gcd(ie).compareTo(S.ONE)==0){this.n=this.p.multiply(this.q),this.d=ie.modInverse(Oe),this.dmp1=this.d.mod(ce),this.dmq1=this.d.mod(xe),this.coeff=this.q.modInverse(this.p);break}}},Q.prototype.decrypt=function(B){var W=_(B,16),Y=this.doPrivate(W);return Y==null?null:function($,ie){for(var le=$.toByteArray(),ce=0;ce<le.length&&le[ce]==0;)++ce;if(le.length-ce!=ie-1||le[ce]!=2)return null;for(++ce;le[ce]!=0;)if(++ce>=le.length)return null;for(var xe="";++ce<le.length;){var Oe=255&le[ce];Oe<128?xe+=String.fromCharCode(Oe):Oe>191&&Oe<224?(xe+=String.fromCharCode((31&Oe)<<6|63&le[ce+1]),++ce):(xe+=String.fromCharCode((15&Oe)<<12|(63&le[ce+1])<<6|63&le[ce+2]),ce+=2)}return xe}(Y,this.n.bitLength()+7>>3)},Q.prototype.generateAsync=function(B,W,Y){var $=new ye,ie=B>>1;this.e=parseInt(W,16);var le=new S(W,16),ce=this,xe=function(){var Oe=function(){if(ce.p.compareTo(ce.q)<=0){var Ne=ce.p;ce.p=ce.q,ce.q=Ne}var We=ce.p.subtract(S.ONE),Ke=ce.q.subtract(S.ONE),Qe=We.multiply(Ke);Qe.gcd(le).compareTo(S.ONE)==0?(ce.n=ce.p.multiply(ce.q),ce.d=le.modInverse(Qe),ce.dmp1=ce.d.mod(We),ce.dmq1=ce.d.mod(Ke),ce.coeff=ce.q.modInverse(ce.p),setTimeout(function(){Y()},0)):setTimeout(xe,0)},ke=function(){ce.q=O(),ce.q.fromNumberAsync(ie,1,$,function(){ce.q.subtract(S.ONE).gcda(le,function(Ne){Ne.compareTo(S.ONE)==0&&ce.q.isProbablePrime(10)?setTimeout(Oe,0):setTimeout(ke,0)})})},Ue=function(){ce.p=O(),ce.p.fromNumberAsync(B-ie,1,$,function(){ce.p.subtract(S.ONE).gcda(le,function(Ne){Ne.compareTo(S.ONE)==0&&ce.p.isProbablePrime(10)?setTimeout(ke,0):setTimeout(Ue,0)})})};setTimeout(Ue,0)};setTimeout(xe,0)},Q.prototype.sign=function(B,W,Y){var $=function(ce,xe){if(xe<ce.length+22)return console.error("Message too long for RSA"),null;for(var Oe=xe-ce.length-6,ke="",Ue=0;Ue<Oe;Ue+=2)ke+="ff";return _("0001"+ke+"00"+ce,16)}((de[Y]||"")+W(B).toString(),this.n.bitLength()/4);if($==null)return null;var ie=this.doPrivate($);if(ie==null)return null;var le=ie.toString(16);return(1&le.length)==0?le:"0"+le},Q.prototype.verify=function(B,W,Y){var $=_(W,16),ie=this.doPublic($);return ie==null?null:function(le){for(var ce in de)if(de.hasOwnProperty(ce)){var xe=de[ce],Oe=xe.length;if(le.substr(0,Oe)==xe)return le.substr(Oe)}return le}(ie.toString(16).replace(/^1f+00/,""))==Y(B).toString()},Q}(),de={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/var ve={};ve.lang={extend:function(Q,B,W){if(!B||!Q)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var Y=function(){};if(Y.prototype=B.prototype,Q.prototype=new Y,Q.prototype.constructor=Q,Q.superclass=B.prototype,B.prototype.constructor==Object.prototype.constructor&&(B.prototype.constructor=B),W){var $;for($ in W)Q.prototype[$]=W[$];var ie=function(){},le=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(ie=function(ce,xe){for($=0;$<le.length;$+=1){var Oe=le[$],ke=xe[Oe];typeof ke=="function"&&ke!=Object.prototype[Oe]&&(ce[Oe]=ke)}})}catch{}ie(Q.prototype,W)}}};/**
 * @fileOverview
 * @name asn1-1.0.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version asn1 1.0.13 (2017-Jun-02)
 * @since jsrsasign 2.1
 * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
 */var ne={};ne.asn1!==void 0&&ne.asn1||(ne.asn1={}),ne.asn1.ASN1Util=new function(){this.integerToByteHex=function(Q){var B=Q.toString(16);return B.length%2==1&&(B="0"+B),B},this.bigIntToMinTwosComplementsHex=function(Q){var B=Q.toString(16);if(B.substr(0,1)!="-")B.length%2==1?B="0"+B:B.match(/^[0-7]/)||(B="00"+B);else{var W=B.substr(1).length;W%2==1?W+=1:B.match(/^[0-7]/)||(W+=2);for(var Y="",$=0;$<W;$++)Y+="f";B=new S(Y,16).xor(Q).add(S.ONE).toString(16).replace(/^-/,"")}return B},this.getPEMStringFromHex=function(Q,B){return hextopem(Q,B)},this.newObject=function(Q){var B=ne.asn1,W=B.DERBoolean,Y=B.DERInteger,$=B.DERBitString,ie=B.DEROctetString,le=B.DERNull,ce=B.DERObjectIdentifier,xe=B.DEREnumerated,Oe=B.DERUTF8String,ke=B.DERNumericString,Ue=B.DERPrintableString,Ne=B.DERTeletexString,We=B.DERIA5String,Ke=B.DERUTCTime,Qe=B.DERGeneralizedTime,Ge=B.DERSequence,qe=B.DERSet,Ye=B.DERTaggedObject,ze=B.ASN1Util.newObject,$e=Object.keys(Q);if($e.length!=1)throw"key of param shall be only one.";var je=$e[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+je+":")==-1)throw"undefined key: "+je;if(je=="bool")return new W(Q[je]);if(je=="int")return new Y(Q[je]);if(je=="bitstr")return new $(Q[je]);if(je=="octstr")return new ie(Q[je]);if(je=="null")return new le(Q[je]);if(je=="oid")return new ce(Q[je]);if(je=="enum")return new xe(Q[je]);if(je=="utf8str")return new Oe(Q[je]);if(je=="numstr")return new ke(Q[je]);if(je=="prnstr")return new Ue(Q[je]);if(je=="telstr")return new Ne(Q[je]);if(je=="ia5str")return new We(Q[je]);if(je=="utctime")return new Ke(Q[je]);if(je=="gentime")return new Qe(Q[je]);if(je=="seq"){for(var et=Q[je],tt=[],at=0;at<et.length;at++){var st=ze(et[at]);tt.push(st)}return new Ge({array:tt})}if(je=="set"){for(et=Q[je],tt=[],at=0;at<et.length;at++)st=ze(et[at]),tt.push(st);return new qe({array:tt})}if(je=="tag"){var Ze=Q[je];if(Object.prototype.toString.call(Ze)==="[object Array]"&&Ze.length==3){var nt=ze(Ze[2]);return new Ye({tag:Ze[0],explicit:Ze[1],obj:nt})}var Ve={};if(Ze.explicit!==void 0&&(Ve.explicit=Ze.explicit),Ze.tag!==void 0&&(Ve.tag=Ze.tag),Ze.obj===void 0)throw"obj shall be specified for 'tag'.";return Ve.obj=ze(Ze.obj),new Ye(Ve)}},this.jsonToASN1HEX=function(Q){return this.newObject(Q).getEncodedHex()}},ne.asn1.ASN1Util.oidHexToInt=function(Q){for(var B="",W=parseInt(Q.substr(0,2),16),Y=(B=Math.floor(W/40)+"."+W%40,""),$=2;$<Q.length;$+=2){var ie=("00000000"+parseInt(Q.substr($,2),16).toString(2)).slice(-8);Y+=ie.substr(1,7),ie.substr(0,1)=="0"&&(B=B+"."+new S(Y,2).toString(10),Y="")}return B},ne.asn1.ASN1Util.oidIntToHex=function(Q){var B=function(ce){var xe=ce.toString(16);return xe.length==1&&(xe="0"+xe),xe},W=function(ce){var xe="",Oe=new S(ce,10).toString(2),ke=7-Oe.length%7;ke==7&&(ke=0);for(var Ue="",Ne=0;Ne<ke;Ne++)Ue+="0";for(Oe=Ue+Oe,Ne=0;Ne<Oe.length-1;Ne+=7){var We=Oe.substr(Ne,7);Ne!=Oe.length-7&&(We="1"+We),xe+=B(parseInt(We,2))}return xe};if(!Q.match(/^[0-9.]+$/))throw"malformed oid string: "+Q;var Y="",$=Q.split("."),ie=40*parseInt($[0])+parseInt($[1]);Y+=B(ie),$.splice(0,2);for(var le=0;le<$.length;le++)Y+=W($[le]);return Y},ne.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(this.hV===void 0||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var Q=this.hV.length/2,B=Q.toString(16);if(B.length%2==1&&(B="0"+B),Q<128)return B;var W=B.length/2;if(W>15)throw"ASN.1 length too long to represent by 8x: n = "+Q.toString(16);return(128+W).toString(16)+B},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},ne.asn1.DERAbstractString=function(Q){ne.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(B){this.hTLV=null,this.isModified=!0,this.s=B,this.hV=stohex(this.s)},this.setStringHex=function(B){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=B},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(typeof Q=="string"?this.setString(Q):Q.str!==void 0?this.setString(Q.str):Q.hex!==void 0&&this.setStringHex(Q.hex))},ve.lang.extend(ne.asn1.DERAbstractString,ne.asn1.ASN1Object),ne.asn1.DERAbstractTime=function(Q){ne.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(B){return utc=B.getTime()+6e4*B.getTimezoneOffset(),new Date(utc)},this.formatDate=function(B,W,Y){var $=this.zeroPadding,ie=this.localDateToUTC(B),le=String(ie.getFullYear());W=="utc"&&(le=le.substr(2,2));var ce=le+$(String(ie.getMonth()+1),2)+$(String(ie.getDate()),2)+$(String(ie.getHours()),2)+$(String(ie.getMinutes()),2)+$(String(ie.getSeconds()),2);if(Y===!0){var xe=ie.getMilliseconds();if(xe!=0){var Oe=$(String(xe),3);ce=ce+"."+(Oe=Oe.replace(/[0]+$/,""))}}return ce+"Z"},this.zeroPadding=function(B,W){return B.length>=W?B:new Array(W-B.length+1).join("0")+B},this.getString=function(){return this.s},this.setString=function(B){this.hTLV=null,this.isModified=!0,this.s=B,this.hV=stohex(B)},this.setByDateValue=function(B,W,Y,$,ie,le){var ce=new Date(Date.UTC(B,W-1,Y,$,ie,le,0));this.setByDate(ce)},this.getFreshValueHex=function(){return this.hV}},ve.lang.extend(ne.asn1.DERAbstractTime,ne.asn1.ASN1Object),ne.asn1.DERAbstractStructured=function(Q){ne.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(B){this.hTLV=null,this.isModified=!0,this.asn1Array=B},this.appendASN1Object=function(B){this.hTLV=null,this.isModified=!0,this.asn1Array.push(B)},this.asn1Array=new Array,Q!==void 0&&Q.array!==void 0&&(this.asn1Array=Q.array)},ve.lang.extend(ne.asn1.DERAbstractStructured,ne.asn1.ASN1Object),ne.asn1.DERBoolean=function(){ne.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ve.lang.extend(ne.asn1.DERBoolean,ne.asn1.ASN1Object),ne.asn1.DERInteger=function(Q){ne.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(B){this.hTLV=null,this.isModified=!0,this.hV=ne.asn1.ASN1Util.bigIntToMinTwosComplementsHex(B)},this.setByInteger=function(B){var W=new S(String(B),10);this.setByBigInteger(W)},this.setValueHex=function(B){this.hV=B},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(Q.bigint!==void 0?this.setByBigInteger(Q.bigint):Q.int!==void 0?this.setByInteger(Q.int):typeof Q=="number"?this.setByInteger(Q):Q.hex!==void 0&&this.setValueHex(Q.hex))},ve.lang.extend(ne.asn1.DERInteger,ne.asn1.ASN1Object),ne.asn1.DERBitString=function(Q){if(Q!==void 0&&Q.obj!==void 0){var B=ne.asn1.ASN1Util.newObject(Q.obj);Q.hex="00"+B.getEncodedHex()}ne.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(W){this.hTLV=null,this.isModified=!0,this.hV=W},this.setUnusedBitsAndHexValue=function(W,Y){if(W<0||7<W)throw"unused bits shall be from 0 to 7: u = "+W;var $="0"+W;this.hTLV=null,this.isModified=!0,this.hV=$+Y},this.setByBinaryString=function(W){var Y=8-(W=W.replace(/0+$/,"")).length%8;Y==8&&(Y=0);for(var $=0;$<=Y;$++)W+="0";var ie="";for($=0;$<W.length-1;$+=8){var le=W.substr($,8),ce=parseInt(le,2).toString(16);ce.length==1&&(ce="0"+ce),ie+=ce}this.hTLV=null,this.isModified=!0,this.hV="0"+Y+ie},this.setByBooleanArray=function(W){for(var Y="",$=0;$<W.length;$++)W[$]==1?Y+="1":Y+="0";this.setByBinaryString(Y)},this.newFalseArray=function(W){for(var Y=new Array(W),$=0;$<W;$++)Y[$]=!1;return Y},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(typeof Q=="string"&&Q.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(Q):Q.hex!==void 0?this.setHexValueIncludingUnusedBits(Q.hex):Q.bin!==void 0?this.setByBinaryString(Q.bin):Q.array!==void 0&&this.setByBooleanArray(Q.array))},ve.lang.extend(ne.asn1.DERBitString,ne.asn1.ASN1Object),ne.asn1.DEROctetString=function(Q){if(Q!==void 0&&Q.obj!==void 0){var B=ne.asn1.ASN1Util.newObject(Q.obj);Q.hex=B.getEncodedHex()}ne.asn1.DEROctetString.superclass.constructor.call(this,Q),this.hT="04"},ve.lang.extend(ne.asn1.DEROctetString,ne.asn1.DERAbstractString),ne.asn1.DERNull=function(){ne.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ve.lang.extend(ne.asn1.DERNull,ne.asn1.ASN1Object),ne.asn1.DERObjectIdentifier=function(Q){var B=function(Y){var $=Y.toString(16);return $.length==1&&($="0"+$),$},W=function(Y){var $="",ie=new S(Y,10).toString(2),le=7-ie.length%7;le==7&&(le=0);for(var ce="",xe=0;xe<le;xe++)ce+="0";for(ie=ce+ie,xe=0;xe<ie.length-1;xe+=7){var Oe=ie.substr(xe,7);xe!=ie.length-7&&(Oe="1"+Oe),$+=B(parseInt(Oe,2))}return $};ne.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(Y){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=Y},this.setValueOidString=function(Y){if(!Y.match(/^[0-9.]+$/))throw"malformed oid string: "+Y;var $="",ie=Y.split("."),le=40*parseInt(ie[0])+parseInt(ie[1]);$+=B(le),ie.splice(0,2);for(var ce=0;ce<ie.length;ce++)$+=W(ie[ce]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=$},this.setValueName=function(Y){var $=ne.asn1.x509.OID.name2oid(Y);if($==="")throw"DERObjectIdentifier oidName undefined: "+Y;this.setValueOidString($)},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(typeof Q=="string"?Q.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(Q):this.setValueName(Q):Q.oid!==void 0?this.setValueOidString(Q.oid):Q.hex!==void 0?this.setValueHex(Q.hex):Q.name!==void 0&&this.setValueName(Q.name))},ve.lang.extend(ne.asn1.DERObjectIdentifier,ne.asn1.ASN1Object),ne.asn1.DEREnumerated=function(Q){ne.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(B){this.hTLV=null,this.isModified=!0,this.hV=ne.asn1.ASN1Util.bigIntToMinTwosComplementsHex(B)},this.setByInteger=function(B){var W=new S(String(B),10);this.setByBigInteger(W)},this.setValueHex=function(B){this.hV=B},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(Q.int!==void 0?this.setByInteger(Q.int):typeof Q=="number"?this.setByInteger(Q):Q.hex!==void 0&&this.setValueHex(Q.hex))},ve.lang.extend(ne.asn1.DEREnumerated,ne.asn1.ASN1Object),ne.asn1.DERUTF8String=function(Q){ne.asn1.DERUTF8String.superclass.constructor.call(this,Q),this.hT="0c"},ve.lang.extend(ne.asn1.DERUTF8String,ne.asn1.DERAbstractString),ne.asn1.DERNumericString=function(Q){ne.asn1.DERNumericString.superclass.constructor.call(this,Q),this.hT="12"},ve.lang.extend(ne.asn1.DERNumericString,ne.asn1.DERAbstractString),ne.asn1.DERPrintableString=function(Q){ne.asn1.DERPrintableString.superclass.constructor.call(this,Q),this.hT="13"},ve.lang.extend(ne.asn1.DERPrintableString,ne.asn1.DERAbstractString),ne.asn1.DERTeletexString=function(Q){ne.asn1.DERTeletexString.superclass.constructor.call(this,Q),this.hT="14"},ve.lang.extend(ne.asn1.DERTeletexString,ne.asn1.DERAbstractString),ne.asn1.DERIA5String=function(Q){ne.asn1.DERIA5String.superclass.constructor.call(this,Q),this.hT="16"},ve.lang.extend(ne.asn1.DERIA5String,ne.asn1.DERAbstractString),ne.asn1.DERUTCTime=function(Q){ne.asn1.DERUTCTime.superclass.constructor.call(this,Q),this.hT="17",this.setByDate=function(B){this.hTLV=null,this.isModified=!0,this.date=B,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},Q!==void 0&&(Q.str!==void 0?this.setString(Q.str):typeof Q=="string"&&Q.match(/^[0-9]{12}Z$/)?this.setString(Q):Q.hex!==void 0?this.setStringHex(Q.hex):Q.date!==void 0&&this.setByDate(Q.date))},ve.lang.extend(ne.asn1.DERUTCTime,ne.asn1.DERAbstractTime),ne.asn1.DERGeneralizedTime=function(Q){ne.asn1.DERGeneralizedTime.superclass.constructor.call(this,Q),this.hT="18",this.withMillis=!1,this.setByDate=function(B){this.hTLV=null,this.isModified=!0,this.date=B,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},Q!==void 0&&(Q.str!==void 0?this.setString(Q.str):typeof Q=="string"&&Q.match(/^[0-9]{14}Z$/)?this.setString(Q):Q.hex!==void 0?this.setStringHex(Q.hex):Q.date!==void 0&&this.setByDate(Q.date),Q.millis===!0&&(this.withMillis=!0))},ve.lang.extend(ne.asn1.DERGeneralizedTime,ne.asn1.DERAbstractTime),ne.asn1.DERSequence=function(Q){ne.asn1.DERSequence.superclass.constructor.call(this,Q),this.hT="30",this.getFreshValueHex=function(){for(var B="",W=0;W<this.asn1Array.length;W++)B+=this.asn1Array[W].getEncodedHex();return this.hV=B,this.hV}},ve.lang.extend(ne.asn1.DERSequence,ne.asn1.DERAbstractStructured),ne.asn1.DERSet=function(Q){ne.asn1.DERSet.superclass.constructor.call(this,Q),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var B=new Array,W=0;W<this.asn1Array.length;W++){var Y=this.asn1Array[W];B.push(Y.getEncodedHex())}return this.sortFlag==1&&B.sort(),this.hV=B.join(""),this.hV},Q!==void 0&&Q.sortflag!==void 0&&Q.sortflag==0&&(this.sortFlag=!1)},ve.lang.extend(ne.asn1.DERSet,ne.asn1.DERAbstractStructured),ne.asn1.DERTaggedObject=function(Q){ne.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(B,W,Y){this.hT=W,this.isExplicit=B,this.asn1Object=Y,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=Y.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,W),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},Q!==void 0&&(Q.tag!==void 0&&(this.hT=Q.tag),Q.explicit!==void 0&&(this.isExplicit=Q.explicit),Q.obj!==void 0&&(this.asn1Object=Q.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ve.lang.extend(ne.asn1.DERTaggedObject,ne.asn1.ASN1Object);var we,Ce=(we=function(Q,B){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(W,Y){W.__proto__=Y}||function(W,Y){for(var $ in Y)Object.prototype.hasOwnProperty.call(Y,$)&&(W[$]=Y[$])})(Q,B)},function(Q,B){function W(){this.constructor=Q}we(Q,B),Q.prototype=B===null?Object.create(B):(W.prototype=B.prototype,new W)}),ge=function(Q){function B(W){var Y=Q.call(this)||this;return W&&(typeof W=="string"?Y.parseKey(W):(B.hasPrivateKeyProperty(W)||B.hasPublicKeyProperty(W))&&Y.parsePropertiesFrom(W)),Y}return Ce(B,Q),B.prototype.parseKey=function(W){try{var Y=0,$=0,ie=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(W)?u(W):t.unarmor(W),le=E.decode(ie);if(le.sub.length===3&&(le=le.sub[2].sub[0]),le.sub.length===9){Y=le.sub[1].getHexStringValue(),this.n=_(Y,16),$=le.sub[2].getHexStringValue(),this.e=parseInt($,16);var ce=le.sub[3].getHexStringValue();this.d=_(ce,16);var xe=le.sub[4].getHexStringValue();this.p=_(xe,16);var Oe=le.sub[5].getHexStringValue();this.q=_(Oe,16);var ke=le.sub[6].getHexStringValue();this.dmp1=_(ke,16);var Ue=le.sub[7].getHexStringValue();this.dmq1=_(Ue,16);var Ne=le.sub[8].getHexStringValue();this.coeff=_(Ne,16)}else{if(le.sub.length!==2)return!1;var We=le.sub[1].sub[0];Y=We.sub[0].getHexStringValue(),this.n=_(Y,16),$=We.sub[1].getHexStringValue(),this.e=parseInt($,16)}return!0}catch{return!1}},B.prototype.getPrivateBaseKey=function(){var W={array:[new ne.asn1.DERInteger({int:0}),new ne.asn1.DERInteger({bigint:this.n}),new ne.asn1.DERInteger({int:this.e}),new ne.asn1.DERInteger({bigint:this.d}),new ne.asn1.DERInteger({bigint:this.p}),new ne.asn1.DERInteger({bigint:this.q}),new ne.asn1.DERInteger({bigint:this.dmp1}),new ne.asn1.DERInteger({bigint:this.dmq1}),new ne.asn1.DERInteger({bigint:this.coeff})]};return new ne.asn1.DERSequence(W).getEncodedHex()},B.prototype.getPrivateBaseKeyB64=function(){return n(this.getPrivateBaseKey())},B.prototype.getPublicBaseKey=function(){var W=new ne.asn1.DERSequence({array:[new ne.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new ne.asn1.DERNull]}),Y=new ne.asn1.DERSequence({array:[new ne.asn1.DERInteger({bigint:this.n}),new ne.asn1.DERInteger({int:this.e})]}),$=new ne.asn1.DERBitString({hex:"00"+Y.getEncodedHex()});return new ne.asn1.DERSequence({array:[W,$]}).getEncodedHex()},B.prototype.getPublicBaseKeyB64=function(){return n(this.getPublicBaseKey())},B.wordwrap=function(W,Y){if(!W)return W;var $="(.{1,"+(Y=Y||64)+`})( +|$
?)|(.{1,`+Y+"})";return W.match(RegExp($,"g")).join(`
`)},B.prototype.getPrivateKey=function(){var W=`-----BEGIN RSA PRIVATE KEY-----
`;return W+=B.wordwrap(this.getPrivateBaseKeyB64())+`
`,W+="-----END RSA PRIVATE KEY-----"},B.prototype.getPublicKey=function(){var W=`-----BEGIN PUBLIC KEY-----
`;return W+=B.wordwrap(this.getPublicBaseKeyB64())+`
`,W+="-----END PUBLIC KEY-----"},B.hasPublicKeyProperty=function(W){return(W=W||{}).hasOwnProperty("n")&&W.hasOwnProperty("e")},B.hasPrivateKeyProperty=function(W){return(W=W||{}).hasOwnProperty("n")&&W.hasOwnProperty("e")&&W.hasOwnProperty("d")&&W.hasOwnProperty("p")&&W.hasOwnProperty("q")&&W.hasOwnProperty("dmp1")&&W.hasOwnProperty("dmq1")&&W.hasOwnProperty("coeff")},B.prototype.parsePropertiesFrom=function(W){this.n=W.n,this.e=W.e,W.hasOwnProperty("d")&&(this.d=W.d,this.p=W.p,this.q=W.q,this.dmp1=W.dmp1,this.dmq1=W.dmq1,this.coeff=W.coeff)},B}(pe);const _e="3.0.1",Pe=function(){function Q(B){B=B||{},this.default_key_size=B.default_key_size?parseInt(B.default_key_size,10):1024,this.default_public_exponent=B.default_public_exponent||"010001",this.log=B.log||!1,this.key=null}return Q.prototype.setKey=function(B){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ge(B)},Q.prototype.setPrivateKey=function(B){this.setKey(B)},Q.prototype.setPublicKey=function(B){this.setKey(B)},Q.prototype.decrypt=function(B){try{return this.getKey().decrypt(a(B))}catch{return!1}},Q.prototype.encrypt=function(B){try{return n(this.getKey().encrypt(B))}catch{return!1}},Q.prototype.sign=function(B,W,Y){try{return n(this.getKey().sign(B,W,Y))}catch{return!1}},Q.prototype.verify=function(B,W,Y){try{return this.getKey().verify(B,a(W),Y)}catch{return!1}},Q.prototype.getKey=function(B){if(!this.key){if(this.key=new ge,B&&{}.toString.call(B)==="[object Function]")return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,B);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},Q.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},Q.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},Q.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},Q.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},Q.version=_e,Q}()},802:be=>{var H=function(X){return X.replace(/^\s+|\s+$/g,"")};be.exports=function(X){if(!X)return{};for(var I,K={},F=H(X).split(`
`),G=0;G<F.length;G++){var m=F[G],r=m.indexOf(":"),c=H(m.slice(0,r)).toLowerCase(),l=H(m.slice(r+1));K[c]===void 0?K[c]=l:(I=K[c],Object.prototype.toString.call(I)==="[object Array]"?K[c].push(l):K[c]=[K[c],l])}return K}},415:(be,H,X)=>{var I=X(579),K=X(135),F=X(802),G=X(515);function m(l,e,n){var a=l;return K(e)?(n=e,typeof l=="string"&&(a={uri:l})):a=G(e,{uri:l}),a.callback=n,a}function r(l,e,n){return c(e=m(l,e,n))}function c(l){if(l.callback===void 0)throw new Error("callback argument missing");var e=!1,n=function(b,S,C){e||(e=!0,l.callback(b,S,C))};function a(){var b=void 0;if(b=h.response?h.response:h.responseText||function(S){try{if(S.responseType==="document")return S.responseXML;var C=S.responseXML&&S.responseXML.documentElement.nodeName==="parsererror";if(S.responseType===""&&!C)return S.responseXML}catch{}return null}(h),w)try{b=JSON.parse(b)}catch{}return b}function s(b){return clearTimeout(v),b instanceof Error||(b=new Error(""+(b||"Unknown XMLHttpRequest Error"))),b.statusCode=0,n(b,D)}function u(){if(!f){var b;clearTimeout(v),b=l.useXDR&&h.status===void 0?200:h.status===1223?204:h.status;var S=D,C=null;return b!==0?(S={body:a(),statusCode:b,method:p,headers:{},url:y,rawRequest:h},h.getAllResponseHeaders&&(S.headers=F(h.getAllResponseHeaders()))):C=new Error("Internal XMLHttpRequest Error"),n(C,S,S.body)}}var t,f,h=l.xhr||null;h||(h=l.cors||l.useXDR?new r.XDomainRequest:new r.XMLHttpRequest);var v,y=h.url=l.uri||l.url,p=h.method=l.method||"GET",g=l.body||l.data,d=h.headers=l.headers||{},E=!!l.sync,w=!1,D={body:void 0,headers:{},statusCode:0,method:p,url:y,rawRequest:h};if("json"in l&&l.json!==!1&&(w=!0,d.accept||d.Accept||(d.Accept="application/json"),p!=="GET"&&p!=="HEAD"&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),g=JSON.stringify(l.json===!0?g:l.json))),h.onreadystatechange=function(){h.readyState===4&&setTimeout(u,0)},h.onload=u,h.onerror=s,h.onprogress=function(){},h.onabort=function(){f=!0},h.ontimeout=s,h.open(p,y,!E,l.username,l.password),E||(h.withCredentials=!!l.withCredentials),!E&&l.timeout>0&&(v=setTimeout(function(){if(!f){f=!0,h.abort("timeout");var b=new Error("XMLHttpRequest timeout");b.code="ETIMEDOUT",s(b)}},l.timeout)),h.setRequestHeader)for(t in d)d.hasOwnProperty(t)&&h.setRequestHeader(t,d[t]);else if(l.headers&&!function(b){for(var S in b)if(b.hasOwnProperty(S))return!1;return!0}(l.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in l&&(h.responseType=l.responseType),"beforeSend"in l&&typeof l.beforeSend=="function"&&l.beforeSend(h),h.send(g||null),h}be.exports=r,be.exports.default=r,r.XMLHttpRequest=I.XMLHttpRequest||function(){},r.XDomainRequest="withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:I.XDomainRequest,function(l,e){for(var n=0;n<l.length;n++)e(l[n])}(["get","put","post","patch","head","delete"],function(l){r[l==="delete"?"del":l]=function(e,n,a){return(n=m(e,n,a)).method=l.toUpperCase(),c(n)}})},515:be=>{be.exports=function(){for(var X={},I=0;I<arguments.length;I++){var K=arguments[I];for(var F in K)H.call(K,F)&&(X[F]=K[F])}return X};var H=Object.prototype.hasOwnProperty},533:()=>{}},__webpack_module_cache__={};function __webpack_require__(be){if(__webpack_module_cache__[be])return __webpack_module_cache__[be].exports;var H=__webpack_module_cache__[be]={exports:{}};return __webpack_modules__[be](H,H.exports,__webpack_require__),H.exports}__webpack_require__.n=be=>{var H=be&&be.__esModule?()=>be.default:()=>be;return __webpack_require__.d(H,{a:H}),H},__webpack_require__.d=(be,H)=>{for(var X in H)__webpack_require__.o(H,X)&&!__webpack_require__.o(be,X)&&Object.defineProperty(be,X,{enumerable:!0,get:H[X]})},__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(be,H)=>Object.prototype.hasOwnProperty.call(be,H),__webpack_require__.r=be=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(be,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(be,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{var be=__webpack_exports__,H=__webpack_require__(727);function X(f){return(X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(f)}be.default=void 0;var I=l(__webpack_require__(415)),K=c(__webpack_require__(464)),F=c(__webpack_require__(95)),G=l(__webpack_require__(132)),m=__webpack_require__(672);function r(){if(typeof WeakMap!="function")return null;var f=new WeakMap;return r=function(){return f},f}function c(f){if(f&&f.__esModule)return f;if(f===null||X(f)!=="object"&&typeof f!="function")return{default:f};var h=r();if(h&&h.has(f))return h.get(f);var v={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in f)if(Object.prototype.hasOwnProperty.call(f,p)){var g=y?Object.getOwnPropertyDescriptor(f,p):null;g&&(g.get||g.set)?Object.defineProperty(v,p,g):v[p]=f[p]}return v.default=f,h&&h.set(f,v),v}function l(f){return f&&f.__esModule?f:{default:f}}function e(f,h){var v=Object.keys(f);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(f);h&&(y=y.filter(function(p){return Object.getOwnPropertyDescriptor(f,p).enumerable})),v.push.apply(v,y)}return v}function n(f){for(var h=1;h<arguments.length;h++){var v=arguments[h]!=null?arguments[h]:{};h%2?e(Object(v),!0).forEach(function(y){a(f,y,v[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(v)):e(Object(v)).forEach(function(y){Object.defineProperty(f,y,Object.getOwnPropertyDescriptor(v,y))})}return f}function a(f,h,v){return h in f?Object.defineProperty(f,h,{value:v,enumerable:!0,configurable:!0,writable:!0}):f[h]=v,f}function s(f,h){for(var v=0;v<h.length;v++){var y=h[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(f,y.key,y)}}var u=function(){function f(p,g,d){(function(E,w){if(!(E instanceof w))throw new TypeError("Cannot call a class as a function")})(this,f),this.checkEnv(p),this.getVideoInfo(g),this.callback=d,this.hlsConfig=g.hlsConfig||{}}var h,v,y;return h=f,y=[{key:"isSupported",value:function(){return K.isSupported()}}],(v=[{key:"checkEnv",value:function(p){if(K.isSupported()?this.loadHls():console.error("Hls.js is not supported."),typeof p=="string")this.el=document.querySelector("#"+p);else{if(!p||!p.nodeName)throw new Error("The ID or element supplied is not valid.");this.el=p}if(this.el.nodeName.toLowerCase()!="video"&&this.el.nodeName.toLowerCase()!="audio")throw new Error("The element type must be <video>.")}},{key:"getVideoBasicInfo",value:function(){var p=this.basicInfo||{};return{name:p.name,duration:p.duration,description:p.description,coverUrl:p.coverUrl}}},{key:"getStreamimgOutputList",value:function(){var p=this.streamingInfo[0];return{type:p.type,url:p.url,subStreams:p.subStreams}}},{key:"getKeyFrameDescInfo",value:function(){return this.keyFrameDescInfo}},{key:"getImageSpriteInfo",value:function(){return this.imageSpriteInfo}},{key:"getVideoInfo",value:function(p){return H.g(H.v(0,H.d(["HgQxAjEDOAMeBjECMQMxBDEFKQMDAAodHSkEKQAMC2ELcwtzC2ULbQtiC2wLeQtQC2ELdAtoC1YLNEMMC2cLZQt0C3ALbAthC3kLaQtuC2YLbw8AIwwLYQtwC3ALSQtENxkPACMMC2YLaQtsC2ULSQtENxkPACMMC3ALcwtpC2cLbjcZJAQKHR0pBQ8BIwwLZAtlC2YLYQt1C2wLdDcPAggBCh0GAiMMC2ULbgtNC28LZAt1C2wLZTcDBRcdHSkEKQUMC2cLZQtuC2ULcgthC3QLZQtQC2wLYQt5C0MLZwtpC1ULcgtsQwMEJAEKHR0pAAwLZwtlC3QLSQtuC2YLbwtSC2ULdAtyC3kLVAtpC20LZQtzQw8AFx0dKQAMC2cLZQt0C0kLbgtmC28LUgtlC3ELdQtlC3MLdEM4JB4FMQIPAAYDIwwLZAtlC2YLYQt1C2wLdDcZDwQuOgAyDAt1C3ILbB8DAxcdHTIMC3QLaQttC2ULbwt1C3QfDxcdBgUjDAtiC2kLbgtkNwMEKQQMC28LbgtSC2ULcwt1C2wLdAtWCzRDGSQCFgIdMycNAgADBAQDFx0dKQAMC2cLZQt0C0kLbgtmC28LUgtlC3ELdQtlC3MLdEMkAB0zJykDDQkAAAodHTMn",[7,479,316,431,381,3e3,432,318]]),[function(){return p===void 0?void 0:p},function(){return G===void 0?void 0:G},function(){return typeof window=="undefined"?void 0:window},function(){return I===void 0?void 0:I},function(){return typeof Object=="undefined"?void 0:Object},function(){return K===void 0?void 0:K}])).call(this)}},{key:"assemblyPathV4",value:function(p,g,d,E){var w=window.location.protocol;return w!="http:"&&w!="https:"&&(w="https:"),"".concat(w).concat(m.SERVER_PATH_V4,"/").concat(p,"/v4/").concat(g,"/").concat(d,"?psign=").concat(E)}},{key:"onResultV4",value:function(p,g,d){try{d?g=JSON.parse(d):p||g.body||(p=new Error("ServerError"))}catch(w){p=new Error(w.message||"ServerError")}if(g.code!==0)return g.code>=2e3&&g.code<3e3&&this.getInfoRetryTimes<3?(this.getInfoRetryTimes++,this.getInfoRequest(),!1):(F.trigger(this,n({type:m.TcAdapterEvents.ERROR},{message:g.message||m.TcAdapterErrors[0]})),!1);if(p||g.version!==4){if(g.version===2)return F.trigger(this,n({type:m.TcAdapterEvents.ERROR},{message:m.TcAdapterErrors[1]})),!1;if(this.getInfoRetryTimes<3)return this.getInfoRetryTimes++,void this.getInfoRequest();F.trigger(this,n({type:m.TcAdapterEvents.ERROR},{message:p&&p.message||"ServerError"}))}else{var E=g.media;this.parseMediaInfo(E),this.callback&&this.callback(),F.trigger(this,{type:m.TcAdapterEvents.LOADEDMETADATA}),this.load(this.getSrcV4(E))}}},{key:"parseMediaInfo",value:function(p){this.basicInfo=p.basicInfo||{},this.streamingInfo=p.streamingInfo&&p.streamingInfo.drmOutput||[],this.keyFrameDescInfo=p.keyFrameDescInfo&&p.keyFrameDescInfo.keyFrameDescList||{},this.imageSpriteInfo=p.imageSpriteInfo||{}}},{key:"getSrcV4",value:function(p){var g;if(!p.streamingInfo)throw new Error(m.TcAdapterErrors[2]);if(p.streamingInfo){if(this.hlsConfig.startLevel||(this.hlsConfig.startLevel=5),p.streamingInfo.plainOutput&&(g=p.streamingInfo.plainOutput.url,window.enModule=null),p.streamingInfo.drmOutput&&Array.isArray(p.streamingInfo.drmOutput)){var d=p.streamingInfo.drmOutput;if(d[0].type==="SimpleAES"){var E=d[0].url.split("/");E[E.length-1]="voddrm.token."+p.streamingInfo.drmToken+"."+E[E.length-1],g=E.join("/")}}if(!g)throw new Error(m.TcAdapterErrors[2])}return K.unifyProtocol(g)}},{key:"loadHls",value:function(p){if(window.TcHls===void 0)try{K.loadScript(K.unifyProtocol("//cloudcache.tencentcs.com/qcloud/video/dist/tchls.min.js"),p)}catch(g){throw new Error(g.message||m.TcAdapterErrors[3])}}},{key:"load",value:function(p){var g=this;window.TcHls===void 0?this.loadHls(function(){g.hlsLoaded.call(g,p)}):this.hlsLoaded(p)}},{key:"on",value:function(p,g){return F.on(this,p,g)}},{key:"proxyEvents",value:function(p,g){F.trigger(this,n({type:p},g))}},{key:"hlsLoaded",value:function(p){window.enModule&&Object.assign(this.hlsConfig,window.enModule.generateOverlayKeyAndIv());var g=new TcHls(this.hlsConfig),d=Object.keys(m.EventsNotExposed);for(var E in TcHls.Events)d.includes(E)||g.on(TcHls.Events[E],this.proxyEvents.bind(this));var w=new Proxy(g,{get:function(D,b){return b==="on"?null:D[b]}});this.hls=w,F.trigger(this,{type:m.TcAdapterEvents.HLSREADY}),g.loadSource(p),g.attachMedia(this.el)}}])&&s(h.prototype,v),y&&s(h,y),f}();u.TcAdapterEvents=m.TcAdapterEvents;var t=u;be.default=t})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()})})(dist);var TcAdapter=getDefaultExportFromCjs(dist.exports),_imports_0="/assets/setting.73f0da38.png";export{HlsJsPlayer as H,TcAdapter as T,_imports_0 as _,fabric as f};
